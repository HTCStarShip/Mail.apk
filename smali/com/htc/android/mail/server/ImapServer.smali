.class public Lcom/htc/android/mail/server/ImapServer;
.super Lcom/htc/android/mail/server/Server;
.source "ImapServer.java"


# annotations
.annotation system Ldalvik/annotation/MemberClasses;
    value = {
        Lcom/htc/android/mail/server/ImapServer$UidRange;,
        Lcom/htc/android/mail/server/ImapServer$UidSet;,
        Lcom/htc/android/mail/server/ImapServer$ImapVanishedResponse;,
        Lcom/htc/android/mail/server/ImapServer$ImapResponses;,
        Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;,
        Lcom/htc/android/mail/server/ImapServer$ImapCapability;,
        Lcom/htc/android/mail/server/ImapServer$ImapEnabled;,
        Lcom/htc/android/mail/server/ImapServer$ByteStringListInputStream;,
        Lcom/htc/android/mail/server/ImapServer$ByteStringInputStream;,
        Lcom/htc/android/mail/server/ImapServer$StringComparator;
    }
.end annotation


# static fields
.field public static final CHAR_PLUS:C = '+'

.field public static ONETIME_ENCODE_SIZE:I = 0x0

.field private static final STR_BAD:Lcom/htc/android/mail/ByteString; = null

.field private static final STR_EOM:Lcom/htc/android/mail/ByteString; = null

.field public static final STR_EXISTS:Ljava/lang/String; = "EXISTS"

.field protected static final STR_NIL:Lcom/htc/android/mail/ByteString; = null

.field private static final STR_NO:Lcom/htc/android/mail/ByteString; = null

.field protected static final STR_OK:Lcom/htc/android/mail/ByteString; = null

.field private static final STR_SPACE:Lcom/htc/android/mail/ByteString; = null

.field protected static final STR_STAR:Lcom/htc/android/mail/ByteString; = null

.field protected static final STR_STAR_OK:Lcom/htc/android/mail/ByteString; = null

.field private static final STR_UIDL:Lcom/htc/android/mail/ByteString; = null

.field private static final TAG:Ljava/lang/String; = "ImapServer"

.field private static final sMaxDownloadSize:I = 0x400


# instance fields
.field private alterBoundary:Ljava/lang/String;

.field protected countOutStream:Lcom/htc/android/mail/CountSizeOutputStream;

.field protected mAccount:Lcom/htc/android/mail/Account;

.field protected mBeginningTimeMillis:J

.field protected final mConnectionTimeOut:I

.field protected mContext:Landroid/content/Context;

.field protected mCurrentImapMailboxInfo:Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;

.field mFetchHeaderSize:I

.field protected mImapCapability:Lcom/htc/android/mail/server/ImapServer$ImapCapability;

.field protected mImapEnabled:Lcom/htc/android/mail/server/ImapServer$ImapEnabled;

.field protected mIn:Ljava/io/BufferedInputStream;

.field private mInPort:I

.field private mInServer:Ljava/lang/String;

.field protected mIsNotSupportSearch:Z

.field private mIsRefreshing:Z

.field private mLastUid:Ljava/lang/String;

.field private mMSGID:I

.field protected mMailbox:Lcom/htc/android/mail/Mailbox;

.field protected mMailboxIdForSummariesUri:J

.field protected mMessageStatusMap:Lcom/htc/android/mail/AbsRequestController$MessageStatusMap;

.field protected mOut:Ljava/io/BufferedOutputStream;

.field protected final mReadTimeOut:I

.field protected mSocket:Ljava/net/Socket;

.field private mSslError:Lcom/htc/android/mail/ssl/MailSslError;

.field protected mSummariesUri:Landroid/net/Uri;

.field private mSyncResult:Lcom/htc/android/mail/server/Server$SyncResult;

.field private mUseSSLin:I

.field private mX509Certificate:Ljava/security/cert/X509Certificate;

.field private mixBoundary:Ljava/lang/String;

.field protected mixedType:I

.field private relatedBoundary:Ljava/lang/String;

.field protected relatedType:I


# direct methods
.method static constructor <clinit>()V
    .locals 2

    .prologue
    .line 128
    new-instance v0, Lcom/htc/android/mail/ByteString;

    const-string v1, "OK"

    invoke-direct {v0, v1}, Lcom/htc/android/mail/ByteString;-><init>(Ljava/lang/String;)V

    sput-object v0, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    .line 129
    new-instance v0, Lcom/htc/android/mail/ByteString;

    const-string v1, "BAD"

    invoke-direct {v0, v1}, Lcom/htc/android/mail/ByteString;-><init>(Ljava/lang/String;)V

    sput-object v0, Lcom/htc/android/mail/server/ImapServer;->STR_BAD:Lcom/htc/android/mail/ByteString;

    .line 130
    new-instance v0, Lcom/htc/android/mail/ByteString;

    const-string v1, "NO"

    invoke-direct {v0, v1}, Lcom/htc/android/mail/ByteString;-><init>(Ljava/lang/String;)V

    sput-object v0, Lcom/htc/android/mail/server/ImapServer;->STR_NO:Lcom/htc/android/mail/ByteString;

    .line 131
    new-instance v0, Lcom/htc/android/mail/ByteString;

    const-string v1, ".\r\n"

    invoke-direct {v0, v1}, Lcom/htc/android/mail/ByteString;-><init>(Ljava/lang/String;)V

    sput-object v0, Lcom/htc/android/mail/server/ImapServer;->STR_EOM:Lcom/htc/android/mail/ByteString;

    .line 132
    new-instance v0, Lcom/htc/android/mail/ByteString;

    const-string v1, "UIDL"

    invoke-direct {v0, v1}, Lcom/htc/android/mail/ByteString;-><init>(Ljava/lang/String;)V

    sput-object v0, Lcom/htc/android/mail/server/ImapServer;->STR_UIDL:Lcom/htc/android/mail/ByteString;

    .line 133
    new-instance v0, Lcom/htc/android/mail/ByteString;

    const-string v1, "*"

    invoke-direct {v0, v1}, Lcom/htc/android/mail/ByteString;-><init>(Ljava/lang/String;)V

    sput-object v0, Lcom/htc/android/mail/server/ImapServer;->STR_STAR:Lcom/htc/android/mail/ByteString;

    .line 134
    new-instance v0, Lcom/htc/android/mail/ByteString;

    const-string v1, "* OK"

    invoke-direct {v0, v1}, Lcom/htc/android/mail/ByteString;-><init>(Ljava/lang/String;)V

    sput-object v0, Lcom/htc/android/mail/server/ImapServer;->STR_STAR_OK:Lcom/htc/android/mail/ByteString;

    .line 135
    new-instance v0, Lcom/htc/android/mail/ByteString;

    const-string v1, " "

    invoke-direct {v0, v1}, Lcom/htc/android/mail/ByteString;-><init>(Ljava/lang/String;)V

    sput-object v0, Lcom/htc/android/mail/server/ImapServer;->STR_SPACE:Lcom/htc/android/mail/ByteString;

    .line 136
    new-instance v0, Lcom/htc/android/mail/ByteString;

    const-string v1, "NIL"

    invoke-direct {v0, v1}, Lcom/htc/android/mail/ByteString;-><init>(Ljava/lang/String;)V

    sput-object v0, Lcom/htc/android/mail/server/ImapServer;->STR_NIL:Lcom/htc/android/mail/ByteString;

    .line 165
    const/16 v0, 0x7530

    sput v0, Lcom/htc/android/mail/server/ImapServer;->ONETIME_ENCODE_SIZE:I

    return-void
.end method

.method public constructor <init>(Landroid/content/Context;Lcom/htc/android/mail/Account;)V
    .locals 3
    .parameter "context"
    .parameter "account"

    .prologue
    const/16 v0, 0x7530

    const/4 v1, 0x0

    const/4 v2, 0x0

    .line 176
    invoke-direct {p0}, Lcom/htc/android/mail/server/Server;-><init>()V

    .line 148
    iput v0, p0, Lcom/htc/android/mail/server/ImapServer;->mConnectionTimeOut:I

    .line 149
    iput v0, p0, Lcom/htc/android/mail/server/ImapServer;->mReadTimeOut:I

    .line 150
    iput v1, p0, Lcom/htc/android/mail/server/ImapServer;->mMSGID:I

    .line 152
    const-string v0, ""

    iput-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mInServer:Ljava/lang/String;

    .line 154
    iput-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mSslError:Lcom/htc/android/mail/ssl/MailSslError;

    .line 155
    iput-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mX509Certificate:Ljava/security/cert/X509Certificate;

    .line 157
    const/16 v0, 0x64

    iput v0, p0, Lcom/htc/android/mail/server/ImapServer;->mFetchHeaderSize:I

    .line 158
    const-string v0, ""

    iput-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mLastUid:Ljava/lang/String;

    .line 159
    const/4 v0, 0x1

    iput v0, p0, Lcom/htc/android/mail/server/ImapServer;->mixedType:I

    .line 160
    const/4 v0, 0x2

    iput v0, p0, Lcom/htc/android/mail/server/ImapServer;->relatedType:I

    .line 161
    iput-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->countOutStream:Lcom/htc/android/mail/CountSizeOutputStream;

    .line 162
    const-string v0, ""

    iput-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mixBoundary:Ljava/lang/String;

    .line 163
    const-string v0, ""

    iput-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->relatedBoundary:Ljava/lang/String;

    .line 164
    const-string v0, ""

    iput-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->alterBoundary:Ljava/lang/String;

    .line 166
    iput-boolean v1, p0, Lcom/htc/android/mail/server/ImapServer;->mIsNotSupportSearch:Z

    .line 167
    const-wide/16 v0, 0x0

    iput-wide v0, p0, Lcom/htc/android/mail/server/ImapServer;->mBeginningTimeMillis:J

    .line 169
    iput-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mSummariesUri:Landroid/net/Uri;

    .line 170
    const-wide/16 v0, -0x1

    iput-wide v0, p0, Lcom/htc/android/mail/server/ImapServer;->mMailboxIdForSummariesUri:J

    .line 171
    new-instance v0, Lcom/htc/android/mail/server/Server$SyncResult;

    invoke-direct {v0}, Lcom/htc/android/mail/server/Server$SyncResult;-><init>()V

    iput-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mSyncResult:Lcom/htc/android/mail/server/Server$SyncResult;

    .line 172
    iput-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mCurrentImapMailboxInfo:Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;

    .line 173
    iput-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mImapCapability:Lcom/htc/android/mail/server/ImapServer$ImapCapability;

    .line 174
    iput-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mImapEnabled:Lcom/htc/android/mail/server/ImapServer$ImapEnabled;

    .line 177
    invoke-virtual {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->setContext(Landroid/content/Context;)V

    .line 178
    invoke-virtual {p0, p2}, Lcom/htc/android/mail/server/ImapServer;->setAccount(Lcom/htc/android/mail/Account;)V

    .line 180
    return-void
.end method

.method private checkAccount()V
    .locals 2

    .prologue
    .line 5525
    iget v0, p0, Lcom/htc/android/mail/server/ImapServer;->mUseSSLin:I

    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v1}, Lcom/htc/android/mail/Account;->getUseSSLin()I

    move-result v1

    if-ne v0, v1, :cond_0

    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mInServer:Ljava/lang/String;

    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v1}, Lcom/htc/android/mail/Account;->getInServer()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_0

    iget v0, p0, Lcom/htc/android/mail/server/ImapServer;->mInPort:I

    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v1}, Lcom/htc/android/mail/Account;->getInPort()I

    move-result v1

    if-ne v0, v1, :cond_0

    .line 5530
    :goto_0
    return-void

    .line 5528
    :cond_0
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->close()V

    goto :goto_0
.end method

.method private clearList(Ljava/lang/String;Ljava/lang/String;Ljava/util/List;)Ljava/util/List;
    .locals 4
    .parameter "tag"
    .parameter "cmd"
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;)",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;"
        }
    .end annotation

    .prologue
    .line 5568
    .local p3, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/4 v0, 0x0

    .local v0, i:I
    :goto_0
    invoke-interface {p3}, Ljava/util/List;->size()I

    move-result v1

    add-int/lit8 v1, v1, -0x1

    if-ge v0, v1, :cond_1

    .line 5569
    invoke-virtual {p3}, Ljava/lang/Object;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/String;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object v1

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "* "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, " "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v1

    if-eqz v1, :cond_0

    .line 5570
    invoke-interface {p3, v0}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 5568
    :cond_0
    add-int/lit8 v0, v0, 0x1

    goto :goto_0

    .line 5574
    :cond_1
    return-object p3
.end method

.method private connect()V
    .locals 7
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    const/4 v6, 0x0

    const/16 v5, 0x400

    const/16 v4, 0x7530

    .line 385
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v0}, Lcom/htc/android/mail/Account;->getUseSSLin()I

    move-result v0

    iput v0, p0, Lcom/htc/android/mail/server/ImapServer;->mUseSSLin:I

    .line 386
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v0}, Lcom/htc/android/mail/Account;->getInServer()Ljava/lang/String;

    move-result-object v0

    iput-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mInServer:Ljava/lang/String;

    .line 387
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v0}, Lcom/htc/android/mail/Account;->getInPort()I

    move-result v0

    iput v0, p0, Lcom/htc/android/mail/server/ImapServer;->mInPort:I

    .line 388
    sget-boolean v0, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v0, :cond_0

    .line 389
    const-string v0, "ImapServer"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "mInServer is "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mInServer:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 390
    :cond_0
    sget-boolean v0, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v0, :cond_1

    .line 391
    const-string v0, "ImapServer"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "mInPort is "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget v2, p0, Lcom/htc/android/mail/server/ImapServer;->mInPort:I

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 392
    :cond_1
    sget-boolean v0, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v0, :cond_2

    .line 393
    const-string v0, "ImapServer"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "mUseSSLin is "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget v2, p0, Lcom/htc/android/mail/server/ImapServer;->mUseSSLin:I

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 394
    :cond_2
    iget v0, p0, Lcom/htc/android/mail/server/ImapServer;->mUseSSLin:I

    if-eqz v0, :cond_3

    iget v0, p0, Lcom/htc/android/mail/server/ImapServer;->mUseSSLin:I

    const/4 v1, 0x2

    if-ne v0, v1, :cond_4

    .line 395
    :cond_3
    new-instance v0, Ljava/net/Socket;

    invoke-direct {v0}, Ljava/net/Socket;-><init>()V

    iput-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mSocket:Ljava/net/Socket;

    .line 396
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    const-string v1, ""

    invoke-virtual {p0, v0, v1}, Lcom/htc/android/mail/server/ImapServer;->updateProgressStatus(Lcom/htc/android/mail/Account;Ljava/lang/String;)V

    .line 397
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mSocket:Ljava/net/Socket;

    new-instance v1, Ljava/net/InetSocketAddress;

    iget-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mInServer:Ljava/lang/String;

    iget v3, p0, Lcom/htc/android/mail/server/ImapServer;->mInPort:I

    invoke-direct {v1, v2, v3}, Ljava/net/InetSocketAddress;-><init>(Ljava/lang/String;I)V

    invoke-virtual {v0, v1, v4}, Ljava/net/Socket;->connect(Ljava/net/SocketAddress;I)V

    .line 407
    :goto_0
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mSocket:Ljava/net/Socket;

    invoke-virtual {v0, v4}, Ljava/net/Socket;->setSoTimeout(I)V

    .line 408
    new-instance v0, Ljava/io/BufferedInputStream;

    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mSocket:Ljava/net/Socket;

    invoke-virtual {v1}, Ljava/net/Socket;->getInputStream()Ljava/io/InputStream;

    move-result-object v1

    invoke-direct {v0, v1, v5}, Ljava/io/BufferedInputStream;-><init>(Ljava/io/InputStream;I)V

    iput-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mIn:Ljava/io/BufferedInputStream;

    .line 409
    new-instance v0, Ljava/io/BufferedOutputStream;

    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mSocket:Ljava/net/Socket;

    invoke-virtual {v1}, Ljava/net/Socket;->getOutputStream()Ljava/io/OutputStream;

    move-result-object v1

    invoke-direct {v0, v1, v5}, Ljava/io/BufferedOutputStream;-><init>(Ljava/io/OutputStream;I)V

    iput-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mOut:Ljava/io/BufferedOutputStream;

    .line 411
    const/4 v0, 0x0

    iput v0, p0, Lcom/htc/android/mail/server/Server;->socketState:I

    .line 412
    return-void

    .line 399
    :cond_4
    const/4 v0, 0x1

    invoke-static {v0}, Lcom/htc/android/mail/util/SSLUtils;->getSSLSocketFactory(Z)Ljavax/net/ssl/SSLSocketFactory;

    move-result-object v0

    invoke-virtual {v0}, Ljavax/net/ssl/SSLSocketFactory;->createSocket()Ljava/net/Socket;

    move-result-object v0

    iput-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mSocket:Ljava/net/Socket;

    .line 400
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    const-string v1, ""

    invoke-virtual {p0, v0, v1}, Lcom/htc/android/mail/server/ImapServer;->updateProgressStatus(Lcom/htc/android/mail/Account;Ljava/lang/String;)V

    .line 401
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mSocket:Ljava/net/Socket;

    new-instance v1, Ljava/net/InetSocketAddress;

    iget-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mInServer:Ljava/lang/String;

    iget v3, p0, Lcom/htc/android/mail/server/ImapServer;->mInPort:I

    invoke-direct {v1, v2, v3}, Ljava/net/InetSocketAddress;-><init>(Ljava/lang/String;I)V

    invoke-virtual {v0, v1, v4}, Ljava/net/Socket;->connect(Ljava/net/SocketAddress;I)V

    .line 402
    iput-object v6, p0, Lcom/htc/android/mail/server/ImapServer;->mSslError:Lcom/htc/android/mail/ssl/MailSslError;

    .line 403
    iput-object v6, p0, Lcom/htc/android/mail/server/ImapServer;->mX509Certificate:Ljava/security/cert/X509Certificate;

    .line 404
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mSocket:Ljava/net/Socket;

    invoke-virtual {v0, v4}, Ljava/net/Socket;->setSoTimeout(I)V

    goto :goto_0
.end method

.method private fetchHeader(Lcom/htc/android/mail/Mailbox;Ljava/util/List;)Ljava/util/List;
    .locals 8
    .parameter "mailbox"
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/Mailbox;",
            "Ljava/util/List",
            "<",
            "Ljava/lang/String;",
            ">;)",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/MailMessage;",
            ">;"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .local p2, uIdList:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    const/4 v7, 0x0

    .line 3690
    iget-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    if-eqz v2, :cond_0

    iget-object v2, p1, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    iget-object v3, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-object v3, v3, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    invoke-virtual {v2, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_1

    .line 3691
    :cond_0
    invoke-virtual {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->selectMailbox(Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    .line 3694
    :cond_1
    invoke-interface {p2}, Ljava/util/List;->size()I

    move-result v2

    if-lez v2, :cond_2

    .line 3695
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v1

    .line 3696
    .local v1, tag:Ljava/lang/String;
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v3, "%s UID FETCH %s (INTERNALDATE RFC822.SIZE FLAGS BODY.PEEK[HEADER.FIELDS (%s)])"

    const/4 v4, 0x3

    new-array v4, v4, [Ljava/lang/Object;

    aput-object v1, v4, v7

    const/4 v5, 0x1

    const-string v6, ","

    invoke-virtual {p0, p2, v6, v7}, Lcom/htc/android/mail/server/ImapServer;->combine(Ljava/util/List;Ljava/lang/String;Z)Ljava/lang/String;

    move-result-object v6

    aput-object v6, v4, v5

    const/4 v5, 0x2

    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getHeaderFieldsForFetchHeader()Ljava/lang/String;

    move-result-object v6

    aput-object v6, v4, v5

    invoke-static {v2, v3, v4}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v2

    invoke-virtual {p0, v2}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 3701
    invoke-virtual {p0, v1}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v0

    .line 3702
    .local v0, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->processFetchHeader(Ljava/util/List;)Ljava/util/List;

    move-result-object v2

    .line 3704
    .end local v0           #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    .end local v1           #tag:Ljava/lang/String;
    :goto_0
    return-object v2

    :cond_2
    const/4 v2, 0x0

    goto :goto_0
.end method

.method private fetchPartByUidInternal(Lcom/htc/android/mail/Mailbox;Lcom/htc/android/mail/MailMessage;JLjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;ZILcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;Ljava/lang/String;)V
    .locals 30
    .parameter "mailbox"
    .parameter "mailMessage"
    .parameter "bodyid"
    .parameter "index"
    .parameter "encode"
    .parameter "charsetOrfilename"
    .parameter "mimetype"
    .parameter "saveAsFile"
    .parameter "attachType"
    .parameter "controller"
    .parameter
    .parameter "fileReference"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/Mailbox;",
            "Lcom/htc/android/mail/MailMessage;",
            "J",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "ZI",
            "Lcom/htc/android/mail/AbsRequestController;",
            "Ljava/lang/ref/WeakReference",
            "<",
            "Landroid/os/Handler;",
            ">;",
            "Ljava/lang/String;",
            ")V"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 4515
    .local p12, weakHandler:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Landroid/os/Handler;>;"
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v14

    .line 4516
    .local v14, tag:Ljava/lang/String;
    if-nez p9, :cond_0

    .line 4517
    sget-object v4, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v5, "%s UID FETCH %s BODY.PEEK[%s]<0.%d>"

    const/4 v6, 0x4

    new-array v6, v6, [Ljava/lang/Object;

    const/4 v7, 0x0

    aput-object v14, v6, v7

    const/4 v7, 0x1

    move-object/from16 v0, p2

    iget-object v8, v0, Lcom/htc/android/mail/MailMessage;->uid:Ljava/lang/String;

    aput-object v8, v6, v7

    const/4 v7, 0x2

    aput-object p5, v6, v7

    const/4 v7, 0x3

    const/high16 v8, 0x10

    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v8

    aput-object v8, v6, v7

    invoke-static {v4, v5, v6}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v4

    move-object/from16 v0, p0

    invoke-virtual {v0, v4}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 4522
    :goto_0
    if-eqz p9, :cond_2

    .line 4523
    const-string v4, "QUOTED-PRINTABLE"

    move-object/from16 v0, p6

    invoke-virtual {v0, v4}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v4

    if-nez v4, :cond_1

    .line 4524
    move-object/from16 v0, p0

    iget-object v5, v0, Lcom/htc/android/mail/server/ImapServer;->mIn:Ljava/io/BufferedInputStream;

    move-object/from16 v4, p0

    move-object/from16 v6, p2

    move-wide/from16 v7, p3

    move-object/from16 v9, p5

    move-object/from16 v10, p6

    move-object/from16 v11, p7

    move-object/from16 v12, p8

    move/from16 v13, p9

    move/from16 v15, p10

    move-object/from16 v16, p11

    move-object/from16 v17, p12

    move-object/from16 v18, p13

    invoke-direct/range {v4 .. v18}, Lcom/htc/android/mail/server/ImapServer;->processFetchPartByUid(Ljava/io/BufferedInputStream;Lcom/htc/android/mail/MailMessage;JLjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;ZLjava/lang/String;ILcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;Ljava/lang/String;)V

    .line 4540
    :goto_1
    return-void

    .line 4519
    :cond_0
    sget-object v4, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v5, "%s UID FETCH %s BODY.PEEK[%s]"

    const/4 v6, 0x3

    new-array v6, v6, [Ljava/lang/Object;

    const/4 v7, 0x0

    aput-object v14, v6, v7

    const/4 v7, 0x1

    move-object/from16 v0, p2

    iget-object v8, v0, Lcom/htc/android/mail/MailMessage;->uid:Ljava/lang/String;

    aput-object v8, v6, v7

    const/4 v7, 0x2

    aput-object p5, v6, v7

    invoke-static {v4, v5, v6}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v4

    move-object/from16 v0, p0

    invoke-virtual {v0, v4}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    goto :goto_0

    .line 4529
    :cond_1
    move-object/from16 v0, p0

    move-object/from16 v1, p11

    move-object/from16 v2, p12

    move-object/from16 v3, p13

    invoke-direct {v0, v14, v1, v2, v3}, Lcom/htc/android/mail/server/ImapServer;->readProgressResponse(Ljava/lang/String;Lcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;Ljava/lang/String;)Ljava/util/List;

    move-result-object v16

    .line 4532
    .local v16, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/16 v26, 0x1

    move-object/from16 v15, p0

    move-object/from16 v17, p2

    move-wide/from16 v18, p3

    move-object/from16 v20, p5

    move-object/from16 v21, p6

    move-object/from16 v22, p7

    move-object/from16 v23, p8

    move/from16 v24, p9

    move/from16 v25, p10

    move-object/from16 v27, p11

    move-object/from16 v28, p12

    move-object/from16 v29, p13

    invoke-direct/range {v15 .. v29}, Lcom/htc/android/mail/server/ImapServer;->processFetchPartByUid(Ljava/util/List;Lcom/htc/android/mail/MailMessage;JLjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;ZIZLcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;Ljava/lang/String;)V

    goto :goto_1

    .line 4536
    .end local v16           #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    :cond_2
    move-object/from16 v0, p0

    invoke-virtual {v0, v14}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v16

    .line 4538
    .restart local v16       #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/16 v26, 0x0

    move-object/from16 v15, p0

    move-object/from16 v17, p2

    move-wide/from16 v18, p3

    move-object/from16 v20, p5

    move-object/from16 v21, p6

    move-object/from16 v22, p7

    move-object/from16 v23, p8

    move/from16 v24, p9

    move/from16 v25, p10

    move-object/from16 v27, p11

    move-object/from16 v28, p12

    move-object/from16 v29, p13

    invoke-direct/range {v15 .. v29}, Lcom/htc/android/mail/server/ImapServer;->processFetchPartByUid(Ljava/util/List;Lcom/htc/android/mail/MailMessage;JLjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;ZIZLcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;Ljava/lang/String;)V

    goto :goto_1
.end method

.method private final findMimeType(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
    .locals 1
    .parameter "type"
    .parameter "subtype"
    .annotation runtime Ljava/lang/Deprecated;
    .end annotation

    .prologue
    .line 3234
    const-string v0, "text"

    invoke-virtual {p1, v0}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_1

    .line 3235
    const-string v0, "plain"

    invoke-virtual {p2, v0}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_0

    .line 3236
    const-string v0, "text/plain"

    .line 3245
    :goto_0
    return-object v0

    .line 3237
    :cond_0
    const-string v0, "html"

    invoke-virtual {p2, v0}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_2

    .line 3238
    const-string v0, "text/html"

    goto :goto_0

    .line 3240
    :cond_1
    const-string v0, "image"

    invoke-virtual {p1, v0}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_2

    .line 3241
    const-string v0, "png"

    invoke-virtual {p2, v0}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_2

    .line 3242
    const-string v0, "image/png"

    goto :goto_0

    .line 3245
    :cond_2
    const/4 v0, 0x0

    goto :goto_0
.end method

.method private forceSync(Ljava/io/File;)V
    .locals 8
    .parameter "desPathFile"

    .prologue
    .line 4824
    sget-boolean v5, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v5, :cond_0

    const-string v5, "ImapServer"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "force Sync> "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 4827
    :cond_0
    const/high16 v5, 0x1000

    :try_start_0
    invoke-static {p1, v5}, Landroid/os/ParcelFileDescriptor;->open(Ljava/io/File;I)Landroid/os/ParcelFileDescriptor;

    move-result-object v3

    .line 4828
    .local v3, pfd:Landroid/os/ParcelFileDescriptor;
    invoke-virtual {v3}, Landroid/os/ParcelFileDescriptor;->getFileDescriptor()Ljava/io/FileDescriptor;

    move-result-object v0

    .line 4829
    .local v0, fd:Ljava/io/FileDescriptor;
    invoke-virtual {v0}, Ljava/io/FileDescriptor;->sync()V

    .line 4830
    if-eqz v3, :cond_1

    .line 4831
    invoke-virtual {v3}, Landroid/os/ParcelFileDescriptor;->close()V
    :try_end_0
    .catch Ljava/io/FileNotFoundException; {:try_start_0 .. :try_end_0} :catch_0
    .catch Ljava/io/SyncFailedException; {:try_start_0 .. :try_end_0} :catch_1
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_2

    .line 4850
    .end local v0           #fd:Ljava/io/FileDescriptor;
    .end local v3           #pfd:Landroid/os/ParcelFileDescriptor;
    :cond_1
    :goto_0
    return-void

    .line 4833
    :catch_0
    move-exception v1

    .line 4834
    .local v1, fe:Ljava/io/FileNotFoundException;
    const-string v5, "ImapServer"

    const-string v6, "File Not Found Exception!"

    invoke-static {v5, v6}, Lcom/htc/android/mail/ll;->e(Ljava/lang/String;Ljava/lang/String;)V

    goto :goto_0

    .line 4835
    .end local v1           #fe:Ljava/io/FileNotFoundException;
    :catch_1
    move-exception v4

    .line 4836
    .local v4, se:Ljava/io/SyncFailedException;
    const-string v5, "ImapServer"

    const-string v6, "Sync Failed Exception"

    invoke-static {v5, v6}, Lcom/htc/android/mail/ll;->e(Ljava/lang/String;Ljava/lang/String;)V

    goto :goto_0

    .line 4837
    .end local v4           #se:Ljava/io/SyncFailedException;
    :catch_2
    move-exception v2

    .line 4838
    .local v2, ioe:Ljava/io/IOException;
    const-string v5, "ImapServer"

    const-string v6, "could not force sync to SD card"

    invoke-static {v5, v6}, Lcom/htc/android/mail/ll;->e(Ljava/lang/String;Ljava/lang/String;)V

    goto :goto_0
.end method

.method private getAppendUID(Ljava/lang/String;)Ljava/lang/String;
    .locals 9
    .parameter "str"

    .prologue
    const/4 v4, 0x0

    const/4 v8, 0x3

    const/4 v7, 0x2

    .line 5168
    if-nez p1, :cond_1

    move-object v2, v4

    .line 5180
    :cond_0
    :goto_0
    return-object v2

    .line 5169
    :cond_1
    const/4 v2, 0x0

    .line 5170
    .local v2, uid:Ljava/lang/String;
    invoke-static {}, Lcom/htc/android/mail/Regex;->getInstance()Lcom/htc/android/mail/Regex;

    move-result-object v5

    const/16 v6, 0x13

    invoke-virtual {v5, v6}, Lcom/htc/android/mail/Regex;->getPattern(I)Ljava/util/regex/Pattern;

    move-result-object v5

    invoke-virtual {v5, p1}, Ljava/util/regex/Pattern;->matcher(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;

    move-result-object v1

    .line 5171
    .local v1, m:Ljava/util/regex/Matcher;
    invoke-virtual {v1}, Ljava/util/regex/Matcher;->find()Z

    move-result v5

    if-eqz v5, :cond_0

    .line 5172
    const/4 v5, 0x1

    invoke-virtual {v1, v5}, Ljava/util/regex/Matcher;->group(I)Ljava/lang/String;

    move-result-object v0

    .line 5173
    .local v0, appendUid:Ljava/lang/String;
    if-nez v0, :cond_2

    move-object v2, v4

    goto :goto_0

    .line 5174
    :cond_2
    const-string v4, " "

    invoke-virtual {v0, v4, v8}, Ljava/lang/String;->split(Ljava/lang/String;I)[Ljava/lang/String;

    move-result-object v3

    .line 5175
    .local v3, uidArray:[Ljava/lang/String;
    if-eqz v3, :cond_0

    array-length v4, v3

    if-ne v4, v8, :cond_0

    const-string v4, "appenduid"

    const/4 v5, 0x0

    aget-object v5, v3, v5

    invoke-virtual {v4, v5}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v4

    if-eqz v4, :cond_0

    .line 5176
    sget-boolean v4, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v4, :cond_3

    const-string v4, "ImapServer"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "appenduid response uid : "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    aget-object v6, v3, v7

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 5177
    :cond_3
    aget-object v2, v3, v7

    goto :goto_0
.end method

.method private getBody(Ljava/io/PushbackInputStream;)Lcom/htc/android/mail/ByteString;
    .locals 8
    .parameter "pbIn"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    const/4 v5, 0x0

    const/4 v7, -0x1

    .line 5790
    invoke-direct {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->skipSpace(Ljava/io/PushbackInputStream;)V

    .line 5792
    new-instance v3, Ljava/io/ByteArrayOutputStream;

    invoke-direct {v3}, Ljava/io/ByteArrayOutputStream;-><init>()V

    .line 5795
    .local v3, output:Ljava/io/ByteArrayOutputStream;
    :cond_0
    :goto_0
    invoke-virtual {p1}, Ljava/io/PushbackInputStream;->read()I

    move-result v1

    .local v1, c:I
    if-eq v1, v7, :cond_1

    .line 5796
    const/16 v6, 0xd

    if-ne v1, v6, :cond_3

    .line 5798
    invoke-virtual {p1}, Ljava/io/PushbackInputStream;->read()I

    .line 5808
    :cond_1
    :goto_1
    invoke-virtual {v3}, Ljava/io/ByteArrayOutputStream;->toString()Ljava/lang/String;

    move-result-object v4

    .line 5809
    .local v4, value:Ljava/lang/String;
    const-string v6, "NIL"

    invoke-virtual {v6, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_5

    .line 5823
    :cond_2
    :goto_2
    return-object v5

    .line 5801
    .end local v4           #value:Ljava/lang/String;
    :cond_3
    const/16 v6, 0x7b

    if-eq v1, v6, :cond_0

    const/16 v6, 0x7d

    if-eq v1, v6, :cond_0

    .line 5802
    const/16 v6, 0x29

    if-ne v1, v6, :cond_4

    .line 5803
    invoke-virtual {p1, v1}, Ljava/io/PushbackInputStream;->unread(I)V

    goto :goto_1

    .line 5806
    :cond_4
    invoke-virtual {v3, v1}, Ljava/io/ByteArrayOutputStream;->write(I)V

    goto :goto_0

    .line 5811
    .restart local v4       #value:Ljava/lang/String;
    :cond_5
    new-instance v3, Ljava/io/ByteArrayOutputStream;

    .end local v3           #output:Ljava/io/ByteArrayOutputStream;
    invoke-direct {v3}, Ljava/io/ByteArrayOutputStream;-><init>()V

    .line 5812
    .restart local v3       #output:Ljava/io/ByteArrayOutputStream;
    invoke-static {v4}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I

    move-result v0

    .line 5813
    .local v0, bodySize:I
    const/4 v2, 0x0

    .local v2, i:I
    :goto_3
    if-ge v2, v0, :cond_7

    .line 5814
    invoke-virtual {p1}, Ljava/io/PushbackInputStream;->read()I

    move-result v1

    .line 5815
    if-ne v1, v7, :cond_6

    new-instance v5, Ljava/io/IOException;

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "bodySize: "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ", body content only have "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, "bytes"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-direct {v5, v6}, Ljava/io/IOException;-><init>(Ljava/lang/String;)V

    throw v5

    .line 5816
    :cond_6
    invoke-virtual {v3, v1}, Ljava/io/ByteArrayOutputStream;->write(I)V

    .line 5813
    add-int/lit8 v2, v2, 0x1

    goto :goto_3

    .line 5819
    :cond_7
    invoke-virtual {v3}, Ljava/io/ByteArrayOutputStream;->size()I

    move-result v6

    if-lez v6, :cond_2

    .line 5820
    new-instance v5, Lcom/htc/android/mail/ByteString;

    invoke-virtual {v3}, Ljava/io/ByteArrayOutputStream;->toByteArray()[B

    move-result-object v6

    invoke-direct {v5, v6}, Lcom/htc/android/mail/ByteString;-><init>([B)V

    goto :goto_2
.end method

.method private getCopyUid(Ljava/lang/String;)Ljava/util/ArrayList;
    .locals 8
    .parameter "str"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            ")",
            "Ljava/util/ArrayList",
            "<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .prologue
    const/4 v6, 0x4

    const/4 v7, 0x3

    .line 5184
    new-instance v2, Ljava/util/ArrayList;

    invoke-direct {v2}, Ljava/util/ArrayList;-><init>()V

    .line 5186
    .local v2, ret:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/String;>;"
    if-nez p1, :cond_0

    move-object v4, v2

    .line 5198
    :goto_0
    return-object v4

    .line 5187
    :cond_0
    invoke-static {}, Lcom/htc/android/mail/Regex;->getInstance()Lcom/htc/android/mail/Regex;

    move-result-object v4

    const/16 v5, 0x13

    invoke-virtual {v4, v5}, Lcom/htc/android/mail/Regex;->getPattern(I)Ljava/util/regex/Pattern;

    move-result-object v4

    invoke-virtual {v4, p1}, Ljava/util/regex/Pattern;->matcher(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;

    move-result-object v1

    .line 5188
    .local v1, m:Ljava/util/regex/Matcher;
    invoke-virtual {v1}, Ljava/util/regex/Matcher;->find()Z

    move-result v4

    if-eqz v4, :cond_3

    .line 5189
    const/4 v4, 0x1

    invoke-virtual {v1, v4}, Ljava/util/regex/Matcher;->group(I)Ljava/lang/String;

    move-result-object v0

    .line 5190
    .local v0, appendUid:Ljava/lang/String;
    if-nez v0, :cond_1

    const/4 v4, 0x0

    goto :goto_0

    .line 5191
    :cond_1
    const-string v4, " "

    invoke-virtual {v0, v4, v6}, Ljava/lang/String;->split(Ljava/lang/String;I)[Ljava/lang/String;

    move-result-object v3

    .line 5192
    .local v3, uidArray:[Ljava/lang/String;
    if-eqz v3, :cond_3

    array-length v4, v3

    if-ne v4, v6, :cond_3

    const-string v4, "copyuid"

    const/4 v5, 0x0

    aget-object v5, v3, v5

    invoke-virtual {v4, v5}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v4

    if-eqz v4, :cond_3

    .line 5193
    sget-boolean v4, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v4, :cond_2

    const-string v4, "ImapServer"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "copyuid response uid : "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    aget-object v6, v3, v7

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v4, v5}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 5194
    :cond_2
    aget-object v4, v3, v7

    invoke-direct {p0, v4}, Lcom/htc/android/mail/server/ImapServer;->translateUidListToUidArray(Ljava/lang/String;)Ljava/util/ArrayList;

    move-result-object v2

    move-object v4, v2

    .line 5195
    goto :goto_0

    .end local v0           #appendUid:Ljava/lang/String;
    .end local v3           #uidArray:[Ljava/lang/String;
    :cond_3
    move-object v4, v2

    .line 5198
    goto :goto_0
.end method

.method private getKey(Ljava/io/PushbackInputStream;)Lcom/htc/android/mail/ByteString;
    .locals 5
    .parameter "pbIn"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    const/16 v4, 0x20

    .line 6016
    new-instance v2, Ljava/io/ByteArrayOutputStream;

    invoke-direct {v2}, Ljava/io/ByteArrayOutputStream;-><init>()V

    .line 6018
    .local v2, output:Ljava/io/ByteArrayOutputStream;
    invoke-direct {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->skipSpace(Ljava/io/PushbackInputStream;)V

    .line 6019
    const/4 v1, 0x0

    .line 6021
    .local v1, leftBracket:Z
    :goto_0
    invoke-virtual {p1}, Ljava/io/PushbackInputStream;->read()I

    move-result v0

    .local v0, c:I
    const/4 v3, -0x1

    if-eq v0, v3, :cond_2

    .line 6022
    const/16 v3, 0x5b

    if-ne v0, v3, :cond_0

    .line 6023
    const/4 v1, 0x1

    .line 6025
    :cond_0
    const/16 v3, 0x5d

    if-ne v0, v3, :cond_1

    .line 6027
    invoke-virtual {p1}, Ljava/io/PushbackInputStream;->read()I

    move-result v0

    .line 6028
    if-eq v0, v4, :cond_2

    .line 6029
    const/4 v1, 0x0

    .line 6034
    :cond_1
    if-nez v1, :cond_3

    if-ne v0, v4, :cond_3

    .line 6037
    :cond_2
    invoke-virtual {v2}, Ljava/io/ByteArrayOutputStream;->size()I

    move-result v3

    if-nez v3, :cond_4

    const/4 v3, 0x0

    .line 6038
    :goto_1
    return-object v3

    .line 6035
    :cond_3
    invoke-virtual {v2, v0}, Ljava/io/ByteArrayOutputStream;->write(I)V

    goto :goto_0

    .line 6038
    :cond_4
    new-instance v3, Lcom/htc/android/mail/ByteString;

    invoke-virtual {v2}, Ljava/io/ByteArrayOutputStream;->toByteArray()[B

    move-result-object v4

    invoke-direct {v3, v4}, Lcom/htc/android/mail/ByteString;-><init>([B)V

    goto :goto_1
.end method

.method private getMessageIdList(Ljava/util/List;)Ljava/util/List;
    .locals 8
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/MailMessage;",
            ">;)",
            "Ljava/util/List",
            "<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .prologue
    .line 4056
    .local p1, mailMessageList:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    new-instance v1, Ljava/util/ArrayList;

    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V

    .line 4057
    .local v1, list:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v3

    .line 4059
    .local v3, size:I
    const/4 v0, 0x0

    .local v0, i:I
    :goto_0
    if-ge v0, v3, :cond_1

    .line 4060
    invoke-interface {p1, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/htc/android/mail/MailMessage;

    .line 4061
    .local v2, mailMessage:Lcom/htc/android/mail/MailMessage;
    iget-wide v4, v2, Lcom/htc/android/mail/MailMessage;->id:J

    const-wide/16 v6, -0x1

    cmp-long v4, v4, v6

    if-eqz v4, :cond_0

    .line 4062
    iget-wide v4, v2, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-static {v4, v5}, Ljava/lang/String;->valueOf(J)Ljava/lang/String;

    move-result-object v4

    invoke-interface {v1, v4}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 4059
    :cond_0
    add-int/lit8 v0, v0, 0x1

    goto :goto_0

    .line 4065
    .end local v2           #mailMessage:Lcom/htc/android/mail/MailMessage;
    :cond_1
    return-object v1
.end method

.method private getMinUidInLatestNumMail(I)J
    .locals 14
    .parameter "num"

    .prologue
    .line 4219
    sget-boolean v0, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v0, :cond_0

    const-string v0, "ImapServer"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "getMinUidInLatestNumMail: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 4220
    :cond_0
    const-wide/16 v8, 0x1

    .line 4221
    .local v8, minUid:J
    const/4 v6, 0x0

    .line 4223
    .local v6, c:Landroid/database/Cursor;
    :try_start_0
    sget-object v0, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v1, "_account = \'%d\' AND _mailboxId = \'%d\'"

    const/4 v2, 0x2

    new-array v2, v2, [Ljava/lang/Object;

    const/4 v4, 0x0

    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v5}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v12

    invoke-static {v12, v13}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v5

    aput-object v5, v2, v4

    const/4 v4, 0x1

    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-wide v12, v5, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-static {v12, v13}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v5

    aput-object v5, v2, v4

    invoke-static {v0, v1, v2}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    .line 4224
    .local v3, where:Ljava/lang/String;
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v0

    sget-object v1, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    const/4 v2, 0x1

    new-array v2, v2, [Ljava/lang/String;

    const/4 v4, 0x0

    const-string v5, "abs(_uid) as uid"

    aput-object v5, v2, v4

    const/4 v4, 0x0

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v12, "abs(_uid) asc limit "

    invoke-virtual {v5, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-interface/range {v0 .. v5}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v6

    .line 4226
    if-eqz v6, :cond_2

    .line 4227
    invoke-interface {v6}, Landroid/database/Cursor;->moveToNext()Z

    move-result v0

    if-eqz v0, :cond_2

    .line 4228
    const-string v0, "uid"

    invoke-interface {v6, v0}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v0

    invoke-interface {v6, v0}, Landroid/database/Cursor;->getLong(I)J
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result-wide v10

    .line 4229
    .local v10, uid:J
    const-wide/16 v0, 0x0

    cmp-long v0, v10, v0

    if-nez v0, :cond_1

    .line 4230
    const-wide/16 v10, 0x1

    .line 4232
    :cond_1
    move-wide v8, v10

    .line 4238
    .end local v10           #uid:J
    :cond_2
    if-eqz v6, :cond_3

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v0

    if-nez v0, :cond_3

    .line 4239
    .end local v3           #where:Ljava/lang/String;
    :goto_0
    invoke-interface {v6}, Landroid/database/Cursor;->close()V

    .line 4243
    :cond_3
    return-wide v8

    .line 4235
    :catch_0
    move-exception v7

    .line 4236
    .local v7, e:Landroid/os/RemoteException;
    :try_start_1
    const-string v0, "ImapServer"

    const-string v1, "catch RemoteException"

    invoke-static {v0, v1, v7}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 4238
    if-eqz v6, :cond_3

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v0

    if-nez v0, :cond_3

    goto :goto_0

    .end local v7           #e:Landroid/os/RemoteException;
    :catchall_0
    move-exception v0

    if-eqz v6, :cond_4

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v1

    if-nez v1, :cond_4

    .line 4239
    invoke-interface {v6}, Landroid/database/Cursor;->close()V

    .line 4238
    :cond_4
    throw v0
.end method

.method private getPendingFetchMailMap(Ljava/util/HashMap;)Ljava/util/HashMap;
    .locals 14
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/HashMap",
            "<",
            "Ljava/lang/String;",
            "Ljava/lang/Integer;",
            ">;)",
            "Ljava/util/HashMap",
            "<",
            "Ljava/lang/String;",
            "Ljava/lang/Object;",
            ">;"
        }
    .end annotation

    .prologue
    .line 3350
    .local p1, uidMap:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Ljava/lang/Integer;>;"
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v0

    .line 3351
    .local v0, cp:Landroid/content/IContentProvider;
    new-instance v9, Ljava/util/HashMap;

    invoke-direct {v9}, Ljava/util/HashMap;-><init>()V

    .line 3352
    .local v9, pendingFetchMailMap:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Ljava/lang/Object;>;"
    new-instance v8, Ljava/util/ArrayList;

    invoke-direct {v8}, Ljava/util/ArrayList;-><init>()V

    .line 3354
    .local v8, notExistUidList:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/String;>;"
    sget-object v1, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v2, "_accountId = \'%d\' AND _fromMailboxId = \'%d\' AND _request = \'%d\'"

    const/4 v4, 0x3

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v5, 0x0

    iget-object v12, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v12}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v12

    invoke-static {v12, v13}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v12

    aput-object v12, v4, v5

    const/4 v5, 0x1

    iget-object v12, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-wide v12, v12, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-static {v12, v13}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v12

    aput-object v12, v4, v5

    const/4 v5, 0x2

    const/4 v12, 0x6

    invoke-static {v12}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v12

    aput-object v12, v4, v5

    invoke-static {v1, v2, v4}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    .line 3356
    .local v3, where:Ljava/lang/String;
    const/4 v6, 0x0

    .line 3358
    .local v6, c:Landroid/database/Cursor;
    :try_start_0
    sget-object v1, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    const/4 v2, 0x1

    new-array v2, v2, [Ljava/lang/String;

    const/4 v4, 0x0

    const-string v5, "_uid"

    aput-object v5, v2, v4

    const/4 v4, 0x0

    const/4 v5, 0x0

    invoke-interface/range {v0 .. v5}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v6

    .line 3359
    if-eqz v6, :cond_6

    .line 3361
    :cond_0
    :goto_0
    invoke-interface {v6}, Landroid/database/Cursor;->moveToNext()Z

    move-result v1

    if-eqz v1, :cond_6

    .line 3362
    const-string v1, "_uid"

    invoke-interface {v6, v1}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v1

    invoke-interface {v6, v1}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v10

    .line 3363
    .local v10, uid:Ljava/lang/String;
    if-eqz v10, :cond_0

    .line 3365
    if-eqz p1, :cond_1

    if-eqz p1, :cond_4

    invoke-virtual {p1, v10}, Ljava/util/HashMap;->containsKey(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_4

    .line 3366
    :cond_1
    const/4 v1, 0x0

    invoke-virtual {v9, v10, v1}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_0

    .line 3373
    .end local v10           #uid:Ljava/lang/String;
    :catch_0
    move-exception v7

    .line 3374
    .local v7, e:Landroid/os/RemoteException;
    :try_start_1
    const-string v1, "ImapServer"

    const-string v2, "catch exception"

    invoke-static {v1, v2, v7}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 3376
    if-eqz v6, :cond_2

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v1

    if-nez v1, :cond_2

    .line 3377
    .end local v7           #e:Landroid/os/RemoteException;
    :goto_1
    invoke-interface {v6}, Landroid/database/Cursor;->close()V

    .line 3381
    :cond_2
    invoke-virtual {v8}, Ljava/util/ArrayList;->size()I

    move-result v1

    if-lez v1, :cond_3

    .line 3383
    :try_start_2
    const-string v1, ","

    const/4 v2, 0x1

    invoke-virtual {p0, v8, v1, v2}, Lcom/htc/android/mail/server/ImapServer;->combine(Ljava/util/List;Ljava/lang/String;Z)Ljava/lang/String;

    move-result-object v11

    .line 3384
    .local v11, uidSeq:Ljava/lang/String;
    sget-object v1, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v2, "_accountId = \'%d\' AND _fromMailboxId = \'%d\' AND _request = \'%d\' AND _uid in (%s)"

    const/4 v4, 0x4

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v5, 0x0

    iget-object v12, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v12}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v12

    invoke-static {v12, v13}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v12

    aput-object v12, v4, v5

    const/4 v5, 0x1

    iget-object v12, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-wide v12, v12, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-static {v12, v13}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v12

    aput-object v12, v4, v5

    const/4 v5, 0x2

    const/4 v12, 0x6

    invoke-static {v12}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v12

    aput-object v12, v4, v5

    const/4 v5, 0x3

    aput-object v11, v4, v5

    invoke-static {v1, v2, v4}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    .line 3386
    sget-object v1, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    const/4 v2, 0x0

    invoke-interface {v0, v1, v3, v2}, Landroid/content/IContentProvider;->delete(Landroid/net/Uri;Ljava/lang/String;[Ljava/lang/String;)I
    :try_end_2
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_1

    .line 3392
    .end local v11           #uidSeq:Ljava/lang/String;
    :cond_3
    :goto_2
    return-object v9

    .line 3368
    .restart local v10       #uid:Ljava/lang/String;
    :cond_4
    :try_start_3
    invoke-virtual {v8, v10}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_0

    goto :goto_0

    .line 3376
    .end local v10           #uid:Ljava/lang/String;
    :catchall_0
    move-exception v1

    if-eqz v6, :cond_5

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v2

    if-nez v2, :cond_5

    .line 3377
    invoke-interface {v6}, Landroid/database/Cursor;->close()V

    .line 3376
    :cond_5
    throw v1

    .line 3387
    :catch_1
    move-exception v7

    .line 3388
    .restart local v7       #e:Landroid/os/RemoteException;
    const-string v1, "ImapServer"

    const-string v2, "catch exception"

    invoke-static {v1, v2, v7}, Lcom/htc/android/mail/ll;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V

    goto :goto_2

    .line 3376
    .end local v7           #e:Landroid/os/RemoteException;
    :cond_6
    if-eqz v6, :cond_2

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v1

    if-nez v1, :cond_2

    goto :goto_1
.end method

.method private getStringUntil(Ljava/io/PushbackInputStream;I)Ljava/lang/String;
    .locals 4
    .parameter "pbIn"
    .parameter "term"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .line 5944
    new-instance v1, Ljava/io/ByteArrayOutputStream;

    invoke-direct {v1}, Ljava/io/ByteArrayOutputStream;-><init>()V

    .line 5946
    .local v1, output:Ljava/io/ByteArrayOutputStream;
    :goto_0
    invoke-virtual {p1}, Ljava/io/PushbackInputStream;->read()I

    move-result v0

    .local v0, c:I
    const/4 v2, -0x1

    if-eq v0, v2, :cond_0

    .line 5947
    if-ne v0, p2, :cond_1

    .line 5950
    :cond_0
    new-instance v2, Ljava/lang/String;

    invoke-virtual {v1}, Ljava/io/ByteArrayOutputStream;->toByteArray()[B

    move-result-object v3

    invoke-direct {v2, v3}, Ljava/lang/String;-><init>([B)V

    return-object v2

    .line 5948
    :cond_1
    invoke-virtual {v1, v0}, Ljava/io/ByteArrayOutputStream;->write(I)V

    goto :goto_0
.end method

.method private getStringUntilEOL(Ljava/io/PushbackInputStream;)Ljava/lang/String;
    .locals 5
    .parameter "pbIn"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .line 5955
    new-instance v2, Ljava/io/ByteArrayOutputStream;

    invoke-direct {v2}, Ljava/io/ByteArrayOutputStream;-><init>()V

    .line 5957
    .local v2, output:Ljava/io/ByteArrayOutputStream;
    :goto_0
    invoke-virtual {p1}, Ljava/io/PushbackInputStream;->read()I

    move-result v0

    .local v0, c:I
    const/4 v3, -0x1

    if-eq v0, v3, :cond_0

    .line 5958
    const/16 v3, 0xd

    if-ne v0, v3, :cond_1

    .line 5959
    invoke-virtual {p1}, Ljava/io/PushbackInputStream;->read()I

    move-result v1

    .line 5960
    .local v1, next:I
    const/16 v3, 0xa

    if-ne v1, v3, :cond_1

    .line 5961
    invoke-virtual {p1, v1}, Ljava/io/PushbackInputStream;->unread(I)V

    .line 5962
    invoke-virtual {p1, v0}, Ljava/io/PushbackInputStream;->unread(I)V

    .line 5968
    .end local v1           #next:I
    :cond_0
    new-instance v3, Ljava/lang/String;

    invoke-virtual {v2}, Ljava/io/ByteArrayOutputStream;->toByteArray()[B

    move-result-object v4

    invoke-direct {v3, v4}, Ljava/lang/String;-><init>([B)V

    return-object v3

    .line 5966
    :cond_1
    invoke-virtual {v2, v0}, Ljava/io/ByteArrayOutputStream;->write(I)V

    goto :goto_0
.end method

.method private getTagResponse(Ljava/io/PushbackInputStream;)[Ljava/lang/String;
    .locals 5
    .parameter "pbIn"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    const/4 v4, 0x0

    const/4 v3, 0x0

    .line 5877
    const/4 v2, 0x2

    new-array v1, v2, [Ljava/lang/String;

    aput-object v4, v1, v3

    const/4 v2, 0x1

    aput-object v4, v1, v2

    .line 5879
    .local v1, responses:[Ljava/lang/String;
    invoke-direct {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->nextToken(Ljava/io/PushbackInputStream;)Ljava/lang/String;

    move-result-object v0

    .line 5880
    .local v0, nextToken:Ljava/lang/String;
    aput-object v0, v1, v3

    .line 5882
    return-object v1
.end method

.method private getUidFromStore(Lcom/htc/android/mail/server/Server$PendingRequest;)Ljava/lang/String;
    .locals 13
    .parameter "request"

    .prologue
    const/4 v8, 0x0

    const/4 v12, 0x1

    const/4 v11, 0x0

    .line 1774
    sget-object v0, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v1, "_accountId = %d AND _request = %d AND _messageId = \'%d\' AND _fromMailboxId = \'%d\'"

    const/4 v2, 0x4

    new-array v2, v2, [Ljava/lang/Object;

    iget-wide v9, p1, Lcom/htc/android/mail/server/Server$PendingRequest;->accountId:J

    invoke-static {v9, v10}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v4

    aput-object v4, v2, v11

    const/4 v4, 0x7

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v2, v12

    const/4 v4, 0x2

    iget-wide v9, p1, Lcom/htc/android/mail/server/Server$PendingRequest;->messageId:J

    invoke-static {v9, v10}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v9

    aput-object v9, v2, v4

    const/4 v4, 0x3

    iget-wide v9, p1, Lcom/htc/android/mail/server/Server$PendingRequest;->fromMailboxId:J

    invoke-static {v9, v10}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v9

    aput-object v9, v2, v4

    invoke-static {v0, v1, v2}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    .line 1776
    .local v3, where:Ljava/lang/String;
    const-string v5, "_id desc limit 1"

    .line 1777
    .local v5, sort:Ljava/lang/String;
    const/4 v6, 0x0

    .line 1779
    .local v6, cursor:Landroid/database/Cursor;
    :try_start_0
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v0

    sget-object v1, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    const/4 v2, 0x1

    new-array v2, v2, [Ljava/lang/String;

    const/4 v4, 0x0

    const-string v9, "_uid"

    aput-object v9, v2, v4

    const/4 v4, 0x0

    invoke-interface/range {v0 .. v5}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v6

    .line 1780
    if-eqz v6, :cond_2

    .line 1781
    invoke-interface {v6}, Landroid/database/Cursor;->moveToNext()Z

    move-result v0

    if-eqz v0, :cond_2

    .line 1782
    const-string v0, "_uid"

    invoke-interface {v6, v0}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v0

    invoke-interface {v6, v0}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result-object v8

    .line 1789
    .local v8, uid:Ljava/lang/String;
    if-eqz v6, :cond_0

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v0

    if-nez v0, :cond_0

    .line 1790
    .end local v8           #uid:Ljava/lang/String;
    :goto_0
    invoke-interface {v6}, Landroid/database/Cursor;->close()V

    .line 1793
    :cond_0
    return-object v8

    .line 1786
    :catch_0
    move-exception v7

    .line 1787
    .local v7, e:Landroid/os/RemoteException;
    :try_start_1
    const-string v0, "ImapServer"

    const-string v1, "catch RemoteException"

    invoke-static {v0, v1, v7}, Lcom/htc/android/mail/ll;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 1789
    if-eqz v6, :cond_0

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v0

    if-nez v0, :cond_0

    goto :goto_0

    .end local v7           #e:Landroid/os/RemoteException;
    :catchall_0
    move-exception v0

    if-eqz v6, :cond_1

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v1

    if-nez v1, :cond_1

    .line 1790
    invoke-interface {v6}, Landroid/database/Cursor;->close()V

    .line 1789
    :cond_1
    throw v0

    :cond_2
    if-eqz v6, :cond_0

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v0

    if-nez v0, :cond_0

    goto :goto_0
.end method

.method private getUidList(Ljava/util/List;)Ljava/util/List;
    .locals 5
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/MailMessage;",
            ">;)",
            "Ljava/util/List",
            "<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .prologue
    .line 4043
    .local p1, mailMessageList:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    new-instance v1, Ljava/util/ArrayList;

    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V

    .line 4044
    .local v1, list:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v3

    .line 4046
    .local v3, size:I
    const/4 v0, 0x0

    .local v0, i:I
    :goto_0
    if-ge v0, v3, :cond_1

    .line 4047
    invoke-interface {p1, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/htc/android/mail/MailMessage;

    .line 4048
    .local v2, mailMessage:Lcom/htc/android/mail/MailMessage;
    iget-object v4, v2, Lcom/htc/android/mail/MailMessage;->uid:Ljava/lang/String;

    if-eqz v4, :cond_0

    .line 4049
    iget-object v4, v2, Lcom/htc/android/mail/MailMessage;->uid:Ljava/lang/String;

    invoke-interface {v1, v4}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 4046
    :cond_0
    add-int/lit8 v0, v0, 0x1

    goto :goto_0

    .line 4052
    .end local v2           #mailMessage:Lcom/htc/android/mail/MailMessage;
    :cond_1
    return-object v1
.end method

.method private getValue(Ljava/io/PushbackInputStream;)Lcom/htc/android/mail/ByteString;
    .locals 5
    .parameter "pbIn"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    const/4 v4, -0x1

    .line 6043
    new-instance v2, Ljava/io/ByteArrayOutputStream;

    invoke-direct {v2}, Ljava/io/ByteArrayOutputStream;-><init>()V

    .line 6044
    .local v2, output:Ljava/io/ByteArrayOutputStream;
    const/4 v1, 0x0

    .line 6046
    .local v1, leftParenthesisCount:I
    invoke-direct {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->skipSpace(Ljava/io/PushbackInputStream;)V

    .line 6049
    :goto_0
    invoke-virtual {p1}, Ljava/io/PushbackInputStream;->read()I

    move-result v0

    .local v0, c:I
    if-eq v0, v4, :cond_0

    .line 6050
    if-nez v1, :cond_1

    const/16 v3, 0x20

    if-ne v0, v3, :cond_1

    .line 6066
    :cond_0
    :goto_1
    invoke-virtual {v2}, Ljava/io/ByteArrayOutputStream;->size()I

    move-result v3

    if-nez v3, :cond_5

    const/4 v3, 0x0

    .line 6067
    :goto_2
    return-object v3

    .line 6051
    :cond_1
    const/16 v3, 0x28

    if-ne v0, v3, :cond_3

    .line 6052
    add-int/lit8 v1, v1, 0x1

    .line 6064
    :cond_2
    invoke-virtual {v2, v0}, Ljava/io/ByteArrayOutputStream;->write(I)V

    goto :goto_0

    .line 6053
    :cond_3
    const/16 v3, 0x29

    if-ne v0, v3, :cond_2

    .line 6054
    add-int/lit8 v1, v1, -0x1

    .line 6055
    if-nez v1, :cond_4

    .line 6056
    invoke-virtual {v2, v0}, Ljava/io/ByteArrayOutputStream;->write(I)V

    goto :goto_1

    .line 6058
    :cond_4
    if-ne v1, v4, :cond_2

    .line 6059
    invoke-virtual {p1, v0}, Ljava/io/PushbackInputStream;->unread(I)V

    goto :goto_1

    .line 6067
    :cond_5
    new-instance v3, Lcom/htc/android/mail/ByteString;

    invoke-virtual {v2}, Ljava/io/ByteArrayOutputStream;->toByteArray()[B

    move-result-object v4

    invoke-direct {v3, v4}, Lcom/htc/android/mail/ByteString;-><init>([B)V

    goto :goto_2
.end method

.method private goToEOL(Ljava/io/PushbackInputStream;)V
    .locals 2
    .parameter "pbIn"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .line 5864
    :cond_0
    :goto_0
    invoke-virtual {p1}, Ljava/io/PushbackInputStream;->read()I

    move-result v0

    .local v0, c:I
    const/4 v1, -0x1

    if-eq v0, v1, :cond_1

    .line 5865
    const/16 v1, 0xd

    if-ne v0, v1, :cond_0

    .line 5866
    invoke-virtual {p1}, Ljava/io/PushbackInputStream;->read()I

    move-result v0

    .line 5867
    const/16 v1, 0xa

    if-ne v0, v1, :cond_2

    .line 5874
    :cond_1
    return-void

    .line 5870
    :cond_2
    invoke-virtual {p1, v0}, Ljava/io/PushbackInputStream;->unread(I)V

    goto :goto_0
.end method

.method private includeAttach(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Z
    .locals 12
    .parameter "fileFullpath"
    .parameter "filename"
    .parameter "type"

    .prologue
    .line 5437
    new-instance v2, Ljava/io/File;

    invoke-direct {v2, p1}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 5438
    .local v2, file:Ljava/io/File;
    const/4 v3, 0x0

    .line 5440
    .local v3, fis:Ljava/io/FileInputStream;
    :try_start_0
    new-instance v4, Ljava/io/FileInputStream;

    invoke-direct {v4, v2}, Ljava/io/FileInputStream;-><init>(Ljava/io/File;)V
    :try_end_0
    .catch Ljava/io/FileNotFoundException; {:try_start_0 .. :try_end_0} :catch_0

    .line 5446
    .end local v3           #fis:Ljava/io/FileInputStream;
    .local v4, fis:Ljava/io/FileInputStream;
    :try_start_1
    const-string v9, "utf-8"

    invoke-virtual {p2, v9}, Ljava/lang/String;->getBytes(Ljava/lang/String;)[B

    move-result-object v9

    invoke-static {v9}, Lcom/htc/android/mail/Util;->needEncode([B)Z

    move-result v9

    if-eqz v9, :cond_1

    .line 5447
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Content-Type: "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, ";\r\n\tname="

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, "\""

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-static {p2}, Lcom/htc/android/mail/server/SmtpServer;->rfc2047Base64Encode(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, "\""

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {p0, v9}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5450
    :goto_0
    const-string v9, "Content-Transfer-Encoding: base64"

    invoke-virtual {p0, v9}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5451
    const-string v9, "utf-8"

    invoke-virtual {p2, v9}, Ljava/lang/String;->getBytes(Ljava/lang/String;)[B

    move-result-object v9

    invoke-static {v9}, Lcom/htc/android/mail/Util;->needEncode([B)Z

    move-result v9

    if-eqz v9, :cond_3

    .line 5452
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Content-Disposition: attachment;\r\n\tfilename=\""

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-static {p2}, Lcom/htc/android/mail/server/SmtpServer;->rfc2047Base64Encode(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, "\""

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {p0, v9}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5456
    :goto_1
    const-string v9, ""

    invoke-virtual {p0, v9}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5458
    sget v7, Lcom/htc/android/mail/server/ImapServer;->ONETIME_ENCODE_SIZE:I

    .line 5459
    .local v7, oneTime:I
    new-array v0, v7, [B

    .line 5462
    .local v0, content:[B
    const/4 v5, 0x0

    .line 5463
    .local v5, i:I
    :goto_2
    const/4 v9, 0x0

    invoke-virtual {v4, v0, v9, v7}, Ljava/io/FileInputStream;->read([BII)I
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Ljava/io/IOException; {:try_start_1 .. :try_end_1} :catch_1
    .catch Ljava/lang/OutOfMemoryError; {:try_start_1 .. :try_end_1} :catch_2

    move-result v8

    .line 5464
    .local v8, size:I
    const/4 v9, -0x1

    if-ne v8, v9, :cond_5

    .line 5475
    const/4 v0, 0x0

    .line 5486
    if-eqz v4, :cond_0

    :try_start_2
    invoke-virtual {v4}, Ljava/io/FileInputStream;->close()V
    :try_end_2
    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_6

    .line 5491
    :cond_0
    :goto_3
    const/4 v9, 0x1

    move-object v3, v4

    .end local v0           #content:[B
    .end local v4           #fis:Ljava/io/FileInputStream;
    .end local v5           #i:I
    .end local v7           #oneTime:I
    .end local v8           #size:I
    .restart local v3       #fis:Ljava/io/FileInputStream;
    :goto_4
    return v9

    .line 5441
    :catch_0
    move-exception v1

    .line 5442
    .local v1, e:Ljava/io/FileNotFoundException;
    invoke-virtual {v1}, Ljava/io/FileNotFoundException;->printStackTrace()V

    .line 5443
    const/4 v9, 0x0

    goto :goto_4

    .line 5449
    .end local v1           #e:Ljava/io/FileNotFoundException;
    .end local v3           #fis:Ljava/io/FileInputStream;
    .restart local v4       #fis:Ljava/io/FileInputStream;
    :cond_1
    :try_start_3
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Content-Type: "

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, ";\r\n\tname="

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, "\""

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, "\""

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {p0, v9}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0
    .catch Ljava/io/IOException; {:try_start_3 .. :try_end_3} :catch_1
    .catch Ljava/lang/OutOfMemoryError; {:try_start_3 .. :try_end_3} :catch_2

    goto :goto_0

    .line 5477
    :catch_1
    move-exception v1

    .line 5478
    .local v1, e:Ljava/io/IOException;
    :try_start_4
    invoke-virtual {v1}, Ljava/io/IOException;->printStackTrace()V

    .line 5479
    const-string v9, "ImapServer"

    const-string v10, "catch io exception"

    invoke-static {v9, v10, v1}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    .line 5480
    const/4 v9, 0x0

    .line 5486
    if-eqz v4, :cond_2

    :try_start_5
    invoke-virtual {v4}, Ljava/io/FileInputStream;->close()V
    :try_end_5
    .catch Ljava/lang/Exception; {:try_start_5 .. :try_end_5} :catch_4

    .end local v1           #e:Ljava/io/IOException;
    :cond_2
    :goto_5
    move-object v3, v4

    .line 5480
    .end local v4           #fis:Ljava/io/FileInputStream;
    .restart local v3       #fis:Ljava/io/FileInputStream;
    goto :goto_4

    .line 5454
    .end local v3           #fis:Ljava/io/FileInputStream;
    .restart local v4       #fis:Ljava/io/FileInputStream;
    :cond_3
    :try_start_6
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v10, "Content-Disposition: attachment;\r\n\tfilename=\""

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, "\""

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {p0, v9}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0
    .catch Ljava/io/IOException; {:try_start_6 .. :try_end_6} :catch_1
    .catch Ljava/lang/OutOfMemoryError; {:try_start_6 .. :try_end_6} :catch_2

    goto :goto_1

    .line 5481
    :catch_2
    move-exception v1

    .line 5482
    .local v1, e:Ljava/lang/OutOfMemoryError;
    :try_start_7
    iget-object v9, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    iget-object v10, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    const v11, 0x7f0b01a6

    invoke-virtual {v10, v11}, Landroid/content/Context;->getText(I)Ljava/lang/CharSequence;

    move-result-object v10

    const/4 v11, 0x1

    invoke-static {v9, v10, v11}, Landroid/widget/Toast;->makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast;

    move-result-object v9

    invoke-virtual {v9}, Landroid/widget/Toast;->show()V
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_0

    .line 5483
    const/4 v9, 0x0

    .line 5486
    if-eqz v4, :cond_4

    :try_start_8
    invoke-virtual {v4}, Ljava/io/FileInputStream;->close()V
    :try_end_8
    .catch Ljava/lang/Exception; {:try_start_8 .. :try_end_8} :catch_5

    .end local v1           #e:Ljava/lang/OutOfMemoryError;
    :cond_4
    :goto_6
    move-object v3, v4

    .line 5483
    .end local v4           #fis:Ljava/io/FileInputStream;
    .restart local v3       #fis:Ljava/io/FileInputStream;
    goto :goto_4

    .line 5467
    .end local v3           #fis:Ljava/io/FileInputStream;
    .restart local v0       #content:[B
    .restart local v4       #fis:Ljava/io/FileInputStream;
    .restart local v5       #i:I
    .restart local v7       #oneTime:I
    .restart local v8       #size:I
    :cond_5
    if-ne v8, v7, :cond_6

    .line 5468
    :try_start_9
    invoke-static {v0}, Lorg/apache/commons/codec/binary/Base64;->encodeBase64Chunked([B)[B

    move-result-object v9

    invoke-virtual {p0, v9}, Lcom/htc/android/mail/server/ImapServer;->write([B)V

    .line 5462
    :goto_7
    add-int/lit8 v5, v5, 0x1

    goto/16 :goto_2

    .line 5470
    :cond_6
    new-array v6, v8, [B

    .line 5471
    .local v6, lessContent:[B
    const/4 v9, 0x0

    const/4 v10, 0x0

    invoke-static {v0, v9, v6, v10, v8}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V

    .line 5472
    invoke-static {v6}, Lorg/apache/commons/codec/binary/Base64;->encodeBase64Chunked([B)[B

    move-result-object v9

    invoke-virtual {p0, v9}, Lcom/htc/android/mail/server/ImapServer;->write([B)V
    :try_end_9
    .catchall {:try_start_9 .. :try_end_9} :catchall_0
    .catch Ljava/io/IOException; {:try_start_9 .. :try_end_9} :catch_1
    .catch Ljava/lang/OutOfMemoryError; {:try_start_9 .. :try_end_9} :catch_2

    goto :goto_7

    .line 5485
    .end local v0           #content:[B
    .end local v5           #i:I
    .end local v6           #lessContent:[B
    .end local v7           #oneTime:I
    .end local v8           #size:I
    :catchall_0
    move-exception v9

    .line 5486
    if-eqz v4, :cond_7

    :try_start_a
    invoke-virtual {v4}, Ljava/io/FileInputStream;->close()V
    :try_end_a
    .catch Ljava/lang/Exception; {:try_start_a .. :try_end_a} :catch_3

    .line 5485
    :cond_7
    :goto_8
    throw v9

    .line 5487
    :catch_3
    move-exception v1

    .line 5488
    .local v1, e:Ljava/lang/Exception;
    invoke-virtual {v1}, Ljava/lang/Exception;->printStackTrace()V

    goto :goto_8

    .line 5487
    .local v1, e:Ljava/io/IOException;
    :catch_4
    move-exception v1

    .line 5488
    .local v1, e:Ljava/lang/Exception;
    invoke-virtual {v1}, Ljava/lang/Exception;->printStackTrace()V

    goto :goto_5

    .line 5487
    .local v1, e:Ljava/lang/OutOfMemoryError;
    :catch_5
    move-exception v1

    .line 5488
    .local v1, e:Ljava/lang/Exception;
    invoke-virtual {v1}, Ljava/lang/Exception;->printStackTrace()V

    goto :goto_6

    .line 5487
    .end local v1           #e:Ljava/lang/Exception;
    .restart local v0       #content:[B
    .restart local v5       #i:I
    .restart local v7       #oneTime:I
    .restart local v8       #size:I
    :catch_6
    move-exception v1

    .line 5488
    .restart local v1       #e:Ljava/lang/Exception;
    invoke-virtual {v1}, Ljava/lang/Exception;->printStackTrace()V

    goto/16 :goto_3
.end method

.method private insertPendingFetchMailRequest(Ljava/util/List;Ljava/util/HashMap;Ljava/util/HashMap;)V
    .locals 10
    .parameter
    .parameter
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Ljava/lang/String;",
            ">;",
            "Ljava/util/HashMap",
            "<",
            "Ljava/lang/String;",
            "Ljava/lang/Object;",
            ">;",
            "Ljava/util/HashMap",
            "<",
            "Ljava/lang/String;",
            "Ljava/lang/Object;",
            ">;)V"
        }
    .end annotation

    .prologue
    .line 3419
    .local p1, uidListForFetch:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    .local p2, pendingFetchMailMap:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Ljava/lang/Object;>;"
    .local p3, pendingFetchMailMapRemoved:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Ljava/lang/Object;>;"
    new-instance v6, Ljava/util/ArrayList;

    invoke-direct {v6}, Ljava/util/ArrayList;-><init>()V

    .line 3420
    .local v6, valuesArrayList:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/ContentValues;>;"
    invoke-interface {p1}, Ljava/util/List;->iterator()Ljava/util/Iterator;

    move-result-object v2

    .local v2, i$:Ljava/util/Iterator;
    :cond_0
    :goto_0
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_3

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/String;

    .line 3421
    .local v3, uid:Ljava/lang/String;
    if-eqz p2, :cond_1

    invoke-virtual {p2, v3}, Ljava/util/HashMap;->containsKey(Ljava/lang/Object;)Z

    move-result v7

    if-nez v7, :cond_0

    :cond_1
    if-eqz p3, :cond_2

    invoke-virtual {p3, v3}, Ljava/util/HashMap;->containsKey(Ljava/lang/Object;)Z

    move-result v7

    if-nez v7, :cond_0

    .line 3423
    :cond_2
    new-instance v4, Landroid/content/ContentValues;

    invoke-direct {v4}, Landroid/content/ContentValues;-><init>()V

    .line 3424
    .local v4, values:Landroid/content/ContentValues;
    const-string v7, "_accountId"

    iget-object v8, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v8}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v8

    invoke-static {v8, v9}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v8

    invoke-virtual {v4, v7, v8}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 3425
    const-string v7, "_request"

    const/4 v8, 0x6

    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v8

    invoke-virtual {v4, v7, v8}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 3426
    const-string v7, "_fromMailboxId"

    iget-object v8, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-wide v8, v8, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-static {v8, v9}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v8

    invoke-virtual {v4, v7, v8}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 3427
    const-string v7, "_uid"

    invoke-virtual {v4, v7, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3428
    invoke-virtual {v6, v4}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_0

    .line 3432
    .end local v3           #uid:Ljava/lang/String;
    .end local v4           #values:Landroid/content/ContentValues;
    :cond_3
    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v7

    if-lez v7, :cond_4

    .line 3433
    const/4 v7, 0x0

    new-array v7, v7, [Landroid/content/ContentValues;

    invoke-virtual {v6, v7}, Ljava/util/ArrayList;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;

    move-result-object v5

    check-cast v5, [Landroid/content/ContentValues;

    .line 3434
    .local v5, valuesArray:[Landroid/content/ContentValues;
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v0

    .line 3436
    .local v0, cp:Landroid/content/IContentProvider;
    :try_start_0
    sget-object v7, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    invoke-interface {v0, v7, v5}, Landroid/content/IContentProvider;->bulkInsert(Landroid/net/Uri;[Landroid/content/ContentValues;)I
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 3441
    .end local v0           #cp:Landroid/content/IContentProvider;
    .end local v5           #valuesArray:[Landroid/content/ContentValues;
    :cond_4
    :goto_1
    return-void

    .line 3437
    .restart local v0       #cp:Landroid/content/IContentProvider;
    .restart local v5       #valuesArray:[Landroid/content/ContentValues;
    :catch_0
    move-exception v1

    .line 3438
    .local v1, e:Landroid/os/RemoteException;
    const-string v7, "ImapServer"

    const-string v8, "catch exception"

    invoke-static {v7, v8, v1}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V

    goto :goto_1
.end method

.method private insertReadStatusRequest(JJLjava/lang/String;Ljava/lang/String;IZ)V
    .locals 12
    .parameter "fromMailboxId"
    .parameter "messageId"
    .parameter "uid"
    .parameter "msgIdInHeader"
    .parameter "request"
    .parameter "leaveIfNotExist"

    .prologue
    .line 1352
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v1

    .line 1354
    .local v1, cp:Landroid/content/IContentProvider;
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v3, "_messageId = \'%d\' AND _request = \'%d\' AND _accountId = \'%d\'"

    const/4 v5, 0x3

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v6, 0x0

    invoke-static/range {p3 .. p4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v10

    aput-object v10, v5, v6

    const/4 v6, 0x1

    const/4 v10, 0x2

    invoke-static {v10}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v10

    aput-object v10, v5, v6

    const/4 v6, 0x2

    iget-object v10, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v10}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v10

    invoke-static {v10, v11}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v10

    aput-object v10, v5, v6

    invoke-static {v2, v3, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v4

    .line 1356
    .local v4, where:Ljava/lang/String;
    const/4 v7, 0x0

    .line 1358
    .local v7, c:Landroid/database/Cursor;
    :try_start_0
    sget-object v2, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    const/4 v3, 0x0

    const/4 v5, 0x0

    const/4 v6, 0x0

    invoke-interface/range {v1 .. v6}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v7

    .line 1360
    if-eqz p8, :cond_1

    .line 1361
    invoke-interface {v7}, Landroid/database/Cursor;->getCount()I
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_1

    move-result v2

    if-nez v2, :cond_1

    .line 1374
    if-eqz v7, :cond_0

    invoke-interface {v7}, Landroid/database/Cursor;->isClosed()Z

    move-result v2

    if-nez v2, :cond_0

    .line 1375
    invoke-interface {v7}, Landroid/database/Cursor;->close()V

    .line 1393
    :cond_0
    :goto_0
    return-void

    .line 1366
    :cond_1
    :try_start_1
    invoke-interface {v7}, Landroid/database/Cursor;->getCount()I

    move-result v2

    if-lez v2, :cond_2

    .line 1367
    invoke-interface {v7}, Landroid/database/Cursor;->moveToNext()Z

    .line 1368
    const-string v2, "_uid"

    invoke-interface {v7, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    invoke-interface {v7, v2}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object p5

    .line 1369
    const-string v2, "_fromMailboxId"

    invoke-interface {v7, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    invoke-interface {v7, v2}, Landroid/database/Cursor;->getLong(I)J
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1

    move-result-wide p1

    .line 1374
    :cond_2
    if-eqz v7, :cond_3

    invoke-interface {v7}, Landroid/database/Cursor;->isClosed()Z

    move-result v2

    if-nez v2, :cond_3

    .line 1375
    :goto_1
    invoke-interface {v7}, Landroid/database/Cursor;->close()V

    .line 1379
    :cond_3
    new-instance v9, Landroid/content/ContentValues;

    invoke-direct {v9}, Landroid/content/ContentValues;-><init>()V

    .line 1380
    .local v9, values:Landroid/content/ContentValues;
    const-string v2, "_accountId"

    iget-object v3, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v3}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v5

    invoke-static {v5, v6}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v3

    invoke-virtual {v9, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 1381
    const-string v2, "_messageId"

    invoke-static/range {p3 .. p4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v3

    invoke-virtual {v9, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 1382
    const-string v2, "_uid"

    move-object/from16 v0, p5

    invoke-virtual {v9, v2, v0}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 1383
    const-string v2, "_msgId"

    move-object/from16 v0, p6

    invoke-virtual {v9, v2, v0}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 1384
    const-string v2, "_request"

    invoke-static/range {p7 .. p7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v9, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 1385
    const-string v2, "_fromMailboxId"

    invoke-static {p1, p2}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v3

    invoke-virtual {v9, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 1387
    :try_start_2
    sget-object v2, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    invoke-interface {v1, v2, v9}, Landroid/content/IContentProvider;->insert(Landroid/net/Uri;Landroid/content/ContentValues;)Landroid/net/Uri;
    :try_end_2
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_0
    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_2

    goto :goto_0

    .line 1388
    :catch_0
    move-exception v8

    .line 1389
    .local v8, e:Landroid/os/RemoteException;
    const-string v2, "ImapServer"

    const-string v3, "insert into peding_requests fail"

    invoke-static {v2, v3, v8}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_0

    .line 1371
    .end local v8           #e:Landroid/os/RemoteException;
    .end local v9           #values:Landroid/content/ContentValues;
    :catch_1
    move-exception v8

    .line 1372
    .restart local v8       #e:Landroid/os/RemoteException;
    :try_start_3
    const-string v2, "ImapServer"

    const-string v3, "catch exception"

    invoke-static {v2, v3, v8}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 1374
    if-eqz v7, :cond_3

    invoke-interface {v7}, Landroid/database/Cursor;->isClosed()Z

    move-result v2

    if-nez v2, :cond_3

    goto :goto_1

    .end local v8           #e:Landroid/os/RemoteException;
    :catchall_0
    move-exception v2

    if-eqz v7, :cond_4

    invoke-interface {v7}, Landroid/database/Cursor;->isClosed()Z

    move-result v3

    if-nez v3, :cond_4

    .line 1375
    invoke-interface {v7}, Landroid/database/Cursor;->close()V

    .line 1374
    :cond_4
    throw v2

    .line 1390
    .restart local v9       #values:Landroid/content/ContentValues;
    :catch_2
    move-exception v8

    .line 1391
    .local v8, e:Ljava/lang/Exception;
    const-string v2, "ImapServer"

    const-string v3, "Unknow Exception"

    invoke-static {v2, v3, v8}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto/16 :goto_0
.end method

.method private isIncludeAttachment(Ljava/lang/Long;)I
    .locals 10
    .parameter "messageId"

    .prologue
    const/4 v2, 0x0

    .line 5495
    const/4 v9, 0x0

    .line 5496
    .local v9, ret:I
    iget v6, p0, Lcom/htc/android/mail/server/ImapServer;->mixedType:I

    .line 5497
    .local v6, includeMix:I
    iget v7, p0, Lcom/htc/android/mail/server/ImapServer;->relatedType:I

    .line 5498
    .local v7, includeRelative:I
    sget-object v0, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v1, "_message = \'%d\' AND _filename<>\'\' AND _filepath<>\'\'"

    const/4 v4, 0x1

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v5, 0x0

    aput-object p1, v4, v5

    invoke-static {v0, v1, v4}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    .line 5499
    .local v3, where:Ljava/lang/String;
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v0

    sget-object v1, Lcom/htc/android/mail/MailProvider;->sPartsURI:Landroid/net/Uri;

    move-object v4, v2

    move-object v5, v2

    invoke-virtual/range {v0 .. v5}, Landroid/content/ContentResolver;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v8

    .line 5501
    .local v8, parts:Landroid/database/Cursor;
    :cond_0
    :goto_0
    invoke-interface {v8}, Landroid/database/Cursor;->moveToNext()Z

    move-result v0

    if-eqz v0, :cond_2

    .line 5502
    const-string v0, "_filename"

    invoke-interface {v8, v0}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v0

    invoke-interface {v8, v0}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v0

    const-string v1, ""

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_0

    .line 5503
    const-string v0, "_contenttype"

    invoke-interface {v8, v0}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v0

    invoke-interface {v8, v0}, Landroid/database/Cursor;->getInt(I)I

    move-result v0

    sget v1, Lcom/htc/android/mail/Rfc2822;->CONTENTTYPE_MIXED:I

    if-ne v0, v1, :cond_1

    .line 5504
    or-int/2addr v9, v6

    goto :goto_0

    .line 5505
    :cond_1
    const-string v0, "_contenttype"

    invoke-interface {v8, v0}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v0

    invoke-interface {v8, v0}, Landroid/database/Cursor;->getInt(I)I

    move-result v0

    sget v1, Lcom/htc/android/mail/Rfc2822;->CONTENTTYPE_RELATED:I

    if-ne v0, v1, :cond_0

    .line 5506
    or-int/2addr v9, v7

    goto :goto_0

    .line 5510
    :cond_2
    invoke-interface {v8}, Landroid/database/Cursor;->close()V

    .line 5511
    return v9
.end method

.method private isNumber(Ljava/lang/String;)Z
    .locals 4
    .parameter "str"

    .prologue
    const/4 v2, 0x0

    .line 6125
    if-eqz p1, :cond_0

    invoke-virtual {p1}, Ljava/lang/String;->length()I

    move-result v3

    if-nez v3, :cond_1

    .line 6130
    :cond_0
    :goto_0
    return v2

    .line 6126
    :cond_1
    invoke-virtual {p1}, Ljava/lang/String;->length()I

    move-result v1

    .line 6127
    .local v1, len:I
    const/4 v0, 0x0

    .local v0, i:I
    :goto_1
    if-ge v0, v1, :cond_2

    .line 6128
    invoke-virtual {p1, v0}, Ljava/lang/String;->charAt(I)C

    move-result v3

    invoke-static {v3}, Ljava/lang/Character;->isDigit(C)Z

    move-result v3

    if-eqz v3, :cond_0

    .line 6127
    add-int/lit8 v0, v0, 0x1

    goto :goto_1

    .line 6130
    :cond_2
    const/4 v2, 0x1

    goto :goto_0
.end method

.method private issueBody(Ljava/lang/StringBuilder;Landroid/database/Cursor;Landroid/database/Cursor;Landroid/database/Cursor;Landroid/database/Cursor;Landroid/database/Cursor;J)V
    .locals 22
    .parameter "mailbody"
    .parameter "message"
    .parameter "plainBody"
    .parameter "htmlBody"
    .parameter "parts"
    .parameter "relatedParts"
    .parameter "messageId"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 5264
    invoke-interface/range {p2 .. p2}, Landroid/database/Cursor;->getCount()I

    move-result v2

    const/4 v3, 0x1

    if-ge v2, v3, :cond_1

    .line 5312
    :cond_0
    :goto_0
    return-void

    .line 5267
    :cond_1
    invoke-interface/range {p2 .. p2}, Landroid/database/Cursor;->moveToFirst()Z

    move-result v2

    if-eqz v2, :cond_0

    .line 5271
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->issueAdditionalHeader()V

    .line 5273
    const-string v2, "_to"

    move-object/from16 v0, p2

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    move-object/from16 v0, p2

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v21

    .line 5274
    .local v21, to:Ljava/lang/String;
    const-string v2, "_cc"

    move-object/from16 v0, p2

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    move-object/from16 v0, p2

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v13

    .line 5275
    .local v13, cc:Ljava/lang/String;
    const-string v2, "_from"

    move-object/from16 v0, p2

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    move-object/from16 v0, p2

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v15

    .line 5276
    .local v15, from:Ljava/lang/String;
    const-string v2, "_fromEmail"

    move-object/from16 v0, p2

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    move-object/from16 v0, p2

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v16

    .line 5277
    .local v16, fromEmail:Ljava/lang/String;
    const-string v2, "_date"

    move-object/from16 v0, p2

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    move-object/from16 v0, p2

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v2

    invoke-static {v2, v3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v14

    .line 5278
    .local v14, date:Ljava/lang/Long;
    const-string v2, "_subject"

    move-object/from16 v0, p2

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    move-object/from16 v0, p2

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v20

    .line 5279
    .local v20, subject:Ljava/lang/String;
    const-string v2, "_messageid"

    move-object/from16 v0, p2

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    move-object/from16 v0, p2

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v18

    .line 5280
    .local v18, msgIdInHeader:Ljava/lang/String;
    const-string v2, "_importance"

    move-object/from16 v0, p2

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    move-object/from16 v0, p2

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getInt(I)I

    move-result v17

    .line 5281
    .local v17, importance:I
    if-eqz v15, :cond_8

    const-string v2, "utf-8"

    invoke-virtual {v15, v2}, Ljava/lang/String;->getBytes(Ljava/lang/String;)[B

    move-result-object v2

    invoke-static {v2}, Lcom/htc/android/mail/Util;->needEncode([B)Z

    move-result v2

    if-eqz v2, :cond_8

    .line 5282
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "From: \""

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-static {v15}, Lcom/htc/android/mail/server/SmtpServer;->rfc2047Base64Encode(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, "\""

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, " <"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    move-object/from16 v0, v16

    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, ">"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, p0

    invoke-virtual {v0, v2}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5290
    :goto_1
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Subject: "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-static/range {v20 .. v20}, Lcom/htc/android/mail/server/SmtpServer;->rfc2047SegmentedBase64Encode(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, p0

    invoke-virtual {v0, v2}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5291
    if-eqz v21, :cond_2

    const-string v2, ""

    move-object/from16 v0, v21

    invoke-virtual {v0, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_2

    .line 5292
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "To: "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    move-object/from16 v0, v21

    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, p0

    invoke-virtual {v0, v2}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5293
    :cond_2
    if-eqz v13, :cond_3

    const-string v2, ""

    invoke-virtual {v13, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_3

    .line 5294
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Cc: "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, p0

    invoke-virtual {v0, v2}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5295
    :cond_3
    if-eqz v14, :cond_4

    .line 5296
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Date: "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v14}, Ljava/lang/Long;->longValue()J

    move-result-wide v3

    invoke-static {v3, v4}, Lcom/htc/android/mail/Util;->getTimeWithTimeZone(J)Ljava/lang/CharSequence;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, p0

    invoke-virtual {v0, v2}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5297
    :cond_4
    if-eqz v18, :cond_5

    const-string v2, ""

    move-object/from16 v0, v18

    invoke-virtual {v0, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_5

    .line 5298
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Message-ID: <"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    move-object/from16 v0, v18

    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, ">"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, p0

    invoke-virtual {v0, v2}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5299
    :cond_5
    move-object/from16 v0, p0

    move/from16 v1, v17

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->writeImportanceHeader(I)V

    .line 5300
    const-string v2, "MIME-Version: 1.0"

    move-object/from16 v0, p0

    invoke-virtual {v0, v2}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5305
    const/16 v19, 0x0

    .line 5306
    .local v19, ret:I
    invoke-interface/range {p5 .. p5}, Landroid/database/Cursor;->getCount()I

    move-result v2

    if-lez v2, :cond_6

    .line 5307
    move-object/from16 v0, p0

    iget v2, v0, Lcom/htc/android/mail/server/ImapServer;->mixedType:I

    or-int v19, v19, v2

    .line 5308
    :cond_6
    invoke-interface/range {p6 .. p6}, Landroid/database/Cursor;->getCount()I

    move-result v2

    if-lez v2, :cond_7

    .line 5309
    move-object/from16 v0, p0

    iget v2, v0, Lcom/htc/android/mail/server/ImapServer;->relatedType:I

    or-int v19, v19, v2

    .line 5311
    :cond_7
    invoke-static/range {p7 .. p8}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v4

    sget-boolean v10, Lcom/htc/android/mail/Mime;->supportHTML:Z

    move-object/from16 v0, p0

    iget v2, v0, Lcom/htc/android/mail/server/ImapServer;->relatedType:I

    and-int v2, v2, v19

    if-eqz v2, :cond_9

    const/4 v11, 0x1

    :goto_2
    move-object/from16 v0, p0

    iget v2, v0, Lcom/htc/android/mail/server/ImapServer;->mixedType:I

    and-int v2, v2, v19

    if-eqz v2, :cond_a

    const/4 v12, 0x1

    :goto_3
    move-object/from16 v2, p0

    move-object/from16 v3, p1

    move-object/from16 v5, p2

    move-object/from16 v6, p3

    move-object/from16 v7, p4

    move-object/from16 v8, p5

    move-object/from16 v9, p6

    invoke-direct/range {v2 .. v12}, Lcom/htc/android/mail/server/ImapServer;->issueContent(Ljava/lang/StringBuilder;Ljava/lang/Long;Landroid/database/Cursor;Landroid/database/Cursor;Landroid/database/Cursor;Landroid/database/Cursor;Landroid/database/Cursor;ZZZ)V

    goto/16 :goto_0

    .line 5284
    .end local v19           #ret:I
    :cond_8
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "From: \""

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-static {v15}, Lcom/htc/android/mail/server/SmtpServer;->addEscape(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, "\""

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, " <"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    move-object/from16 v0, v16

    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, ">"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, p0

    invoke-virtual {v0, v2}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    goto/16 :goto_1

    .line 5311
    .restart local v19       #ret:I
    :cond_9
    const/4 v11, 0x0

    goto :goto_2

    :cond_a
    const/4 v12, 0x0

    goto :goto_3
.end method

.method private issueContent(Ljava/lang/StringBuilder;Ljava/lang/Long;Landroid/database/Cursor;Landroid/database/Cursor;Landroid/database/Cursor;Landroid/database/Cursor;Landroid/database/Cursor;ZZZ)V
    .locals 15
    .parameter "mailbody"
    .parameter "messageId"
    .parameter "message"
    .parameter "plainBody"
    .parameter "htmlBody"
    .parameter "parts"
    .parameter "relatedParts"
    .parameter "alternative"
    .parameter "related"
    .parameter "mixed"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 5317
    const/4 v1, 0x0

    .line 5318
    .local v1, BoundaryNum:I
    const/4 v9, 0x0

    .line 5319
    .local v9, htmlBodyExist:Z
    const/4 v12, 0x0

    .line 5320
    .local v12, plainBodyText:Ljava/lang/String;
    const/4 v10, 0x0

    .line 5321
    .local v10, htmlBodyText:Ljava/lang/String;
    const-string v4, ""

    .line 5322
    .local v4, editText:Ljava/lang/String;
    const-string v8, ""

    .line 5325
    .local v8, headerText:Ljava/lang/String;
    if-eqz p8, :cond_d

    iget-object v13, p0, Lcom/htc/android/mail/server/ImapServer;->alterBoundary:Ljava/lang/String;

    const-string v14, ""

    invoke-virtual {v13, v14}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v13

    if-eqz v13, :cond_d

    .line 5326
    add-int/lit8 v2, v1, 0x1

    .end local v1           #BoundaryNum:I
    .local v2, BoundaryNum:I
    invoke-static {v1}, Lcom/htc/android/mail/Util;->GenBoundary(I)Ljava/lang/String;

    move-result-object v13

    iput-object v13, p0, Lcom/htc/android/mail/server/ImapServer;->alterBoundary:Ljava/lang/String;

    .line 5327
    :goto_0
    if-eqz p9, :cond_0

    iget-object v13, p0, Lcom/htc/android/mail/server/ImapServer;->relatedBoundary:Ljava/lang/String;

    const-string v14, ""

    invoke-virtual {v13, v14}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v13

    if-eqz v13, :cond_0

    .line 5328
    add-int/lit8 v1, v2, 0x1

    .end local v2           #BoundaryNum:I
    .restart local v1       #BoundaryNum:I
    invoke-static {v2}, Lcom/htc/android/mail/Util;->GenBoundary(I)Ljava/lang/String;

    move-result-object v13

    iput-object v13, p0, Lcom/htc/android/mail/server/ImapServer;->relatedBoundary:Ljava/lang/String;

    move v2, v1

    .line 5329
    .end local v1           #BoundaryNum:I
    .restart local v2       #BoundaryNum:I
    :cond_0
    if-eqz p10, :cond_c

    iget-object v13, p0, Lcom/htc/android/mail/server/ImapServer;->mixBoundary:Ljava/lang/String;

    const-string v14, ""

    invoke-virtual {v13, v14}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v13

    if-eqz v13, :cond_c

    .line 5330
    add-int/lit8 v1, v2, 0x1

    .end local v2           #BoundaryNum:I
    .restart local v1       #BoundaryNum:I
    invoke-static {v2}, Lcom/htc/android/mail/Util;->GenBoundary(I)Ljava/lang/String;

    move-result-object v13

    iput-object v13, p0, Lcom/htc/android/mail/server/ImapServer;->mixBoundary:Ljava/lang/String;

    .line 5332
    :goto_1
    if-eqz p10, :cond_1

    .line 5333
    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "Content-Type: multipart/mixed;\r\n\tboundary=\""

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    iget-object v14, p0, Lcom/htc/android/mail/server/ImapServer;->mixBoundary:Ljava/lang/String;

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    const-string v14, "\""

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5334
    const-string v13, ""

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5335
    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "--"

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    iget-object v14, p0, Lcom/htc/android/mail/server/ImapServer;->mixBoundary:Ljava/lang/String;

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5338
    :cond_1
    if-eqz p9, :cond_2

    .line 5339
    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "Content-Type: multipart/related;\r\n\tboundary=\""

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    iget-object v14, p0, Lcom/htc/android/mail/server/ImapServer;->relatedBoundary:Ljava/lang/String;

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    const-string v14, "\""

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5340
    const-string v13, ""

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5341
    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "--"

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    iget-object v14, p0, Lcom/htc/android/mail/server/ImapServer;->relatedBoundary:Ljava/lang/String;

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5344
    :cond_2
    if-eqz p8, :cond_3

    .line 5345
    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "Content-Type: multipart/alternative;\r\n\tboundary=\""

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    iget-object v14, p0, Lcom/htc/android/mail/server/ImapServer;->alterBoundary:Ljava/lang/String;

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    const-string v14, "\""

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5346
    const-string v13, ""

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5347
    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "--"

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    iget-object v14, p0, Lcom/htc/android/mail/server/ImapServer;->alterBoundary:Ljava/lang/String;

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5350
    :cond_3
    invoke-interface/range {p5 .. p5}, Landroid/database/Cursor;->getCount()I

    move-result v13

    if-lez v13, :cond_4

    .line 5351
    invoke-interface/range {p5 .. p5}, Landroid/database/Cursor;->moveToFirst()Z

    move-result v13

    if-eqz v13, :cond_4

    .line 5352
    const-string v13, "_text"

    move-object/from16 v0, p5

    invoke-interface {v0, v13}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v13

    move-object/from16 v0, p5

    invoke-interface {v0, v13}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v10

    .line 5356
    :cond_4
    invoke-interface/range {p4 .. p4}, Landroid/database/Cursor;->getCount()I

    move-result v13

    if-lez v13, :cond_5

    .line 5357
    invoke-interface/range {p4 .. p4}, Landroid/database/Cursor;->moveToFirst()Z

    move-result v13

    if-eqz v13, :cond_5

    .line 5358
    const-string v13, "_text"

    move-object/from16 v0, p4

    invoke-interface {v0, v13}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v13

    move-object/from16 v0, p4

    invoke-interface {v0, v13}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v12

    .line 5362
    :cond_5
    invoke-static {v12, v10}, Lcom/htc/android/mail/server/SmtpServer;->parsingMailBodyFromDraft(Ljava/lang/String;Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v3

    .line 5363
    .local v3, bodyArray:[Ljava/lang/String;
    if-eqz v3, :cond_6

    array-length v13, v3

    const/4 v14, 0x2

    if-ne v13, v14, :cond_6

    .line 5364
    const/4 v13, 0x0

    aget-object v12, v3, v13

    .line 5365
    const/4 v13, 0x1

    aget-object v10, v3, v13

    .line 5369
    :cond_6
    const/4 v13, 0x0

    invoke-direct {p0, v13, v12}, Lcom/htc/android/mail/server/ImapServer;->loadBody(ZLjava/lang/String;)V

    .line 5372
    if-eqz p8, :cond_7

    .line 5373
    const-string v13, ""

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5374
    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "--"

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    iget-object v14, p0, Lcom/htc/android/mail/server/ImapServer;->alterBoundary:Ljava/lang/String;

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5378
    :cond_7
    const/4 v13, 0x1

    invoke-direct {p0, v13, v10}, Lcom/htc/android/mail/server/ImapServer;->loadBody(ZLjava/lang/String;)V

    .line 5381
    const-string v13, ""

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5382
    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "--"

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    iget-object v14, p0, Lcom/htc/android/mail/server/ImapServer;->alterBoundary:Ljava/lang/String;

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    const-string v14, "--"

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5384
    if-eqz p9, :cond_8

    .line 5385
    iget-object v13, p0, Lcom/htc/android/mail/server/ImapServer;->relatedBoundary:Ljava/lang/String;

    move-object/from16 v0, p7

    invoke-virtual {p0, v0, v13}, Lcom/htc/android/mail/server/ImapServer;->GenRelatedAttachAndBound(Landroid/database/Cursor;Ljava/lang/String;)V

    .line 5387
    const-string v13, ""

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5388
    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "--"

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    iget-object v14, p0, Lcom/htc/android/mail/server/ImapServer;->relatedBoundary:Ljava/lang/String;

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    const-string v14, "--"

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5389
    const-string v13, ""

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5392
    :cond_8
    if-eqz p10, :cond_b

    .line 5393
    const/4 v13, -0x1

    move-object/from16 v0, p6

    invoke-interface {v0, v13}, Landroid/database/Cursor;->moveToPosition(I)Z

    .line 5394
    :cond_9
    :goto_2
    invoke-interface/range {p6 .. p6}, Landroid/database/Cursor;->moveToNext()Z

    move-result v13

    if-eqz v13, :cond_a

    .line 5395
    const-string v13, "_filename"

    move-object/from16 v0, p6

    invoke-interface {v0, v13}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v13

    move-object/from16 v0, p6

    invoke-interface {v0, v13}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v6

    .line 5396
    .local v6, filename:Ljava/lang/String;
    const-string v13, "_filepath"

    move-object/from16 v0, p6

    invoke-interface {v0, v13}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v13

    move-object/from16 v0, p6

    invoke-interface {v0, v13}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v7

    .line 5397
    .local v7, filepath:Ljava/lang/String;
    const-string v13, "_mimetype"

    move-object/from16 v0, p6

    invoke-interface {v0, v13}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v13

    move-object/from16 v0, p6

    invoke-interface {v0, v13}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v11

    .line 5398
    .local v11, mimetype:Ljava/lang/String;
    new-instance v5, Ljava/io/File;

    invoke-direct {v5, v7}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 5399
    .local v5, file:Ljava/io/File;
    invoke-virtual {v5}, Ljava/io/File;->exists()Z

    move-result v13

    if-eqz v13, :cond_9

    .line 5402
    const-string v13, ""

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5403
    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "--"

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    iget-object v14, p0, Lcom/htc/android/mail/server/ImapServer;->mixBoundary:Ljava/lang/String;

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5404
    invoke-direct {p0, v7, v6, v11}, Lcom/htc/android/mail/server/ImapServer;->includeAttach(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Z

    goto :goto_2

    .line 5406
    .end local v5           #file:Ljava/io/File;
    .end local v6           #filename:Ljava/lang/String;
    .end local v7           #filepath:Ljava/lang/String;
    .end local v11           #mimetype:Ljava/lang/String;
    :cond_a
    const-string v13, ""

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5407
    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "--"

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    iget-object v14, p0, Lcom/htc/android/mail/server/ImapServer;->mixBoundary:Ljava/lang/String;

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    const-string v14, "--"

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5410
    :cond_b
    return-void

    .end local v1           #BoundaryNum:I
    .end local v3           #bodyArray:[Ljava/lang/String;
    .restart local v2       #BoundaryNum:I
    :cond_c
    move v1, v2

    .end local v2           #BoundaryNum:I
    .restart local v1       #BoundaryNum:I
    goto/16 :goto_1

    :cond_d
    move v2, v1

    .end local v1           #BoundaryNum:I
    .restart local v2       #BoundaryNum:I
    goto/16 :goto_0
.end method

.method private loadBody(ZLjava/lang/String;)V
    .locals 3
    .parameter "isHtml"
    .parameter "body"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 5413
    const-string v0, "utf-8"

    invoke-virtual {p2, v0}, Ljava/lang/String;->getBytes(Ljava/lang/String;)[B

    move-result-object v0

    invoke-static {v0}, Lcom/htc/android/mail/Util;->needEncode([B)Z

    move-result v0

    if-eqz v0, :cond_1

    .line 5415
    if-eqz p1, :cond_0

    .line 5416
    const-string v0, "Content-Type: text/html;\r\n\tcharset=utf-8"

    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5419
    :goto_0
    const-string v0, "Content-Transfer-Encoding: base64"

    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5420
    const-string v0, "Content-Disposition: inline"

    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5421
    const-string v0, ""

    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5422
    new-instance v0, Ljava/lang/String;

    const-string v1, "utf-8"

    invoke-virtual {p2, v1}, Ljava/lang/String;->getBytes(Ljava/lang/String;)[B

    move-result-object v1

    invoke-static {v1}, Lorg/apache/commons/codec/binary/Base64;->encodeBase64Chunked([B)[B

    move-result-object v1

    const-string v2, "ISO8859-1"

    invoke-direct {v0, v1, v2}, Ljava/lang/String;-><init>([BLjava/lang/String;)V

    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5434
    :goto_1
    return-void

    .line 5418
    :cond_0
    const-string v0, "Content-Type: text/plain;\r\n\tcharset=utf-8"

    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    goto :goto_0

    .line 5425
    :cond_1
    if-eqz p1, :cond_2

    .line 5426
    const-string v0, "Content-Type: text/html;\r\n\tcharset=ISO-8859-1"

    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5429
    :goto_2
    const-string v0, "Content-Transfer-Encoding: 7bit"

    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5430
    const-string v0, "Content-Disposition: inline"

    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5431
    const-string v0, ""

    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5432
    invoke-virtual {p0, p2}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    goto :goto_1

    .line 5428
    :cond_2
    const-string v0, "Content-Type: text/plain;\r\n\tcharset=ISO-8859-1"

    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    goto :goto_2
.end method

.method private needBroadcastBack(I)Z
    .locals 7
    .parameter "percent"

    .prologue
    .line 568
    const/16 v6, 0xa

    new-array v5, v6, [I

    fill-array-data v5, :array_0

    .line 569
    .local v5, p_table:[I
    const/4 v1, 0x0

    .line 571
    .local v1, bNeed:Z
    move-object v0, v5

    .local v0, arr$:[I
    array-length v4, v0

    .local v4, len$:I
    const/4 v3, 0x0

    .local v3, i$:I
    :goto_0
    if-ge v3, v4, :cond_0

    aget v2, v0, v3

    .line 572
    .local v2, i:I
    if-ne v2, p1, :cond_1

    .line 573
    const/4 v1, 0x1

    .line 578
    .end local v2           #i:I
    :cond_0
    return v1

    .line 571
    .restart local v2       #i:I
    :cond_1
    add-int/lit8 v3, v3, 0x1

    goto :goto_0

    .line 568
    :array_0
    .array-data 0x4
        0xat 0x0t 0x0t 0x0t
        0x14t 0x0t 0x0t 0x0t
        0x1et 0x0t 0x0t 0x0t
        0x28t 0x0t 0x0t 0x0t
        0x32t 0x0t 0x0t 0x0t
        0x3ct 0x0t 0x0t 0x0t
        0x46t 0x0t 0x0t 0x0t
        0x50t 0x0t 0x0t 0x0t
        0x5at 0x0t 0x0t 0x0t
        0x64t 0x0t 0x0t 0x0t
    .end array-data
.end method

.method private newTLSSocket()V
    .locals 6
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 416
    const/4 v1, 0x1

    :try_start_0
    invoke-static {v1}, Lcom/htc/android/mail/util/SSLUtils;->getSSLSocketFactory(Z)Ljavax/net/ssl/SSLSocketFactory;

    move-result-object v1

    iget-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mSocket:Ljava/net/Socket;

    iget-object v3, p0, Lcom/htc/android/mail/server/ImapServer;->mInServer:Ljava/lang/String;

    iget v4, p0, Lcom/htc/android/mail/server/ImapServer;->mInPort:I

    const/4 v5, 0x1

    invoke-virtual {v1, v2, v3, v4, v5}, Ljavax/net/ssl/SSLSocketFactory;->createSocket(Ljava/net/Socket;Ljava/lang/String;IZ)Ljava/net/Socket;

    move-result-object v1

    iput-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mSocket:Ljava/net/Socket;

    .line 417
    new-instance v1, Ljava/io/BufferedInputStream;

    iget-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mSocket:Ljava/net/Socket;

    invoke-virtual {v2}, Ljava/net/Socket;->getInputStream()Ljava/io/InputStream;

    move-result-object v2

    const/16 v3, 0x400

    invoke-direct {v1, v2, v3}, Ljava/io/BufferedInputStream;-><init>(Ljava/io/InputStream;I)V

    iput-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mIn:Ljava/io/BufferedInputStream;

    .line 418
    new-instance v1, Ljava/io/BufferedOutputStream;

    iget-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mSocket:Ljava/net/Socket;

    invoke-virtual {v2}, Ljava/net/Socket;->getOutputStream()Ljava/io/OutputStream;

    move-result-object v2

    const/16 v3, 0x400

    invoke-direct {v1, v2, v3}, Ljava/io/BufferedOutputStream;-><init>(Ljava/io/OutputStream;I)V

    iput-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mOut:Ljava/io/BufferedOutputStream;

    .line 420
    const/4 v1, 0x0

    iput v1, p0, Lcom/htc/android/mail/server/Server;->socketState:I
    :try_end_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0

    .line 425
    return-void

    .line 421
    :catch_0
    move-exception v0

    .line 423
    .local v0, e:Ljava/io/IOException;
    new-instance v1, Ljava/io/IOException;

    invoke-direct {v1}, Ljava/io/IOException;-><init>()V

    throw v1
.end method

.method private nextToken(Ljava/io/PushbackInputStream;)Ljava/lang/String;
    .locals 4
    .parameter "pbIn"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .line 5886
    new-instance v2, Ljava/io/ByteArrayOutputStream;

    invoke-direct {v2}, Ljava/io/ByteArrayOutputStream;-><init>()V

    .line 5888
    .local v2, output:Ljava/io/ByteArrayOutputStream;
    invoke-direct {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->skipSpace(Ljava/io/PushbackInputStream;)V

    .line 5891
    :goto_0
    invoke-virtual {p1}, Ljava/io/PushbackInputStream;->read()I

    move-result v0

    .local v0, c:I
    const/4 v3, -0x1

    if-eq v0, v3, :cond_0

    .line 5892
    const/16 v3, 0x20

    if-ne v0, v3, :cond_1

    .line 5905
    :cond_0
    :goto_1
    invoke-virtual {v2}, Ljava/io/ByteArrayOutputStream;->toString()Ljava/lang/String;

    move-result-object v3

    return-object v3

    .line 5893
    :cond_1
    const/16 v3, 0x5d

    if-eq v0, v3, :cond_0

    .line 5894
    const/16 v3, 0xd

    if-ne v0, v3, :cond_2

    .line 5895
    invoke-virtual {p1}, Ljava/io/PushbackInputStream;->read()I

    move-result v1

    .line 5896
    .local v1, next:I
    const/16 v3, 0xa

    if-ne v1, v3, :cond_2

    .line 5897
    invoke-virtual {p1, v1}, Ljava/io/PushbackInputStream;->unread(I)V

    .line 5898
    invoke-virtual {p1, v0}, Ljava/io/PushbackInputStream;->unread(I)V

    goto :goto_1

    .line 5902
    .end local v1           #next:I
    :cond_2
    invoke-virtual {v2, v0}, Ljava/io/ByteArrayOutputStream;->write(I)V

    goto :goto_0
.end method

.method private parseExpungedResp(Ljava/io/PushbackInputStream;Lcom/htc/android/mail/server/ImapServer$ImapResponses;)V
    .locals 4
    .parameter "pbIn"
    .parameter "responses"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .line 5909
    invoke-direct {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->nextToken(Ljava/io/PushbackInputStream;)Ljava/lang/String;

    move-result-object v0

    .line 5910
    .local v0, nextToken:Ljava/lang/String;
    const-string v3, "(EARLIER)"

    invoke-virtual {v3, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_0

    .line 5914
    :goto_0
    return-void

    .line 5911
    :cond_0
    invoke-direct {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->getStringUntilEOL(Ljava/io/PushbackInputStream;)Ljava/lang/String;

    move-result-object v2

    .line 5912
    .local v2, uids:Ljava/lang/String;
    invoke-virtual {p2}, Lcom/htc/android/mail/server/ImapServer$ImapResponses;->getImapVanishedResponse()Lcom/htc/android/mail/server/ImapServer$ImapVanishedResponse;

    move-result-object v1

    .line 5913
    .local v1, response:Lcom/htc/android/mail/server/ImapServer$ImapVanishedResponse;
    invoke-virtual {v1, v2}, Lcom/htc/android/mail/server/ImapServer$ImapVanishedResponse;->parse(Ljava/lang/String;)V

    goto :goto_0
.end method

.method private parseRespTextCode(Ljava/io/PushbackInputStream;Lcom/htc/android/mail/server/ImapServer$ImapResponses;)V
    .locals 7
    .parameter "pbIn"
    .parameter "responses"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .line 5917
    invoke-direct {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->skipSpace(Ljava/io/PushbackInputStream;)V

    .line 5920
    invoke-virtual {p1}, Ljava/io/PushbackInputStream;->read()I

    move-result v0

    .line 5921
    .local v0, c:I
    const/16 v5, 0x5b

    if-eq v0, v5, :cond_1

    .line 5941
    :cond_0
    :goto_0
    return-void

    .line 5923
    :cond_1
    invoke-direct {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->nextToken(Ljava/io/PushbackInputStream;)Ljava/lang/String;

    move-result-object v4

    .line 5924
    .local v4, nextToken:Ljava/lang/String;
    const-string v5, "UIDVALIDITY"

    invoke-virtual {v5, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_2

    .line 5925
    invoke-direct {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->nextToken(Ljava/io/PushbackInputStream;)Ljava/lang/String;

    move-result-object v4

    .line 5926
    invoke-virtual {p2}, Lcom/htc/android/mail/server/ImapServer$ImapResponses;->getImapMailboxInfo()Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;

    move-result-object v3

    .line 5927
    .local v3, imapMailboxInfo:Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;
    iput-object v4, v3, Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;->uidValidity:Ljava/lang/String;

    goto :goto_0

    .line 5928
    .end local v3           #imapMailboxInfo:Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;
    :cond_2
    const-string v5, "UIDNEXT"

    invoke-virtual {v5, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_3

    .line 5929
    invoke-direct {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->nextToken(Ljava/io/PushbackInputStream;)Ljava/lang/String;

    move-result-object v4

    .line 5930
    invoke-virtual {p2}, Lcom/htc/android/mail/server/ImapServer$ImapResponses;->getImapMailboxInfo()Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;

    move-result-object v3

    .line 5931
    .restart local v3       #imapMailboxInfo:Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;
    invoke-static {v4}, Ljava/lang/Long;->parseLong(Ljava/lang/String;)J

    move-result-wide v5

    iput-wide v5, v3, Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;->uidNext:J

    goto :goto_0

    .line 5932
    .end local v3           #imapMailboxInfo:Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;
    :cond_3
    const-string v5, "HIGHESTMODSEQ"

    invoke-virtual {v5, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_4

    .line 5933
    invoke-direct {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->nextToken(Ljava/io/PushbackInputStream;)Ljava/lang/String;

    move-result-object v4

    .line 5934
    invoke-virtual {p2}, Lcom/htc/android/mail/server/ImapServer$ImapResponses;->getImapMailboxInfo()Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;

    move-result-object v3

    .line 5935
    .restart local v3       #imapMailboxInfo:Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;
    invoke-static {v4}, Ljava/lang/Long;->parseLong(Ljava/lang/String;)J

    move-result-wide v5

    iput-wide v5, v3, Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;->highestModSeq:J

    goto :goto_0

    .line 5936
    .end local v3           #imapMailboxInfo:Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;
    :cond_4
    const-string v5, "CAPABILITY"

    invoke-virtual {v5, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_0

    .line 5937
    const/16 v5, 0x5d

    invoke-direct {p0, p1, v5}, Lcom/htc/android/mail/server/ImapServer;->getStringUntil(Ljava/io/PushbackInputStream;I)Ljava/lang/String;

    move-result-object v1

    .line 5938
    .local v1, capa:Ljava/lang/String;
    invoke-virtual {p2}, Lcom/htc/android/mail/server/ImapServer$ImapResponses;->getImapCapability()Lcom/htc/android/mail/server/ImapServer$ImapCapability;

    move-result-object v2

    .line 5939
    .local v2, imapCapability:Lcom/htc/android/mail/server/ImapServer$ImapCapability;
    invoke-virtual {v2, v1}, Lcom/htc/android/mail/server/ImapServer$ImapCapability;->parse(Ljava/lang/String;)V

    goto :goto_0
.end method

.method private final processCAPA(Ljava/util/List;)Z
    .locals 7
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;)Z"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/4 v6, 0x1

    .line 310
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v2

    .line 312
    .local v2, size:I
    if-nez v2, :cond_0

    .line 313
    new-instance v4, Ljava/io/IOException;

    invoke-direct {v4}, Ljava/io/IOException;-><init>()V

    throw v4

    .line 316
    :cond_0
    add-int/lit8 v4, v2, -0x1

    invoke-interface {p1, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/htc/android/mail/ByteString;

    .line 317
    .local v0, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v0}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v4

    const-string v5, " "

    invoke-virtual {v4, v5}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v3

    .line 319
    .local v3, token:[Ljava/lang/String;
    array-length v4, v3

    const/4 v5, 0x2

    if-lt v4, v5, :cond_1

    array-length v4, v3

    if-le v4, v6, :cond_2

    aget-object v4, v3, v6

    sget-object v5, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v5}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v4

    if-eqz v4, :cond_2

    .line 320
    :cond_1
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->close()V

    .line 321
    new-instance v4, Ljava/io/IOException;

    invoke-direct {v4}, Ljava/io/IOException;-><init>()V

    throw v4

    .line 324
    :cond_2
    invoke-virtual {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->processFetchResponse(Ljava/util/List;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    move-result-object v1

    .line 325
    .local v1, responses:Lcom/htc/android/mail/server/ImapServer$ImapResponses;
    invoke-virtual {v1}, Lcom/htc/android/mail/server/ImapServer$ImapResponses;->getImapCapability()Lcom/htc/android/mail/server/ImapServer$ImapCapability;

    move-result-object v4

    iput-object v4, p0, Lcom/htc/android/mail/server/ImapServer;->mImapCapability:Lcom/htc/android/mail/server/ImapServer$ImapCapability;

    .line 327
    return v6
.end method

.method private processCOPY(Ljava/util/List;)Z
    .locals 7
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;)Z"
        }
    .end annotation

    .prologue
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/4 v3, 0x0

    const/4 v4, 0x1

    .line 1120
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v1

    .line 1121
    .local v1, size:I
    if-nez v1, :cond_1

    .line 1131
    :cond_0
    :goto_0
    return v3

    .line 1124
    :cond_1
    add-int/lit8 v5, v1, -0x1

    invoke-interface {p1, v5}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/htc/android/mail/ByteString;

    .line 1125
    .local v0, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v0}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v5

    const-string v6, " "

    invoke-virtual {v5, v6}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v2

    .line 1127
    .local v2, token:[Ljava/lang/String;
    array-length v5, v2

    const/4 v6, 0x2

    if-lt v5, v6, :cond_0

    array-length v5, v2

    if-le v5, v4, :cond_2

    aget-object v5, v2, v4

    sget-object v6, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v6}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v5

    if-nez v5, :cond_0

    :cond_2
    move v3, v4

    .line 1131
    goto :goto_0
.end method

.method private processCOPYUID(Ljava/util/List;)Ljava/util/ArrayList;
    .locals 7
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;)",
            "Ljava/util/ArrayList",
            "<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .prologue
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/4 v3, 0x0

    const/4 v6, 0x1

    .line 1138
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v1

    .line 1139
    .local v1, size:I
    if-nez v1, :cond_1

    .line 1149
    :cond_0
    :goto_0
    return-object v3

    .line 1142
    :cond_1
    add-int/lit8 v4, v1, -0x1

    invoke-interface {p1, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/htc/android/mail/ByteString;

    .line 1143
    .local v0, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v0}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v4

    const-string v5, " "

    invoke-virtual {v4, v5}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v2

    .line 1145
    .local v2, token:[Ljava/lang/String;
    array-length v4, v2

    const/4 v5, 0x2

    if-lt v4, v5, :cond_0

    array-length v4, v2

    if-le v4, v6, :cond_2

    aget-object v4, v2, v6

    sget-object v5, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v5}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v4

    if-nez v4, :cond_0

    .line 1149
    :cond_2
    invoke-virtual {v0}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {p0, v3}, Lcom/htc/android/mail/server/ImapServer;->getCopyUid(Ljava/lang/String;)Ljava/util/ArrayList;

    move-result-object v3

    goto :goto_0
.end method

.method private processCreateMailbox(Ljava/util/List;)I
    .locals 7
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;)I"
        }
    .end annotation

    .prologue
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/4 v6, 0x1

    const/4 v3, -0x2

    .line 5551
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v1

    .line 5552
    .local v1, size:I
    if-nez v1, :cond_1

    .line 5563
    :cond_0
    :goto_0
    return v3

    .line 5555
    :cond_1
    add-int/lit8 v4, v1, -0x1

    invoke-interface {p1, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/htc/android/mail/ByteString;

    .line 5556
    .local v0, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v0}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v4

    const-string v5, " "

    invoke-virtual {v4, v5}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v2

    .line 5558
    .local v2, token:[Ljava/lang/String;
    aget-object v4, v2, v6

    sget-object v5, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v5}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/String;->compareToIgnoreCase(Ljava/lang/String;)I

    move-result v4

    if-nez v4, :cond_2

    .line 5559
    const/4 v3, 0x0

    goto :goto_0

    .line 5560
    :cond_2
    aget-object v4, v2, v6

    sget-object v5, Lcom/htc/android/mail/server/ImapServer;->STR_NO:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v5}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/String;->compareToIgnoreCase(Ljava/lang/String;)I

    move-result v4

    if-nez v4, :cond_0

    .line 5561
    const/4 v3, -0x1

    goto :goto_0
.end method

.method private processFetchInfo(Ljava/util/List;Lcom/htc/android/mail/MailMessage;Ljava/lang/String;Ljava/util/ArrayList;)Z
    .locals 49
    .parameter
    .parameter "mailMessage"
    .parameter "tag"
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;",
            "Lcom/htc/android/mail/MailMessage;",
            "Ljava/lang/String;",
            "Ljava/util/ArrayList",
            "<",
            "Landroid/content/ContentProviderOperation;",
            ">;)Z"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .line 2879
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    .local p4, operations:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/ContentProviderOperation;>;"
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v41

    .line 2881
    .local v41, size:I
    if-nez v41, :cond_1

    .line 2882
    const/4 v5, 0x0

    .line 3081
    :cond_0
    :goto_0
    return v5

    .line 2885
    :cond_1
    move-object/from16 v0, p2

    iget-object v5, v0, Lcom/htc/android/mail/MailMessage;->mSubjectCharset:Ljava/lang/String;

    if-nez v5, :cond_2

    invoke-static {}, Lcom/htc/android/mail/Mail;->getDefaultCharset()Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, p2

    iput-object v5, v0, Lcom/htc/android/mail/MailMessage;->mSubjectCharset:Ljava/lang/String;

    .line 2886
    :cond_2
    add-int/lit8 v5, v41, -0x1

    move-object/from16 v0, p1

    invoke-interface {v0, v5}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v37

    check-cast v37, Lcom/htc/android/mail/ByteString;

    .line 2887
    .local v37, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual/range {v37 .. v37}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v5

    const-string v6, " "

    invoke-virtual {v5, v6}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v44

    .line 2889
    .local v44, token:[Ljava/lang/String;
    move-object/from16 v0, v44

    array-length v5, v0

    const/4 v6, 0x2

    if-lt v5, v6, :cond_3

    move-object/from16 v0, v44

    array-length v5, v0

    const/4 v6, 0x1

    if-le v5, v6, :cond_4

    const/4 v5, 0x1

    aget-object v5, v44, v5

    sget-object v6, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v6}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v5

    if-eqz v5, :cond_4

    .line 2890
    :cond_3
    const/4 v5, 0x0

    goto :goto_0

    .line 2894
    :cond_4
    const/16 v29, 0x0

    .line 2895
    .local v29, includeAttach:I
    const/4 v12, 0x0

    .line 2896
    .local v12, includeMixAttach:I
    const/16 v31, 0x0

    .line 2897
    .local v31, includeText:I
    const/16 v30, 0x0

    .line 2898
    .local v30, includeHtml:I
    const/16 v34, 0x0

    .line 2899
    .local v34, mixNum:I
    const/4 v14, 0x0

    .line 2900
    .local v14, alternativeNum:I
    const/16 v38, 0x0

    .line 2901
    .local v38, related:I
    const/16 v39, 0x0

    .line 2902
    .local v39, relatedNum:I
    const-string v16, ""

    .line 2903
    .local v16, bodyIndex:Ljava/lang/String;
    const-string v35, ""

    .line 2904
    .local v35, nowEncode:Ljava/lang/String;
    const-string v22, ""

    .line 2905
    .local v22, charsetOrfilename:Ljava/lang/String;
    const-string v33, ""

    .line 2906
    .local v33, mimeType:Ljava/lang/String;
    const/4 v11, 0x0

    .line 2907
    .local v11, readtotalSize:I
    const-string v45, ""

    .line 2908
    .local v45, uid:Ljava/lang/String;
    new-instance v36, Ljava/lang/StringBuilder;

    invoke-direct/range {v36 .. v36}, Ljava/lang/StringBuilder;-><init>()V

    .line 2909
    .local v36, preparebody:Ljava/lang/StringBuilder;
    sget-boolean v5, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v5, :cond_5

    .line 2910
    const-string v5, "ImapServer"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "tag is "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, p3

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 2914
    :cond_5
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v5

    add-int/lit8 v26, v5, -0x1

    .local v26, i:I
    :goto_1
    if-ltz v26, :cond_8

    .line 2915
    move-object/from16 v0, p1

    move/from16 v1, v26

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v37

    .end local v37           #r:Lcom/htc/android/mail/ByteString;
    check-cast v37, Lcom/htc/android/mail/ByteString;

    .line 2916
    .restart local v37       #r:Lcom/htc/android/mail/ByteString;
    invoke-virtual/range {v37 .. v37}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v5

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, p3

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    sget-object v7, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v7}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v5

    if-eqz v5, :cond_7

    .line 2922
    move-object/from16 v0, p1

    move/from16 v1, v26

    invoke-interface {v0, v1}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 2914
    :cond_6
    :goto_2
    add-int/lit8 v26, v26, -0x1

    goto :goto_1

    .line 2923
    :cond_7
    invoke-virtual/range {v37 .. v37}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v5

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    sget-object v7, Lcom/htc/android/mail/server/ImapServer;->STR_STAR:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v7}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v5

    if-eqz v5, :cond_6

    invoke-virtual/range {v37 .. v37}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/String;->toLowerCase()Ljava/lang/String;

    move-result-object v5

    const-string v6, "bodystructure"

    invoke-virtual {v5, v6}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v5

    if-nez v5, :cond_6

    .line 2924
    move-object/from16 v0, p1

    move/from16 v1, v26

    invoke-interface {v0, v1}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    goto :goto_2

    .line 2932
    :cond_8
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v5

    if-nez v5, :cond_9

    .line 2934
    new-instance v46, Landroid/content/ContentValues;

    invoke-direct/range {v46 .. v46}, Landroid/content/ContentValues;-><init>()V

    .line 2935
    .local v46, values:Landroid/content/ContentValues;
    const-string v5, "_del"

    const/4 v6, 0x1

    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    move-object/from16 v0, v46

    invoke-virtual {v0, v5, v6}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 2937
    :try_start_0
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v5

    move-object/from16 v0, p2

    iget-wide v6, v0, Lcom/htc/android/mail/MailMessage;->accountId:J

    move-object/from16 v0, p2

    iget-wide v8, v0, Lcom/htc/android/mail/MailMessage;->mailBoxId:J

    move-object/from16 v0, p0

    invoke-virtual {v0, v6, v7, v8, v9}, Lcom/htc/android/mail/server/ImapServer;->getSummariesUri(JJ)Landroid/net/Uri;

    move-result-object v6

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "_id = "

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object/from16 v0, p2

    iget-wide v8, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v7, v8, v9}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    const/4 v8, 0x0

    move-object/from16 v0, v46

    invoke-interface {v5, v6, v0, v7, v8}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 2938
    const/4 v5, 0x0

    goto/16 :goto_0

    .line 2939
    :catch_0
    move-exception v24

    .line 2940
    .local v24, e:Landroid/os/RemoteException;
    sget-boolean v5, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v5, :cond_9

    .line 2941
    const-string v5, "ImapServer"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Remove Exception:"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v24

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 2945
    .end local v24           #e:Landroid/os/RemoteException;
    .end local v46           #values:Landroid/content/ContentValues;
    :cond_9
    invoke-virtual/range {p0 .. p1}, Lcom/htc/android/mail/server/ImapServer;->processFetchResponse(Ljava/util/List;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    move-result-object v28

    .line 2946
    .local v28, imapResponses:Lcom/htc/android/mail/server/ImapServer$ImapResponses;
    invoke-virtual/range {v28 .. v28}, Lcom/htc/android/mail/server/ImapServer$ImapResponses;->getFetchResponses()Ljava/util/ArrayList;

    move-result-object v40

    .line 2949
    .local v40, responsesList:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/util/HashMap<Ljava/lang/String;Lcom/htc/android/mail/ByteString;>;>;"
    const/4 v5, 0x0

    move-object/from16 v0, v40

    invoke-virtual {v0, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v32

    check-cast v32, Ljava/util/HashMap;

    .line 2950
    .local v32, map:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Lcom/htc/android/mail/ByteString;>;"
    if-nez v32, :cond_a

    const/4 v5, 0x0

    goto/16 :goto_0

    .line 2952
    :cond_a
    const-string v5, "ANNOTATION"

    move-object/from16 v0, v32

    invoke-virtual {v0, v5}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v15

    check-cast v15, Lcom/htc/android/mail/ByteString;

    .line 2953
    .local v15, annotationsByteString:Lcom/htc/android/mail/ByteString;
    move-object/from16 v0, p0

    move-object/from16 v1, p2

    move-object/from16 v2, p4

    invoke-virtual {v0, v1, v15, v2}, Lcom/htc/android/mail/server/ImapServer;->processAnnotations(Lcom/htc/android/mail/MailMessage;Lcom/htc/android/mail/ByteString;Ljava/util/ArrayList;)V

    .line 2955
    const-string v5, "BODYSTRUCTURE"

    move-object/from16 v0, v32

    invoke-virtual {v0, v5}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v19

    check-cast v19, Lcom/htc/android/mail/ByteString;

    .line 2956
    .local v19, bodystructureByteString:Lcom/htc/android/mail/ByteString;
    if-nez v19, :cond_b

    const/4 v5, 0x0

    goto/16 :goto_0

    .line 2959
    :cond_b
    const/4 v5, 0x1

    invoke-virtual/range {v19 .. v19}, Lcom/htc/android/mail/ByteString;->length()I

    move-result v6

    add-int/lit8 v6, v6, -0x1

    move-object/from16 v0, v19

    invoke-virtual {v0, v5, v6}, Lcom/htc/android/mail/ByteString;->substring(II)Lcom/htc/android/mail/ByteString;

    move-result-object v5

    invoke-virtual {v5}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v18

    .line 2961
    .local v18, bodystructure:Ljava/lang/String;
    sget-boolean v5, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v5, :cond_c

    .line 2962
    const-string v5, "ImapServer"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "bodystructure is :"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v18

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 2963
    :cond_c
    new-instance v27, Lcom/htc/android/mail/IMap4Body;

    move-object/from16 v0, v27

    move-object/from16 v1, v18

    invoke-direct {v0, v1}, Lcom/htc/android/mail/IMap4Body;-><init>(Ljava/lang/String;)V

    .line 2966
    .local v27, imap4body:Lcom/htc/android/mail/IMap4Body;
    invoke-virtual/range {v27 .. v27}, Lcom/htc/android/mail/IMap4Body;->includeAttach()I

    move-result v29

    .line 2968
    invoke-virtual/range {v27 .. v27}, Lcom/htc/android/mail/IMap4Body;->includeMixAttach()I

    move-result v5

    if-lez v5, :cond_19

    const/4 v12, 0x1

    .line 2969
    :goto_3
    invoke-virtual/range {v27 .. v27}, Lcom/htc/android/mail/IMap4Body;->includeText()I

    move-result v31

    .line 2970
    invoke-virtual/range {v27 .. v27}, Lcom/htc/android/mail/IMap4Body;->includeHtml()I

    move-result v30

    .line 2971
    invoke-virtual/range {v27 .. v27}, Lcom/htc/android/mail/IMap4Body;->mixedNum()I

    move-result v34

    .line 2972
    invoke-virtual/range {v27 .. v27}, Lcom/htc/android/mail/IMap4Body;->alternativeNum()I

    move-result v14

    .line 2973
    invoke-virtual/range {v27 .. v27}, Lcom/htc/android/mail/IMap4Body;->getRelated()I

    move-result v38

    .line 2974
    invoke-virtual/range {v27 .. v27}, Lcom/htc/android/mail/IMap4Body;->getRelatedNum()I

    move-result v39

    .line 2975
    invoke-virtual/range {v27 .. v27}, Lcom/htc/android/mail/IMap4Body;->getTable()Ljava/util/HashMap;

    move-result-object v42

    .line 2977
    .local v42, table:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/Integer;Lcom/htc/android/mail/Imap4InfoObject;>;"
    move-object/from16 v0, p0

    iget-object v5, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v0, p0

    move-object/from16 v1, v27

    invoke-virtual {v0, v5, v1}, Lcom/htc/android/mail/server/ImapServer;->getBodyInfoBySizeLimit(Lcom/htc/android/mail/Account;Lcom/htc/android/mail/IMap4Body;)Lcom/htc/android/mail/Imap4InfoObject;

    move-result-object v17

    .line 2979
    .local v17, bodyinfo:Lcom/htc/android/mail/Imap4InfoObject;
    if-eqz v17, :cond_11

    .line 2980
    move-object/from16 v0, v17

    iget-object v0, v0, Lcom/htc/android/mail/Imap4InfoObject;->index:Ljava/lang/String;

    move-object/from16 v16, v0

    .line 2981
    move-object/from16 v0, v17

    iget-object v0, v0, Lcom/htc/android/mail/Imap4InfoObject;->encode:Ljava/lang/String;

    move-object/from16 v35, v0

    .line 2982
    move-object/from16 v0, v17

    iget-object v0, v0, Lcom/htc/android/mail/Imap4InfoObject;->typename:Ljava/lang/String;

    move-object/from16 v22, v0

    .line 2983
    sget-boolean v5, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v5, :cond_d

    const-string v5, "ImapServer"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "org charsetOrfilename : "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v22

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, " ,"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, p2

    iget-object v7, v0, Lcom/htc/android/mail/MailMessage;->mSubjectCharset:Ljava/lang/String;

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 2984
    :cond_d
    const-string v5, ""

    move-object/from16 v0, v22

    invoke-virtual {v5, v0}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v5

    if-nez v5, :cond_e

    if-nez v22, :cond_f

    :cond_e
    move-object/from16 v0, p2

    iget-object v5, v0, Lcom/htc/android/mail/MailMessage;->mSubjectCharset:Ljava/lang/String;

    if-eqz v5, :cond_f

    const-string v5, ""

    move-object/from16 v0, p2

    iget-object v6, v0, Lcom/htc/android/mail/MailMessage;->mSubjectCharset:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_f

    move-object/from16 v0, p2

    iget-object v0, v0, Lcom/htc/android/mail/MailMessage;->mSubjectCharset:Ljava/lang/String;

    move-object/from16 v22, v0

    .line 2985
    :cond_f
    sget-boolean v5, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v5, :cond_10

    const-string v5, "ImapServer"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "use charsetOrfilename : "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v22

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 2986
    :cond_10
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, v17

    iget-object v6, v0, Lcom/htc/android/mail/Imap4InfoObject;->type:Ljava/lang/String;

    invoke-virtual {v6}, Ljava/lang/String;->toLowerCase()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, "/"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, v17

    iget-object v6, v0, Lcom/htc/android/mail/Imap4InfoObject;->subtype:Ljava/lang/String;

    invoke-virtual {v6}, Ljava/lang/String;->toLowerCase()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v33

    .line 2987
    move-object/from16 v0, v17

    iget-object v5, v0, Lcom/htc/android/mail/Imap4InfoObject;->size:Ljava/lang/String;

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/Integer;->intValue()I

    move-result v11

    .line 2990
    :cond_11
    sget-boolean v5, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v5, :cond_12

    .line 2991
    const-string v5, "ImapServer"

    const-string v6, "mail status:-> uid:includeMixAttach:includeText:includeHtml:mixNum:alternativeNum:related:relatedNum"

    invoke-static {v5, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 2992
    :cond_12
    sget-boolean v5, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v5, :cond_13

    .line 2993
    const-string v5, "ImapServer"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "mail status:-> "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v45

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ":"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v12}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ":"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move/from16 v0, v31

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ":"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move/from16 v0, v30

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ":"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move/from16 v0, v34

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ":"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v14}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ":"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move/from16 v0, v38

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ":"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move/from16 v0, v39

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 2995
    :cond_13
    sget-boolean v5, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v5, :cond_14

    .line 2996
    const-string v5, "ImapServer"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "INFO="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual/range {v27 .. v27}, Lcom/htc/android/mail/IMap4Body;->getInfo()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 2997
    :cond_14
    sget-boolean v5, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v5, :cond_15

    .line 2998
    const-string v5, "ImapServer"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "fetchIndex is "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, v16

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ", readtotalSize is "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v11}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 3002
    :cond_15
    const/16 v23, 0x0

    .line 3003
    .local v23, displayTotalSize:I
    move-object/from16 v0, p0

    iget-object v5, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v0, p0

    move-object/from16 v1, v27

    move/from16 v2, v31

    move/from16 v3, v30

    invoke-virtual {v0, v5, v1, v2, v3}, Lcom/htc/android/mail/server/ImapServer;->getTheDisplaySize(Lcom/htc/android/mail/Account;Lcom/htc/android/mail/IMap4Body;II)I

    move-result v23

    .line 3007
    const/16 v21, 0x0

    .line 3019
    .local v21, c:Landroid/database/Cursor;
    new-instance v46, Landroid/content/ContentValues;

    invoke-direct/range {v46 .. v46}, Landroid/content/ContentValues;-><init>()V

    .line 3020
    .restart local v46       #values:Landroid/content/ContentValues;
    const-string v5, "_readtotalsize"

    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    move-object/from16 v0, v46

    invoke-virtual {v0, v5, v6}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 3021
    const-string v5, "_messagesize"

    invoke-static/range {v23 .. v23}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    move-object/from16 v0, v46

    invoke-virtual {v0, v5, v6}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 3022
    const-string v5, "_incAttachment"

    invoke-static {v12}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    move-object/from16 v0, v46

    invoke-virtual {v0, v5, v6}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 3024
    move-object/from16 v0, p2

    iget-wide v5, v0, Lcom/htc/android/mail/MailMessage;->accountId:J

    move-object/from16 v0, p2

    iget-wide v7, v0, Lcom/htc/android/mail/MailMessage;->mailBoxId:J

    move-object/from16 v0, p0

    invoke-virtual {v0, v5, v6, v7, v8}, Lcom/htc/android/mail/server/ImapServer;->getSummariesUri(JJ)Landroid/net/Uri;

    move-result-object v5

    invoke-static {v5}, Landroid/content/ContentProviderOperation;->newUpdate(Landroid/net/Uri;)Landroid/content/ContentProviderOperation$Builder;

    move-result-object v20

    .line 3026
    .local v20, builder:Landroid/content/ContentProviderOperation$Builder;
    move-object/from16 v0, v20

    move-object/from16 v1, v46

    invoke-virtual {v0, v1}, Landroid/content/ContentProviderOperation$Builder;->withValues(Landroid/content/ContentValues;)Landroid/content/ContentProviderOperation$Builder;

    move-result-object v20

    .line 3027
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "_id = "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p2

    iget-wide v6, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v5, v6, v7}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    const/4 v6, 0x0

    move-object/from16 v0, v20

    invoke-virtual {v0, v5, v6}, Landroid/content/ContentProviderOperation$Builder;->withSelection(Ljava/lang/String;[Ljava/lang/String;)Landroid/content/ContentProviderOperation$Builder;

    move-result-object v20

    .line 3028
    invoke-virtual/range {v20 .. v20}, Landroid/content/ContentProviderOperation$Builder;->build()Landroid/content/ContentProviderOperation;

    move-result-object v5

    move-object/from16 v0, p4

    invoke-virtual {v0, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 3032
    sget-boolean v5, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v5, :cond_16

    .line 3033
    const-string v5, "ImapServer"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, " ###########save messageID \'s readtotalSize to "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v11}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v5, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 3044
    :cond_16
    move-object/from16 v0, p0

    move-object/from16 v1, v27

    move-object/from16 v2, p2

    move/from16 v3, v29

    move-object/from16 v4, p4

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/htc/android/mail/server/ImapServer;->updateAttachments(Lcom/htc/android/mail/IMap4Body;Lcom/htc/android/mail/MailMessage;ILjava/util/ArrayList;)V

    .line 3045
    sget-boolean v5, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v5, :cond_17

    const-string v5, "ImapServer"

    const-string v6, "updateAttachments complete"

    invoke-static {v5, v6}, Landroid/util/Log;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 3046
    :cond_17
    const/16 v25, 0x0

    .line 3047
    .local v25, htmlCursor:Landroid/database/Cursor;
    const/16 v43, 0x0

    .line 3050
    .local v43, textCursor:Landroid/database/Cursor;
    :try_start_1
    const-string v5, "text/html"

    move-object/from16 v0, v33

    invoke-virtual {v0, v5}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v5

    if-eqz v5, :cond_1a

    .line 3051
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v5

    sget-object v6, Lcom/htc/android/mail/MailProvider;->sPartsURI:Landroid/net/Uri;

    const/4 v7, 0x1

    new-array v7, v7, [Ljava/lang/String;

    const/4 v8, 0x0

    const-string v9, "count(_id) as _total"

    aput-object v9, v7, v8

    sget-object v8, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v9, "_message = \'%d\' AND _mimetype = \'text/html\' AND _filename=\'\'"

    const/4 v10, 0x1

    new-array v10, v10, [Ljava/lang/Object;

    const/4 v13, 0x0

    move-object/from16 v0, p2

    iget-wide v0, v0, Lcom/htc/android/mail/MailMessage;->id:J

    move-wide/from16 v47, v0

    invoke-static/range {v47 .. v48}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v47

    aput-object v47, v10, v13

    invoke-static {v8, v9, v10}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v8

    const/4 v9, 0x0

    const/4 v10, 0x0

    invoke-interface/range {v5 .. v10}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v25

    .line 3054
    if-eqz v25, :cond_20

    .line 3055
    invoke-interface/range {v25 .. v25}, Landroid/database/Cursor;->moveToNext()Z

    .line 3056
    const-string v5, "_total"

    move-object/from16 v0, v25

    invoke-interface {v0, v5}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v5

    move-object/from16 v0, v25

    invoke-interface {v0, v5}, Landroid/database/Cursor;->getInt(I)I

    move-result v5

    if-nez v5, :cond_20

    move-object/from16 v5, p0

    move-object/from16 v6, p2

    move-object/from16 v7, v16

    move-object/from16 v8, v33

    move-object/from16 v9, v22

    move-object/from16 v10, v35

    move-object/from16 v13, p4

    .line 3057
    invoke-virtual/range {v5 .. v13}, Lcom/htc/android/mail/server/ImapServer;->fetchPartWithSize(Lcom/htc/android/mail/MailMessage;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;IILjava/util/ArrayList;)Z
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1

    move-result v5

    .line 3077
    if-eqz v25, :cond_18

    invoke-interface/range {v25 .. v25}, Landroid/database/Cursor;->close()V

    .line 3078
    :cond_18
    if-eqz v43, :cond_0

    :goto_4
    invoke-interface/range {v43 .. v43}, Landroid/database/Cursor;->close()V

    goto/16 :goto_0

    .line 2968
    .end local v17           #bodyinfo:Lcom/htc/android/mail/Imap4InfoObject;
    .end local v20           #builder:Landroid/content/ContentProviderOperation$Builder;
    .end local v21           #c:Landroid/database/Cursor;
    .end local v23           #displayTotalSize:I
    .end local v25           #htmlCursor:Landroid/database/Cursor;
    .end local v42           #table:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/Integer;Lcom/htc/android/mail/Imap4InfoObject;>;"
    .end local v43           #textCursor:Landroid/database/Cursor;
    .end local v46           #values:Landroid/content/ContentValues;
    :cond_19
    const/4 v12, 0x0

    goto/16 :goto_3

    .line 3061
    .restart local v17       #bodyinfo:Lcom/htc/android/mail/Imap4InfoObject;
    .restart local v20       #builder:Landroid/content/ContentProviderOperation$Builder;
    .restart local v21       #c:Landroid/database/Cursor;
    .restart local v23       #displayTotalSize:I
    .restart local v25       #htmlCursor:Landroid/database/Cursor;
    .restart local v42       #table:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/Integer;Lcom/htc/android/mail/Imap4InfoObject;>;"
    .restart local v43       #textCursor:Landroid/database/Cursor;
    .restart local v46       #values:Landroid/content/ContentValues;
    :cond_1a
    :try_start_2
    const-string v5, "text/plain"

    move-object/from16 v0, v33

    invoke-virtual {v0, v5}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v5

    if-eqz v5, :cond_20

    .line 3062
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v5

    sget-object v6, Lcom/htc/android/mail/MailProvider;->sPartsURI:Landroid/net/Uri;

    const/4 v7, 0x1

    new-array v7, v7, [Ljava/lang/String;

    const/4 v8, 0x0

    const-string v9, "count(_id) as _total"

    aput-object v9, v7, v8

    sget-object v8, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v9, "_message = \'%d\' AND _mimetype = \'text/plain\' AND _filename=\'\'"

    const/4 v10, 0x1

    new-array v10, v10, [Ljava/lang/Object;

    const/4 v13, 0x0

    move-object/from16 v0, p2

    iget-wide v0, v0, Lcom/htc/android/mail/MailMessage;->id:J

    move-wide/from16 v47, v0

    invoke-static/range {v47 .. v48}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v47

    aput-object v47, v10, v13

    invoke-static {v8, v9, v10}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v8

    const/4 v9, 0x0

    const/4 v10, 0x0

    invoke-interface/range {v5 .. v10}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v43

    .line 3066
    if-eqz v43, :cond_20

    .line 3067
    invoke-interface/range {v43 .. v43}, Landroid/database/Cursor;->moveToNext()Z

    .line 3068
    const-string v5, "_total"

    move-object/from16 v0, v43

    invoke-interface {v0, v5}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v5

    move-object/from16 v0, v43

    invoke-interface {v0, v5}, Landroid/database/Cursor;->getInt(I)I

    move-result v5

    if-nez v5, :cond_20

    move-object/from16 v5, p0

    move-object/from16 v6, p2

    move-object/from16 v7, v16

    move-object/from16 v8, v33

    move-object/from16 v9, v22

    move-object/from16 v10, v35

    move-object/from16 v13, p4

    .line 3069
    invoke-virtual/range {v5 .. v13}, Lcom/htc/android/mail/server/ImapServer;->fetchPartWithSize(Lcom/htc/android/mail/MailMessage;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;IILjava/util/ArrayList;)Z
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_1

    move-result v5

    .line 3077
    if-eqz v25, :cond_1b

    invoke-interface/range {v25 .. v25}, Landroid/database/Cursor;->close()V

    .line 3078
    :cond_1b
    if-eqz v43, :cond_0

    goto :goto_4

    .line 3077
    :catchall_0
    move-exception v5

    if-eqz v25, :cond_1c

    invoke-interface/range {v25 .. v25}, Landroid/database/Cursor;->close()V

    .line 3078
    :cond_1c
    if-eqz v43, :cond_1d

    invoke-interface/range {v43 .. v43}, Landroid/database/Cursor;->close()V

    .line 3077
    :cond_1d
    throw v5

    .line 3074
    :catch_1
    move-exception v5

    .line 3077
    if-eqz v25, :cond_1e

    invoke-interface/range {v25 .. v25}, Landroid/database/Cursor;->close()V

    .line 3078
    :cond_1e
    if-eqz v43, :cond_1f

    :goto_5
    invoke-interface/range {v43 .. v43}, Landroid/database/Cursor;->close()V

    .line 3081
    :cond_1f
    const/4 v5, 0x1

    goto/16 :goto_0

    .line 3077
    :cond_20
    if-eqz v25, :cond_21

    invoke-interface/range {v25 .. v25}, Landroid/database/Cursor;->close()V

    .line 3078
    :cond_21
    if-eqz v43, :cond_1f

    goto :goto_5
.end method

.method private processFetchPartByUid(Ljava/io/BufferedInputStream;Lcom/htc/android/mail/MailMessage;JLjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;ZLjava/lang/String;ILcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;Ljava/lang/String;)V
    .locals 29
    .parameter "mIn"
    .parameter "mailMessage"
    .parameter "bodyid"
    .parameter "index"
    .parameter "nowEncode"
    .parameter "charsetOrfilename"
    .parameter "mimeType"
    .parameter "saveAsFile"
    .parameter "tag"
    .parameter "attachType"
    .parameter "controller"
    .parameter
    .parameter "fileReference"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/io/BufferedInputStream;",
            "Lcom/htc/android/mail/MailMessage;",
            "J",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "Z",
            "Ljava/lang/String;",
            "I",
            "Lcom/htc/android/mail/AbsRequestController;",
            "Ljava/lang/ref/WeakReference",
            "<",
            "Landroid/os/Handler;",
            ">;",
            "Ljava/lang/String;",
            ")V"
        }
    .end annotation

    .prologue
    .line 4701
    .local p13, weakHandler:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Landroid/os/Handler;>;"
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v3, :cond_0

    const-string v3, "ImapServer"

    const-string v6, "@ before ."

    invoke-static {v3, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 4702
    :cond_0
    new-instance v2, Lcom/htc/android/mail/Imap4PartParser;

    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    const/4 v8, 0x3

    move-object/from16 v0, p2

    iget-object v10, v0, Lcom/htc/android/mail/MailMessage;->uid:Ljava/lang/String;

    move-object/from16 v5, p1

    move-object/from16 v6, p7

    move-object/from16 v7, p6

    move/from16 v9, p9

    move-object/from16 v11, p10

    move-object/from16 v12, p14

    move-object/from16 v13, p12

    move-object/from16 v14, p13

    invoke-direct/range {v2 .. v14}, Lcom/htc/android/mail/Imap4PartParser;-><init>(Landroid/content/Context;Lcom/htc/android/mail/Account;Ljava/io/BufferedInputStream;Ljava/lang/String;Ljava/lang/String;IZLjava/lang/String;Ljava/lang/String;Ljava/lang/String;Lcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;)V

    .line 4704
    .local v2, partparser:Lcom/htc/android/mail/Imap4PartParser;
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v3, :cond_1

    const-string v3, "ImapServer"

    const-string v6, "@ after ."

    invoke-static {v3, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 4705
    :cond_1
    new-instance v27, Landroid/content/ContentValues;

    invoke-direct/range {v27 .. v27}, Landroid/content/ContentValues;-><init>()V

    .line 4707
    .local v27, values:Landroid/content/ContentValues;
    const-string v3, "_mimetype"

    move-object/from16 v0, v27

    move-object/from16 v1, p8

    invoke-virtual {v0, v3, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 4708
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v3, :cond_2

    const-string v3, "ImapServer"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "2 save mail as :"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, p8

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v3, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 4709
    :cond_2
    if-nez p9, :cond_9

    .line 4710
    const-string v3, "_text"

    invoke-virtual {v2}, Lcom/htc/android/mail/Imap4PartParser;->getBody()Ljava/lang/String;

    move-result-object v6

    move-object/from16 v0, v27

    invoke-virtual {v0, v3, v6}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 4738
    :cond_3
    :goto_0
    const-string v3, "_message"

    move-object/from16 v0, p2

    iget-wide v6, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-static {v6, v7}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v6

    move-object/from16 v0, v27

    invoke-virtual {v0, v3, v6}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 4739
    const-string v3, "_account"

    move-object/from16 v0, p0

    iget-object v6, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v6}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v6

    invoke-static {v6, v7}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v6

    move-object/from16 v0, v27

    invoke-virtual {v0, v3, v6}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 4740
    const-string v3, "_flags"

    const/4 v6, 0x0

    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    move-object/from16 v0, v27

    invoke-virtual {v0, v3, v6}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 4742
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v5

    .line 4745
    .local v5, cp:Landroid/content/IContentProvider;
    :try_start_0
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v3, :cond_4

    .line 4746
    const-string v3, "ImapServer"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "2 ### "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, p2

    iget-wide v7, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v6, v7, v8}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ">"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-wide/from16 v0, p3

    invoke-virtual {v6, v0, v1}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v3, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 4748
    :cond_4
    const-wide/16 v6, 0x0

    cmp-long v3, p3, v6

    if-eqz v3, :cond_d

    .line 4749
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    sget-object v6, Lcom/htc/android/mail/MailProvider;->sPartsURI:Landroid/net/Uri;

    invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v6, "/"

    invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-wide/from16 v0, p3

    invoke-virtual {v3, v0, v1}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Landroid/net/Uri;->parse(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v3

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "_message = "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, p2

    iget-wide v7, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v6, v7, v8}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    const/4 v7, 0x0

    move-object/from16 v0, v27

    invoke-interface {v5, v3, v0, v6, v7}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    .line 4750
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    sget-object v6, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v6, "/"

    invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p2

    iget-wide v6, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v3, v6, v7}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Landroid/net/Uri;->parse(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v6

    const/4 v3, 0x3

    new-array v7, v3, [Ljava/lang/String;

    const/4 v3, 0x0

    const-string v8, "_readsize"

    aput-object v8, v7, v3

    const/4 v3, 0x1

    const-string v8, "_readtotalsize"

    aput-object v8, v7, v3

    const/4 v3, 0x2

    const-string v8, "_downloadtotalsize"

    aput-object v8, v7, v3

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    invoke-interface/range {v5 .. v10}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v23

    .line 4752
    .local v23, sizeCursor:Landroid/database/Cursor;
    const/16 v25, 0x0

    .line 4753
    .local v25, total:I
    const/16 v20, 0x0

    .line 4754
    .local v20, readsize:I
    const/16 v16, 0x0

    .line 4756
    .local v16, downloadtotalsize:I
    invoke-interface/range {v23 .. v23}, Landroid/database/Cursor;->getCount()I

    move-result v3

    if-lez v3, :cond_5

    .line 4757
    invoke-interface/range {v23 .. v23}, Landroid/database/Cursor;->moveToNext()Z

    .line 4758
    const-string v3, "_readtotalsize"

    move-object/from16 v0, v23

    invoke-interface {v0, v3}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v3

    move-object/from16 v0, v23

    invoke-interface {v0, v3}, Landroid/database/Cursor;->getInt(I)I

    move-result v25

    .line 4759
    const-string v3, "_readsize"

    move-object/from16 v0, v23

    invoke-interface {v0, v3}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v3

    move-object/from16 v0, v23

    invoke-interface {v0, v3}, Landroid/database/Cursor;->getInt(I)I

    move-result v20

    .line 4760
    const-string v3, "_downloadtotalsize"

    move-object/from16 v0, v23

    invoke-interface {v0, v3}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v3

    move-object/from16 v0, v23

    invoke-interface {v0, v3}, Landroid/database/Cursor;->getInt(I)I

    move-result v16

    .line 4762
    :cond_5
    invoke-interface/range {v23 .. v23}, Landroid/database/Cursor;->close()V

    .line 4764
    new-instance v28, Landroid/content/ContentValues;

    invoke-direct/range {v28 .. v28}, Landroid/content/ContentValues;-><init>()V
    :try_end_0
    .catch Landroid/os/DeadObjectException; {:try_start_0 .. :try_end_0} :catch_2
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_3

    .line 4765
    .end local v27           #values:Landroid/content/ContentValues;
    .local v28, values:Landroid/content/ContentValues;
    :try_start_1
    const-string v3, "text/html"

    move-object/from16 v0, p8

    invoke-virtual {v3, v0}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v3

    if-eqz v3, :cond_c

    .line 4766
    const-string v3, "_preview"

    invoke-virtual {v2}, Lcom/htc/android/mail/Imap4PartParser;->getBody()Ljava/lang/String;

    move-result-object v6

    invoke-static {v6}, Lcom/htc/android/mail/MailCommon;->converHTMLtoPlainText(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v6

    invoke-static {v6}, Lcom/htc/android/mail/MailCommon;->s_convert(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v6

    move-object/from16 v0, v28

    invoke-virtual {v0, v3, v6}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 4770
    :cond_6
    :goto_1
    const-string v3, "_readsize"

    invoke-static/range {v25 .. v25}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    move-object/from16 v0, v28

    invoke-virtual {v0, v3, v6}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 4771
    const-string v3, "_downloadtotalsize"

    sub-int v6, v16, v20

    add-int v6, v6, v25

    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    move-object/from16 v0, v28

    invoke-virtual {v0, v3, v6}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 4772
    move-object/from16 v0, p2

    iget-wide v6, v0, Lcom/htc/android/mail/MailMessage;->accountId:J

    move-object/from16 v0, p2

    iget-wide v8, v0, Lcom/htc/android/mail/MailMessage;->mailBoxId:J

    move-object/from16 v0, p0

    invoke-virtual {v0, v6, v7, v8, v9}, Lcom/htc/android/mail/server/ImapServer;->getSummariesUri(JJ)Landroid/net/Uri;

    move-result-object v3

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "_id = "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, p2

    iget-wide v7, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v6, v7, v8}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    const/4 v7, 0x0

    move-object/from16 v0, v28

    invoke-interface {v5, v3, v0, v6, v7}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    .line 4773
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v3, :cond_7

    .line 4774
    const-string v3, "ImapServer"

    const-string v6, "### set total size ok."

    invoke-static {v3, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V
    :try_end_1
    .catch Landroid/os/DeadObjectException; {:try_start_1 .. :try_end_1} :catch_1
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_4

    :cond_7
    move-object/from16 v27, v28

    .line 4819
    .end local v5           #cp:Landroid/content/IContentProvider;
    .end local v16           #downloadtotalsize:I
    .end local v20           #readsize:I
    .end local v23           #sizeCursor:Landroid/database/Cursor;
    .end local v25           #total:I
    .end local v28           #values:Landroid/content/ContentValues;
    .restart local v27       #values:Landroid/content/ContentValues;
    :cond_8
    :goto_2
    return-void

    .line 4711
    :cond_9
    if-eqz p9, :cond_b

    invoke-virtual {v2}, Lcom/htc/android/mail/Imap4PartParser;->getFilename()Ljava/lang/String;

    move-result-object v3

    if-eqz v3, :cond_b

    .line 4712
    invoke-static/range {p7 .. p7}, Lcom/htc/android/mail/MailCommon;->eraseInvalidChar(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v18

    .line 4714
    .local v18, filename:Ljava/lang/String;
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v3}, Lcom/htc/android/mail/Account;->enableSDsave()I

    move-result v3

    move-object/from16 v0, p0

    iget-object v6, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    move-object/from16 v0, v18

    move/from16 v1, p11

    invoke-static {v3, v0, v6, v1}, Lcom/htc/android/mail/MailCommon;->getSuggestFileName(ILjava/lang/String;Landroid/content/Context;I)Ljava/lang/String;

    move-result-object v18

    .line 4716
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    move-object/from16 v0, p0

    iget-object v6, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v6}, Lcom/htc/android/mail/Account;->enableSDsave()I

    move-result v6

    const/4 v7, 0x0

    move-object/from16 v0, v18

    move/from16 v1, p11

    invoke-static {v3, v6, v7, v0, v1}, Lcom/htc/android/mail/util/StorageControl;->getAttachmentFilePath(Landroid/content/Context;ILjava/lang/String;Ljava/lang/String;I)Ljava/lang/String;

    move-result-object v4

    .line 4718
    .local v4, path:Ljava/lang/String;
    const-string v3, "_filename"

    move-object/from16 v0, v27

    move-object/from16 v1, p7

    invoke-virtual {v0, v3, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 4720
    :try_start_2
    new-instance v24, Ljava/io/File;

    invoke-virtual {v2}, Lcom/htc/android/mail/Imap4PartParser;->getFilename()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, v24

    invoke-direct {v0, v3}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 4721
    .local v24, tmpFile:Ljava/io/File;
    const-string v3, "_filesize"

    invoke-virtual/range {v24 .. v24}, Ljava/io/File;->length()J

    move-result-wide v6

    invoke-static {v6, v7}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v6

    move-object/from16 v0, v27

    invoke-virtual {v0, v3, v6}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V
    :try_end_2
    .catch Ljava/lang/SecurityException; {:try_start_2 .. :try_end_2} :catch_0

    .line 4725
    .end local v24           #tmpFile:Ljava/io/File;
    :goto_3
    invoke-virtual {v2}, Lcom/htc/android/mail/Imap4PartParser;->getFilename()Ljava/lang/String;

    move-result-object v6

    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    const-string v7, "mail"

    const/4 v8, 0x0

    invoke-virtual {v3, v7, v8}, Landroid/content/Context;->getDir(Ljava/lang/String;I)Ljava/io/File;

    move-result-object v3

    invoke-virtual {v3}, Ljava/io/File;->getPath()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v4, v3}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v3

    if-nez v3, :cond_a

    const/4 v7, 0x1

    :goto_4
    move-object/from16 v3, p0

    move-object/from16 v5, p8

    move/from16 v8, p11

    invoke-direct/range {v3 .. v8}, Lcom/htc/android/mail/server/ImapServer;->saveFileWithPath2(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;ZI)Z

    .line 4728
    const-string v3, "_filepath"

    move-object/from16 v0, v27

    invoke-virtual {v0, v3, v4}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 4729
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v3, :cond_3

    .line 4730
    const-string v3, "ImapServer"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Try save attachment:"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ", enableSDsave:"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, p0

    iget-object v7, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v7}, Lcom/htc/android/mail/Account;->enableSDsave()I

    move-result v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v7, ", tmpfile:"

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v2}, Lcom/htc/android/mail/Imap4PartParser;->getFilename()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v3, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    goto/16 :goto_0

    .line 4722
    :catch_0
    move-exception v22

    .line 4723
    .local v22, se:Ljava/lang/SecurityException;
    const-string v3, "ImapServer"

    const-string v6, "catch file size fail due to security exception"

    invoke-static {v3, v6}, Lcom/htc/android/mail/ll;->e(Ljava/lang/String;Ljava/lang/String;)V

    goto :goto_3

    .line 4725
    .end local v22           #se:Ljava/lang/SecurityException;
    :cond_a
    const/4 v7, 0x0

    goto :goto_4

    .line 4733
    .end local v4           #path:Ljava/lang/String;
    .end local v18           #filename:Ljava/lang/String;
    :cond_b
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v3, :cond_8

    .line 4734
    const-string v3, "ImapServer"

    const-string v6, "Imap4PartParser save file fail."

    invoke-static {v3, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    goto/16 :goto_2

    .line 4767
    .end local v27           #values:Landroid/content/ContentValues;
    .restart local v5       #cp:Landroid/content/IContentProvider;
    .restart local v16       #downloadtotalsize:I
    .restart local v20       #readsize:I
    .restart local v23       #sizeCursor:Landroid/database/Cursor;
    .restart local v25       #total:I
    .restart local v28       #values:Landroid/content/ContentValues;
    :cond_c
    :try_start_3
    const-string v3, "text/plain"

    move-object/from16 v0, p8

    invoke-virtual {v3, v0}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v3

    if-eqz v3, :cond_6

    .line 4768
    const-string v3, "_preview"

    invoke-virtual {v2}, Lcom/htc/android/mail/Imap4PartParser;->getBody()Ljava/lang/String;

    move-result-object v6

    invoke-static {v6}, Lcom/htc/android/mail/MailCommon;->s_convert(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v6

    move-object/from16 v0, v28

    invoke-virtual {v0, v3, v6}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V
    :try_end_3
    .catch Landroid/os/DeadObjectException; {:try_start_3 .. :try_end_3} :catch_1
    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_4

    goto/16 :goto_1

    .line 4814
    :catch_1
    move-exception v17

    move-object/from16 v27, v28

    .line 4815
    .end local v16           #downloadtotalsize:I
    .end local v20           #readsize:I
    .end local v23           #sizeCursor:Landroid/database/Cursor;
    .end local v25           #total:I
    .end local v28           #values:Landroid/content/ContentValues;
    .local v17, ex:Landroid/os/DeadObjectException;
    .restart local v27       #values:Landroid/content/ContentValues;
    :goto_5
    const-string v3, "ImapServer"

    const-string v6, "error"

    move-object/from16 v0, v17

    invoke-static {v3, v6, v0}, Lcom/htc/android/mail/ll;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V

    goto/16 :goto_2

    .line 4776
    .end local v17           #ex:Landroid/os/DeadObjectException;
    :cond_d
    :try_start_4
    sget-object v6, Lcom/htc/android/mail/MailProvider;->sPartsURI:Landroid/net/Uri;

    const/4 v3, 0x2

    new-array v7, v3, [Ljava/lang/String;

    const/4 v3, 0x0

    const-string v8, "_id"

    aput-object v8, v7, v3

    const/4 v3, 0x1

    const-string v8, "_filesize"

    aput-object v8, v7, v3

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v8, "_message = "

    invoke-virtual {v3, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p2

    iget-wide v8, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v3, v8, v9}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v8, " AND _filename = ? AND _index=\'"

    invoke-virtual {v3, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p5

    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v8, "\'"

    invoke-virtual {v3, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    const/4 v3, 0x1

    new-array v9, v3, [Ljava/lang/String;

    const/4 v3, 0x0

    aput-object p7, v9, v3

    const/4 v10, 0x0

    invoke-interface/range {v5 .. v10}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v15

    .line 4779
    .local v15, att:Landroid/database/Cursor;
    const-string v3, "ImapServer"

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "@ att.getCount()="

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-interface {v15}, Landroid/database/Cursor;->getCount()I

    move-result v7

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v3, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 4787
    invoke-interface {v15}, Landroid/database/Cursor;->getCount()I

    move-result v3

    if-lez v3, :cond_12

    .line 4788
    invoke-interface {v15}, Landroid/database/Cursor;->moveToNext()Z

    .line 4789
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    sget-object v6, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v6, "/"

    invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p2

    iget-wide v6, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v3, v6, v7}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Landroid/net/Uri;->parse(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v6

    const/4 v3, 0x1

    new-array v7, v3, [Ljava/lang/String;

    const/4 v3, 0x0

    const-string v8, "_downloadtotalsize"

    aput-object v8, v7, v3

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x0

    invoke-interface/range {v5 .. v10}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v23

    .line 4791
    .restart local v23       #sizeCursor:Landroid/database/Cursor;
    invoke-interface/range {v23 .. v23}, Landroid/database/Cursor;->getCount()I

    move-result v3

    if-lez v3, :cond_e

    .line 4792
    invoke-interface/range {v23 .. v23}, Landroid/database/Cursor;->moveToNext()Z

    .line 4794
    :cond_e
    const-string v3, "_downloadtotalsize"

    move-object/from16 v0, v23

    invoke-interface {v0, v3}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v3

    move-object/from16 v0, v23

    invoke-interface {v0, v3}, Landroid/database/Cursor;->getInt(I)I

    move-result v16

    .line 4795
    .restart local v16       #downloadtotalsize:I
    invoke-interface/range {v23 .. v23}, Landroid/database/Cursor;->close()V

    .line 4796
    const-string v3, "_filesize"

    invoke-interface {v15, v3}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v3

    invoke-interface {v15, v3}, Landroid/database/Cursor;->getInt(I)I

    move-result v19

    .line 4798
    .local v19, filesize:I
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v3, :cond_f

    .line 4799
    const-string v3, "ImapServer"

    const-string v6, "udpate the attachment information."

    invoke-static {v3, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 4800
    :cond_f
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    sget-object v6, Lcom/htc/android/mail/MailProvider;->sPartsURI:Landroid/net/Uri;

    invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v6, "/"

    invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v6, "_id"

    invoke-interface {v15, v6}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v6

    invoke-interface {v15, v6}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v6

    invoke-virtual {v3, v6, v7}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Landroid/net/Uri;->parse(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v3

    const/4 v6, 0x0

    const/4 v7, 0x0

    move-object/from16 v0, v27

    invoke-interface {v5, v3, v0, v6, v7}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    .line 4802
    new-instance v26, Landroid/content/ContentValues;

    invoke-direct/range {v26 .. v26}, Landroid/content/ContentValues;-><init>()V

    .line 4803
    .local v26, updateMessage:Landroid/content/ContentValues;
    const-string v3, "_downloadtotalsize"

    add-int v6, v16, v19

    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    move-object/from16 v0, v26

    invoke-virtual {v0, v3, v6}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 4804
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v3, :cond_10

    .line 4805
    const-string v3, "ImapServer"

    const-string v6, "udpate the message downloadsize information."

    invoke-static {v3, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 4806
    :cond_10
    move-object/from16 v0, p2

    iget-wide v6, v0, Lcom/htc/android/mail/MailMessage;->accountId:J

    move-object/from16 v0, p2

    iget-wide v8, v0, Lcom/htc/android/mail/MailMessage;->mailBoxId:J

    move-object/from16 v0, p0

    invoke-virtual {v0, v6, v7, v8, v9}, Lcom/htc/android/mail/server/ImapServer;->getSummariesUri(JJ)Landroid/net/Uri;

    move-result-object v3

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "_id = "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    move-object/from16 v0, p2

    iget-wide v7, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v6, v7, v8}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    const/4 v7, 0x0

    move-object/from16 v0, v26

    invoke-interface {v5, v3, v0, v6, v7}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    .line 4812
    .end local v16           #downloadtotalsize:I
    .end local v19           #filesize:I
    .end local v23           #sizeCursor:Landroid/database/Cursor;
    .end local v26           #updateMessage:Landroid/content/ContentValues;
    :cond_11
    :goto_6
    invoke-interface {v15}, Landroid/database/Cursor;->close()V

    goto/16 :goto_2

    .line 4814
    .end local v15           #att:Landroid/database/Cursor;
    :catch_2
    move-exception v17

    goto/16 :goto_5

    .line 4808
    .restart local v15       #att:Landroid/database/Cursor;
    :cond_12
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v3, :cond_11

    .line 4809
    const-string v3, "ImapServer"

    const-string v6, "should not happened ..."

    invoke-static {v3, v6}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V
    :try_end_4
    .catch Landroid/os/DeadObjectException; {:try_start_4 .. :try_end_4} :catch_2
    .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_3

    goto :goto_6

    .line 4816
    .end local v15           #att:Landroid/database/Cursor;
    :catch_3
    move-exception v21

    .line 4817
    .local v21, rex:Landroid/os/RemoteException;
    :goto_7
    const-string v3, "ImapServer"

    const-string v6, "error"

    move-object/from16 v0, v21

    invoke-static {v3, v6, v0}, Lcom/htc/android/mail/ll;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V

    goto/16 :goto_2

    .line 4816
    .end local v21           #rex:Landroid/os/RemoteException;
    .end local v27           #values:Landroid/content/ContentValues;
    .restart local v16       #downloadtotalsize:I
    .restart local v20       #readsize:I
    .restart local v23       #sizeCursor:Landroid/database/Cursor;
    .restart local v25       #total:I
    .restart local v28       #values:Landroid/content/ContentValues;
    :catch_4
    move-exception v21

    move-object/from16 v27, v28

    .end local v28           #values:Landroid/content/ContentValues;
    .restart local v27       #values:Landroid/content/ContentValues;
    goto :goto_7
.end method

.method private processFetchPartByUid(Ljava/util/List;Lcom/htc/android/mail/MailMessage;JLjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;ZIZLcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;Ljava/lang/String;)V
    .locals 39
    .parameter
    .parameter "mailMessage"
    .parameter "bodyid"
    .parameter "index"
    .parameter "nowEncode"
    .parameter "charsetOrfilename"
    .parameter "mimeType"
    .parameter "saveAsFile"
    .parameter "attachType"
    .parameter "hasProgress"
    .parameter "controller"
    .parameter
    .parameter "fileReference"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;",
            "Lcom/htc/android/mail/MailMessage;",
            "J",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "ZIZ",
            "Lcom/htc/android/mail/AbsRequestController;",
            "Ljava/lang/ref/WeakReference",
            "<",
            "Landroid/os/Handler;",
            ">;",
            "Ljava/lang/String;",
            ")V"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 4544
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    .local p13, weakHandler:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Landroid/os/Handler;>;"
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v31

    .line 4545
    .local v31, size:I
    if-nez v31, :cond_1

    .line 4695
    :cond_0
    :goto_0
    return-void

    .line 4549
    :cond_1
    add-int/lit8 v4, v31, -0x1

    move-object/from16 v0, p1

    invoke-interface {v0, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v26

    check-cast v26, Lcom/htc/android/mail/ByteString;

    .line 4550
    .local v26, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual/range {v26 .. v26}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v4

    const-string v7, " "

    invoke-virtual {v4, v7}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v34

    .line 4552
    .local v34, token:[Ljava/lang/String;
    move-object/from16 v0, v34

    array-length v4, v0

    const/4 v7, 0x2

    if-lt v4, v7, :cond_0

    move-object/from16 v0, v34

    array-length v4, v0

    const/4 v7, 0x1

    if-le v4, v7, :cond_2

    const/4 v4, 0x1

    aget-object v4, v34, v4

    sget-object v7, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v7}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v4, v7}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v4

    if-nez v4, :cond_0

    .line 4556
    :cond_2
    new-instance v19, Ljava/util/ArrayList;

    invoke-direct/range {v19 .. v19}, Ljava/util/ArrayList;-><init>()V

    .line 4558
    .local v19, currentMessage:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/16 v24, 0x0

    .local v24, i:I
    :goto_1
    add-int/lit8 v4, v31, -0x1

    move/from16 v0, v24

    if-ge v0, v4, :cond_4

    .line 4559
    move-object/from16 v0, p1

    move/from16 v1, v24

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v26

    .end local v26           #r:Lcom/htc/android/mail/ByteString;
    check-cast v26, Lcom/htc/android/mail/ByteString;

    .line 4560
    .restart local v26       #r:Lcom/htc/android/mail/ByteString;
    invoke-virtual/range {v26 .. v26}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v4

    const-string v7, " "

    invoke-virtual {v4, v7}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v34

    .line 4561
    sget-object v4, Lcom/htc/android/mail/server/ImapServer;->STR_STAR:Lcom/htc/android/mail/ByteString;

    move-object/from16 v0, v26

    invoke-virtual {v0, v4}, Lcom/htc/android/mail/ByteString;->startsWith(Lcom/htc/android/mail/ByteString;)Z

    move-result v4

    if-nez v4, :cond_3

    .line 4562
    move-object/from16 v0, v19

    move-object/from16 v1, v26

    invoke-interface {v0, v1}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 4558
    :cond_3
    add-int/lit8 v24, v24, 0x1

    goto :goto_1

    .line 4565
    :cond_4
    sget-boolean v4, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v4, :cond_5

    const-string v4, "ImapServer"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "currentMessage.size() is "

    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-interface/range {v19 .. v19}, Ljava/util/List;->size()I

    move-result v9

    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v4, v7}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 4566
    :cond_5
    invoke-interface/range {v19 .. v19}, Ljava/util/List;->size()I

    move-result v4

    if-nez v4, :cond_6

    new-instance v4, Lcom/htc/android/mail/exception/MailNotFoundException;

    invoke-direct {v4}, Lcom/htc/android/mail/exception/MailNotFoundException;-><init>()V

    throw v4

    .line 4569
    :cond_6
    sget-boolean v4, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v4, :cond_7

    const-string v4, "ImapServer"

    const-string v7, "@ before ."

    invoke-static {v4, v7}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 4570
    :cond_7
    new-instance v3, Lcom/htc/android/mail/Imap4PartParser;

    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    move-object/from16 v0, p0

    iget-object v5, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v6, v19

    check-cast v6, Ljava/util/ArrayList;

    const/4 v9, 0x3

    move-object/from16 v0, p2

    iget-object v11, v0, Lcom/htc/android/mail/MailMessage;->uid:Ljava/lang/String;

    move-object/from16 v7, p7

    move-object/from16 v8, p6

    move/from16 v10, p9

    move-object/from16 v12, p14

    move-object/from16 v13, p12

    move-object/from16 v14, p13

    invoke-direct/range {v3 .. v14}, Lcom/htc/android/mail/Imap4PartParser;-><init>(Landroid/content/Context;Lcom/htc/android/mail/Account;Ljava/util/ArrayList;Ljava/lang/String;Ljava/lang/String;IZLjava/lang/String;Ljava/lang/String;Lcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;)V

    .line 4572
    .local v3, partparser:Lcom/htc/android/mail/Imap4PartParser;
    sget-boolean v4, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v4, :cond_8

    const-string v4, "ImapServer"

    const-string v7, "@ after ."

    invoke-static {v4, v7}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 4573
    :cond_8
    new-instance v37, Landroid/content/ContentValues;

    invoke-direct/range {v37 .. v37}, Landroid/content/ContentValues;-><init>()V

    .line 4575
    .local v37, values:Landroid/content/ContentValues;
    const-string v4, "_mimetype"

    move-object/from16 v0, v37

    move-object/from16 v1, p8

    invoke-virtual {v0, v4, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 4576
    sget-boolean v4, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v4, :cond_9

    const-string v4, "ImapServer"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "2 save mail as :"

    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object/from16 v0, p8

    invoke-virtual {v7, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v4, v7}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 4577
    :cond_9
    if-nez p9, :cond_10

    .line 4578
    const-string v4, "_text"

    invoke-virtual {v3}, Lcom/htc/android/mail/Imap4PartParser;->getBody()Ljava/lang/String;

    move-result-object v7

    move-object/from16 v0, v37

    invoke-virtual {v0, v4, v7}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 4579
    const-string v4, "_filename"

    const-string v7, ""

    move-object/from16 v0, v37

    invoke-virtual {v0, v4, v7}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 4605
    :cond_a
    :goto_2
    const-string v4, "_message"

    move-object/from16 v0, p2

    iget-wide v11, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-static {v11, v12}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    move-object/from16 v0, v37

    invoke-virtual {v0, v4, v7}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 4606
    const-string v4, "_account"

    move-object/from16 v0, p0

    iget-object v7, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v7}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v11

    invoke-static {v11, v12}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    move-object/from16 v0, v37

    invoke-virtual {v0, v4, v7}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 4607
    const-string v4, "_flags"

    const/4 v7, 0x0

    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v7

    move-object/from16 v0, v37

    invoke-virtual {v0, v4, v7}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 4609
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v6

    .line 4612
    .local v6, cp:Landroid/content/IContentProvider;
    :try_start_0
    sget-boolean v4, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v4, :cond_b

    const-string v4, "ImapServer"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "2 ### "

    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object/from16 v0, p2

    iget-wide v11, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v7, v11, v12}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v9, ">"

    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-wide/from16 v0, p3

    invoke-virtual {v7, v0, v1}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v4, v7}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 4614
    :cond_b
    const-wide/16 v11, 0x0

    cmp-long v4, p3, v11

    if-eqz v4, :cond_15

    .line 4615
    move-object/from16 v0, p2

    iget-wide v11, v0, Lcom/htc/android/mail/MailMessage;->id:J

    move-wide/from16 v0, p3

    invoke-static {v0, v1, v11, v12}, Lcom/htc/android/mail/MailCommon;->getPartMessageUri(JJ)Landroid/net/Uri;

    move-result-object v4

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "_message = "

    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object/from16 v0, p2

    iget-wide v11, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v7, v11, v12}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    const/4 v9, 0x0

    move-object/from16 v0, v37

    invoke-interface {v6, v4, v0, v7, v9}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    .line 4616
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    sget-object v7, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    invoke-virtual {v4, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v7, "/"

    invoke-virtual {v4, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object/from16 v0, p2

    iget-wide v11, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v4, v11, v12}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v4}, Landroid/net/Uri;->parse(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v7

    const/4 v4, 0x3

    new-array v8, v4, [Ljava/lang/String;

    const/4 v4, 0x0

    const-string v9, "_readsize"

    aput-object v9, v8, v4

    const/4 v4, 0x1

    const-string v9, "_readtotalsize"

    aput-object v9, v8, v4

    const/4 v4, 0x2

    const-string v9, "_downloadtotalsize"

    aput-object v9, v8, v4

    const/4 v9, 0x0

    const/4 v10, 0x0

    const/4 v11, 0x0

    invoke-interface/range {v6 .. v11}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v32

    .line 4618
    .local v32, sizeCursor:Landroid/database/Cursor;
    const/16 v35, 0x0

    .line 4619
    .local v35, total:I
    const/16 v27, 0x0

    .line 4620
    .local v27, readsize:I
    const/16 v20, 0x0

    .line 4622
    .local v20, downloadtotalsize:I
    invoke-interface/range {v32 .. v32}, Landroid/database/Cursor;->getCount()I

    move-result v4

    if-lez v4, :cond_c

    .line 4623
    invoke-interface/range {v32 .. v32}, Landroid/database/Cursor;->moveToNext()Z

    .line 4624
    const-string v4, "_readtotalsize"

    move-object/from16 v0, v32

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v32

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getInt(I)I

    move-result v35

    .line 4625
    const-string v4, "_readsize"

    move-object/from16 v0, v32

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v32

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getInt(I)I

    move-result v27

    .line 4626
    const-string v4, "_downloadtotalsize"

    move-object/from16 v0, v32

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v32

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getInt(I)I

    move-result v20

    .line 4628
    :cond_c
    invoke-interface/range {v32 .. v32}, Landroid/database/Cursor;->close()V

    .line 4630
    new-instance v38, Landroid/content/ContentValues;

    invoke-direct/range {v38 .. v38}, Landroid/content/ContentValues;-><init>()V
    :try_end_0
    .catch Landroid/os/DeadObjectException; {:try_start_0 .. :try_end_0} :catch_2
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_3

    .line 4632
    .end local v37           #values:Landroid/content/ContentValues;
    .local v38, values:Landroid/content/ContentValues;
    :try_start_1
    const-string v4, "text/html"

    move-object/from16 v0, p8

    invoke-virtual {v4, v0}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v4

    if-eqz v4, :cond_14

    .line 4633
    const-string v4, "_preview"

    invoke-virtual {v3}, Lcom/htc/android/mail/Imap4PartParser;->getBody()Ljava/lang/String;

    move-result-object v7

    invoke-static {v7}, Lcom/htc/android/mail/MailCommon;->converHTMLtoPlainText(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v7

    invoke-static {v7}, Lcom/htc/android/mail/MailCommon;->s_convert(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v7

    move-object/from16 v0, v38

    invoke-virtual {v0, v4, v7}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 4637
    :cond_d
    :goto_3
    const-string v4, "_readsize"

    invoke-static/range {v35 .. v35}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v7

    move-object/from16 v0, v38

    invoke-virtual {v0, v4, v7}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 4638
    const-string v4, "_downloadtotalsize"

    sub-int v7, v20, v27

    add-int v7, v7, v35

    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v7

    move-object/from16 v0, v38

    invoke-virtual {v0, v4, v7}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 4639
    move-object/from16 v0, p2

    iget-wide v11, v0, Lcom/htc/android/mail/MailMessage;->accountId:J

    move-object/from16 v0, p2

    iget-wide v13, v0, Lcom/htc/android/mail/MailMessage;->mailBoxId:J

    move-object/from16 v0, p0

    invoke-virtual {v0, v11, v12, v13, v14}, Lcom/htc/android/mail/server/ImapServer;->getSummariesUri(JJ)Landroid/net/Uri;

    move-result-object v4

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "_id = "

    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object/from16 v0, p2

    iget-wide v11, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v7, v11, v12}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    const/4 v9, 0x0

    move-object/from16 v0, v38

    invoke-interface {v6, v4, v0, v7, v9}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    .line 4640
    sget-boolean v4, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v4, :cond_e

    const-string v4, "ImapServer"

    const-string v7, "### set total size ok."

    invoke-static {v4, v7}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V
    :try_end_1
    .catch Landroid/os/DeadObjectException; {:try_start_1 .. :try_end_1} :catch_1
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_4

    :cond_e
    move-object/from16 v37, v38

    .line 4694
    .end local v20           #downloadtotalsize:I
    .end local v27           #readsize:I
    .end local v32           #sizeCursor:Landroid/database/Cursor;
    .end local v35           #total:I
    .end local v38           #values:Landroid/content/ContentValues;
    .restart local v37       #values:Landroid/content/ContentValues;
    :cond_f
    :goto_4
    const/4 v3, 0x0

    .line 4695
    goto/16 :goto_0

    .line 4580
    .end local v6           #cp:Landroid/content/IContentProvider;
    :cond_10
    if-eqz p9, :cond_13

    invoke-virtual {v3}, Lcom/htc/android/mail/Imap4PartParser;->getFilename()Ljava/lang/String;

    move-result-object v4

    if-eqz v4, :cond_13

    .line 4581
    invoke-static/range {p7 .. p7}, Lcom/htc/android/mail/MailCommon;->eraseInvalidChar(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v22

    .line 4582
    .local v22, filename:Ljava/lang/String;
    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v4}, Lcom/htc/android/mail/Account;->enableSDsave()I

    move-result v4

    move-object/from16 v0, p0

    iget-object v7, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    move-object/from16 v0, v22

    move/from16 v1, p10

    invoke-static {v4, v0, v7, v1}, Lcom/htc/android/mail/MailCommon;->checkFileExist(ILjava/lang/String;Landroid/content/Context;I)I

    move-result v4

    if-nez v4, :cond_11

    .line 4583
    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v4}, Lcom/htc/android/mail/Account;->enableSDsave()I

    move-result v4

    move-object/from16 v0, p0

    iget-object v7, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    move-object/from16 v0, v22

    move/from16 v1, p10

    invoke-static {v4, v0, v7, v1}, Lcom/htc/android/mail/MailCommon;->getSuggestFileName(ILjava/lang/String;Landroid/content/Context;I)Ljava/lang/String;

    move-result-object v22

    .line 4585
    :cond_11
    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    move-object/from16 v0, p0

    iget-object v7, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v7}, Lcom/htc/android/mail/Account;->enableSDsave()I

    move-result v7

    const/4 v9, 0x0

    move-object/from16 v0, v22

    move/from16 v1, p10

    invoke-static {v4, v7, v9, v0, v1}, Lcom/htc/android/mail/util/StorageControl;->getAttachmentFilePath(Landroid/content/Context;ILjava/lang/String;Ljava/lang/String;I)Ljava/lang/String;

    move-result-object v5

    .line 4587
    .local v5, path:Ljava/lang/String;
    const-string v4, "_filename"

    move-object/from16 v0, v37

    move-object/from16 v1, p7

    invoke-virtual {v0, v4, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 4589
    :try_start_2
    new-instance v33, Ljava/io/File;

    invoke-virtual {v3}, Lcom/htc/android/mail/Imap4PartParser;->getFilename()Ljava/lang/String;

    move-result-object v4

    move-object/from16 v0, v33

    invoke-direct {v0, v4}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 4590
    .local v33, tmpFile:Ljava/io/File;
    const-string v4, "_filesize"

    invoke-virtual/range {v33 .. v33}, Ljava/io/File;->length()J

    move-result-wide v11

    invoke-static {v11, v12}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    move-object/from16 v0, v37

    invoke-virtual {v0, v4, v7}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V
    :try_end_2
    .catch Ljava/lang/SecurityException; {:try_start_2 .. :try_end_2} :catch_0

    .line 4594
    .end local v33           #tmpFile:Ljava/io/File;
    :goto_5
    invoke-virtual {v3}, Lcom/htc/android/mail/Imap4PartParser;->getFilename()Ljava/lang/String;

    move-result-object v7

    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    const-string v9, "mail"

    const/4 v11, 0x0

    invoke-virtual {v4, v9, v11}, Landroid/content/Context;->getDir(Ljava/lang/String;I)Ljava/io/File;

    move-result-object v4

    invoke-virtual {v4}, Ljava/io/File;->getPath()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v5, v4}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v4

    if-nez v4, :cond_12

    const/4 v8, 0x1

    :goto_6
    move-object/from16 v4, p0

    move-object/from16 v6, p8

    move/from16 v9, p10

    invoke-direct/range {v4 .. v9}, Lcom/htc/android/mail/server/ImapServer;->saveFileWithPath2(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;ZI)Z

    .line 4595
    const-string v4, "_filepath"

    move-object/from16 v0, v37

    invoke-virtual {v0, v4, v5}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 4596
    sget-boolean v4, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v4, :cond_a

    .line 4597
    const-string v4, "ImapServer"

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Try save attachment:"

    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v9, ", enableSDsave:"

    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object/from16 v0, p0

    iget-object v9, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v9}, Lcom/htc/android/mail/Account;->enableSDsave()I

    move-result v9

    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v7

    const-string v9, ", tmpfile:"

    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v3}, Lcom/htc/android/mail/Imap4PartParser;->getFilename()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v4, v7}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    goto/16 :goto_2

    .line 4591
    :catch_0
    move-exception v29

    .line 4592
    .local v29, se:Ljava/lang/SecurityException;
    const-string v4, "ImapServer"

    const-string v7, "catch file size fail due to security exception"

    invoke-static {v4, v7}, Lcom/htc/android/mail/ll;->e(Ljava/lang/String;Ljava/lang/String;)V

    goto :goto_5

    .line 4594
    .end local v29           #se:Ljava/lang/SecurityException;
    :cond_12
    const/4 v8, 0x0

    goto :goto_6

    .line 4601
    .end local v5           #path:Ljava/lang/String;
    .end local v22           #filename:Ljava/lang/String;
    :cond_13
    sget-boolean v4, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v4, :cond_0

    const-string v4, "ImapServer"

    const-string v7, "Imap4PartParser save file fail."

    invoke-static {v4, v7}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    goto/16 :goto_0

    .line 4634
    .end local v37           #values:Landroid/content/ContentValues;
    .restart local v6       #cp:Landroid/content/IContentProvider;
    .restart local v20       #downloadtotalsize:I
    .restart local v27       #readsize:I
    .restart local v32       #sizeCursor:Landroid/database/Cursor;
    .restart local v35       #total:I
    .restart local v38       #values:Landroid/content/ContentValues;
    :cond_14
    :try_start_3
    const-string v4, "text/plain"

    move-object/from16 v0, p8

    invoke-virtual {v4, v0}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v4

    if-eqz v4, :cond_d

    .line 4635
    const-string v4, "_preview"

    invoke-virtual {v3}, Lcom/htc/android/mail/Imap4PartParser;->getBody()Ljava/lang/String;

    move-result-object v7

    invoke-static {v7}, Lcom/htc/android/mail/MailCommon;->s_convert(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v7

    move-object/from16 v0, v38

    invoke-virtual {v0, v4, v7}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V
    :try_end_3
    .catch Landroid/os/DeadObjectException; {:try_start_3 .. :try_end_3} :catch_1
    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_4

    goto/16 :goto_3

    .line 4687
    :catch_1
    move-exception v21

    move-object/from16 v37, v38

    .line 4688
    .end local v20           #downloadtotalsize:I
    .end local v27           #readsize:I
    .end local v32           #sizeCursor:Landroid/database/Cursor;
    .end local v35           #total:I
    .end local v38           #values:Landroid/content/ContentValues;
    .local v21, ex:Landroid/os/DeadObjectException;
    .restart local v37       #values:Landroid/content/ContentValues;
    :goto_7
    const-string v4, "ImapServer"

    const-string v7, "error"

    move-object/from16 v0, v21

    invoke-static {v4, v7, v0}, Lcom/htc/android/mail/ll;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V

    goto/16 :goto_0

    .line 4642
    .end local v21           #ex:Landroid/os/DeadObjectException;
    :cond_15
    const/4 v4, 0x2

    :try_start_4
    new-array v8, v4, [Ljava/lang/String;

    const/4 v4, 0x0

    const-string v7, "_id"

    aput-object v7, v8, v4

    const/4 v4, 0x1

    const-string v7, "_filesize"

    aput-object v7, v8, v4

    .line 4643
    .local v8, projection:[Ljava/lang/String;
    new-instance v30, Ljava/lang/StringBuilder;

    const-string v4, "_message= ? AND _filename= ?  AND _index= ?"

    move-object/from16 v0, v30

    invoke-direct {v0, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    .line 4645
    .local v30, selection:Ljava/lang/StringBuilder;
    const/4 v4, 0x3

    new-array v10, v4, [Ljava/lang/String;

    const/4 v4, 0x0

    move-object/from16 v0, p2

    iget-wide v11, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-static {v11, v12}, Ljava/lang/Long;->toString(J)Ljava/lang/String;

    move-result-object v7

    aput-object v7, v10, v4

    const/4 v4, 0x1

    aput-object p7, v10, v4

    const/4 v4, 0x2

    aput-object p5, v10, v4

    .line 4646
    .local v10, selectionArgs:[Ljava/lang/String;
    sget-object v7, Lcom/htc/android/mail/MailProvider;->sPartsURI:Landroid/net/Uri;

    invoke-virtual/range {v30 .. v30}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    const/4 v11, 0x0

    invoke-interface/range {v6 .. v11}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v17

    .line 4649
    .local v17, att:Landroid/database/Cursor;
    invoke-interface/range {v17 .. v17}, Landroid/database/Cursor;->getCount()I

    move-result v4

    if-lez v4, :cond_1a

    .line 4650
    invoke-interface/range {v17 .. v17}, Landroid/database/Cursor;->moveToNext()Z

    .line 4651
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    sget-object v7, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    invoke-virtual {v4, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v7, "/"

    invoke-virtual {v4, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-object/from16 v0, p2

    iget-wide v11, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v4, v11, v12}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v4}, Landroid/net/Uri;->parse(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v12

    const/4 v4, 0x1

    new-array v13, v4, [Ljava/lang/String;

    const/4 v4, 0x0

    const-string v7, "_downloadtotalsize"

    aput-object v7, v13, v4

    const/4 v14, 0x0

    const/4 v15, 0x0

    const/16 v16, 0x0

    move-object v11, v6

    invoke-interface/range {v11 .. v16}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v32

    .line 4653
    .restart local v32       #sizeCursor:Landroid/database/Cursor;
    invoke-interface/range {v32 .. v32}, Landroid/database/Cursor;->getCount()I

    move-result v4

    if-lez v4, :cond_16

    invoke-interface/range {v32 .. v32}, Landroid/database/Cursor;->moveToNext()Z

    .line 4655
    :cond_16
    const-string v4, "_downloadtotalsize"

    move-object/from16 v0, v32

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v32

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getInt(I)I

    move-result v20

    .line 4656
    .restart local v20       #downloadtotalsize:I
    invoke-interface/range {v32 .. v32}, Landroid/database/Cursor;->close()V

    .line 4657
    const-string v4, "_filesize"

    move-object/from16 v0, v17

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v17

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getInt(I)I

    move-result v23

    .line 4659
    .local v23, filesize:I
    sget-boolean v4, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v4, :cond_17

    const-string v4, "ImapServer"

    const-string v7, "udpate the attachment information."

    invoke-static {v4, v7}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 4660
    :cond_17
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    sget-object v7, Lcom/htc/android/mail/MailProvider;->sPartsURI:Landroid/net/Uri;

    invoke-virtual {v4, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v7, "/"

    invoke-virtual {v4, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v7, "_id"

    move-object/from16 v0, v17

    invoke-interface {v0, v7}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v7

    move-object/from16 v0, v17

    invoke-interface {v0, v7}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v11

    invoke-virtual {v4, v11, v12}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v4}, Landroid/net/Uri;->parse(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v4

    const/4 v7, 0x0

    const/4 v9, 0x0

    move-object/from16 v0, v37

    invoke-interface {v6, v4, v0, v7, v9}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    .line 4662
    new-instance v36, Landroid/content/ContentValues;

    invoke-direct/range {v36 .. v36}, Landroid/content/ContentValues;-><init>()V

    .line 4663
    .local v36, updateMessage:Landroid/content/ContentValues;
    const-string v4, "_downloadtotalsize"

    add-int v7, v20, v23

    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v7

    move-object/from16 v0, v36

    invoke-virtual {v0, v4, v7}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 4664
    sget-boolean v4, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v4, :cond_18

    const-string v4, "ImapServer"

    const-string v7, "udpate the message downloadsize information."

    invoke-static {v4, v7}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 4665
    :cond_18
    move-object/from16 v0, p2

    iget-wide v11, v0, Lcom/htc/android/mail/MailMessage;->accountId:J

    move-object/from16 v0, p2

    iget-wide v13, v0, Lcom/htc/android/mail/MailMessage;->mailBoxId:J

    move-object/from16 v0, p0

    invoke-virtual {v0, v11, v12, v13, v14}, Lcom/htc/android/mail/server/ImapServer;->getSummariesUri(JJ)Landroid/net/Uri;

    move-result-object v4

    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "_id = "

    invoke-virtual {v7, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v7

    move-object/from16 v0, p2

    iget-wide v11, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v7, v11, v12}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    const/4 v9, 0x0

    move-object/from16 v0, v36

    invoke-interface {v6, v4, v0, v7, v9}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    .line 4670
    .end local v20           #downloadtotalsize:I
    .end local v23           #filesize:I
    .end local v32           #sizeCursor:Landroid/database/Cursor;
    .end local v36           #updateMessage:Landroid/content/ContentValues;
    :cond_19
    :goto_8
    invoke-interface/range {v17 .. v17}, Landroid/database/Cursor;->close()V

    .line 4673
    if-eqz p11, :cond_f

    .line 4674
    new-instance v25, Landroid/os/Message;

    invoke-direct/range {v25 .. v25}, Landroid/os/Message;-><init>()V

    .line 4675
    .local v25, msg:Landroid/os/Message;
    new-instance v18, Landroid/os/Bundle;

    invoke-direct/range {v18 .. v18}, Landroid/os/Bundle;-><init>()V

    .line 4676
    .local v18, b:Landroid/os/Bundle;
    const-string v4, "accountId"

    move-object/from16 v0, p0

    iget-object v7, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v7}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v11

    move-object/from16 v0, v18

    invoke-virtual {v0, v4, v11, v12}, Landroid/os/Bundle;->putLong(Ljava/lang/String;J)V

    .line 4677
    const-string v4, "ret"

    const/4 v7, 0x1

    move-object/from16 v0, v18

    invoke-virtual {v0, v4, v7}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V

    .line 4678
    const-string v4, "filereference"

    move-object/from16 v0, v18

    move-object/from16 v1, p14

    invoke-virtual {v0, v4, v1}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 4679
    move-object/from16 v0, v25

    move-object/from16 v1, v18

    invoke-virtual {v0, v1}, Landroid/os/Message;->setData(Landroid/os/Bundle;)V

    .line 4681
    if-eqz p12, :cond_f

    if-eqz p13, :cond_f

    .line 4682
    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v0, p12

    move-object/from16 v1, v25

    move-object/from16 v2, p13

    invoke-virtual {v0, v4, v1, v2}, Lcom/htc/android/mail/AbsRequestController;->broadcastAttachmentDownloadComplete(Lcom/htc/android/mail/Account;Landroid/os/Message;Ljava/lang/ref/WeakReference;)V

    goto/16 :goto_4

    .line 4687
    .end local v8           #projection:[Ljava/lang/String;
    .end local v10           #selectionArgs:[Ljava/lang/String;
    .end local v17           #att:Landroid/database/Cursor;
    .end local v18           #b:Landroid/os/Bundle;
    .end local v25           #msg:Landroid/os/Message;
    .end local v30           #selection:Ljava/lang/StringBuilder;
    :catch_2
    move-exception v21

    goto/16 :goto_7

    .line 4667
    .restart local v8       #projection:[Ljava/lang/String;
    .restart local v10       #selectionArgs:[Ljava/lang/String;
    .restart local v17       #att:Landroid/database/Cursor;
    .restart local v30       #selection:Ljava/lang/StringBuilder;
    :cond_1a
    sget-boolean v4, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v4, :cond_19

    const-string v4, "ImapServer"

    const-string v7, "should not happened ..."

    invoke-static {v4, v7}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V
    :try_end_4
    .catch Landroid/os/DeadObjectException; {:try_start_4 .. :try_end_4} :catch_2
    .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_3

    goto :goto_8

    .line 4690
    .end local v8           #projection:[Ljava/lang/String;
    .end local v10           #selectionArgs:[Ljava/lang/String;
    .end local v17           #att:Landroid/database/Cursor;
    .end local v30           #selection:Ljava/lang/StringBuilder;
    :catch_3
    move-exception v28

    .line 4691
    .local v28, rex:Landroid/os/RemoteException;
    :goto_9
    const-string v4, "ImapServer"

    const-string v7, "error"

    move-object/from16 v0, v28

    invoke-static {v4, v7, v0}, Lcom/htc/android/mail/ll;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V

    goto/16 :goto_0

    .line 4690
    .end local v28           #rex:Landroid/os/RemoteException;
    .end local v37           #values:Landroid/content/ContentValues;
    .restart local v20       #downloadtotalsize:I
    .restart local v27       #readsize:I
    .restart local v32       #sizeCursor:Landroid/database/Cursor;
    .restart local v35       #total:I
    .restart local v38       #values:Landroid/content/ContentValues;
    :catch_4
    move-exception v28

    move-object/from16 v37, v38

    .end local v38           #values:Landroid/content/ContentValues;
    .restart local v37       #values:Landroid/content/ContentValues;
    goto :goto_9
.end method

.method private processFetchResponse(Ljava/io/PushbackInputStream;Ljava/util/HashMap;)Ljava/util/HashMap;
    .locals 6
    .parameter "pbIn"
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/io/PushbackInputStream;",
            "Ljava/util/HashMap",
            "<",
            "Ljava/lang/String;",
            "Lcom/htc/android/mail/ByteString;",
            ">;)",
            "Ljava/util/HashMap",
            "<",
            "Ljava/lang/String;",
            "Lcom/htc/android/mail/ByteString;",
            ">;"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .local p2, map:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Lcom/htc/android/mail/ByteString;>;"
    const/4 v5, -0x1

    .line 5827
    if-nez p2, :cond_0

    .line 5828
    new-instance p2, Ljava/util/HashMap;

    .end local p2           #map:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Lcom/htc/android/mail/ByteString;>;"
    invoke-direct {p2}, Ljava/util/HashMap;-><init>()V

    .line 5832
    .restart local p2       #map:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Lcom/htc/android/mail/ByteString;>;"
    :cond_0
    invoke-virtual {p1}, Ljava/io/PushbackInputStream;->read()I

    move-result v0

    .local v0, c:I
    if-eq v0, v5, :cond_1

    .line 5833
    const/16 v4, 0x28

    if-ne v0, v4, :cond_0

    .line 5836
    :cond_1
    :goto_0
    invoke-virtual {p1}, Ljava/io/PushbackInputStream;->read()I

    move-result v0

    if-eq v0, v5, :cond_2

    .line 5837
    const/16 v4, 0x29

    if-ne v0, v4, :cond_3

    .line 5849
    :cond_2
    return-object p2

    .line 5838
    :cond_3
    invoke-virtual {p1, v0}, Ljava/io/PushbackInputStream;->unread(I)V

    .line 5839
    invoke-direct {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->getKey(Ljava/io/PushbackInputStream;)Lcom/htc/android/mail/ByteString;

    move-result-object v1

    .line 5840
    .local v1, key:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v1}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v2

    .line 5841
    .local v2, keyString:Ljava/lang/String;
    const/4 v3, 0x0

    .line 5842
    .local v3, value:Lcom/htc/android/mail/ByteString;
    const-string v4, "BODY["

    invoke-virtual {v2, v4}, Ljava/lang/String;->indexOf(Ljava/lang/String;)I

    move-result v4

    if-ltz v4, :cond_4

    .line 5843
    invoke-direct {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->getBody(Ljava/io/PushbackInputStream;)Lcom/htc/android/mail/ByteString;

    move-result-object v3

    .line 5847
    :goto_1
    invoke-virtual {v1}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {p2, v4, v3}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    goto :goto_0

    .line 5845
    :cond_4
    invoke-direct {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->getValue(Ljava/io/PushbackInputStream;)Lcom/htc/android/mail/ByteString;

    move-result-object v3

    goto :goto_1
.end method

.method private processGetUid(Ljava/util/List;)Ljava/lang/String;
    .locals 10
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;)",
            "Ljava/lang/String;"
        }
    .end annotation

    .prologue
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/4 v9, 0x2

    const/4 v5, 0x0

    const/4 v8, 0x1

    .line 2369
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v2

    .line 2370
    .local v2, size:I
    if-nez v2, :cond_1

    .line 2392
    :cond_0
    :goto_0
    return-object v5

    .line 2374
    :cond_1
    add-int/lit8 v6, v2, -0x1

    invoke-interface {p1, v6}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/htc/android/mail/ByteString;

    .line 2375
    .local v1, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v1}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v6

    const-string v7, " "

    invoke-virtual {v6, v7}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v3

    .line 2377
    .local v3, token:[Ljava/lang/String;
    array-length v6, v3

    if-lt v6, v9, :cond_0

    array-length v6, v3

    if-le v6, v8, :cond_2

    aget-object v6, v3, v8

    sget-object v7, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v7}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v6, v7}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v6

    if-nez v6, :cond_0

    .line 2381
    :cond_2
    const/4 v0, 0x0

    .local v0, i:I
    :goto_1
    add-int/lit8 v6, v2, -0x1

    if-ge v0, v6, :cond_0

    .line 2382
    invoke-interface {p1, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    .end local v1           #r:Lcom/htc/android/mail/ByteString;
    check-cast v1, Lcom/htc/android/mail/ByteString;

    .line 2383
    .restart local v1       #r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v1}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object v6

    const-string v7, " "

    invoke-virtual {v6, v7}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v4

    .line 2384
    .local v4, uids:[Ljava/lang/String;
    array-length v6, v4

    const/4 v7, 0x3

    if-ge v6, v7, :cond_4

    .line 2381
    :cond_3
    add-int/lit8 v0, v0, 0x1

    goto :goto_1

    .line 2388
    :cond_4
    const-string v6, "SEARCH"

    aget-object v7, v4, v8

    invoke-virtual {v6, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_3

    .line 2389
    aget-object v5, v4, v9

    goto :goto_0
.end method

.method private final processID(Ljava/util/List;)V
    .locals 6
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;)V"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/htc/android/mail/exception/YahooIDException;
        }
    .end annotation

    .prologue
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/4 v5, 0x1

    .line 331
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v1

    .line 333
    .local v1, size:I
    if-nez v1, :cond_0

    .line 334
    new-instance v3, Lcom/htc/android/mail/exception/YahooIDException;

    invoke-direct {v3}, Lcom/htc/android/mail/exception/YahooIDException;-><init>()V

    throw v3

    .line 337
    :cond_0
    add-int/lit8 v3, v1, -0x1

    invoke-interface {p1, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/htc/android/mail/ByteString;

    .line 338
    .local v0, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v0}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v3

    const-string v4, " "

    invoke-virtual {v3, v4}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v2

    .line 340
    .local v2, token:[Ljava/lang/String;
    array-length v3, v2

    const/4 v4, 0x2

    if-lt v3, v4, :cond_1

    array-length v3, v2

    if-le v3, v5, :cond_2

    aget-object v3, v2, v5

    sget-object v4, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v4}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v3, v4}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v3

    if-eqz v3, :cond_2

    .line 341
    :cond_1
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->close()V

    .line 342
    new-instance v3, Lcom/htc/android/mail/exception/YahooIDException;

    invoke-direct {v3}, Lcom/htc/android/mail/exception/YahooIDException;-><init>()V

    throw v3

    .line 344
    :cond_2
    return-void
.end method

.method private final processLOGIN(Ljava/util/List;)V
    .locals 6
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;)V"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/htc/android/mail/exception/AuthorizationException;
        }
    .end annotation

    .prologue
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/4 v5, 0x1

    .line 347
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v1

    .line 349
    .local v1, size:I
    if-nez v1, :cond_0

    .line 350
    new-instance v3, Lcom/htc/android/mail/exception/AuthorizationException;

    invoke-direct {v3}, Lcom/htc/android/mail/exception/AuthorizationException;-><init>()V

    throw v3

    .line 353
    :cond_0
    add-int/lit8 v3, v1, -0x1

    invoke-interface {p1, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/htc/android/mail/ByteString;

    .line 354
    .local v0, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v0}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v3

    const-string v4, " "

    invoke-virtual {v3, v4}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v2

    .line 356
    .local v2, token:[Ljava/lang/String;
    array-length v3, v2

    const/4 v4, 0x2

    if-lt v3, v4, :cond_1

    array-length v3, v2

    if-le v3, v5, :cond_2

    aget-object v3, v2, v5

    sget-object v4, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v4}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v3, v4}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v3

    if-eqz v3, :cond_2

    .line 357
    :cond_1
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->close()V

    .line 358
    new-instance v3, Lcom/htc/android/mail/exception/AuthorizationException;

    invoke-direct {v3}, Lcom/htc/android/mail/exception/AuthorizationException;-><init>()V

    throw v3

    .line 360
    :cond_2
    return-void
.end method

.method private processSELECT(Ljava/util/List;Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;
    .locals 15
    .parameter
    .parameter "mailbox"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;",
            "Lcom/htc/android/mail/Mailbox;",
            ")",
            "Lcom/htc/android/mail/server/ImapServer$ImapResponses;"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/htc/android/mail/exception/MailException;
        }
    .end annotation

    .prologue
    .line 940
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/4 v11, 0x0

    iput-object v11, p0, Lcom/htc/android/mail/server/ImapServer;->mCurrentImapMailboxInfo:Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;

    .line 941
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v7

    .line 943
    .local v7, size:I
    if-nez v7, :cond_0

    .line 944
    new-instance v11, Lcom/htc/android/mail/exception/MailBoxNotFoundException;

    iget-object v12, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    const/4 v13, 0x0

    move-object/from16 v0, p2

    invoke-virtual {v0, v12, v13}, Lcom/htc/android/mail/Mailbox;->getShortFolderName(Landroid/content/Context;Z)Ljava/lang/String;

    move-result-object v12

    invoke-direct {v11, v12}, Lcom/htc/android/mail/exception/MailBoxNotFoundException;-><init>(Ljava/lang/String;)V

    throw v11

    .line 947
    :cond_0
    add-int/lit8 v11, v7, -0x1

    move-object/from16 v0, p1

    invoke-interface {v0, v11}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/htc/android/mail/ByteString;

    .line 948
    .local v4, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v4}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v11

    const-string v12, " "

    invoke-virtual {v11, v12}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v8

    .line 950
    .local v8, token:[Ljava/lang/String;
    array-length v11, v8

    const/4 v12, 0x2

    if-lt v11, v12, :cond_1

    array-length v11, v8

    const/4 v12, 0x1

    if-le v11, v12, :cond_4

    const/4 v11, 0x1

    aget-object v11, v8, v11

    sget-object v12, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v12}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v12

    invoke-virtual {v11, v12}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v11

    if-eqz v11, :cond_4

    .line 951
    :cond_1
    iget-object v11, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v11}, Lcom/htc/android/mail/Account;->getMailboxs()Lcom/htc/android/mail/Mailboxs;

    move-result-object v3

    .line 953
    .local v3, mailboxs:Lcom/htc/android/mail/Mailboxs;
    if-eqz v3, :cond_3

    move-object/from16 v0, p2

    iget-object v11, v0, Lcom/htc/android/mail/Mailbox;->decodeName:Ljava/lang/String;

    if-eqz v11, :cond_3

    .line 955
    invoke-virtual {v3}, Lcom/htc/android/mail/Mailboxs;->getDraftMailboxUnDecodeName()Ljava/lang/String;

    move-result-object v1

    .line 956
    .local v1, draftMailboxUnDecodeName:Ljava/lang/String;
    invoke-virtual {v3}, Lcom/htc/android/mail/Mailboxs;->getTrashMailboxUnDecodeName()Ljava/lang/String;

    move-result-object v9

    .line 957
    .local v9, trashMailboxUnDecodeName:Ljava/lang/String;
    invoke-virtual {v3}, Lcom/htc/android/mail/Mailboxs;->getSentMailboxUnDecodeName()Ljava/lang/String;

    move-result-object v6

    .line 959
    .local v6, sentMailboxUnDecodeName:Ljava/lang/String;
    move-object/from16 v0, p2

    iget-object v11, v0, Lcom/htc/android/mail/Mailbox;->decodeName:Ljava/lang/String;

    invoke-virtual {v11, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v11

    if-nez v11, :cond_2

    move-object/from16 v0, p2

    iget-object v11, v0, Lcom/htc/android/mail/Mailbox;->decodeName:Ljava/lang/String;

    invoke-virtual {v11, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v11

    if-nez v11, :cond_2

    move-object/from16 v0, p2

    iget-object v11, v0, Lcom/htc/android/mail/Mailbox;->decodeName:Ljava/lang/String;

    invoke-virtual {v11, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v11

    if-eqz v11, :cond_3

    .line 963
    :cond_2
    :try_start_0
    move-object/from16 v0, p2

    iget-object v11, v0, Lcom/htc/android/mail/Mailbox;->decodeName:Ljava/lang/String;

    invoke-virtual {p0, v11}, Lcom/htc/android/mail/server/ImapServer;->createMailbox(Ljava/lang/String;)I

    move-result v11

    if-nez v11, :cond_3

    .line 964
    move-object/from16 v0, p2

    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->selectMailbox(Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    move-result-object v5

    .line 993
    .end local v1           #draftMailboxUnDecodeName:Ljava/lang/String;
    .end local v3           #mailboxs:Lcom/htc/android/mail/Mailboxs;
    .end local v6           #sentMailboxUnDecodeName:Ljava/lang/String;
    .end local v9           #trashMailboxUnDecodeName:Ljava/lang/String;
    :goto_0
    return-object v5

    .line 966
    .restart local v1       #draftMailboxUnDecodeName:Ljava/lang/String;
    .restart local v3       #mailboxs:Lcom/htc/android/mail/Mailboxs;
    .restart local v6       #sentMailboxUnDecodeName:Ljava/lang/String;
    .restart local v9       #trashMailboxUnDecodeName:Ljava/lang/String;
    :catch_0
    move-exception v2

    .line 967
    .local v2, e:Ljava/lang/Exception;
    new-instance v11, Lcom/htc/android/mail/exception/MailBoxNotFoundException;

    iget-object v12, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    const/4 v13, 0x0

    move-object/from16 v0, p2

    invoke-virtual {v0, v12, v13}, Lcom/htc/android/mail/Mailbox;->getShortFolderName(Landroid/content/Context;Z)Ljava/lang/String;

    move-result-object v12

    invoke-direct {v11, v12}, Lcom/htc/android/mail/exception/MailBoxNotFoundException;-><init>(Ljava/lang/String;)V

    throw v11

    .line 972
    .end local v1           #draftMailboxUnDecodeName:Ljava/lang/String;
    .end local v2           #e:Ljava/lang/Exception;
    .end local v6           #sentMailboxUnDecodeName:Ljava/lang/String;
    .end local v9           #trashMailboxUnDecodeName:Ljava/lang/String;
    :cond_3
    new-instance v11, Lcom/htc/android/mail/exception/MailBoxNotFoundException;

    iget-object v12, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    const/4 v13, 0x0

    move-object/from16 v0, p2

    invoke-virtual {v0, v12, v13}, Lcom/htc/android/mail/Mailbox;->getShortFolderName(Landroid/content/Context;Z)Ljava/lang/String;

    move-result-object v12

    invoke-direct {v11, v12}, Lcom/htc/android/mail/exception/MailBoxNotFoundException;-><init>(Ljava/lang/String;)V

    throw v11

    .line 975
    .end local v3           #mailboxs:Lcom/htc/android/mail/Mailboxs;
    :cond_4
    invoke-virtual/range {p0 .. p1}, Lcom/htc/android/mail/server/ImapServer;->processFetchResponse(Ljava/util/List;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    move-result-object v5

    .line 976
    .local v5, responses:Lcom/htc/android/mail/server/ImapServer$ImapResponses;
    invoke-virtual {v5}, Lcom/htc/android/mail/server/ImapServer$ImapResponses;->getImapMailboxInfo()Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;

    move-result-object v11

    iput-object v11, p0, Lcom/htc/android/mail/server/ImapServer;->mCurrentImapMailboxInfo:Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;

    .line 978
    iget-object v11, p0, Lcom/htc/android/mail/server/ImapServer;->mCurrentImapMailboxInfo:Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;

    iget-wide v11, v11, Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;->highestModSeq:J

    const-wide/16 v13, 0x0

    cmp-long v11, v11, v13

    if-nez v11, :cond_5

    .line 979
    iget-object v11, p0, Lcom/htc/android/mail/server/ImapServer;->mImapEnabled:Lcom/htc/android/mail/server/ImapServer$ImapEnabled;

    if-eqz v11, :cond_5

    .line 980
    iget-object v11, p0, Lcom/htc/android/mail/server/ImapServer;->mImapEnabled:Lcom/htc/android/mail/server/ImapServer$ImapEnabled;

    const/4 v12, 0x0

    invoke-virtual {v11, v12}, Lcom/htc/android/mail/server/ImapServer$ImapEnabled;->setCondStoreEnabled(Z)V

    .line 981
    iget-object v11, p0, Lcom/htc/android/mail/server/ImapServer;->mImapEnabled:Lcom/htc/android/mail/server/ImapServer$ImapEnabled;

    const/4 v12, 0x0

    invoke-virtual {v11, v12}, Lcom/htc/android/mail/server/ImapServer$ImapEnabled;->setQrsyncEnabled(Z)V

    .line 986
    :cond_5
    new-instance v10, Landroid/content/ContentValues;

    invoke-direct {v10}, Landroid/content/ContentValues;-><init>()V

    .line 987
    .local v10, values:Landroid/content/ContentValues;
    const-string v11, "_existsize"

    iget-object v12, p0, Lcom/htc/android/mail/server/ImapServer;->mCurrentImapMailboxInfo:Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;

    iget v12, v12, Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;->exists:I

    invoke-static {v12}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v12

    invoke-virtual {v10, v11, v12}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 988
    iget-object v11, p0, Lcom/htc/android/mail/server/ImapServer;->mCurrentImapMailboxInfo:Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;

    iget-object v11, v11, Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;->uidValidity:Ljava/lang/String;

    invoke-virtual/range {p2 .. p2}, Lcom/htc/android/mail/Mailbox;->getUidValidity()Ljava/lang/String;

    move-result-object v12

    if-eq v11, v12, :cond_6

    .line 989
    iget-object v11, p0, Lcom/htc/android/mail/server/ImapServer;->mCurrentImapMailboxInfo:Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;

    iget-object v11, v11, Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;->uidValidity:Ljava/lang/String;

    move-object/from16 v0, p2

    invoke-virtual {v0, v11}, Lcom/htc/android/mail/Mailbox;->setUidValidity(Ljava/lang/String;)V

    .line 990
    const-string v11, "_uidValidity"

    iget-object v12, p0, Lcom/htc/android/mail/server/ImapServer;->mCurrentImapMailboxInfo:Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;

    iget-object v12, v12, Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;->uidValidity:Ljava/lang/String;

    invoke-virtual {v10, v11, v12}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 992
    :cond_6
    move-object/from16 v0, p2

    invoke-virtual {p0, v0, v10}, Lcom/htc/android/mail/server/ImapServer;->updateMailbox(Lcom/htc/android/mail/Mailbox;Landroid/content/ContentValues;)V

    goto :goto_0
.end method

.method private final processSTARTTLS(Ljava/util/List;)V
    .locals 6
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;)V"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/4 v5, 0x1

    .line 291
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v1

    .line 293
    .local v1, size:I
    if-nez v1, :cond_0

    .line 294
    new-instance v3, Lcom/htc/android/mail/exception/NoTLSSupportException;

    invoke-direct {v3}, Lcom/htc/android/mail/exception/NoTLSSupportException;-><init>()V

    throw v3

    .line 297
    :cond_0
    add-int/lit8 v3, v1, -0x1

    invoke-interface {p1, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/htc/android/mail/ByteString;

    .line 298
    .local v0, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v0}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v3

    const-string v4, " "

    invoke-virtual {v3, v4}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v2

    .line 300
    .local v2, token:[Ljava/lang/String;
    array-length v3, v2

    const/4 v4, 0x2

    if-lt v3, v4, :cond_1

    array-length v3, v2

    if-le v3, v5, :cond_2

    aget-object v3, v2, v5

    sget-object v4, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v4}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v3, v4}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v3

    if-eqz v3, :cond_2

    .line 301
    :cond_1
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->close()V

    .line 302
    new-instance v3, Lcom/htc/android/mail/exception/NoTLSSupportException;

    invoke-direct {v3}, Lcom/htc/android/mail/exception/NoTLSSupportException;-><init>()V

    throw v3

    .line 305
    :cond_2
    invoke-direct {p0}, Lcom/htc/android/mail/server/ImapServer;->newTLSSocket()V

    .line 307
    return-void
.end method

.method private processfetchPartWithHeaderOnly(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;IILjava/lang/String;Ljava/lang/String;)Z
    .locals 16
    .parameter "uid"
    .parameter "mimeType"
    .parameter "charset"
    .parameter "Encode"
    .parameter "totalSize"
    .parameter "includeAttach"
    .parameter "tag"
    .parameter "index"

    .prologue
    .line 2480
    const-wide/16 v9, 0x0

    .line 2483
    .local v9, mId:J
    :try_start_0
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v1

    .line 2485
    .local v1, cp:Landroid/content/IContentProvider;
    sget-object v2, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    const/4 v3, 0x1

    new-array v3, v3, [Ljava/lang/String;

    const/4 v4, 0x0

    const-string v5, "_id"

    aput-object v5, v3, v4

    sget-object v4, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v5, "_mailboxId = \'%d\' AND _account = \'%d\' AND _uid = \'%s\'"

    const/4 v6, 0x3

    new-array v6, v6, [Ljava/lang/Object;

    const/4 v13, 0x0

    move-object/from16 v0, p0

    iget-object v14, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-wide v14, v14, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-static {v14, v15}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v14

    aput-object v14, v6, v13

    const/4 v13, 0x1

    move-object/from16 v0, p0

    iget-object v14, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v14}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v14

    invoke-static {v14, v15}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v14

    aput-object v14, v6, v13

    const/4 v13, 0x2

    aput-object p1, v6, v13

    invoke-static {v4, v5, v6}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v4

    const/4 v5, 0x0

    const/4 v6, 0x0

    invoke-interface/range {v1 .. v6}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v7

    .line 2488
    .local v7, c:Landroid/database/Cursor;
    invoke-interface {v7}, Landroid/database/Cursor;->getCount()I

    move-result v2

    if-lez v2, :cond_1

    .line 2489
    invoke-interface {v7}, Landroid/database/Cursor;->moveToNext()Z

    .line 2490
    const-string v2, "_id"

    invoke-interface {v7, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    invoke-interface {v7, v2}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v9

    .line 2501
    invoke-interface {v7}, Landroid/database/Cursor;->close()V

    .line 2508
    new-instance v12, Landroid/content/ContentValues;

    invoke-direct {v12}, Landroid/content/ContentValues;-><init>()V

    .line 2509
    .local v12, values2:Landroid/content/ContentValues;
    const-string v2, "_mimetype"

    move-object/from16 v0, p2

    invoke-virtual {v12, v2, v0}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 2510
    sget-boolean v2, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v2, :cond_0

    .line 2511
    const-string v2, "ImapServer"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "save mail as :"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p2

    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 2512
    :cond_0
    const-string v2, "_text"

    const-string v3, ""

    invoke-virtual {v12, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 2513
    const-string v2, "_encode"

    move-object/from16 v0, p4

    invoke-virtual {v12, v2, v0}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 2514
    const-string v2, "_index"

    move-object/from16 v0, p8

    invoke-virtual {v12, v2, v0}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 2515
    const-string v2, "_charset"

    move-object/from16 v0, p3

    invoke-virtual {v12, v2, v0}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 2516
    const-string v2, "_message"

    invoke-static {v9, v10}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v3

    invoke-virtual {v12, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 2517
    const-string v2, "_account"

    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v3}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v3

    invoke-static {v3, v4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v3

    invoke-virtual {v12, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 2518
    const-string v2, "_flags"

    const/4 v3, 0x0

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v12, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 2519
    const-string v2, "_filename"

    const-string v3, ""

    invoke-virtual {v12, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 2521
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v8

    .line 2522
    .local v8, cp2:Landroid/content/IContentProvider;
    sget-object v2, Lcom/htc/android/mail/MailProvider;->sPartsURI:Landroid/net/Uri;

    invoke-interface {v8, v2, v12}, Landroid/content/IContentProvider;->insert(Landroid/net/Uri;Landroid/content/ContentValues;)Landroid/net/Uri;

    .line 2523
    const/4 v2, 0x1

    .line 2525
    .end local v1           #cp:Landroid/content/IContentProvider;
    .end local v7           #c:Landroid/database/Cursor;
    .end local v8           #cp2:Landroid/content/IContentProvider;
    .end local v12           #values2:Landroid/content/ContentValues;
    :goto_0
    return v2

    .line 2493
    .restart local v1       #cp:Landroid/content/IContentProvider;
    .restart local v7       #c:Landroid/database/Cursor;
    :cond_1
    if-eqz v7, :cond_2

    .line 2494
    invoke-interface {v7}, Landroid/database/Cursor;->close()V

    .line 2496
    :cond_2
    sget-boolean v2, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v2, :cond_3

    .line 2497
    const-string v2, "ImapServer"

    const-string v3, "processFetchHeaderOnly error."

    invoke-static {v2, v3}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 2498
    :cond_3
    const/4 v2, 0x0

    goto :goto_0

    .line 2524
    .end local v1           #cp:Landroid/content/IContentProvider;
    .end local v7           #c:Landroid/database/Cursor;
    :catch_0
    move-exception v11

    .line 2525
    .local v11, rex:Landroid/os/RemoteException;
    const/4 v2, 0x0

    goto :goto_0
.end method

.method private processfetchPartWithSize(Lcom/htc/android/mail/MailMessage;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;IILjava/lang/String;Ljava/lang/String;Ljava/util/ArrayList;)Z
    .locals 34
    .parameter "mailMessage"
    .parameter
    .parameter "mimeType"
    .parameter "charsetOrfilename"
    .parameter "nowEncode"
    .parameter "totalSize"
    .parameter "includeAttach"
    .parameter "tag"
    .parameter "index"
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/MailMessage;",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "II",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "Ljava/util/ArrayList",
            "<",
            "Landroid/content/ContentProviderOperation;",
            ">;)Z"
        }
    .end annotation

    .prologue
    .line 2531
    .local p2, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    .local p10, operations:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/ContentProviderOperation;>;"
    invoke-interface/range {p2 .. p2}, Ljava/util/List;->size()I

    move-result v29

    .line 2533
    .local v29, size:I
    if-nez v29, :cond_0

    .line 2534
    const/4 v3, 0x0

    .line 2691
    .end local p6
    :goto_0
    return v3

    .line 2537
    .restart local p6
    :cond_0
    add-int/lit8 v3, v29, -0x1

    move-object/from16 v0, p2

    invoke-interface {v0, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v27

    check-cast v27, Lcom/htc/android/mail/ByteString;

    .line 2538
    .local v27, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual/range {v27 .. v27}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v3

    const-string v5, " "

    invoke-virtual {v3, v5}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v31

    .line 2540
    .local v31, token:[Ljava/lang/String;
    move-object/from16 v0, v31

    array-length v3, v0

    const/4 v5, 0x2

    if-lt v3, v5, :cond_1

    move-object/from16 v0, v31

    array-length v3, v0

    const/4 v5, 0x1

    if-le v3, v5, :cond_2

    const/4 v3, 0x1

    aget-object v3, v31, v3

    sget-object v5, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v5}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v3, v5}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v3

    if-eqz v3, :cond_2

    .line 2541
    :cond_1
    const/4 v3, 0x0

    goto :goto_0

    .line 2544
    :cond_2
    new-instance v20, Ljava/util/ArrayList;

    invoke-direct/range {v20 .. v20}, Ljava/util/ArrayList;-><init>()V

    .line 2546
    .local v20, currentMessage:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/16 v28, 0x0

    .line 2547
    .local v28, readFlag:Z
    const/16 v16, 0x0

    .line 2548
    .local v16, bodyHeaderSize:I
    const/16 v21, 0x0

    .line 2549
    .local v21, currentSize:I
    const/16 v23, 0x0

    .line 2550
    .local v23, foundHeader:Z
    const/16 v17, 0x0

    .line 2552
    .local v17, bodyStart:Z
    const/16 v24, 0x0

    .local v24, i:I
    :goto_1
    add-int/lit8 v3, v29, -0x1

    move/from16 v0, v24

    if-ge v0, v3, :cond_b

    .line 2553
    move-object/from16 v0, p2

    move/from16 v1, v24

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v27

    .end local v27           #r:Lcom/htc/android/mail/ByteString;
    check-cast v27, Lcom/htc/android/mail/ByteString;

    .line 2555
    .restart local v27       #r:Lcom/htc/android/mail/ByteString;
    sget-object v3, Lcom/htc/android/mail/server/ImapServer;->STR_STAR:Lcom/htc/android/mail/ByteString;

    move-object/from16 v0, v27

    invoke-virtual {v0, v3}, Lcom/htc/android/mail/ByteString;->startsWith(Lcom/htc/android/mail/ByteString;)Z

    move-result v3

    if-eqz v3, :cond_8

    .line 2556
    invoke-static {}, Lcom/htc/android/mail/Regex;->getInstance()Lcom/htc/android/mail/Regex;

    move-result-object v3

    const/4 v5, 0x7

    invoke-virtual {v3, v5}, Lcom/htc/android/mail/Regex;->getPattern(I)Ljava/util/regex/Pattern;

    move-result-object v3

    invoke-virtual/range {v27 .. v27}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v3, v5}, Ljava/util/regex/Pattern;->matcher(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;

    move-result-object v25

    .line 2557
    .local v25, m:Ljava/util/regex/Matcher;
    invoke-virtual/range {v25 .. v25}, Ljava/util/regex/Matcher;->find()Z

    move-result v22

    .line 2558
    .local v22, found:Z
    if-nez v23, :cond_6

    if-eqz v22, :cond_6

    .line 2559
    move/from16 v23, v22

    .line 2560
    new-instance v30, Ljava/util/ArrayList;

    invoke-direct/range {v30 .. v30}, Ljava/util/ArrayList;-><init>()V

    .line 2561
    .local v30, store:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/String;>;"
    const-string v14, ""

    .line 2563
    .local v14, FlagsValue:Ljava/lang/String;
    const/4 v3, 0x1

    move-object/from16 v0, v25

    invoke-virtual {v0, v3}, Ljava/util/regex/Matcher;->group(I)Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Lcom/htc/android/mail/Util;->parsePairString(Ljava/lang/String;)Ljava/util/ArrayList;

    move-result-object v30

    .line 2569
    const-string v3, "FLAGS"

    move-object/from16 v0, v30

    invoke-static {v0, v3}, Lcom/htc/android/mail/Util;->getValueString(Ljava/util/ArrayList;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    if-eqz v3, :cond_4

    .line 2570
    const-string v3, "FLAGS"

    move-object/from16 v0, v30

    invoke-static {v0, v3}, Lcom/htc/android/mail/Util;->getValueString(Ljava/util/ArrayList;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v14

    .line 2571
    const-string v3, "\\Seen"

    invoke-virtual {v14, v3}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v3

    if-eqz v3, :cond_4

    .line 2572
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v3, :cond_3

    .line 2573
    const-string v3, "ImapServer"

    const-string v5, "Seen !"

    invoke-static {v3, v5}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 2574
    :cond_3
    const/16 v28, 0x1

    .line 2577
    :cond_4
    const/4 v3, 0x2

    move-object/from16 v0, v25

    invoke-virtual {v0, v3}, Ljava/util/regex/Matcher;->group(I)Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v16

    .line 2552
    .end local v14           #FlagsValue:Ljava/lang/String;
    .end local v22           #found:Z
    .end local v25           #m:Ljava/util/regex/Matcher;
    .end local v30           #store:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/String;>;"
    :cond_5
    :goto_2
    add-int/lit8 v24, v24, 0x1

    goto :goto_1

    .line 2581
    .restart local v22       #found:Z
    .restart local v25       #m:Ljava/util/regex/Matcher;
    :cond_6
    if-eqz v17, :cond_7

    .line 2582
    move-object/from16 v0, v20

    move-object/from16 v1, v27

    invoke-interface {v0, v1}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    goto :goto_2

    .line 2586
    :cond_7
    if-nez v23, :cond_5

    goto :goto_2

    .line 2601
    .end local v22           #found:Z
    .end local v25           #m:Ljava/util/regex/Matcher;
    :cond_8
    invoke-virtual/range {v27 .. v27}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v3

    const-string v5, " BODY["

    invoke-virtual {v3, v5}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v3

    if-nez v3, :cond_9

    .line 2602
    move-object/from16 v0, v20

    move-object/from16 v1, v27

    invoke-interface {v0, v1}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    goto :goto_2

    .line 2604
    :cond_9
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v3, :cond_a

    .line 2605
    const-string v3, "ImapServer"

    const-string v5, "start with BODY["

    invoke-static {v3, v5}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 2606
    :cond_a
    const/16 v17, 0x1

    .line 2607
    invoke-static {}, Lcom/htc/android/mail/Regex;->getInstance()Lcom/htc/android/mail/Regex;

    move-result-object v3

    const/16 v5, 0x9

    invoke-virtual {v3, v5}, Lcom/htc/android/mail/Regex;->getPattern(I)Ljava/util/regex/Pattern;

    move-result-object v3

    invoke-virtual/range {v27 .. v27}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v3, v5}, Ljava/util/regex/Pattern;->matcher(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;

    move-result-object v25

    .line 2608
    .restart local v25       #m:Ljava/util/regex/Matcher;
    invoke-virtual/range {v25 .. v25}, Ljava/util/regex/Matcher;->find()Z

    move-result v22

    .line 2609
    .restart local v22       #found:Z
    if-eqz v22, :cond_5

    .line 2610
    const/4 v3, 0x1

    move-object/from16 v0, v25

    invoke-virtual {v0, v3}, Ljava/util/regex/Matcher;->group(I)Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/Integer;->intValue()I

    move-result v21

    .line 2611
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v3, :cond_5

    .line 2612
    const-string v3, "ImapServer"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "BODY[] size:"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move/from16 v0, v21

    invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v3, v5}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    goto :goto_2

    .line 2617
    .end local v22           #found:Z
    .end local v25           #m:Ljava/util/regex/Matcher;
    :cond_b
    invoke-interface/range {v20 .. v20}, Ljava/util/List;->size()I

    move-result v3

    add-int/lit8 v24, v3, -0x1

    .line 2618
    :goto_3
    if-ltz v24, :cond_c

    move-object/from16 v0, v20

    move/from16 v1, v24

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/htc/android/mail/ByteString;

    sget-object v5, Lcom/htc/android/mail/server/ImapServer;->STR_STAR:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v3, v5}, Lcom/htc/android/mail/ByteString;->startsWith(Lcom/htc/android/mail/ByteString;)Z

    move-result v3

    if-eqz v3, :cond_c

    .line 2619
    move-object/from16 v0, v20

    move/from16 v1, v24

    invoke-interface {v0, v1}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 2620
    add-int/lit8 v24, v24, -0x1

    goto :goto_3

    .line 2623
    :cond_c
    const/4 v9, 0x0

    .line 2627
    .local v9, saveAsFile:Z
    const/4 v2, 0x0

    .line 2628
    .local v2, partparser:Lcom/htc/android/mail/Imap4PartParser;
    const/16 v26, 0x0

    .line 2631
    .local v26, mUri:Landroid/net/Uri;
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-static {v3}, Lcom/htc/android/mail/AccountPool;->getInstance(Landroid/content/Context;)Lcom/htc/android/mail/AccountPool;

    move-result-object v15

    .line 2632
    .local v15, accountPool:Lcom/htc/android/mail/AccountPool;
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    move-object/from16 v0, p1

    iget-wide v5, v0, Lcom/htc/android/mail/MailMessage;->accountId:J

    invoke-virtual {v15, v3, v5, v6}, Lcom/htc/android/mail/AccountPool;->getAccount(Landroid/content/Context;J)Lcom/htc/android/mail/Account;

    move-result-object v4

    .line 2635
    .local v4, account:Lcom/htc/android/mail/Account;
    new-instance v2, Lcom/htc/android/mail/Imap4PartParser;

    .end local v2           #partparser:Lcom/htc/android/mail/Imap4PartParser;
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    move-object/from16 v5, v20

    check-cast v5, Ljava/util/ArrayList;

    const/4 v8, 0x0

    move-object/from16 v0, p1

    iget-object v10, v0, Lcom/htc/android/mail/MailMessage;->uid:Ljava/lang/String;

    const/4 v11, 0x0

    const/4 v12, 0x0

    const/4 v13, 0x0

    move-object/from16 v6, p4

    move-object/from16 v7, p5

    invoke-direct/range {v2 .. v13}, Lcom/htc/android/mail/Imap4PartParser;-><init>(Landroid/content/Context;Lcom/htc/android/mail/Account;Ljava/util/ArrayList;Ljava/lang/String;Ljava/lang/String;IZLjava/lang/String;Ljava/lang/String;Lcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;)V

    .line 2638
    .restart local v2       #partparser:Lcom/htc/android/mail/Imap4PartParser;
    new-instance v32, Landroid/content/ContentValues;

    invoke-direct/range {v32 .. v32}, Landroid/content/ContentValues;-><init>()V

    .line 2640
    .local v32, values:Landroid/content/ContentValues;
    const-string v3, "_flags"

    const/4 v5, 0x0

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    move-object/from16 v0, v32

    invoke-virtual {v0, v3, v5}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 2642
    const-string v5, "_readsize"

    const/high16 v3, 0x10

    move/from16 v0, v21

    if-lt v0, v3, :cond_12

    move/from16 v3, p6

    :goto_4
    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    move-object/from16 v0, v32

    invoke-virtual {v0, v5, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 2643
    const-string v3, "_readtotalsize"

    invoke-static/range {p6 .. p6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    move-object/from16 v0, v32

    invoke-virtual {v0, v3, v5}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 2644
    const-string v5, "_downloadtotalsize"

    const/high16 v3, 0x10

    move/from16 v0, v21

    if-lt v0, v3, :cond_13

    move/from16 v3, p6

    :goto_5
    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    move-object/from16 v0, v32

    invoke-virtual {v0, v5, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 2645
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v3, :cond_d

    .line 2646
    const-string v3, "ImapServer"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "### _readsize is "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move/from16 v0, v21

    invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ",_readtotalsize is "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move/from16 v0, p6

    invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    const-string v6, ",fakeSize is "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    const/high16 v6, 0x10

    move/from16 v0, v21

    if-lt v0, v6, :cond_14

    .end local p6
    :goto_6
    move/from16 v0, p6

    invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v3, v5}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 2647
    :cond_d
    const-string v3, "_incAttachment"

    invoke-static/range {p7 .. p7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    move-object/from16 v0, v32

    invoke-virtual {v0, v3, v5}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 2649
    invoke-virtual {v2}, Lcom/htc/android/mail/Imap4PartParser;->getBody()Ljava/lang/String;

    move-result-object v18

    .line 2650
    .local v18, bodytext:Ljava/lang/String;
    if-nez v18, :cond_e

    .line 2651
    const-string v18, ""

    .line 2654
    :cond_e
    const-string v3, "text/html"

    move-object/from16 v0, p3

    invoke-virtual {v3, v0}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v3

    if-eqz v3, :cond_15

    .line 2655
    const-string v3, "_preview"

    invoke-static/range {v18 .. v18}, Lcom/htc/android/mail/MailCommon;->converHTMLtoPlainText(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v5

    invoke-static {v5}, Lcom/htc/android/mail/MailCommon;->s_convert(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, v32

    invoke-virtual {v0, v3, v5}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 2660
    :cond_f
    :goto_7
    move-object/from16 v0, p1

    iget-wide v5, v0, Lcom/htc/android/mail/MailMessage;->id:J

    const-wide/16 v7, 0x0

    cmp-long v3, v5, v7

    if-eqz v3, :cond_10

    .line 2661
    const/16 v19, 0x0

    .line 2662
    .local v19, builder:Landroid/content/ContentProviderOperation$Builder;
    move-object/from16 v0, p1

    iget-wide v5, v0, Lcom/htc/android/mail/MailMessage;->accountId:J

    move-object/from16 v0, p1

    iget-wide v7, v0, Lcom/htc/android/mail/MailMessage;->mailBoxId:J

    move-object/from16 v0, p0

    invoke-virtual {v0, v5, v6, v7, v8}, Lcom/htc/android/mail/server/ImapServer;->getSummariesUri(JJ)Landroid/net/Uri;

    move-result-object v3

    invoke-static {v3}, Landroid/content/ContentProviderOperation;->newUpdate(Landroid/net/Uri;)Landroid/content/ContentProviderOperation$Builder;

    move-result-object v19

    .line 2663
    move-object/from16 v0, v19

    move-object/from16 v1, v32

    invoke-virtual {v0, v1}, Landroid/content/ContentProviderOperation$Builder;->withValues(Landroid/content/ContentValues;)Landroid/content/ContentProviderOperation$Builder;

    move-result-object v19

    .line 2664
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "_id = "

    invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p1

    iget-wide v5, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v3, v5, v6}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    const/4 v5, 0x0

    move-object/from16 v0, v19

    invoke-virtual {v0, v3, v5}, Landroid/content/ContentProviderOperation$Builder;->withSelection(Ljava/lang/String;[Ljava/lang/String;)Landroid/content/ContentProviderOperation$Builder;

    move-result-object v19

    .line 2665
    invoke-virtual/range {v19 .. v19}, Landroid/content/ContentProviderOperation$Builder;->build()Landroid/content/ContentProviderOperation;

    move-result-object v3

    move-object/from16 v0, p10

    invoke-virtual {v0, v3}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 2668
    .end local v19           #builder:Landroid/content/ContentProviderOperation$Builder;
    :cond_10
    new-instance v33, Landroid/content/ContentValues;

    invoke-direct/range {v33 .. v33}, Landroid/content/ContentValues;-><init>()V

    .line 2670
    .local v33, values2:Landroid/content/ContentValues;
    const-string v3, "_mimetype"

    move-object/from16 v0, v33

    move-object/from16 v1, p3

    invoke-virtual {v0, v3, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 2671
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v3, :cond_11

    .line 2672
    const-string v3, "ImapServer"

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "save mail as :"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    move-object/from16 v0, p3

    invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v3, v5}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 2674
    :cond_11
    const-string v3, "_text"

    move-object/from16 v0, v33

    move-object/from16 v1, v18

    invoke-virtual {v0, v3, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 2675
    const-string v3, "_encode"

    move-object/from16 v0, v33

    move-object/from16 v1, p5

    invoke-virtual {v0, v3, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 2676
    const-string v3, "_index"

    move-object/from16 v0, v33

    move-object/from16 v1, p9

    invoke-virtual {v0, v3, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 2677
    const-string v3, "_charset"

    move-object/from16 v0, v33

    move-object/from16 v1, p4

    invoke-virtual {v0, v3, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 2678
    const-string v3, "_message"

    move-object/from16 v0, p1

    iget-wide v5, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-static {v5, v6}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v5

    move-object/from16 v0, v33

    invoke-virtual {v0, v3, v5}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 2679
    const-string v3, "_account"

    move-object/from16 v0, p1

    iget-wide v5, v0, Lcom/htc/android/mail/MailMessage;->accountId:J

    invoke-static {v5, v6}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v5

    move-object/from16 v0, v33

    invoke-virtual {v0, v3, v5}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 2680
    const-string v3, "_flags"

    const/4 v5, 0x0

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    move-object/from16 v0, v33

    invoke-virtual {v0, v3, v5}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 2681
    const-string v3, "_filename"

    const-string v5, ""

    move-object/from16 v0, v33

    invoke-virtual {v0, v3, v5}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 2683
    const/16 v19, 0x0

    .line 2684
    .restart local v19       #builder:Landroid/content/ContentProviderOperation$Builder;
    sget-object v3, Lcom/htc/android/mail/MailProvider;->sPartsURI:Landroid/net/Uri;

    invoke-static {v3}, Landroid/content/ContentProviderOperation;->newInsert(Landroid/net/Uri;)Landroid/content/ContentProviderOperation$Builder;

    move-result-object v19

    .line 2685
    move-object/from16 v0, v19

    move-object/from16 v1, v33

    invoke-virtual {v0, v1}, Landroid/content/ContentProviderOperation$Builder;->withValues(Landroid/content/ContentValues;)Landroid/content/ContentProviderOperation$Builder;

    move-result-object v19

    .line 2686
    invoke-virtual/range {v19 .. v19}, Landroid/content/ContentProviderOperation$Builder;->build()Landroid/content/ContentProviderOperation;

    move-result-object v3

    move-object/from16 v0, p10

    invoke-virtual {v0, v3}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 2688
    const/16 v18, 0x0

    .line 2689
    const/4 v2, 0x0

    .line 2691
    const/4 v3, 0x1

    goto/16 :goto_0

    .end local v18           #bodytext:Ljava/lang/String;
    .end local v19           #builder:Landroid/content/ContentProviderOperation$Builder;
    .end local v33           #values2:Landroid/content/ContentValues;
    .restart local p6
    :cond_12
    move/from16 v3, v21

    .line 2642
    goto/16 :goto_4

    :cond_13
    move/from16 v3, v21

    .line 2644
    goto/16 :goto_5

    :cond_14
    move/from16 p6, v21

    .line 2646
    goto/16 :goto_6

    .line 2656
    .end local p6
    .restart local v18       #bodytext:Ljava/lang/String;
    :cond_15
    const-string v3, "text/plain"

    move-object/from16 v0, p3

    invoke-virtual {v3, v0}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v3

    if-eqz v3, :cond_f

    .line 2657
    const-string v3, "_preview"

    invoke-static/range {v18 .. v18}, Lcom/htc/android/mail/MailCommon;->s_convert(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v5

    move-object/from16 v0, v32

    invoke-virtual {v0, v3, v5}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    goto/16 :goto_7
.end method

.method private pruneFetchCheckMoreList(Ljava/util/List;)V
    .locals 17
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Ljava/lang/String;",
            ">;)V"
        }
    .end annotation

    .prologue
    .line 3648
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    if-eqz p1, :cond_0

    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v2

    if-nez v2, :cond_1

    .line 3682
    :cond_0
    :goto_0
    return-void

    .line 3651
    :cond_1
    const/4 v8, 0x0

    .line 3655
    .local v8, c:Landroid/database/Cursor;
    :try_start_0
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v2

    sget-object v3, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    const/4 v4, 0x1

    new-array v4, v4, [Ljava/lang/String;

    const/4 v5, 0x0

    const-string v6, "min(abs(_uid)) as _minuid"

    aput-object v6, v4, v5

    sget-object v5, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v6, "_mailboxId = \'%d\' AND _account = \'%d\'"

    const/4 v7, 0x2

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v14, 0x0

    move-object/from16 v0, p0

    iget-object v15, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-wide v15, v15, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-static/range {v15 .. v16}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v15

    aput-object v15, v7, v14

    const/4 v14, 0x1

    move-object/from16 v0, p0

    iget-object v15, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v15}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v15

    invoke-static/range {v15 .. v16}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v15

    aput-object v15, v7, v14

    invoke-static {v5, v6, v7}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v5

    const/4 v6, 0x0

    const/4 v7, 0x0

    invoke-interface/range {v2 .. v7}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result-object v8

    .line 3661
    :goto_1
    const/4 v12, 0x0

    .line 3664
    .local v12, minUid:Ljava/lang/String;
    invoke-interface {v8}, Landroid/database/Cursor;->moveToNext()Z

    move-result v2

    if-eqz v2, :cond_2

    .line 3665
    const-string v2, "_minuid"

    invoke-interface {v8, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    invoke-interface {v8, v2}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v2

    invoke-static {v2, v3}, Ljava/lang/String;->valueOf(J)Ljava/lang/String;

    move-result-object v12

    .line 3666
    move-object/from16 v0, p1

    invoke-interface {v0, v12}, Ljava/util/List;->indexOf(Ljava/lang/Object;)I

    move-result v11

    .line 3667
    .local v11, index:I
    const/4 v2, -0x1

    if-eq v11, v2, :cond_2

    .line 3668
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v2

    add-int/lit8 v10, v2, -0x1

    .local v10, i:I
    :goto_2
    if-lt v10, v11, :cond_2

    .line 3669
    move-object/from16 v0, p1

    invoke-interface {v0, v10}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 3668
    add-int/lit8 v10, v10, -0x1

    goto :goto_2

    .line 3657
    .end local v10           #i:I
    .end local v11           #index:I
    .end local v12           #minUid:Ljava/lang/String;
    :catch_0
    move-exception v9

    .line 3658
    .local v9, e:Landroid/os/RemoteException;
    invoke-virtual {v9}, Landroid/os/RemoteException;->printStackTrace()V

    goto :goto_1

    .line 3673
    .end local v9           #e:Landroid/os/RemoteException;
    .restart local v12       #minUid:Ljava/lang/String;
    :cond_2
    invoke-interface {v8}, Landroid/database/Cursor;->close()V

    .line 3676
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v2

    add-int/lit8 v2, v2, -0x1

    add-int/lit8 v10, v2, -0xa

    .restart local v10       #i:I
    :goto_3
    if-ltz v10, :cond_3

    .line 3677
    move-object/from16 v0, p1

    invoke-interface {v0, v10}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 3676
    add-int/lit8 v10, v10, -0x1

    goto :goto_3

    .line 3680
    :cond_3
    const/4 v2, 0x0

    move-object/from16 v0, p0

    invoke-direct {v0, v2}, Lcom/htc/android/mail/server/ImapServer;->getPendingFetchMailMap(Ljava/util/HashMap;)Ljava/util/HashMap;

    move-result-object v13

    .line 3681
    .local v13, pendingFetchMailMap:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Ljava/lang/Object;>;"
    const/4 v2, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    invoke-direct {v0, v1, v13, v2}, Lcom/htc/android/mail/server/ImapServer;->insertPendingFetchMailRequest(Ljava/util/List;Ljava/util/HashMap;Ljava/util/HashMap;)V

    goto/16 :goto_0
.end method

.method private pruneFetchRefreshList(Ljava/util/List;)Ljava/util/List;
    .locals 38
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Ljava/lang/String;",
            ">;)",
            "Ljava/util/List",
            "<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .prologue
    .line 3444
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    if-nez p1, :cond_1

    .line 3445
    const/16 v32, 0x0

    .line 3631
    :cond_0
    :goto_0
    return-object v32

    .line 3448
    :cond_1
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v3

    .line 3450
    .local v3, cp:Landroid/content/IContentProvider;
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v4

    if-nez v4, :cond_3

    .line 3453
    :try_start_0
    sget-object v4, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v5, "_account = \'%d\' AND _mailboxId = \'%d\' AND _uid is not null"

    const/4 v7, 0x2

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v36, v0

    invoke-virtual/range {v36 .. v36}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v36

    invoke-static/range {v36 .. v37}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v36

    aput-object v36, v7, v8

    const/4 v8, 0x1

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    move-object/from16 v36, v0

    move-object/from16 v0, v36

    iget-wide v0, v0, Lcom/htc/android/mail/Mailbox;->id:J

    move-wide/from16 v36, v0

    invoke-static/range {v36 .. v37}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v36

    aput-object v36, v7, v8

    invoke-static {v4, v5, v7}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v6

    .line 3454
    .local v6, where:Ljava/lang/String;
    sget-object v4, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    const/4 v5, 0x0

    invoke-interface {v3, v4, v6, v5}, Landroid/content/IContentProvider;->delete(Landroid/net/Uri;Ljava/lang/String;[Ljava/lang/String;)I

    .line 3457
    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/Server;->mWeakHandler:Ljava/lang/ref/WeakReference;

    if-eqz v4, :cond_2

    .line 3458
    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/Server;->mWeakHandler:Ljava/lang/ref/WeakReference;

    invoke-virtual {v4}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Landroid/os/Handler;

    .line 3459
    .local v14, handler:Landroid/os/Handler;
    if-eqz v14, :cond_2

    .line 3460
    const/16 v4, 0xc

    invoke-virtual {v14, v4}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v4

    invoke-virtual {v4}, Landroid/os/Message;->sendToTarget()V

    .line 3464
    .end local v14           #handler:Landroid/os/Handler;
    :cond_2
    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    move-object/from16 v0, p0

    invoke-virtual {v0, v4}, Lcom/htc/android/mail/server/ImapServer;->clearPendingFetchMailRequest(Lcom/htc/android/mail/Mailbox;)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 3468
    .end local v6           #where:Ljava/lang/String;
    :goto_1
    const/16 v32, 0x0

    goto :goto_0

    .line 3465
    :catch_0
    move-exception v12

    .line 3466
    .local v12, e:Landroid/os/RemoteException;
    const-string v4, "ImapServer"

    const-string v5, "delete all message fail"

    invoke-static {v4, v5, v12}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_1

    .line 3473
    .end local v12           #e:Landroid/os/RemoteException;
    :cond_3
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v17

    .line 3475
    .local v17, listSize:I
    new-instance v33, Ljava/util/HashMap;

    invoke-direct/range {v33 .. v33}, Ljava/util/HashMap;-><init>()V

    .line 3477
    .local v33, uidMap:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Ljava/lang/Integer;>;"
    new-instance v29, Ljava/lang/Integer;

    const/4 v4, 0x1

    move-object/from16 v0, v29

    invoke-direct {v0, v4}, Ljava/lang/Integer;-><init>(I)V

    .line 3478
    .local v29, synInt:Ljava/lang/Integer;
    new-instance v23, Ljava/lang/Integer;

    const/4 v4, 0x0

    move-object/from16 v0, v23

    invoke-direct {v0, v4}, Ljava/lang/Integer;-><init>(I)V

    .line 3479
    .local v23, notSynInt:Ljava/lang/Integer;
    new-instance v11, Ljava/lang/Integer;

    const/4 v4, 0x2

    invoke-direct {v11, v4}, Ljava/lang/Integer;-><init>(I)V

    .line 3481
    .local v11, delInt:Ljava/lang/Integer;
    const/4 v15, 0x0

    .local v15, i:I
    :goto_2
    move/from16 v0, v17

    if-ge v15, v0, :cond_4

    .line 3482
    move-object/from16 v0, p1

    invoke-interface {v0, v15}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v4

    const/4 v5, 0x0

    move-object/from16 v0, v33

    invoke-virtual {v0, v4, v5}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 3481
    add-int/lit8 v15, v15, 0x1

    goto :goto_2

    .line 3485
    :cond_4
    move-object/from16 v0, p0

    move-object/from16 v1, v33

    invoke-direct {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->getPendingFetchMailMap(Ljava/util/HashMap;)Ljava/util/HashMap;

    move-result-object v25

    .line 3486
    .local v25, pendingFetchMailMap:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Ljava/lang/Object;>;"
    new-instance v26, Ljava/util/HashMap;

    invoke-direct/range {v26 .. v26}, Ljava/util/HashMap;-><init>()V

    .line 3488
    .local v26, pendingFetchMailMapRemoved:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Ljava/lang/Object;>;"
    const/4 v9, 0x0

    .line 3490
    .local v9, c:Landroid/database/Cursor;
    new-instance v20, Ljava/util/ArrayList;

    invoke-direct/range {v20 .. v20}, Ljava/util/ArrayList;-><init>()V

    .line 3494
    .local v20, messageIdList:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    :try_start_1
    sget-object v4, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v5, "_account = \'%d\' AND _mailboxId = \'%d\'"

    const/4 v7, 0x2

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v36, v0

    invoke-virtual/range {v36 .. v36}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v36

    invoke-static/range {v36 .. v37}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v36

    aput-object v36, v7, v8

    const/4 v8, 0x1

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    move-object/from16 v36, v0

    move-object/from16 v0, v36

    iget-wide v0, v0, Lcom/htc/android/mail/Mailbox;->id:J

    move-wide/from16 v36, v0

    invoke-static/range {v36 .. v37}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v36

    aput-object v36, v7, v8

    invoke-static {v4, v5, v7}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v6

    .line 3495
    .restart local v6       #where:Ljava/lang/String;
    sget-object v4, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    const/4 v5, 0x4

    new-array v5, v5, [Ljava/lang/String;

    const/4 v7, 0x0

    const-string v8, "_id"

    aput-object v8, v5, v7

    const/4 v7, 0x1

    const-string v8, "_uid"

    aput-object v8, v5, v7

    const/4 v7, 0x2

    const-string v8, "_sync"

    aput-object v8, v5, v7

    const/4 v7, 0x3

    const-string v8, "_del"

    aput-object v8, v5, v7

    const/4 v7, 0x0

    const/4 v8, 0x0

    invoke-interface/range {v3 .. v8}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v9

    .line 3496
    if-eqz v9, :cond_12

    .line 3500
    :cond_5
    :goto_3
    invoke-interface {v9}, Landroid/database/Cursor;->moveToNext()Z

    move-result v4

    if-eqz v4, :cond_12

    .line 3501
    const-string v4, "_id"

    invoke-interface {v9, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    invoke-interface {v9, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v18

    .line 3502
    .local v18, messageId:J
    const-string v4, "_uid"

    invoke-interface {v9, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    invoke-interface {v9, v4}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v31

    .line 3503
    .local v31, uid:Ljava/lang/String;
    const-string v4, "_sync"

    invoke-interface {v9, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    invoke-interface {v9, v4}, Landroid/database/Cursor;->getInt(I)I

    move-result v30

    .line 3504
    .local v30, sync:I
    const-string v4, "_del"

    invoke-interface {v9, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    invoke-interface {v9, v4}, Landroid/database/Cursor;->getInt(I)I

    move-result v10

    .line 3505
    .local v10, del:I
    if-eqz v31, :cond_5

    const-string v4, ""

    move-object/from16 v0, v31

    invoke-virtual {v4, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-nez v4, :cond_5

    .line 3509
    move-object/from16 v0, v33

    move-object/from16 v1, v31

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->containsKey(Ljava/lang/Object;)Z

    move-result v4

    if-nez v4, :cond_b

    .line 3510
    invoke-static/range {v18 .. v19}, Ljava/lang/String;->valueOf(J)Ljava/lang/String;

    move-result-object v4

    move-object/from16 v0, v20

    invoke-interface {v0, v4}, Ljava/util/List;->add(Ljava/lang/Object;)Z
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1

    goto :goto_3

    .line 3526
    .end local v6           #where:Ljava/lang/String;
    .end local v10           #del:I
    .end local v18           #messageId:J
    .end local v30           #sync:I
    .end local v31           #uid:Ljava/lang/String;
    :catch_1
    move-exception v12

    .line 3527
    .restart local v12       #e:Landroid/os/RemoteException;
    :try_start_2
    const-string v4, "ImapServer"

    const-string v5, "query imessge fail"

    invoke-static {v4, v5, v12}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 3529
    if-eqz v9, :cond_6

    invoke-interface {v9}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_6

    .line 3530
    .end local v12           #e:Landroid/os/RemoteException;
    :goto_4
    invoke-interface {v9}, Landroid/database/Cursor;->close()V

    .line 3536
    :cond_6
    invoke-interface/range {v20 .. v20}, Ljava/util/List;->size()I

    move-result v4

    if-lez v4, :cond_7

    .line 3538
    :try_start_3
    const-string v4, ","

    const/4 v5, 0x1

    move-object/from16 v0, p0

    move-object/from16 v1, v20

    invoke-virtual {v0, v1, v4, v5}, Lcom/htc/android/mail/server/ImapServer;->combine(Ljava/util/List;Ljava/lang/String;Z)Ljava/lang/String;

    move-result-object v21

    .line 3539
    .local v21, messageSeq:Ljava/lang/String;
    sget-object v4, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v5, "_id in (%s)"

    const/4 v7, 0x1

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    aput-object v21, v7, v8

    invoke-static {v4, v5, v7}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v6

    .line 3540
    .restart local v6       #where:Ljava/lang/String;
    new-instance v35, Landroid/content/ContentValues;

    invoke-direct/range {v35 .. v35}, Landroid/content/ContentValues;-><init>()V

    .line 3541
    .local v35, values:Landroid/content/ContentValues;
    const-string v4, "_del"

    const/4 v5, 0x2

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    move-object/from16 v0, v35

    invoke-virtual {v0, v4, v5}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 3542
    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v4}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v4

    move-object/from16 v0, p0

    iget-object v7, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-wide v7, v7, Lcom/htc/android/mail/Mailbox;->id:J

    move-object/from16 v0, p0

    invoke-virtual {v0, v4, v5, v7, v8}, Lcom/htc/android/mail/server/ImapServer;->getSummariesUri(JJ)Landroid/net/Uri;

    move-result-object v4

    const/4 v5, 0x0

    move-object/from16 v0, v35

    invoke-interface {v3, v4, v0, v6, v5}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I
    :try_end_3
    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_2

    .line 3548
    .end local v6           #where:Ljava/lang/String;
    .end local v21           #messageSeq:Ljava/lang/String;
    .end local v35           #values:Landroid/content/ContentValues;
    :cond_7
    :goto_5
    new-instance v32, Ljava/util/ArrayList;

    invoke-direct/range {v32 .. v32}, Ljava/util/ArrayList;-><init>()V

    .line 3551
    .local v32, uidListForFetch:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    const/16 v24, 0x0

    .line 3553
    .local v24, num:I
    const/16 v28, 0x0

    .line 3556
    .local v28, reachMaxUid:Z
    new-instance v22, Ljava/util/ArrayList;

    invoke-direct/range {v22 .. v22}, Ljava/util/ArrayList;-><init>()V

    .line 3558
    .local v22, notSycList:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/String;>;"
    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v0, p0

    iget-object v5, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v4, v5}, Lcom/htc/android/mail/Account;->getFetchMailNum(Landroid/content/Context;)I

    move-result v13

    .line 3559
    .local v13, fetchMailNum:I
    add-int/lit8 v15, v17, -0x1

    :goto_6
    if-ltz v15, :cond_f

    move/from16 v0, v24

    if-ge v0, v13, :cond_f

    .line 3560
    move-object/from16 v0, p1

    invoke-interface {v0, v15}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v31

    check-cast v31, Ljava/lang/String;

    .line 3561
    .restart local v31       #uid:Ljava/lang/String;
    move-object/from16 v0, v33

    move-object/from16 v1, v31

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v30

    check-cast v30, Ljava/lang/Integer;

    .line 3562
    .local v30, sync:Ljava/lang/Integer;
    add-int/lit8 v24, v24, 0x1

    .line 3563
    if-nez v30, :cond_9

    .line 3565
    move-object/from16 v0, v25

    move-object/from16 v1, v31

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->containsKey(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_8

    .line 3566
    move-object/from16 v0, v25

    move-object/from16 v1, v31

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 3567
    const/4 v4, 0x0

    move-object/from16 v0, v26

    move-object/from16 v1, v31

    invoke-virtual {v0, v1, v4}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 3569
    :cond_8
    move-object/from16 v0, v32

    move-object/from16 v1, v31

    invoke-interface {v0, v1}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 3572
    :cond_9
    if-eqz v30, :cond_a

    .line 3573
    invoke-virtual/range {v30 .. v30}, Ljava/lang/Integer;->intValue()I

    move-result v4

    const/4 v5, 0x1

    if-ne v4, v5, :cond_d

    .line 3574
    if-nez v28, :cond_a

    .line 3575
    const/16 v28, 0x1

    .line 3559
    :cond_a
    :goto_7
    add-int/lit8 v15, v15, -0x1

    goto :goto_6

    .line 3512
    .end local v13           #fetchMailNum:I
    .end local v22           #notSycList:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/String;>;"
    .end local v24           #num:I
    .end local v28           #reachMaxUid:Z
    .end local v32           #uidListForFetch:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    .restart local v6       #where:Ljava/lang/String;
    .restart local v10       #del:I
    .restart local v18       #messageId:J
    .local v30, sync:I
    :cond_b
    packed-switch v30, :pswitch_data_0

    .line 3520
    :goto_8
    const/4 v4, 0x1

    if-ne v10, v4, :cond_5

    .line 3521
    :try_start_4
    move-object/from16 v0, v33

    move-object/from16 v1, v31

    invoke-virtual {v0, v1, v11}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_1

    goto/16 :goto_3

    .line 3529
    .end local v6           #where:Ljava/lang/String;
    .end local v10           #del:I
    .end local v18           #messageId:J
    .end local v30           #sync:I
    .end local v31           #uid:Ljava/lang/String;
    :catchall_0
    move-exception v4

    if-eqz v9, :cond_c

    invoke-interface {v9}, Landroid/database/Cursor;->isClosed()Z

    move-result v5

    if-nez v5, :cond_c

    .line 3530
    invoke-interface {v9}, Landroid/database/Cursor;->close()V

    .line 3529
    :cond_c
    throw v4

    .line 3514
    .restart local v6       #where:Ljava/lang/String;
    .restart local v10       #del:I
    .restart local v18       #messageId:J
    .restart local v30       #sync:I
    .restart local v31       #uid:Ljava/lang/String;
    :pswitch_0
    :try_start_5
    move-object/from16 v0, v33

    move-object/from16 v1, v31

    move-object/from16 v2, v23

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    goto :goto_8

    .line 3517
    :pswitch_1
    move-object/from16 v0, v33

    move-object/from16 v1, v31

    move-object/from16 v2, v29

    invoke-virtual {v0, v1, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_5 .. :try_end_5} :catch_1

    goto :goto_8

    .line 3543
    .end local v6           #where:Ljava/lang/String;
    .end local v10           #del:I
    .end local v18           #messageId:J
    .end local v30           #sync:I
    .end local v31           #uid:Ljava/lang/String;
    :catch_2
    move-exception v12

    .line 3544
    .restart local v12       #e:Landroid/os/RemoteException;
    const-string v4, "ImapServer"

    const-string v5, "delete message fail"

    invoke-static {v4, v5, v12}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto/16 :goto_5

    .line 3577
    .end local v12           #e:Landroid/os/RemoteException;
    .restart local v13       #fetchMailNum:I
    .restart local v22       #notSycList:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/String;>;"
    .restart local v24       #num:I
    .restart local v28       #reachMaxUid:Z
    .local v30, sync:Ljava/lang/Integer;
    .restart local v31       #uid:Ljava/lang/String;
    .restart local v32       #uidListForFetch:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    :cond_d
    invoke-virtual/range {v30 .. v30}, Ljava/lang/Integer;->intValue()I

    move-result v4

    if-nez v4, :cond_e

    .line 3578
    move-object/from16 v0, v22

    move-object/from16 v1, v31

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_7

    .line 3579
    :cond_e
    invoke-virtual/range {v30 .. v30}, Ljava/lang/Integer;->intValue()I

    move-result v4

    const/4 v5, 0x2

    if-ne v4, v5, :cond_a

    .line 3580
    add-int/lit8 v24, v24, -0x1

    goto :goto_7

    .line 3585
    .end local v30           #sync:Ljava/lang/Integer;
    .end local v31           #uid:Ljava/lang/String;
    :cond_f
    if-ltz v15, :cond_10

    .line 3586
    if-nez v28, :cond_10

    .line 3587
    move-object/from16 v0, p1

    invoke-interface {v0, v15}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v31

    check-cast v31, Ljava/lang/String;

    .line 3588
    .restart local v31       #uid:Ljava/lang/String;
    move-object/from16 v0, v33

    move-object/from16 v1, v31

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    if-nez v4, :cond_10

    .line 3589
    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    move-object/from16 v0, p0

    invoke-virtual {v0, v4}, Lcom/htc/android/mail/server/ImapServer;->clearPendingFetchMailRequest(Lcom/htc/android/mail/Mailbox;)V

    .line 3590
    invoke-virtual/range {v25 .. v25}, Ljava/util/HashMap;->clear()V

    .line 3591
    invoke-virtual/range {v22 .. v22}, Ljava/util/ArrayList;->size()I

    move-result v4

    if-lez v4, :cond_11

    .line 3593
    :try_start_6
    const-string v4, ","

    const/4 v5, 0x1

    move-object/from16 v0, p0

    move-object/from16 v1, v22

    invoke-virtual {v0, v1, v4, v5}, Lcom/htc/android/mail/server/ImapServer;->combine(Ljava/util/List;Ljava/lang/String;Z)Ljava/lang/String;

    move-result-object v34

    .line 3594
    .local v34, uidSeq:Ljava/lang/String;
    sget-object v4, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v5, "_account = \'%d\' AND _mailboxId = \'%d\' AND _uid not in (%s)"

    const/4 v7, 0x3

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v36, v0

    invoke-virtual/range {v36 .. v36}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v36

    invoke-static/range {v36 .. v37}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v36

    aput-object v36, v7, v8

    const/4 v8, 0x1

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    move-object/from16 v36, v0

    move-object/from16 v0, v36

    iget-wide v0, v0, Lcom/htc/android/mail/Mailbox;->id:J

    move-wide/from16 v36, v0

    invoke-static/range {v36 .. v37}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v36

    aput-object v36, v7, v8

    const/4 v8, 0x2

    aput-object v34, v7, v8

    invoke-static {v4, v5, v7}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v6

    .line 3595
    .restart local v6       #where:Ljava/lang/String;
    sget-object v4, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    const/4 v5, 0x0

    invoke-interface {v3, v4, v6, v5}, Landroid/content/IContentProvider;->delete(Landroid/net/Uri;Ljava/lang/String;[Ljava/lang/String;)I

    .line 3598
    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/Server;->mWeakHandler:Ljava/lang/ref/WeakReference;

    if-eqz v4, :cond_10

    .line 3599
    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/Server;->mWeakHandler:Ljava/lang/ref/WeakReference;

    invoke-virtual {v4}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Landroid/os/Handler;

    .line 3600
    .restart local v14       #handler:Landroid/os/Handler;
    if-eqz v14, :cond_10

    .line 3601
    const/16 v4, 0xc

    invoke-virtual {v14, v4}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v4

    invoke-virtual {v4}, Landroid/os/Message;->sendToTarget()V
    :try_end_6
    .catch Landroid/os/RemoteException; {:try_start_6 .. :try_end_6} :catch_3

    .line 3627
    .end local v6           #where:Ljava/lang/String;
    .end local v14           #handler:Landroid/os/Handler;
    .end local v31           #uid:Ljava/lang/String;
    .end local v34           #uidSeq:Ljava/lang/String;
    :cond_10
    :goto_9
    invoke-virtual/range {v25 .. v25}, Ljava/util/HashMap;->keySet()Ljava/util/Set;

    move-result-object v4

    invoke-interface {v4}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v16

    .local v16, i$:Ljava/util/Iterator;
    :goto_a
    invoke-interface/range {v16 .. v16}, Ljava/util/Iterator;->hasNext()Z

    move-result v4

    if-eqz v4, :cond_0

    invoke-interface/range {v16 .. v16}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v27

    check-cast v27, Ljava/lang/String;

    .line 3628
    .local v27, pendingUid:Ljava/lang/String;
    move-object/from16 v0, v32

    move-object/from16 v1, v27

    invoke-interface {v0, v1}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    goto :goto_a

    .line 3605
    .end local v16           #i$:Ljava/util/Iterator;
    .end local v27           #pendingUid:Ljava/lang/String;
    .restart local v31       #uid:Ljava/lang/String;
    :catch_3
    move-exception v12

    .line 3606
    .restart local v12       #e:Landroid/os/RemoteException;
    const-string v4, "ImapServer"

    const-string v5, "delete message fail"

    invoke-static {v4, v5, v12}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_9

    .line 3609
    .end local v12           #e:Landroid/os/RemoteException;
    :cond_11
    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v4}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v4

    move-object/from16 v0, p0

    iget-object v7, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-wide v7, v7, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-static {v4, v5, v7, v8}, Lcom/htc/android/mail/MailProvider;->deleteMessagesByMailbox(JJ)V

    .line 3612
    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/Server;->mWeakHandler:Ljava/lang/ref/WeakReference;

    if-eqz v4, :cond_10

    .line 3613
    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/Server;->mWeakHandler:Ljava/lang/ref/WeakReference;

    invoke-virtual {v4}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Landroid/os/Handler;

    .line 3614
    .restart local v14       #handler:Landroid/os/Handler;
    if-eqz v14, :cond_10

    .line 3615
    const/16 v4, 0xc

    invoke-virtual {v14, v4}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v4

    invoke-virtual {v4}, Landroid/os/Message;->sendToTarget()V

    goto :goto_9

    .line 3529
    .end local v13           #fetchMailNum:I
    .end local v14           #handler:Landroid/os/Handler;
    .end local v22           #notSycList:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/String;>;"
    .end local v24           #num:I
    .end local v28           #reachMaxUid:Z
    .end local v31           #uid:Ljava/lang/String;
    .end local v32           #uidListForFetch:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    .restart local v6       #where:Ljava/lang/String;
    :cond_12
    if-eqz v9, :cond_6

    invoke-interface {v9}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_6

    goto/16 :goto_4

    .line 3512
    nop

    :pswitch_data_0
    .packed-switch 0x0
        :pswitch_0
        :pswitch_1
    .end packed-switch
.end method

.method private pruneFetchRefreshListByDate(Ljava/util/Map;)Ljava/util/List;
    .locals 21
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/Map",
            "<",
            "Ljava/lang/String;",
            "Ljava/lang/Byte;",
            ">;)",
            "Ljava/util/List",
            "<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .prologue
    .line 3249
    .local p1, map:Ljava/util/Map;,"Ljava/util/Map<Ljava/lang/String;Ljava/lang/Byte;>;"
    if-nez p1, :cond_0

    .line 3250
    const/4 v11, 0x0

    .line 3338
    :goto_0
    return-object v11

    .line 3253
    :cond_0
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v2

    .line 3255
    .local v2, cp:Landroid/content/IContentProvider;
    invoke-interface/range {p1 .. p1}, Ljava/util/Map;->size()I

    move-result v3

    if-nez v3, :cond_2

    .line 3258
    :try_start_0
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "_account = \'%d\' AND _mailboxId = \'%d\' AND _uid is not null"

    const/4 v6, 0x2

    new-array v6, v6, [Ljava/lang/Object;

    const/4 v7, 0x0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v19, v0

    invoke-virtual/range {v19 .. v19}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v19

    invoke-static/range {v19 .. v20}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v19

    aput-object v19, v6, v7

    const/4 v7, 0x1

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    iget-wide v0, v0, Lcom/htc/android/mail/Mailbox;->id:J

    move-wide/from16 v19, v0

    invoke-static/range {v19 .. v20}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v19

    aput-object v19, v6, v7

    invoke-static {v3, v4, v6}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v5

    .line 3259
    .local v5, where:Ljava/lang/String;
    sget-object v3, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    const/4 v4, 0x0

    invoke-interface {v2, v3, v5, v4}, Landroid/content/IContentProvider;->delete(Landroid/net/Uri;Ljava/lang/String;[Ljava/lang/String;)I

    .line 3262
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/Server;->mWeakHandler:Ljava/lang/ref/WeakReference;

    if-eqz v3, :cond_1

    .line 3263
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/Server;->mWeakHandler:Ljava/lang/ref/WeakReference;

    invoke-virtual {v3}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Landroid/os/Handler;

    .line 3264
    .local v10, handler:Landroid/os/Handler;
    if-eqz v10, :cond_1

    .line 3265
    const/16 v3, 0xc

    invoke-virtual {v10, v3}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v3

    invoke-virtual {v3}, Landroid/os/Message;->sendToTarget()V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 3272
    .end local v5           #where:Ljava/lang/String;
    .end local v10           #handler:Landroid/os/Handler;
    :cond_1
    :goto_1
    const/4 v11, 0x0

    goto :goto_0

    .line 3269
    :catch_0
    move-exception v9

    .line 3270
    .local v9, e:Landroid/os/RemoteException;
    const-string v3, "ImapServer"

    const-string v4, "delete all message fail"

    invoke-static {v3, v4, v9}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_1

    .line 3275
    .end local v9           #e:Landroid/os/RemoteException;
    :cond_2
    const/4 v8, 0x0

    .line 3277
    .local v8, c:Landroid/database/Cursor;
    new-instance v14, Ljava/util/ArrayList;

    invoke-direct {v14}, Ljava/util/ArrayList;-><init>()V

    .line 3281
    .local v14, messageIdList:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    :try_start_1
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "_account = \'%d\' AND _mailboxId = \'%d\'"

    const/4 v6, 0x2

    new-array v6, v6, [Ljava/lang/Object;

    const/4 v7, 0x0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v19, v0

    invoke-virtual/range {v19 .. v19}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v19

    invoke-static/range {v19 .. v20}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v19

    aput-object v19, v6, v7

    const/4 v7, 0x1

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    iget-wide v0, v0, Lcom/htc/android/mail/Mailbox;->id:J

    move-wide/from16 v19, v0

    invoke-static/range {v19 .. v20}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v19

    aput-object v19, v6, v7

    invoke-static {v3, v4, v6}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v5

    .line 3282
    .restart local v5       #where:Ljava/lang/String;
    sget-object v3, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    const/4 v4, 0x2

    new-array v4, v4, [Ljava/lang/String;

    const/4 v6, 0x0

    const-string v7, "_id"

    aput-object v7, v4, v6

    const/4 v6, 0x1

    const-string v7, "_uid"

    aput-object v7, v4, v6

    const/4 v6, 0x0

    const/4 v7, 0x0

    invoke-interface/range {v2 .. v7}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v8

    .line 3283
    if-eqz v8, :cond_a

    .line 3286
    :cond_3
    :goto_2
    invoke-interface {v8}, Landroid/database/Cursor;->moveToNext()Z

    move-result v3

    if-eqz v3, :cond_a

    .line 3287
    const-string v3, "_id"

    invoke-interface {v8, v3}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v3

    invoke-interface {v8, v3}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v12

    .line 3288
    .local v12, messageId:J
    const-string v3, "_uid"

    invoke-interface {v8, v3}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v3

    invoke-interface {v8, v3}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v16

    .line 3289
    .local v16, uid:Ljava/lang/String;
    if-eqz v16, :cond_3

    const-string v3, ""

    move-object/from16 v0, v16

    invoke-virtual {v3, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_3

    .line 3292
    move-object/from16 v0, p1

    move-object/from16 v1, v16

    invoke-interface {v0, v1}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    if-nez v3, :cond_7

    .line 3293
    invoke-static {v12, v13}, Ljava/lang/String;->valueOf(J)Ljava/lang/String;

    move-result-object v3

    invoke-interface {v14, v3}, Ljava/util/List;->add(Ljava/lang/Object;)Z
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1

    goto :goto_2

    .line 3299
    .end local v5           #where:Ljava/lang/String;
    .end local v12           #messageId:J
    .end local v16           #uid:Ljava/lang/String;
    :catch_1
    move-exception v9

    .line 3300
    .restart local v9       #e:Landroid/os/RemoteException;
    :try_start_2
    const-string v3, "ImapServer"

    const-string v4, "query imessge fail"

    invoke-static {v3, v4, v9}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 3302
    if-eqz v8, :cond_4

    invoke-interface {v8}, Landroid/database/Cursor;->isClosed()Z

    move-result v3

    if-nez v3, :cond_4

    .line 3303
    .end local v9           #e:Landroid/os/RemoteException;
    :goto_3
    invoke-interface {v8}, Landroid/database/Cursor;->close()V

    .line 3309
    :cond_4
    invoke-interface {v14}, Ljava/util/List;->size()I

    move-result v3

    if-lez v3, :cond_5

    .line 3311
    :try_start_3
    const-string v3, ","

    const/4 v4, 0x1

    move-object/from16 v0, p0

    invoke-virtual {v0, v14, v3, v4}, Lcom/htc/android/mail/server/ImapServer;->combine(Ljava/util/List;Ljava/lang/String;Z)Ljava/lang/String;

    move-result-object v15

    .line 3312
    .local v15, messageSeq:Ljava/lang/String;
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "_id in (%s)"

    const/4 v6, 0x1

    new-array v6, v6, [Ljava/lang/Object;

    const/4 v7, 0x0

    aput-object v15, v6, v7

    invoke-static {v3, v4, v6}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v5

    .line 3313
    .restart local v5       #where:Ljava/lang/String;
    new-instance v18, Landroid/content/ContentValues;

    invoke-direct/range {v18 .. v18}, Landroid/content/ContentValues;-><init>()V

    .line 3314
    .local v18, values:Landroid/content/ContentValues;
    const-string v3, "_del"

    const/4 v4, 0x2

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    move-object/from16 v0, v18

    invoke-virtual {v0, v3, v4}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 3315
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v3}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v3

    move-object/from16 v0, p0

    iget-object v6, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-wide v6, v6, Lcom/htc/android/mail/Mailbox;->id:J

    move-object/from16 v0, p0

    invoke-virtual {v0, v3, v4, v6, v7}, Lcom/htc/android/mail/server/ImapServer;->getSummariesUri(JJ)Landroid/net/Uri;

    move-result-object v3

    const/4 v4, 0x0

    move-object/from16 v0, v18

    invoke-interface {v2, v3, v0, v5, v4}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I
    :try_end_3
    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_2

    .line 3321
    .end local v5           #where:Ljava/lang/String;
    .end local v15           #messageSeq:Ljava/lang/String;
    .end local v18           #values:Landroid/content/ContentValues;
    :cond_5
    :goto_4
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v3, v4}, Lcom/htc/android/mail/Account;->getFetchMailType(Landroid/content/Context;)I

    move-result v3

    const/4 v4, 0x1

    if-ne v3, v4, :cond_6

    move-object/from16 v0, p0

    iget-boolean v3, v0, Lcom/htc/android/mail/server/ImapServer;->mIsNotSupportSearch:Z

    if-eqz v3, :cond_6

    .line 3323
    :try_start_4
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "_account = \'%d\' AND _mailboxId = \'%d\' AND _internaldate < \'%d\'"

    const/4 v6, 0x3

    new-array v6, v6, [Ljava/lang/Object;

    const/4 v7, 0x0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v19, v0

    invoke-virtual/range {v19 .. v19}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v19

    invoke-static/range {v19 .. v20}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v19

    aput-object v19, v6, v7

    const/4 v7, 0x1

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    move-object/from16 v19, v0

    move-object/from16 v0, v19

    iget-wide v0, v0, Lcom/htc/android/mail/Mailbox;->id:J

    move-wide/from16 v19, v0

    invoke-static/range {v19 .. v20}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v19

    aput-object v19, v6, v7

    const/4 v7, 0x2

    move-object/from16 v0, p0

    iget-wide v0, v0, Lcom/htc/android/mail/server/ImapServer;->mBeginningTimeMillis:J

    move-wide/from16 v19, v0

    invoke-static/range {v19 .. v20}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v19

    aput-object v19, v6, v7

    invoke-static {v3, v4, v6}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v5

    .line 3324
    .restart local v5       #where:Ljava/lang/String;
    new-instance v18, Landroid/content/ContentValues;

    invoke-direct/range {v18 .. v18}, Landroid/content/ContentValues;-><init>()V

    .line 3325
    .restart local v18       #values:Landroid/content/ContentValues;
    const-string v3, "_del"

    const/4 v4, 0x2

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    move-object/from16 v0, v18

    invoke-virtual {v0, v3, v4}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 3326
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v3}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v3

    move-object/from16 v0, p0

    iget-object v6, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-wide v6, v6, Lcom/htc/android/mail/Mailbox;->id:J

    move-object/from16 v0, p0

    invoke-virtual {v0, v3, v4, v6, v7}, Lcom/htc/android/mail/server/ImapServer;->getSummariesUri(JJ)Landroid/net/Uri;

    move-result-object v3

    const/4 v4, 0x0

    move-object/from16 v0, v18

    invoke-interface {v2, v3, v0, v5, v4}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I
    :try_end_4
    .catch Landroid/os/RemoteException; {:try_start_4 .. :try_end_4} :catch_3

    .line 3332
    .end local v5           #where:Ljava/lang/String;
    .end local v18           #values:Landroid/content/ContentValues;
    :cond_6
    :goto_5
    invoke-interface/range {p1 .. p1}, Ljava/util/Map;->size()I

    move-result v3

    if-nez v3, :cond_9

    .line 3333
    const/4 v11, 0x0

    goto/16 :goto_0

    .line 3295
    .restart local v5       #where:Ljava/lang/String;
    .restart local v12       #messageId:J
    .restart local v16       #uid:Ljava/lang/String;
    :cond_7
    :try_start_5
    move-object/from16 v0, p1

    move-object/from16 v1, v16

    invoke-interface {v0, v1}, Ljava/util/Map;->remove(Ljava/lang/Object;)Ljava/lang/Object;
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_5 .. :try_end_5} :catch_1

    goto/16 :goto_2

    .line 3302
    .end local v5           #where:Ljava/lang/String;
    .end local v12           #messageId:J
    .end local v16           #uid:Ljava/lang/String;
    :catchall_0
    move-exception v3

    if-eqz v8, :cond_8

    invoke-interface {v8}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_8

    .line 3303
    invoke-interface {v8}, Landroid/database/Cursor;->close()V

    .line 3302
    :cond_8
    throw v3

    .line 3316
    :catch_2
    move-exception v9

    .line 3317
    .restart local v9       #e:Landroid/os/RemoteException;
    const-string v3, "ImapServer"

    const-string v4, "delete message fail"

    invoke-static {v3, v4, v9}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto/16 :goto_4

    .line 3327
    .end local v9           #e:Landroid/os/RemoteException;
    :catch_3
    move-exception v9

    .line 3328
    .restart local v9       #e:Landroid/os/RemoteException;
    const-string v3, "ImapServer"

    const-string v4, "delete message fail"

    invoke-static {v3, v4, v9}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_5

    .line 3335
    .end local v9           #e:Landroid/os/RemoteException;
    :cond_9
    invoke-interface/range {p1 .. p1}, Ljava/util/Map;->keySet()Ljava/util/Set;

    move-result-object v3

    const/4 v4, 0x0

    new-array v4, v4, [Ljava/lang/String;

    invoke-interface {v3, v4}, Ljava/util/Set;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;

    move-result-object v17

    check-cast v17, [Ljava/lang/String;

    .line 3336
    .local v17, uidArray:[Ljava/lang/String;
    invoke-static/range {v17 .. v17}, Ljava/util/Arrays;->asList([Ljava/lang/Object;)Ljava/util/List;

    move-result-object v11

    .line 3337
    .local v11, list:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    new-instance v3, Lcom/htc/android/mail/server/ImapServer$StringComparator;

    move-object/from16 v0, p0

    invoke-direct {v3, v0}, Lcom/htc/android/mail/server/ImapServer$StringComparator;-><init>(Lcom/htc/android/mail/server/ImapServer;)V

    invoke-static {v11, v3}, Ljava/util/Collections;->sort(Ljava/util/List;Ljava/util/Comparator;)V

    goto/16 :goto_0

    .line 3302
    .end local v11           #list:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    .end local v17           #uidArray:[Ljava/lang/String;
    .restart local v5       #where:Ljava/lang/String;
    :cond_a
    if-eqz v8, :cond_4

    invoke-interface {v8}, Landroid/database/Cursor;->isClosed()Z

    move-result v3

    if-nez v3, :cond_4

    goto/16 :goto_3
.end method

.method private readProgressResponse(Ljava/lang/String;Lcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;Ljava/lang/String;)Ljava/util/List;
    .locals 6
    .parameter "tag"
    .parameter "controller"
    .parameter
    .parameter "fileReference"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "Lcom/htc/android/mail/AbsRequestController;",
            "Ljava/lang/ref/WeakReference",
            "<",
            "Landroid/os/Handler;",
            ">;",
            "Ljava/lang/String;",
            ")",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .line 503
    .local p3, weakHandler:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Landroid/os/Handler;>;"
    const/4 v2, 0x1

    move-object v0, p0

    move-object v1, p1

    move-object v3, p2

    move-object v4, p3

    move-object v5, p4

    invoke-direct/range {v0 .. v5}, Lcom/htc/android/mail/server/ImapServer;->readProgressResponse(Ljava/lang/String;ZLcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;Ljava/lang/String;)Ljava/util/List;

    move-result-object v0

    return-object v0
.end method

.method private readProgressResponse(Ljava/lang/String;ZLcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;Ljava/lang/String;)Ljava/util/List;
    .locals 17
    .parameter "tag"
    .parameter "saveResponse"
    .parameter "controller"
    .parameter
    .parameter "fileReference"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "Z",
            "Lcom/htc/android/mail/AbsRequestController;",
            "Ljava/lang/ref/WeakReference",
            "<",
            "Landroid/os/Handler;",
            ">;",
            "Ljava/lang/String;",
            ")",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .line 507
    .local p4, weakHandler:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Landroid/os/Handler;>;"
    new-instance v9, Ljava/util/ArrayList;

    invoke-direct {v9}, Ljava/util/ArrayList;-><init>()V

    .line 510
    .local v9, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    new-instance v4, Lcom/htc/android/mail/ByteString;

    new-instance v14, Ljava/lang/StringBuilder;

    invoke-direct {v14}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, p1

    invoke-virtual {v14, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    const-string v15, " "

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v14

    invoke-direct {v4, v14}, Lcom/htc/android/mail/ByteString;-><init>(Ljava/lang/String;)V

    .line 512
    .local v4, btag:Lcom/htc/android/mail/ByteString;
    const/4 v8, 0x0

    .line 513
    .local v8, line_num:I
    const/4 v2, 0x0

    .line 514
    .local v2, attachment_size:I
    const/4 v13, 0x0

    .line 515
    .local v13, read_count:I
    const/4 v12, 0x0

    .line 516
    .local v12, percentage:F
    const/4 v6, 0x0

    .line 517
    .local v6, current_percentage:I
    const/4 v5, 0x0

    .line 519
    .local v5, check_percentage:I
    :cond_0
    :goto_0
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->readLine()Lcom/htc/android/mail/ByteString;

    move-result-object v7

    .local v7, line:Lcom/htc/android/mail/ByteString;
    if-eqz v7, :cond_4

    .line 520
    if-nez v8, :cond_1

    .line 521
    invoke-static {}, Lcom/htc/android/mail/Regex;->getInstance()Lcom/htc/android/mail/Regex;

    move-result-object v14

    const/4 v15, 0x7

    invoke-virtual {v14, v15}, Lcom/htc/android/mail/Regex;->getPattern(I)Ljava/util/regex/Pattern;

    move-result-object v14

    invoke-virtual {v7}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v15

    invoke-virtual {v14, v15}, Ljava/util/regex/Pattern;->matcher(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;

    move-result-object v10

    .line 522
    .local v10, m:Ljava/util/regex/Matcher;
    invoke-virtual {v10}, Ljava/util/regex/Matcher;->find()Z

    move-result v14

    if-eqz v14, :cond_1

    .line 523
    const/4 v14, 0x2

    invoke-virtual {v10, v14}, Ljava/util/regex/Matcher;->group(I)Ljava/lang/String;

    move-result-object v14

    invoke-static {v14}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v14

    invoke-virtual {v14}, Ljava/lang/Integer;->intValue()I

    move-result v2

    .line 525
    .end local v10           #m:Ljava/util/regex/Matcher;
    :cond_1
    sget-boolean v14, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v14, :cond_2

    const-string v14, "ImapServer"

    invoke-virtual {v7}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v15

    invoke-static {v14, v15}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 526
    :cond_2
    if-eqz p2, :cond_3

    .line 527
    invoke-interface {v9, v7}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 528
    add-int/lit8 v8, v8, 0x1

    .line 531
    :cond_3
    invoke-virtual {v7}, Lcom/htc/android/mail/ByteString;->length()I

    move-result v14

    add-int/2addr v13, v14

    .line 535
    invoke-virtual {v7, v4}, Lcom/htc/android/mail/ByteString;->startsWith(Lcom/htc/android/mail/ByteString;)Z

    move-result v14

    if-eqz v14, :cond_6

    .line 560
    :cond_4
    if-nez v7, :cond_5

    .line 561
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->close()V

    .line 564
    :cond_5
    return-object v9

    .line 539
    :cond_6
    int-to-float v14, v13

    int-to-float v15, v2

    div-float/2addr v14, v15

    const/high16 v15, 0x42c8

    mul-float v12, v14, v15

    .line 540
    const/high16 v14, 0x4120

    div-float v14, v12, v14

    const/high16 v15, 0x4120

    mul-float/2addr v14, v15

    float-to-int v5, v14

    .line 541
    rem-int/lit8 v14, v5, 0xa

    sub-int v14, v5, v14

    move-object/from16 v0, p0

    invoke-direct {v0, v14}, Lcom/htc/android/mail/server/ImapServer;->needBroadcastBack(I)Z

    move-result v14

    if-eqz v14, :cond_0

    .line 542
    if-eq v6, v5, :cond_0

    .line 545
    move v6, v5

    .line 546
    new-instance v11, Landroid/os/Message;

    invoke-direct {v11}, Landroid/os/Message;-><init>()V

    .line 547
    .local v11, msg:Landroid/os/Message;
    new-instance v3, Landroid/os/Bundle;

    invoke-direct {v3}, Landroid/os/Bundle;-><init>()V

    .line 548
    .local v3, b:Landroid/os/Bundle;
    const-string v14, "accountId"

    move-object/from16 v0, p0

    iget-object v15, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v15}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v15

    move-wide v0, v15

    invoke-virtual {v3, v14, v0, v1}, Landroid/os/Bundle;->putLong(Ljava/lang/String;J)V

    .line 549
    const-string v14, "percentage"

    float-to-int v15, v12

    invoke-virtual {v3, v14, v15}, Landroid/os/Bundle;->putInt(Ljava/lang/String;I)V

    .line 550
    const-string v14, "filereference"

    move-object/from16 v0, p5

    invoke-virtual {v3, v14, v0}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 551
    invoke-virtual {v11, v3}, Landroid/os/Message;->setData(Landroid/os/Bundle;)V

    .line 552
    if-eqz p3, :cond_0

    if-eqz p4, :cond_0

    .line 553
    move-object/from16 v0, p0

    iget-object v14, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v0, p3

    move-object/from16 v1, p4

    invoke-virtual {v0, v14, v11, v1}, Lcom/htc/android/mail/AbsRequestController;->broadcastAttachmentDownloadChange(Lcom/htc/android/mail/Account;Landroid/os/Message;Ljava/lang/ref/WeakReference;)V

    goto/16 :goto_0
.end method

.method private final saveFileWithPath(Ljava/lang/String;Ljava/lang/String;[B)Z
    .locals 3
    .parameter "name"
    .parameter "mimeType"
    .parameter "data"

    .prologue
    .line 4897
    :try_start_0
    new-instance v1, Ljava/io/FileOutputStream;

    invoke-direct {v1, p1}, Ljava/io/FileOutputStream;-><init>(Ljava/lang/String;)V

    .line 4899
    .local v1, f:Ljava/io/FileOutputStream;
    invoke-virtual {v1, p3}, Ljava/io/FileOutputStream;->write([B)V

    .line 4900
    invoke-virtual {v1}, Ljava/io/FileOutputStream;->close()V
    :try_end_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0

    .line 4918
    const/4 v2, 0x1

    .end local v1           #f:Ljava/io/FileOutputStream;
    :goto_0
    return v2

    .line 4914
    :catch_0
    move-exception v0

    .line 4915
    .local v0, e:Ljava/io/IOException;
    invoke-virtual {v0}, Ljava/io/IOException;->printStackTrace()V

    .line 4916
    const/4 v2, 0x0

    goto :goto_0
.end method

.method private final saveFileWithPath2(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;ZI)Z
    .locals 12
    .parameter "name"
    .parameter "mimType"
    .parameter "tmpName"
    .parameter "saveToSD"
    .parameter "attachType"

    .prologue
    .line 4853
    sget-boolean v9, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v9, :cond_0

    .line 4854
    const-string v9, "ImapServer"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "saveFileWithPath2>"

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    const-string v11, ","

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 4855
    :cond_0
    new-instance v8, Ljava/io/File;

    invoke-direct {v8, p3}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 4856
    .local v8, tmp:Ljava/io/File;
    invoke-virtual {v8}, Ljava/io/File;->exists()Z

    move-result v9

    if-eqz v9, :cond_5

    .line 4860
    new-instance v5, Ljava/io/File;

    invoke-direct {v5, p1}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 4862
    .local v5, fout:Ljava/io/File;
    :try_start_0
    new-instance v4, Ljava/io/File;

    invoke-direct {v4, p3}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 4864
    .local v4, fin:Ljava/io/File;
    new-instance v1, Ljava/io/BufferedInputStream;

    new-instance v9, Ljava/io/FileInputStream;

    invoke-direct {v9, v4}, Ljava/io/FileInputStream;-><init>(Ljava/io/File;)V

    const/16 v10, 0x400

    invoke-direct {v1, v9, v10}, Ljava/io/BufferedInputStream;-><init>(Ljava/io/InputStream;I)V

    .line 4865
    .local v1, bufIn:Ljava/io/BufferedInputStream;
    new-instance v2, Ljava/io/BufferedOutputStream;

    new-instance v9, Ljava/io/FileOutputStream;

    invoke-direct {v9, v5}, Ljava/io/FileOutputStream;-><init>(Ljava/io/File;)V

    const/16 v10, 0x400

    invoke-direct {v2, v9, v10}, Ljava/io/BufferedOutputStream;-><init>(Ljava/io/OutputStream;I)V

    .line 4866
    .local v2, bufOut:Ljava/io/BufferedOutputStream;
    sget-boolean v9, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v9, :cond_1

    .line 4867
    const-string v9, "ImapServer"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "insize>"

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v1}, Ljava/io/BufferedInputStream;->available()I

    move-result v11

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 4868
    :cond_1
    const/16 v9, 0x64

    new-array v3, v9, [B

    .line 4870
    .local v3, data:[B
    :goto_0
    invoke-virtual {v1}, Ljava/io/BufferedInputStream;->available()I

    move-result v9

    if-lez v9, :cond_4

    .line 4871
    const/4 v9, 0x0

    const/16 v10, 0x64

    invoke-virtual {v1, v3, v9, v10}, Ljava/io/BufferedInputStream;->read([BII)I

    move-result v7

    .line 4872
    .local v7, len:I
    const/4 v9, 0x0

    invoke-virtual {v2, v3, v9, v7}, Ljava/io/BufferedOutputStream;->write([BII)V
    :try_end_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_0

    .line 4876
    .end local v1           #bufIn:Ljava/io/BufferedInputStream;
    .end local v2           #bufOut:Ljava/io/BufferedOutputStream;
    .end local v3           #data:[B
    .end local v4           #fin:Ljava/io/File;
    .end local v7           #len:I
    :catch_0
    move-exception v6

    .line 4877
    .local v6, ioe:Ljava/io/IOException;
    const-string v9, "ImapServer"

    const-string v10, "Could not read data."

    invoke-static {v9, v10, v6}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 4881
    .end local v6           #ioe:Ljava/io/IOException;
    :goto_1
    if-eqz p4, :cond_2

    sget v9, Lcom/htc/android/mail/Rfc2822;->CONTENTTYPE_RELATED:I

    move/from16 v0, p5

    if-eq v0, v9, :cond_2

    .line 4882
    invoke-direct {p0, v5}, Lcom/htc/android/mail/server/ImapServer;->forceSync(Ljava/io/File;)V

    .line 4883
    iget-object v9, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-static {v9, p1, p2}, Lcom/htc/android/mail/MailCommon;->requestMediaScan(Landroid/content/Context;Ljava/lang/String;Ljava/lang/String;)V

    .line 4885
    :cond_2
    invoke-virtual {v8}, Ljava/io/File;->exists()Z

    move-result v9

    if-eqz v9, :cond_3

    .line 4886
    invoke-virtual {v8}, Ljava/io/File;->delete()Z

    .line 4887
    :cond_3
    const/4 v9, 0x1

    .line 4891
    .end local v5           #fout:Ljava/io/File;
    :goto_2
    return v9

    .line 4874
    .restart local v1       #bufIn:Ljava/io/BufferedInputStream;
    .restart local v2       #bufOut:Ljava/io/BufferedOutputStream;
    .restart local v3       #data:[B
    .restart local v4       #fin:Ljava/io/File;
    .restart local v5       #fout:Ljava/io/File;
    :cond_4
    :try_start_1
    invoke-virtual {v1}, Ljava/io/BufferedInputStream;->close()V

    .line 4875
    invoke-virtual {v2}, Ljava/io/BufferedOutputStream;->close()V
    :try_end_1
    .catch Ljava/io/IOException; {:try_start_1 .. :try_end_1} :catch_0

    goto :goto_1

    .line 4889
    .end local v1           #bufIn:Ljava/io/BufferedInputStream;
    .end local v2           #bufOut:Ljava/io/BufferedOutputStream;
    .end local v3           #data:[B
    .end local v4           #fin:Ljava/io/File;
    .end local v5           #fout:Ljava/io/File;
    :cond_5
    sget-boolean v9, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v9, :cond_6

    .line 4890
    const-string v9, "ImapServer"

    const-string v10, " not exist>"

    invoke-static {v9, v10}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 4891
    :cond_6
    const/4 v9, 0x0

    goto :goto_2
.end method

.method private sendIdentify()V
    .locals 11
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    const/16 v8, 0xa8

    .line 245
    iget-object v6, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    const-string v7, "phone"

    invoke-virtual {v6, v7}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/telephony/TelephonyManager;

    .line 246
    .local v5, tm:Landroid/telephony/TelephonyManager;
    invoke-virtual {v5}, Landroid/telephony/TelephonyManager;->getNetworkOperatorName()Ljava/lang/String;

    move-result-object v2

    .line 247
    .local v2, networkOperator:Ljava/lang/String;
    if-nez v2, :cond_0

    const-string v2, ""

    .line 249
    :cond_0
    const/4 v0, 0x0

    .line 250
    .local v0, info:Lcom/htc/android/mail/providerinfo/ProviderInfo;
    const/4 v3, 0x0

    .line 251
    .local v3, setting:Ljava/util/HashMap;
    iget-object v6, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v6}, Lcom/htc/android/mail/Account;->getInServer()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/String;->toLowerCase()Ljava/lang/String;

    move-result-object v6

    const-string v7, "android.imap.mail.yahoo.com"

    invoke-virtual {v6, v7}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v6

    if-nez v6, :cond_1

    iget-object v6, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v6}, Lcom/htc/android/mail/Account;->getInServer()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/String;->toLowerCase()Ljava/lang/String;

    move-result-object v6

    const-string v7, "htc.imap.mail.yahoo.com"

    invoke-virtual {v6, v7}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v6

    if-eqz v6, :cond_4

    .line 253
    :cond_1
    iget-object v6, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v6}, Lcom/htc/android/mail/Account;->getInServer()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/String;->toLowerCase()Ljava/lang/String;

    move-result-object v6

    const-string v7, "android.imap.mail.yahoo.com"

    invoke-virtual {v6, v7}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v6

    if-eqz v6, :cond_9

    .line 254
    sget-short v6, Lcom/htc/htcjavaflag/HtcBuildFlag;->Htc_DEVICE_flag:S

    const/16 v7, 0x3a

    if-eq v6, v7, :cond_2

    sget-short v6, Lcom/htc/htcjavaflag/HtcBuildFlag;->Htc_DEVICE_flag:S

    const/16 v7, 0x91

    if-eq v6, v7, :cond_2

    sget-short v6, Lcom/htc/htcjavaflag/HtcBuildFlag;->Htc_DEVICE_flag:S

    const/16 v7, 0x93

    if-ne v6, v7, :cond_5

    .line 257
    :cond_2
    sget-short v6, Lcom/htc/htcjavaflag/HtcBuildFlag;->Htc_PROJECT_flag:S

    const/16 v7, 0x94

    if-ne v6, v7, :cond_3

    .line 258
    new-instance v0, Lcom/htc/android/mail/providerinfo/SprintYahooImapInfo;

    .end local v0           #info:Lcom/htc/android/mail/providerinfo/ProviderInfo;
    invoke-direct {v0}, Lcom/htc/android/mail/providerinfo/SprintYahooImapInfo;-><init>()V

    .line 276
    .restart local v0       #info:Lcom/htc/android/mail/providerinfo/ProviderInfo;
    :cond_3
    :goto_0
    if-nez v0, :cond_a

    .line 288
    :cond_4
    :goto_1
    return-void

    .line 260
    :cond_5
    sget-short v6, Lcom/htc/htcjavaflag/HtcBuildFlag;->Htc_DEVICE_flag:S

    const/16 v7, 0x5a

    if-eq v6, v7, :cond_6

    sget-short v6, Lcom/htc/htcjavaflag/HtcBuildFlag;->Htc_DEVICE_flag:S

    const/16 v7, 0x40

    if-eq v6, v7, :cond_6

    sget-short v6, Lcom/htc/htcjavaflag/HtcBuildFlag;->Htc_DEVICE_flag:S

    const/16 v7, 0x61

    if-ne v6, v7, :cond_7

    .line 263
    :cond_6
    sget-short v6, Lcom/htc/htcjavaflag/HtcBuildFlag;->Htc_PROJECT_flag:S

    if-ne v6, v8, :cond_3

    .line 264
    new-instance v0, Lcom/htc/android/mail/providerinfo/VerizonYahooImapInfo;

    .end local v0           #info:Lcom/htc/android/mail/providerinfo/ProviderInfo;
    invoke-direct {v0}, Lcom/htc/android/mail/providerinfo/VerizonYahooImapInfo;-><init>()V

    .restart local v0       #info:Lcom/htc/android/mail/providerinfo/ProviderInfo;
    goto :goto_0

    .line 266
    :cond_7
    sget-short v6, Lcom/htc/htcjavaflag/HtcBuildFlag;->Htc_DEVICE_flag:S

    const/16 v7, 0x20

    if-eq v6, v7, :cond_8

    sget-short v6, Lcom/htc/htcjavaflag/HtcBuildFlag;->Htc_DEVICE_flag:S

    if-ne v6, v8, :cond_3

    .line 268
    :cond_8
    sget-short v6, Lcom/htc/htcjavaflag/HtcBuildFlag;->Htc_PROJECT_flag:S

    const/16 v7, 0x9b

    if-ne v6, v7, :cond_3

    .line 269
    new-instance v0, Lcom/htc/android/mail/providerinfo/TMOYahooImapInfo;

    .end local v0           #info:Lcom/htc/android/mail/providerinfo/ProviderInfo;
    invoke-direct {v0}, Lcom/htc/android/mail/providerinfo/TMOYahooImapInfo;-><init>()V

    .restart local v0       #info:Lcom/htc/android/mail/providerinfo/ProviderInfo;
    goto :goto_0

    .line 272
    :cond_9
    iget-object v6, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v6}, Lcom/htc/android/mail/Account;->getInServer()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/String;->toLowerCase()Ljava/lang/String;

    move-result-object v6

    const-string v7, "htc.imap.mail.yahoo.com"

    invoke-virtual {v6, v7}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v6

    if-eqz v6, :cond_3

    .line 273
    new-instance v0, Lcom/htc/android/mail/providerinfo/HTCYahooImapInfo;

    .end local v0           #info:Lcom/htc/android/mail/providerinfo/ProviderInfo;
    invoke-direct {v0, v2}, Lcom/htc/android/mail/providerinfo/HTCYahooImapInfo;-><init>(Ljava/lang/String;)V

    .restart local v0       #info:Lcom/htc/android/mail/providerinfo/ProviderInfo;
    goto :goto_0

    .line 279
    :cond_a
    invoke-virtual {v0}, Lcom/htc/android/mail/providerinfo/ProviderInfo;->getSetting()Ljava/util/HashMap;

    move-result-object v3

    .line 280
    if-eqz v3, :cond_4

    .line 283
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v4

    .line 284
    .local v4, tag:Ljava/lang/String;
    sget-object v6, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v7, "%s ID (%s)"

    const/4 v8, 0x2

    new-array v8, v8, [Ljava/lang/Object;

    const/4 v9, 0x0

    aput-object v4, v8, v9

    const/4 v9, 0x1

    iget-object v10, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v10}, Lcom/htc/android/mail/Account;->getEmailAddress()Ljava/lang/String;

    move-result-object v10

    invoke-virtual {v0, v10}, Lcom/htc/android/mail/providerinfo/ProviderInfo;->getSettingString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v10

    aput-object v10, v8, v9

    invoke-static {v6, v7, v8}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v6

    invoke-virtual {p0, v6}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 285
    invoke-virtual {p0, v4}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v1

    .line 286
    .local v1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    invoke-direct {p0, v1}, Lcom/htc/android/mail/server/ImapServer;->processID(Ljava/util/List;)V

    goto :goto_1
.end method

.method private skipSpace(Ljava/io/PushbackInputStream;)V
    .locals 2
    .parameter "pbIn"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .line 5854
    :cond_0
    invoke-virtual {p1}, Ljava/io/PushbackInputStream;->read()I

    move-result v0

    .local v0, c:I
    const/4 v1, -0x1

    if-eq v0, v1, :cond_1

    .line 5856
    const/16 v1, 0x20

    if-eq v0, v1, :cond_0

    .line 5857
    invoke-virtual {p1, v0}, Ljava/io/PushbackInputStream;->unread(I)V

    .line 5860
    :cond_1
    return-void
.end method

.method private syncMailtoServerInternal(Ljava/lang/String;J)Z
    .locals 37
    .parameter "flags"
    .parameter "messageId"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 5080
    const/4 v13, 0x0

    .local v13, relatedCursor:Landroid/database/Cursor;
    move-object v12, v13

    .local v12, partsCursor:Ljava/lang/Object;
    move-object v11, v13

    .local v11, htmlCursor:Ljava/lang/Object;
    move-object v10, v13

    .local v10, plainCursor:Ljava/lang/Object;
    move-object v9, v13

    .line 5083
    .local v9, messCursor:Ljava/lang/Object;
    :try_start_0
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v3}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v3

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    sget-object v5, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, "/"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move-wide/from16 v0, p2

    invoke-virtual {v4, v0, v1}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v4}, Landroid/net/Uri;->parse(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v4

    const/4 v5, 0x0

    const/4 v6, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    invoke-virtual/range {v3 .. v8}, Landroid/content/ContentResolver;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v9

    .line 5084
    .local v9, messCursor:Landroid/database/Cursor;
    invoke-interface {v9}, Landroid/database/Cursor;->getCount()I
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    move-result v3

    if-gtz v3, :cond_5

    .line 5085
    const/4 v3, 0x0

    .line 5158
    if-eqz v9, :cond_0

    invoke-interface {v9}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_0

    invoke-interface {v9}, Landroid/database/Cursor;->close()V

    .line 5159
    :cond_0
    if-eqz v10, :cond_1

    invoke-interface {v10}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_1

    invoke-interface {v10}, Landroid/database/Cursor;->close()V

    .line 5160
    :cond_1
    if-eqz v11, :cond_2

    invoke-interface {v11}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_2

    invoke-interface {v11}, Landroid/database/Cursor;->close()V

    .line 5161
    :cond_2
    if-eqz v12, :cond_3

    invoke-interface {v12}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_3

    invoke-interface {v12}, Landroid/database/Cursor;->close()V

    .line 5162
    :cond_3
    if-eqz v13, :cond_4

    invoke-interface {v13}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_4

    .end local v10           #plainCursor:Ljava/lang/Object;
    .end local v11           #htmlCursor:Ljava/lang/Object;
    .end local v12           #partsCursor:Ljava/lang/Object;
    :goto_0
    invoke-interface {v13}, Landroid/database/Cursor;->close()V

    .line 5164
    :cond_4
    :goto_1
    return v3

    .line 5088
    .restart local v10       #plainCursor:Ljava/lang/Object;
    .restart local v11       #htmlCursor:Ljava/lang/Object;
    .restart local v12       #partsCursor:Ljava/lang/Object;
    :cond_5
    :try_start_1
    invoke-interface {v9}, Landroid/database/Cursor;->moveToNext()Z
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    move-result v3

    if-nez v3, :cond_a

    const/4 v3, 0x0

    .line 5158
    if-eqz v9, :cond_6

    invoke-interface {v9}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_6

    invoke-interface {v9}, Landroid/database/Cursor;->close()V

    .line 5159
    :cond_6
    if-eqz v10, :cond_7

    invoke-interface {v10}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_7

    invoke-interface {v10}, Landroid/database/Cursor;->close()V

    .line 5160
    :cond_7
    if-eqz v11, :cond_8

    invoke-interface {v11}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_8

    invoke-interface {v11}, Landroid/database/Cursor;->close()V

    .line 5161
    :cond_8
    if-eqz v12, :cond_9

    invoke-interface {v12}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_9

    invoke-interface {v12}, Landroid/database/Cursor;->close()V

    .line 5162
    :cond_9
    if-eqz v13, :cond_4

    invoke-interface {v13}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_4

    goto :goto_0

    .line 5090
    :cond_a
    :try_start_2
    const-string v3, "_messageid"

    invoke-interface {v9, v3}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v3

    invoke-interface {v9, v3}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v18

    .line 5091
    .local v18, msgIdInHeader:Ljava/lang/String;
    const-string v3, "_account"

    invoke-interface {v9, v3}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v3

    invoke-interface {v9, v3}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v22

    .line 5092
    .local v22, accountId:J
    const-string v3, "_mailboxId"

    invoke-interface {v9, v3}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v3

    invoke-interface {v9, v3}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v24

    .line 5093
    .local v24, mailboxId:J
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-static {v3}, Lcom/htc/android/mail/AccountPool;->getInstance(Landroid/content/Context;)Lcom/htc/android/mail/AccountPool;

    move-result-object v28

    .line 5094
    .local v28, accountPool:Lcom/htc/android/mail/AccountPool;
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    move-object/from16 v0, v28

    move-wide/from16 v1, v22

    invoke-virtual {v0, v3, v1, v2}, Lcom/htc/android/mail/AccountPool;->getAccount(Landroid/content/Context;J)Lcom/htc/android/mail/Account;
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    move-result-object v27

    .line 5095
    .local v27, account:Lcom/htc/android/mail/Account;
    if-nez v27, :cond_f

    const/4 v3, 0x0

    .line 5158
    if-eqz v9, :cond_b

    invoke-interface {v9}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_b

    invoke-interface {v9}, Landroid/database/Cursor;->close()V

    .line 5159
    :cond_b
    if-eqz v10, :cond_c

    invoke-interface {v10}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_c

    invoke-interface {v10}, Landroid/database/Cursor;->close()V

    .line 5160
    :cond_c
    if-eqz v11, :cond_d

    invoke-interface {v11}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_d

    invoke-interface {v11}, Landroid/database/Cursor;->close()V

    .line 5161
    :cond_d
    if-eqz v12, :cond_e

    invoke-interface {v12}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_e

    invoke-interface {v12}, Landroid/database/Cursor;->close()V

    .line 5162
    :cond_e
    if-eqz v13, :cond_4

    invoke-interface {v13}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_4

    goto/16 :goto_0

    .line 5096
    :cond_f
    :try_start_3
    invoke-virtual/range {v27 .. v27}, Lcom/htc/android/mail/Account;->getMailboxs()Lcom/htc/android/mail/Mailboxs;
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    move-result-object v31

    .line 5097
    .local v31, mailboxs:Lcom/htc/android/mail/Mailboxs;
    if-nez v31, :cond_14

    const/4 v3, 0x0

    .line 5158
    if-eqz v9, :cond_10

    invoke-interface {v9}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_10

    invoke-interface {v9}, Landroid/database/Cursor;->close()V

    .line 5159
    :cond_10
    if-eqz v10, :cond_11

    invoke-interface {v10}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_11

    invoke-interface {v10}, Landroid/database/Cursor;->close()V

    .line 5160
    :cond_11
    if-eqz v11, :cond_12

    invoke-interface {v11}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_12

    invoke-interface {v11}, Landroid/database/Cursor;->close()V

    .line 5161
    :cond_12
    if-eqz v12, :cond_13

    invoke-interface {v12}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_13

    invoke-interface {v12}, Landroid/database/Cursor;->close()V

    .line 5162
    :cond_13
    if-eqz v13, :cond_4

    invoke-interface {v13}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_4

    goto/16 :goto_0

    .line 5098
    :cond_14
    :try_start_4
    move-object/from16 v0, v31

    move-wide/from16 v1, v24

    invoke-virtual {v0, v1, v2}, Lcom/htc/android/mail/Mailboxs;->getMailboxById(J)Lcom/htc/android/mail/Mailbox;
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    move-result-object v30

    .line 5099
    .local v30, mailbox:Lcom/htc/android/mail/Mailbox;
    if-nez v30, :cond_19

    const/4 v3, 0x0

    .line 5158
    if-eqz v9, :cond_15

    invoke-interface {v9}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_15

    invoke-interface {v9}, Landroid/database/Cursor;->close()V

    .line 5159
    :cond_15
    if-eqz v10, :cond_16

    invoke-interface {v10}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_16

    invoke-interface {v10}, Landroid/database/Cursor;->close()V

    .line 5160
    :cond_16
    if-eqz v11, :cond_17

    invoke-interface {v11}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_17

    invoke-interface {v11}, Landroid/database/Cursor;->close()V

    .line 5161
    :cond_17
    if-eqz v12, :cond_18

    invoke-interface {v12}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_18

    invoke-interface {v12}, Landroid/database/Cursor;->close()V

    .line 5162
    :cond_18
    if-eqz v13, :cond_4

    invoke-interface {v13}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_4

    goto/16 :goto_0

    .line 5101
    :cond_19
    :try_start_5
    move-object/from16 v0, p0

    move-object/from16 v1, v30

    invoke-virtual {v0, v1, v9}, Lcom/htc/android/mail/server/ImapServer;->getFlagsForAppend(Lcom/htc/android/mail/Mailbox;Landroid/database/Cursor;)Ljava/lang/String;

    move-result-object p1

    .line 5102
    const/4 v3, -0x1

    invoke-interface {v9, v3}, Landroid/database/Cursor;->moveToPosition(I)Z

    .line 5105
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "_message = %d AND _filename=\'\' AND _mimetype=\'text/plain\'"

    const/4 v5, 0x1

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v7, 0x0

    invoke-static/range {p2 .. p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v14

    aput-object v14, v5, v7

    invoke-static {v3, v4, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v6

    .line 5106
    .local v6, where:Ljava/lang/String;
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v3}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v3

    sget-object v4, Lcom/htc/android/mail/MailProvider;->sPartsURI:Landroid/net/Uri;

    const/4 v5, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    invoke-virtual/range {v3 .. v8}, Landroid/content/ContentResolver;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v10

    .line 5107
    .local v10, plainCursor:Landroid/database/Cursor;
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "_message = %d AND _filename=\'\' AND _mimetype=\'text/html\'"

    const/4 v5, 0x1

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v7, 0x0

    invoke-static/range {p2 .. p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v14

    aput-object v14, v5, v7

    invoke-static {v3, v4, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v6

    .line 5108
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v3}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v3

    sget-object v4, Lcom/htc/android/mail/MailProvider;->sPartsURI:Landroid/net/Uri;

    const/4 v5, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    invoke-virtual/range {v3 .. v8}, Landroid/content/ContentResolver;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v11

    .line 5109
    .local v11, htmlCursor:Landroid/database/Cursor;
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "_message = %d AND _filename<>\'\' AND _filepath<>\'\' AND _contenttype = %d"

    const/4 v5, 0x2

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v7, 0x0

    invoke-static/range {p2 .. p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v14

    aput-object v14, v5, v7

    const/4 v7, 0x1

    sget v14, Lcom/htc/android/mail/Rfc2822;->CONTENTTYPE_MIXED:I

    invoke-static {v14}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v14

    aput-object v14, v5, v7

    invoke-static {v3, v4, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v6

    .line 5110
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v3}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v3

    sget-object v4, Lcom/htc/android/mail/MailProvider;->sPartsURI:Landroid/net/Uri;

    const/4 v5, 0x5

    new-array v5, v5, [Ljava/lang/String;

    const/4 v7, 0x0

    const-string v14, "_filename"

    aput-object v14, v5, v7

    const/4 v7, 0x1

    const-string v14, "_filepath"

    aput-object v14, v5, v7

    const/4 v7, 0x2

    const-string v14, "_mimetype"

    aput-object v14, v5, v7

    const/4 v7, 0x3

    const-string v14, "_contenttype"

    aput-object v14, v5, v7

    const/4 v7, 0x4

    const-string v14, "_cid"

    aput-object v14, v5, v7

    const/4 v7, 0x0

    const/4 v8, 0x0

    invoke-virtual/range {v3 .. v8}, Landroid/content/ContentResolver;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v12

    .line 5112
    .local v12, partsCursor:Landroid/database/Cursor;
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "_message = %d AND _filename<>\'\' AND _filepath<>\'\' AND _contenttype = %d"

    const/4 v5, 0x2

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v7, 0x0

    invoke-static/range {p2 .. p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v14

    aput-object v14, v5, v7

    const/4 v7, 0x1

    sget v14, Lcom/htc/android/mail/Rfc2822;->CONTENTTYPE_RELATED:I

    invoke-static {v14}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v14

    aput-object v14, v5, v7

    invoke-static {v3, v4, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v6

    .line 5113
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v3}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v3

    sget-object v4, Lcom/htc/android/mail/MailProvider;->sPartsURI:Landroid/net/Uri;

    const/4 v5, 0x5

    new-array v5, v5, [Ljava/lang/String;

    const/4 v7, 0x0

    const-string v14, "_filename"

    aput-object v14, v5, v7

    const/4 v7, 0x1

    const-string v14, "_filepath"

    aput-object v14, v5, v7

    const/4 v7, 0x2

    const-string v14, "_mimetype"

    aput-object v14, v5, v7

    const/4 v7, 0x3

    const-string v14, "_contenttype"

    aput-object v14, v5, v7

    const/4 v7, 0x4

    const-string v14, "_cid"

    aput-object v14, v5, v7

    const/4 v7, 0x0

    const/4 v8, 0x0

    invoke-virtual/range {v3 .. v8}, Landroid/content/ContentResolver;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v13

    .line 5117
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v34

    .line 5118
    .local v34, tag:Ljava/lang/String;
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    .line 5119
    .local v8, mailbody:Ljava/lang/StringBuilder;
    new-instance v3, Lcom/htc/android/mail/CountSizeOutputStream;

    invoke-direct {v3}, Lcom/htc/android/mail/CountSizeOutputStream;-><init>()V

    move-object/from16 v0, p0

    iput-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->countOutStream:Lcom/htc/android/mail/CountSizeOutputStream;

    move-object/from16 v7, p0

    move-wide/from16 v14, p2

    .line 5120
    invoke-direct/range {v7 .. v15}, Lcom/htc/android/mail/server/ImapServer;->issueBody(Ljava/lang/StringBuilder;Landroid/database/Cursor;Landroid/database/Cursor;Landroid/database/Cursor;Landroid/database/Cursor;Landroid/database/Cursor;J)V

    .line 5121
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->countOutStream:Lcom/htc/android/mail/CountSizeOutputStream;

    invoke-virtual {v3}, Lcom/htc/android/mail/CountSizeOutputStream;->getSize()I

    move-result v33

    .line 5122
    .local v33, size:I
    const/4 v3, 0x0

    move-object/from16 v0, p0

    iput-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->countOutStream:Lcom/htc/android/mail/CountSizeOutputStream;
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    .line 5123
    if-gtz v33, :cond_1e

    .line 5124
    const/4 v3, 0x0

    .line 5158
    if-eqz v9, :cond_1a

    invoke-interface {v9}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_1a

    invoke-interface {v9}, Landroid/database/Cursor;->close()V

    .line 5159
    :cond_1a
    if-eqz v10, :cond_1b

    invoke-interface {v10}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_1b

    invoke-interface {v10}, Landroid/database/Cursor;->close()V

    .line 5160
    :cond_1b
    if-eqz v11, :cond_1c

    invoke-interface {v11}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_1c

    invoke-interface {v11}, Landroid/database/Cursor;->close()V

    .line 5161
    :cond_1c
    if-eqz v12, :cond_1d

    invoke-interface {v12}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_1d

    invoke-interface {v12}, Landroid/database/Cursor;->close()V

    .line 5162
    :cond_1d
    if-eqz v13, :cond_4

    invoke-interface {v13}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_4

    goto/16 :goto_0

    .line 5127
    :cond_1e
    :try_start_6
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "%s APPEND %s %s {%s}"

    const/4 v5, 0x4

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v7, 0x0

    aput-object v34, v5, v7

    const/4 v7, 0x1

    move-object/from16 v0, v30

    iget-object v14, v0, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    aput-object v14, v5, v7

    const/4 v7, 0x2

    aput-object p1, v5, v7

    const/4 v7, 0x3

    invoke-static/range {v33 .. v33}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v14

    aput-object v14, v5, v7

    invoke-static {v3, v4, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p0

    invoke-virtual {v0, v3}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 5128
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->readOneLineResponse()Lcom/htc/android/mail/ByteString;

    move-result-object v32

    .local v32, prepare:Lcom/htc/android/mail/ByteString;
    move-object/from16 v7, p0

    move-wide/from16 v14, p2

    .line 5130
    invoke-direct/range {v7 .. v15}, Lcom/htc/android/mail/server/ImapServer;->issueBody(Ljava/lang/StringBuilder;Landroid/database/Cursor;Landroid/database/Cursor;Landroid/database/Cursor;Landroid/database/Cursor;Landroid/database/Cursor;J)V

    .line 5132
    const-string v3, ""

    move-object/from16 v0, p0

    invoke-virtual {v0, v3}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5133
    invoke-interface {v9}, Landroid/database/Cursor;->close()V

    .line 5134
    invoke-interface {v10}, Landroid/database/Cursor;->close()V

    .line 5135
    invoke-interface {v11}, Landroid/database/Cursor;->close()V

    .line 5136
    invoke-interface {v12}, Landroid/database/Cursor;->close()V

    .line 5137
    invoke-interface {v13}, Landroid/database/Cursor;->close()V

    .line 5140
    move-object/from16 v0, p0

    move-object/from16 v1, v34

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v29

    .line 5141
    .local v29, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/16 v20, 0x0

    .line 5143
    .local v20, uid:Ljava/lang/String;
    invoke-interface/range {v29 .. v29}, Ljava/util/List;->size()I

    move-result v3

    add-int/lit8 v3, v3, -0x1

    move-object/from16 v0, v29

    invoke-interface {v0, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/htc/android/mail/ByteString;

    invoke-virtual {v3}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v3

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, v34

    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    const-string v5, " OK"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v3, v4}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v3

    if-eqz v3, :cond_29

    .line 5144
    invoke-interface/range {v29 .. v29}, Ljava/util/List;->size()I

    move-result v3

    add-int/lit8 v3, v3, -0x1

    move-object/from16 v0, v29

    invoke-interface {v0, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/htc/android/mail/ByteString;

    invoke-virtual {v3}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p0

    invoke-direct {v0, v3}, Lcom/htc/android/mail/server/ImapServer;->getAppendUID(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v20

    .line 5145
    new-instance v36, Landroid/content/ContentValues;

    invoke-direct/range {v36 .. v36}, Landroid/content/ContentValues;-><init>()V

    .line 5146
    .local v36, values:Landroid/content/ContentValues;
    const-string v3, "_local"

    const-string v4, "0"

    move-object/from16 v0, v36

    invoke-virtual {v0, v3, v4}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 5147
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "_id = %d AND _mailboxId = %d"

    const/4 v5, 0x2

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v7, 0x0

    invoke-static/range {p2 .. p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v14

    aput-object v14, v5, v7

    const/4 v7, 0x1

    invoke-static/range {v24 .. v25}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v14

    aput-object v14, v5, v7

    invoke-static {v3, v4, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v6

    .line 5148
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v3}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v3

    sget-object v4, Lcom/htc/android/mail/MailProvider;->sNoNotifyMessagesURI:Landroid/net/Uri;

    const/4 v5, 0x0

    move-object/from16 v0, v36

    invoke-virtual {v3, v4, v0, v6, v5}, Landroid/content/ContentResolver;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    move-result v35

    .line 5149
    .local v35, updated:I
    const/16 v19, 0x1

    move-object/from16 v14, p0

    move-object/from16 v15, v30

    move-wide/from16 v16, p2

    invoke-virtual/range {v14 .. v20}, Lcom/htc/android/mail/server/ImapServer;->getUidFromServer(Lcom/htc/android/mail/Mailbox;JLjava/lang/String;ZLjava/lang/String;)Ljava/lang/String;

    move-result-object v26

    .line 5151
    .local v26, finalUid:Ljava/lang/String;
    if-nez v35, :cond_1f

    .line 5152
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-static {v3}, Lcom/htc/android/mail/RequestController;->getInstance(Landroid/content/Context;)Lcom/htc/android/mail/RequestController;

    move-result-object v21

    .line 5153
    .local v21, controller:Lcom/htc/android/mail/AbsRequestController;
    invoke-virtual/range {v21 .. v26}, Lcom/htc/android/mail/RequestController;->deleteMailOnServer(JJLjava/lang/String;)V
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0

    .line 5155
    .end local v21           #controller:Lcom/htc/android/mail/AbsRequestController;
    :cond_1f
    const/4 v3, 0x1

    .line 5158
    if-eqz v9, :cond_20

    invoke-interface {v9}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_20

    invoke-interface {v9}, Landroid/database/Cursor;->close()V

    .line 5159
    :cond_20
    if-eqz v10, :cond_21

    invoke-interface {v10}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_21

    invoke-interface {v10}, Landroid/database/Cursor;->close()V

    .line 5160
    :cond_21
    if-eqz v11, :cond_22

    invoke-interface {v11}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_22

    invoke-interface {v11}, Landroid/database/Cursor;->close()V

    .line 5161
    :cond_22
    if-eqz v12, :cond_23

    invoke-interface {v12}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_23

    invoke-interface {v12}, Landroid/database/Cursor;->close()V

    .line 5162
    :cond_23
    if-eqz v13, :cond_4

    invoke-interface {v13}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_4

    goto/16 :goto_0

    .line 5158
    .end local v6           #where:Ljava/lang/String;
    .end local v8           #mailbody:Ljava/lang/StringBuilder;
    .end local v9           #messCursor:Landroid/database/Cursor;
    .end local v10           #plainCursor:Landroid/database/Cursor;
    .end local v11           #htmlCursor:Landroid/database/Cursor;
    .end local v12           #partsCursor:Landroid/database/Cursor;
    .end local v18           #msgIdInHeader:Ljava/lang/String;
    .end local v20           #uid:Ljava/lang/String;
    .end local v22           #accountId:J
    .end local v24           #mailboxId:J
    .end local v26           #finalUid:Ljava/lang/String;
    .end local v27           #account:Lcom/htc/android/mail/Account;
    .end local v28           #accountPool:Lcom/htc/android/mail/AccountPool;
    .end local v29           #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    .end local v30           #mailbox:Lcom/htc/android/mail/Mailbox;
    .end local v31           #mailboxs:Lcom/htc/android/mail/Mailboxs;
    .end local v32           #prepare:Lcom/htc/android/mail/ByteString;
    .end local v33           #size:I
    .end local v34           #tag:Ljava/lang/String;
    .end local v35           #updated:I
    .end local v36           #values:Landroid/content/ContentValues;
    :catchall_0
    move-exception v3

    if-eqz v9, :cond_24

    invoke-interface {v9}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_24

    invoke-interface {v9}, Landroid/database/Cursor;->close()V

    .line 5159
    :cond_24
    if-eqz v10, :cond_25

    invoke-interface {v10}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_25

    invoke-interface {v10}, Landroid/database/Cursor;->close()V

    .line 5160
    :cond_25
    if-eqz v11, :cond_26

    invoke-interface {v11}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_26

    invoke-interface {v11}, Landroid/database/Cursor;->close()V

    .line 5161
    :cond_26
    if-eqz v12, :cond_27

    invoke-interface {v12}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_27

    invoke-interface {v12}, Landroid/database/Cursor;->close()V

    .line 5162
    :cond_27
    if-eqz v13, :cond_28

    invoke-interface {v13}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_28

    invoke-interface {v13}, Landroid/database/Cursor;->close()V

    .line 5158
    :cond_28
    throw v3

    .restart local v6       #where:Ljava/lang/String;
    .restart local v8       #mailbody:Ljava/lang/StringBuilder;
    .restart local v9       #messCursor:Landroid/database/Cursor;
    .restart local v10       #plainCursor:Landroid/database/Cursor;
    .restart local v11       #htmlCursor:Landroid/database/Cursor;
    .restart local v12       #partsCursor:Landroid/database/Cursor;
    .restart local v18       #msgIdInHeader:Ljava/lang/String;
    .restart local v20       #uid:Ljava/lang/String;
    .restart local v22       #accountId:J
    .restart local v24       #mailboxId:J
    .restart local v27       #account:Lcom/htc/android/mail/Account;
    .restart local v28       #accountPool:Lcom/htc/android/mail/AccountPool;
    .restart local v29       #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    .restart local v30       #mailbox:Lcom/htc/android/mail/Mailbox;
    .restart local v31       #mailboxs:Lcom/htc/android/mail/Mailboxs;
    .restart local v32       #prepare:Lcom/htc/android/mail/ByteString;
    .restart local v33       #size:I
    .restart local v34       #tag:Ljava/lang/String;
    :cond_29
    if-eqz v9, :cond_2a

    invoke-interface {v9}, Landroid/database/Cursor;->isClosed()Z

    move-result v3

    if-nez v3, :cond_2a

    invoke-interface {v9}, Landroid/database/Cursor;->close()V

    .line 5159
    :cond_2a
    if-eqz v10, :cond_2b

    invoke-interface {v10}, Landroid/database/Cursor;->isClosed()Z

    move-result v3

    if-nez v3, :cond_2b

    invoke-interface {v10}, Landroid/database/Cursor;->close()V

    .line 5160
    :cond_2b
    if-eqz v11, :cond_2c

    invoke-interface {v11}, Landroid/database/Cursor;->isClosed()Z

    move-result v3

    if-nez v3, :cond_2c

    invoke-interface {v11}, Landroid/database/Cursor;->close()V

    .line 5161
    :cond_2c
    if-eqz v12, :cond_2d

    invoke-interface {v12}, Landroid/database/Cursor;->isClosed()Z

    move-result v3

    if-nez v3, :cond_2d

    invoke-interface {v12}, Landroid/database/Cursor;->close()V

    .line 5162
    :cond_2d
    if-eqz v13, :cond_2e

    invoke-interface {v13}, Landroid/database/Cursor;->isClosed()Z

    move-result v3

    if-nez v3, :cond_2e

    invoke-interface {v13}, Landroid/database/Cursor;->close()V

    .line 5164
    :cond_2e
    const/4 v3, 0x0

    goto/16 :goto_1
.end method

.method private translateUidListToUidArray(Ljava/lang/String;)Ljava/util/ArrayList;
    .locals 12
    .parameter "uidStr"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            ")",
            "Ljava/util/ArrayList",
            "<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .prologue
    const/4 v8, 0x0

    .line 5202
    if-eqz p1, :cond_0

    const-string v9, ""

    invoke-virtual {p1, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v9

    if-eqz v9, :cond_2

    :cond_0
    move-object v6, v8

    .line 5230
    :cond_1
    :goto_0
    return-object v6

    .line 5203
    :cond_2
    const-string v9, ","

    invoke-virtual {p1, v9}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v2

    .line 5204
    .local v2, fragments:[Ljava/lang/String;
    new-instance v6, Ljava/util/ArrayList;

    invoke-direct {v6}, Ljava/util/ArrayList;-><init>()V

    .line 5205
    .local v6, retUid:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/String;>;"
    const/4 v4, 0x0

    .local v4, i:I
    :goto_1
    array-length v9, v2

    if-ge v4, v9, :cond_6

    .line 5206
    aget-object v9, v2, v4

    const-string v10, ":"

    invoke-virtual {v9, v10}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v9

    if-eqz v9, :cond_5

    .line 5207
    aget-object v9, v2, v4

    const-string v10, ":"

    invoke-virtual {v9, v10}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v3

    .line 5209
    .local v3, frags:[Ljava/lang/String;
    if-eqz v3, :cond_3

    :try_start_0
    array-length v9, v3

    const/4 v10, 0x2

    if-ne v9, v10, :cond_3

    .line 5210
    const/4 v9, 0x0

    aget-object v9, v3, v9

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/Integer;->intValue()I

    move-result v7

    .line 5211
    .local v7, start:I
    const/4 v9, 0x1

    aget-object v9, v3, v9

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/Integer;->intValue()I

    move-result v1

    .line 5212
    .local v1, end:I
    move v5, v7

    .local v5, j:I
    :goto_2
    if-gt v5, v1, :cond_4

    .line 5213
    invoke-static {v5}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;

    move-result-object v9

    invoke-virtual {v6, v9}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 5212
    add-int/lit8 v5, v5, 0x1

    goto :goto_2

    .line 5216
    .end local v1           #end:I
    .end local v5           #j:I
    .end local v7           #start:I
    :cond_3
    const-string v9, "ImapServer"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "can not handle:"

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    aget-object v11, v2, v4

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10}, Lcom/htc/android/mail/ll;->e(Ljava/lang/String;Ljava/lang/String;)V
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    .line 5205
    .end local v3           #frags:[Ljava/lang/String;
    :cond_4
    :goto_3
    add-int/lit8 v4, v4, 0x1

    goto :goto_1

    .line 5218
    .restart local v3       #frags:[Ljava/lang/String;
    :catch_0
    move-exception v0

    .line 5219
    .local v0, e:Ljava/lang/Exception;
    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V

    goto :goto_3

    .line 5222
    .end local v0           #e:Ljava/lang/Exception;
    .end local v3           #frags:[Ljava/lang/String;
    :cond_5
    aget-object v9, v2, v4

    invoke-virtual {v6, v9}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_3

    .line 5226
    :cond_6
    sget-boolean v9, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v9, :cond_7

    const-string v9, "ImapServer"

    new-instance v10, Ljava/lang/StringBuilder;

    invoke-direct {v10}, Ljava/lang/StringBuilder;-><init>()V

    const-string v11, "translateUidListToUidArray return size is "

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v11

    invoke-virtual {v10, v11}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v10

    invoke-virtual {v10}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v10

    invoke-static {v9, v10}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 5227
    :cond_7
    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v9

    if-nez v9, :cond_1

    move-object v6, v8

    .line 5228
    goto/16 :goto_0
.end method


# virtual methods
.method protected GenRelatedAttachAndBound(Landroid/database/Cursor;Ljava/lang/String;)V
    .locals 17
    .parameter "parts"
    .parameter "boundary"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 5631
    const/4 v14, -0x1

    move-object/from16 v0, p1

    invoke-interface {v0, v14}, Landroid/database/Cursor;->moveToPosition(I)Z

    .line 5632
    :cond_0
    :goto_0
    invoke-interface/range {p1 .. p1}, Landroid/database/Cursor;->moveToNext()Z

    move-result v14

    if-eqz v14, :cond_7

    .line 5633
    const-string v14, "_filename"

    move-object/from16 v0, p1

    invoke-interface {v0, v14}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v14

    move-object/from16 v0, p1

    invoke-interface {v0, v14}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v5

    .line 5634
    .local v5, filename:Ljava/lang/String;
    const-string v14, "_filepath"

    move-object/from16 v0, p1

    invoke-interface {v0, v14}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v14

    move-object/from16 v0, p1

    invoke-interface {v0, v14}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v6

    .line 5635
    .local v6, filepath:Ljava/lang/String;
    const-string v14, "_mimetype"

    move-object/from16 v0, p1

    invoke-interface {v0, v14}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v14

    move-object/from16 v0, p1

    invoke-interface {v0, v14}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v11

    .line 5636
    .local v11, mimetype:Ljava/lang/String;
    const-string v14, "_cid"

    move-object/from16 v0, p1

    invoke-interface {v0, v14}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v14

    move-object/from16 v0, p1

    invoke-interface {v0, v14}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v1

    .line 5638
    .local v1, cid:Ljava/lang/String;
    if-eqz v6, :cond_0

    if-eqz v5, :cond_0

    if-eqz v11, :cond_0

    .line 5641
    new-instance v4, Ljava/io/File;

    invoke-direct {v4, v6}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 5642
    .local v4, file:Ljava/io/File;
    invoke-virtual {v4}, Ljava/io/File;->exists()Z

    move-result v14

    if-nez v14, :cond_1

    invoke-virtual {v4}, Ljava/io/File;->canRead()Z

    move-result v14

    if-eqz v14, :cond_0

    .line 5645
    :cond_1
    const/4 v7, 0x0

    .line 5647
    .local v7, fis:Ljava/io/FileInputStream;
    :try_start_0
    new-instance v8, Ljava/io/FileInputStream;

    invoke-direct {v8, v4}, Ljava/io/FileInputStream;-><init>(Ljava/io/File;)V
    :try_end_0
    .catch Ljava/io/FileNotFoundException; {:try_start_0 .. :try_end_0} :catch_0

    .end local v7           #fis:Ljava/io/FileInputStream;
    .local v8, fis:Ljava/io/FileInputStream;
    move-object v7, v8

    .line 5653
    .end local v8           #fis:Ljava/io/FileInputStream;
    .restart local v7       #fis:Ljava/io/FileInputStream;
    :goto_1
    :try_start_1
    new-instance v14, Ljava/lang/StringBuilder;

    invoke-direct {v14}, Ljava/lang/StringBuilder;-><init>()V

    const-string v15, "--"

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    move-object/from16 v0, p2

    invoke-virtual {v14, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v14

    move-object/from16 v0, p0

    invoke-virtual {v0, v14}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5654
    const-string v14, "utf-8"

    invoke-virtual {v5, v14}, Ljava/lang/String;->getBytes(Ljava/lang/String;)[B

    move-result-object v14

    invoke-static {v14}, Lcom/htc/android/mail/Util;->needEncode([B)Z

    move-result v14

    if-eqz v14, :cond_3

    .line 5655
    new-instance v14, Ljava/lang/StringBuilder;

    invoke-direct {v14}, Ljava/lang/StringBuilder;-><init>()V

    const-string v15, "Content-Type: "

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    invoke-virtual {v14, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    const-string v15, ";\r\n\tname="

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    const-string v15, "\""

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    invoke-static {v5}, Lcom/htc/android/mail/server/SmtpServer;->rfc2047Base64Encode(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v15

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    const-string v15, "\""

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v14

    move-object/from16 v0, p0

    invoke-virtual {v0, v14}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5658
    :goto_2
    const-string v14, "utf-8"

    invoke-virtual {v5, v14}, Ljava/lang/String;->getBytes(Ljava/lang/String;)[B

    move-result-object v14

    invoke-static {v14}, Lcom/htc/android/mail/Util;->needEncode([B)Z

    move-result v14

    if-eqz v14, :cond_4

    .line 5659
    new-instance v14, Ljava/lang/StringBuilder;

    invoke-direct {v14}, Ljava/lang/StringBuilder;-><init>()V

    const-string v15, "Content-Disposition: inline;\r\n\tfilename=\""

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    invoke-static {v5}, Lcom/htc/android/mail/server/SmtpServer;->rfc2047Base64Encode(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v15

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    const-string v15, "\""

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v14

    move-object/from16 v0, p0

    invoke-virtual {v0, v14}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5662
    :goto_3
    if-eqz v1, :cond_2

    .line 5663
    new-instance v14, Ljava/lang/StringBuilder;

    invoke-direct {v14}, Ljava/lang/StringBuilder;-><init>()V

    const-string v15, "Content-ID: <"

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    invoke-virtual {v14, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    const-string v15, ">"

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v14

    move-object/from16 v0, p0

    invoke-virtual {v0, v14}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5664
    :cond_2
    const-string v14, "Content-Transfer-Encoding: base64"

    move-object/from16 v0, p0

    invoke-virtual {v0, v14}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5665
    const-string v14, ""

    move-object/from16 v0, p0

    invoke-virtual {v0, v14}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 5667
    sget v12, Lcom/htc/android/mail/server/ImapServer;->ONETIME_ENCODE_SIZE:I

    .line 5668
    .local v12, oneTime:I
    new-array v2, v12, [B

    .line 5671
    .local v2, content:[B
    const/4 v9, 0x0

    .line 5672
    .local v9, i:I
    :goto_4
    const/4 v14, 0x0

    invoke-virtual {v7, v2, v14, v12}, Ljava/io/FileInputStream;->read([BII)I
    :try_end_1
    .catch Ljava/io/IOException; {:try_start_1 .. :try_end_1} :catch_1
    .catch Ljava/lang/OutOfMemoryError; {:try_start_1 .. :try_end_1} :catch_2

    move-result v13

    .line 5673
    .local v13, size:I
    const/4 v14, -0x1

    if-ne v13, v14, :cond_5

    .line 5684
    const/4 v2, 0x0

    .line 5685
    goto/16 :goto_0

    .line 5648
    .end local v2           #content:[B
    .end local v9           #i:I
    .end local v12           #oneTime:I
    .end local v13           #size:I
    :catch_0
    move-exception v3

    .line 5649
    .local v3, e:Ljava/io/FileNotFoundException;
    invoke-virtual {v3}, Ljava/io/FileNotFoundException;->printStackTrace()V

    goto/16 :goto_1

    .line 5657
    .end local v3           #e:Ljava/io/FileNotFoundException;
    :cond_3
    :try_start_2
    new-instance v14, Ljava/lang/StringBuilder;

    invoke-direct {v14}, Ljava/lang/StringBuilder;-><init>()V

    const-string v15, "Content-Type: "

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    invoke-virtual {v14, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    const-string v15, ";\r\n\tname="

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    const-string v15, "\""

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    invoke-virtual {v14, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    const-string v15, "\""

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v14

    move-object/from16 v0, p0

    invoke-virtual {v0, v14}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V
    :try_end_2
    .catch Ljava/io/IOException; {:try_start_2 .. :try_end_2} :catch_1
    .catch Ljava/lang/OutOfMemoryError; {:try_start_2 .. :try_end_2} :catch_2

    goto/16 :goto_2

    .line 5686
    :catch_1
    move-exception v3

    .line 5687
    .local v3, e:Ljava/io/IOException;
    invoke-virtual {v3}, Ljava/io/IOException;->printStackTrace()V

    .line 5688
    const-string v14, "ImapServer"

    const-string v15, "catch io exception"

    invoke-static {v14, v15, v3}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto/16 :goto_0

    .line 5661
    .end local v3           #e:Ljava/io/IOException;
    :cond_4
    :try_start_3
    new-instance v14, Ljava/lang/StringBuilder;

    invoke-direct {v14}, Ljava/lang/StringBuilder;-><init>()V

    const-string v15, "Content-Disposition: inline;\r\n\tfilename=\""

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    invoke-virtual {v14, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    const-string v15, "\""

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v14

    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v14

    move-object/from16 v0, p0

    invoke-virtual {v0, v14}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V
    :try_end_3
    .catch Ljava/io/IOException; {:try_start_3 .. :try_end_3} :catch_1
    .catch Ljava/lang/OutOfMemoryError; {:try_start_3 .. :try_end_3} :catch_2

    goto/16 :goto_3

    .line 5689
    :catch_2
    move-exception v3

    .line 5690
    .local v3, e:Ljava/lang/OutOfMemoryError;
    move-object/from16 v0, p0

    iget-object v14, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    move-object/from16 v0, p0

    iget-object v15, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    const v16, 0x7f0b01a6

    invoke-virtual/range {v15 .. v16}, Landroid/content/Context;->getText(I)Ljava/lang/CharSequence;

    move-result-object v15

    const/16 v16, 0x1

    invoke-static/range {v14 .. v16}, Landroid/widget/Toast;->makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast;

    move-result-object v14

    invoke-virtual {v14}, Landroid/widget/Toast;->show()V

    .line 5691
    new-instance v14, Ljava/lang/OutOfMemoryError;

    invoke-direct {v14}, Ljava/lang/OutOfMemoryError;-><init>()V

    throw v14

    .line 5676
    .end local v3           #e:Ljava/lang/OutOfMemoryError;
    .restart local v2       #content:[B
    .restart local v9       #i:I
    .restart local v12       #oneTime:I
    .restart local v13       #size:I
    :cond_5
    if-ne v13, v12, :cond_6

    .line 5677
    :try_start_4
    invoke-static {v2}, Lorg/apache/commons/codec/binary/Base64;->encodeBase64Chunked([B)[B

    move-result-object v14

    move-object/from16 v0, p0

    invoke-virtual {v0, v14}, Lcom/htc/android/mail/server/ImapServer;->write([B)V

    .line 5671
    :goto_5
    add-int/lit8 v9, v9, 0x1

    goto/16 :goto_4

    .line 5679
    :cond_6
    new-array v10, v13, [B

    .line 5680
    .local v10, lessContent:[B
    const/4 v14, 0x0

    const/4 v15, 0x0

    invoke-static {v2, v14, v10, v15, v13}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V

    .line 5681
    invoke-static {v10}, Lorg/apache/commons/codec/binary/Base64;->encodeBase64Chunked([B)[B

    move-result-object v14

    move-object/from16 v0, p0

    invoke-virtual {v0, v14}, Lcom/htc/android/mail/server/ImapServer;->write([B)V
    :try_end_4
    .catch Ljava/io/IOException; {:try_start_4 .. :try_end_4} :catch_1
    .catch Ljava/lang/OutOfMemoryError; {:try_start_4 .. :try_end_4} :catch_2

    goto :goto_5

    .line 5694
    .end local v1           #cid:Ljava/lang/String;
    .end local v2           #content:[B
    .end local v4           #file:Ljava/io/File;
    .end local v5           #filename:Ljava/lang/String;
    .end local v6           #filepath:Ljava/lang/String;
    .end local v7           #fis:Ljava/io/FileInputStream;
    .end local v9           #i:I
    .end local v10           #lessContent:[B
    .end local v11           #mimetype:Ljava/lang/String;
    .end local v12           #oneTime:I
    .end local v13           #size:I
    :cond_7
    return-void
.end method

.method protected addDeletePendingRequest(Lcom/htc/android/mail/util/SparseArray;Lcom/htc/android/mail/server/Server$PendingRequest;Ljava/util/HashMap;)V
    .locals 3
    .parameter
    .parameter "request"
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/util/SparseArray",
            "<",
            "Lcom/htc/android/mail/server/Server$PendingRequestList;",
            ">;",
            "Lcom/htc/android/mail/server/Server$PendingRequest;",
            "Ljava/util/HashMap",
            "<",
            "Ljava/lang/Long;",
            "Ljava/lang/Object;",
            ">;)V"
        }
    .end annotation

    .prologue
    .line 1848
    .local p1, deleteSparseArray:Lcom/htc/android/mail/util/SparseArray;,"Lcom/htc/android/mail/util/SparseArray<Lcom/htc/android/mail/server/Server$PendingRequestList;>;"
    .local p3, messageIdMap:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/Long;Ljava/lang/Object;>;"
    iget-object v1, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->uid:Ljava/lang/String;

    if-nez v1, :cond_1

    .line 1849
    iget-wide v1, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->messageId:J

    invoke-static {v1, v2}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v1

    invoke-virtual {p3, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    if-eqz v1, :cond_0

    .line 1865
    :goto_0
    return-void

    .line 1852
    :cond_0
    invoke-direct {p0, p2}, Lcom/htc/android/mail/server/ImapServer;->getUidFromStore(Lcom/htc/android/mail/server/Server$PendingRequest;)Ljava/lang/String;

    move-result-object v1

    iput-object v1, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->uid:Ljava/lang/String;

    .line 1853
    iget-object v1, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->uid:Ljava/lang/String;

    if-nez v1, :cond_1

    .line 1854
    invoke-virtual {p2}, Lcom/htc/android/mail/server/Server$PendingRequest;->delete()I

    goto :goto_0

    .line 1859
    :cond_1
    iget-wide v1, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->fromMailboxId:J

    invoke-virtual {p1, v1, v2}, Lcom/htc/android/mail/util/SparseArray;->get(J)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/htc/android/mail/server/Server$PendingRequestList;

    .line 1860
    .local v0, pendingRequestList:Lcom/htc/android/mail/server/Server$PendingRequestList;
    if-nez v0, :cond_2

    .line 1861
    new-instance v0, Lcom/htc/android/mail/server/Server$PendingRequestList;

    .end local v0           #pendingRequestList:Lcom/htc/android/mail/server/Server$PendingRequestList;
    invoke-direct {v0}, Lcom/htc/android/mail/server/Server$PendingRequestList;-><init>()V

    .line 1862
    .restart local v0       #pendingRequestList:Lcom/htc/android/mail/server/Server$PendingRequestList;
    iget-wide v1, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->fromMailboxId:J

    invoke-virtual {p1, v1, v2, v0}, Lcom/htc/android/mail/util/SparseArray;->put(JLjava/lang/Object;)V

    .line 1864
    :cond_2
    invoke-virtual {v0, p2}, Lcom/htc/android/mail/server/Server$PendingRequestList;->add(Lcom/htc/android/mail/server/Server$PendingRequest;)V

    goto :goto_0
.end method

.method protected addMovePendingRequest(Lcom/htc/android/mail/util/SparseArray;Lcom/htc/android/mail/server/Server$PendingRequest;)V
    .locals 11
    .parameter
    .parameter "request"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/util/SparseArray",
            "<",
            "Lcom/htc/android/mail/util/SparseArray",
            "<",
            "Lcom/htc/android/mail/server/Server$PendingRequestList;",
            ">;>;",
            "Lcom/htc/android/mail/server/Server$PendingRequest;",
            ")V"
        }
    .end annotation

    .prologue
    .line 1803
    .local p1, moveFromSparseArray:Lcom/htc/android/mail/util/SparseArray;,"Lcom/htc/android/mail/util/SparseArray<Lcom/htc/android/mail/util/SparseArray<Lcom/htc/android/mail/server/Server$PendingRequestList;>;>;"
    iget-object v5, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->uid:Ljava/lang/String;

    if-nez v5, :cond_0

    .line 1804
    invoke-direct {p0, p2}, Lcom/htc/android/mail/server/ImapServer;->getUidFromStore(Lcom/htc/android/mail/server/Server$PendingRequest;)Ljava/lang/String;

    move-result-object v5

    iput-object v5, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->uid:Ljava/lang/String;

    .line 1805
    iget-object v5, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->uid:Ljava/lang/String;

    if-nez v5, :cond_0

    .line 1806
    invoke-virtual {p2}, Lcom/htc/android/mail/server/Server$PendingRequest;->delete()I

    .line 1842
    :goto_0
    return-void

    .line 1811
    :cond_0
    iget-wide v5, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->fromMailboxId:J

    iget-wide v7, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->toMailboxId:J

    cmp-long v5, v5, v7

    if-nez v5, :cond_1

    .line 1814
    :try_start_0
    sget-object v5, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v6, "_mailboxId = %d AND _uid = \'%s\' AND _del = \'1\'"

    const/4 v7, 0x2

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    iget-wide v9, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->toMailboxId:J

    invoke-static {v9, v10}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v9

    aput-object v9, v7, v8

    const/4 v8, 0x1

    iget-object v9, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->uid:Ljava/lang/String;

    aput-object v9, v7, v8

    invoke-static {v5, v6, v7}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v4

    .line 1815
    .local v4, where:Ljava/lang/String;
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v5

    sget-object v6, Lcom/htc/android/mail/MailProvider;->sNoNotifyMessagesURI:Landroid/net/Uri;

    const/4 v7, 0x0

    invoke-interface {v5, v6, v4, v7}, Landroid/content/IContentProvider;->delete(Landroid/net/Uri;Ljava/lang/String;[Ljava/lang/String;)I

    .line 1817
    sget-object v5, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v6, "_id = \'%d\' AND _uid is null"

    const/4 v7, 0x1

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    iget-wide v9, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->messageId:J

    invoke-static {v9, v10}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v9

    aput-object v9, v7, v8

    invoke-static {v5, v6, v7}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v4

    .line 1818
    new-instance v3, Landroid/content/ContentValues;

    invoke-direct {v3}, Landroid/content/ContentValues;-><init>()V

    .line 1819
    .local v3, values:Landroid/content/ContentValues;
    const-string v5, "_uid"

    iget-object v6, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->uid:Ljava/lang/String;

    invoke-virtual {v3, v5, v6}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 1820
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v5

    sget-object v6, Lcom/htc/android/mail/MailProvider;->sNoNotifyMessagesURI:Landroid/net/Uri;

    const/4 v7, 0x0

    invoke-interface {v5, v6, v3, v4, v7}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 1824
    .end local v3           #values:Landroid/content/ContentValues;
    .end local v4           #where:Ljava/lang/String;
    :goto_1
    invoke-virtual {p2}, Lcom/htc/android/mail/server/Server$PendingRequest;->delete()I

    goto :goto_0

    .line 1821
    :catch_0
    move-exception v2

    .line 1822
    .local v2, re:Landroid/os/RemoteException;
    const-string v5, "ImapServer"

    const-string v6, "delete request fail"

    invoke-static {v5, v6, v2}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_1

    .line 1828
    .end local v2           #re:Landroid/os/RemoteException;
    :cond_1
    iget-wide v5, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->fromMailboxId:J

    invoke-virtual {p1, v5, v6}, Lcom/htc/android/mail/util/SparseArray;->get(J)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/htc/android/mail/util/SparseArray;

    .line 1829
    .local v0, moveToSparseArray:Lcom/htc/android/mail/util/SparseArray;,"Lcom/htc/android/mail/util/SparseArray<Lcom/htc/android/mail/server/Server$PendingRequestList;>;"
    if-nez v0, :cond_3

    .line 1830
    new-instance v0, Lcom/htc/android/mail/util/SparseArray;

    .end local v0           #moveToSparseArray:Lcom/htc/android/mail/util/SparseArray;,"Lcom/htc/android/mail/util/SparseArray<Lcom/htc/android/mail/server/Server$PendingRequestList;>;"
    invoke-direct {v0}, Lcom/htc/android/mail/util/SparseArray;-><init>()V

    .line 1831
    .restart local v0       #moveToSparseArray:Lcom/htc/android/mail/util/SparseArray;,"Lcom/htc/android/mail/util/SparseArray<Lcom/htc/android/mail/server/Server$PendingRequestList;>;"
    new-instance v1, Lcom/htc/android/mail/server/Server$PendingRequestList;

    invoke-direct {v1}, Lcom/htc/android/mail/server/Server$PendingRequestList;-><init>()V

    .line 1832
    .local v1, pendingRequestList:Lcom/htc/android/mail/server/Server$PendingRequestList;
    iget-wide v5, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->toMailboxId:J

    invoke-virtual {v0, v5, v6, v1}, Lcom/htc/android/mail/util/SparseArray;->put(JLjava/lang/Object;)V

    .line 1833
    iget-wide v5, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->fromMailboxId:J

    invoke-virtual {p1, v5, v6, v0}, Lcom/htc/android/mail/util/SparseArray;->put(JLjava/lang/Object;)V

    .line 1841
    :cond_2
    :goto_2
    invoke-virtual {v1, p2}, Lcom/htc/android/mail/server/Server$PendingRequestList;->add(Lcom/htc/android/mail/server/Server$PendingRequest;)V

    goto/16 :goto_0

    .line 1835
    .end local v1           #pendingRequestList:Lcom/htc/android/mail/server/Server$PendingRequestList;
    :cond_3
    iget-wide v5, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->toMailboxId:J

    invoke-virtual {v0, v5, v6}, Lcom/htc/android/mail/util/SparseArray;->get(J)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/htc/android/mail/server/Server$PendingRequestList;

    .line 1836
    .restart local v1       #pendingRequestList:Lcom/htc/android/mail/server/Server$PendingRequestList;
    if-nez v1, :cond_2

    .line 1837
    new-instance v1, Lcom/htc/android/mail/server/Server$PendingRequestList;

    .end local v1           #pendingRequestList:Lcom/htc/android/mail/server/Server$PendingRequestList;
    invoke-direct {v1}, Lcom/htc/android/mail/server/Server$PendingRequestList;-><init>()V

    .line 1838
    .restart local v1       #pendingRequestList:Lcom/htc/android/mail/server/Server$PendingRequestList;
    iget-wide v5, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->toMailboxId:J

    invoke-virtual {v0, v5, v6, v1}, Lcom/htc/android/mail/util/SparseArray;->put(JLjava/lang/Object;)V

    goto :goto_2
.end method

.method protected addReadPendingRequest(Lcom/htc/android/mail/util/SparseArray;Lcom/htc/android/mail/server/Server$PendingRequest;Ljava/util/HashMap;)V
    .locals 3
    .parameter
    .parameter "request"
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/util/SparseArray",
            "<",
            "Lcom/htc/android/mail/server/Server$PendingRequestList;",
            ">;",
            "Lcom/htc/android/mail/server/Server$PendingRequest;",
            "Ljava/util/HashMap",
            "<",
            "Ljava/lang/Long;",
            "Ljava/lang/Object;",
            ">;)V"
        }
    .end annotation

    .prologue
    .line 1870
    .local p1, readSparseArray:Lcom/htc/android/mail/util/SparseArray;,"Lcom/htc/android/mail/util/SparseArray<Lcom/htc/android/mail/server/Server$PendingRequestList;>;"
    .local p3, messageIdMap:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/Long;Ljava/lang/Object;>;"
    iget-object v1, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->uid:Ljava/lang/String;

    if-nez v1, :cond_1

    .line 1871
    iget-wide v1, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->messageId:J

    invoke-static {v1, v2}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v1

    invoke-virtual {p3, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    if-eqz v1, :cond_0

    .line 1888
    :goto_0
    return-void

    .line 1874
    :cond_0
    invoke-direct {p0, p2}, Lcom/htc/android/mail/server/ImapServer;->getUidFromStore(Lcom/htc/android/mail/server/Server$PendingRequest;)Ljava/lang/String;

    move-result-object v1

    iput-object v1, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->uid:Ljava/lang/String;

    .line 1875
    iget-object v1, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->uid:Ljava/lang/String;

    if-nez v1, :cond_1

    .line 1876
    invoke-virtual {p2}, Lcom/htc/android/mail/server/Server$PendingRequest;->delete()I

    goto :goto_0

    .line 1881
    :cond_1
    iget-wide v1, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->fromMailboxId:J

    invoke-virtual {p1, v1, v2}, Lcom/htc/android/mail/util/SparseArray;->get(J)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/htc/android/mail/server/Server$PendingRequestList;

    .line 1882
    .local v0, pendingRequestList:Lcom/htc/android/mail/server/Server$PendingRequestList;
    if-nez v0, :cond_2

    .line 1883
    new-instance v0, Lcom/htc/android/mail/server/Server$PendingRequestList;

    .end local v0           #pendingRequestList:Lcom/htc/android/mail/server/Server$PendingRequestList;
    invoke-direct {v0}, Lcom/htc/android/mail/server/Server$PendingRequestList;-><init>()V

    .line 1884
    .restart local v0       #pendingRequestList:Lcom/htc/android/mail/server/Server$PendingRequestList;
    iget-wide v1, p2, Lcom/htc/android/mail/server/Server$PendingRequest;->fromMailboxId:J

    invoke-virtual {p1, v1, v2, v0}, Lcom/htc/android/mail/util/SparseArray;->put(JLjava/lang/Object;)V

    .line 1886
    :cond_2
    invoke-virtual {v0, p2}, Lcom/htc/android/mail/server/Server$PendingRequestList;->add(Lcom/htc/android/mail/server/Server$PendingRequest;)V

    goto :goto_0
.end method

.method public checkMore(Lcom/htc/android/mail/Mailbox;)V
    .locals 10
    .parameter "mailbox"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    const/4 v8, 0x1

    .line 2398
    iget-object v6, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    const-string v7, ""

    invoke-virtual {p0, v6, v7}, Lcom/htc/android/mail/server/ImapServer;->updateProgressStatus(Lcom/htc/android/mail/Account;Ljava/lang/String;)V

    .line 2399
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->probe()V

    .line 2401
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->syncPendingRequests()V

    .line 2403
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->isFinishSyncPendingRequest()Z

    move-result v6

    if-nez v6, :cond_0

    .line 2404
    sget-boolean v6, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v6, :cond_0

    .line 2405
    const-string v6, "TAG"

    const-string v7, "PendingRequests is not empty"

    invoke-static {v6, v7}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 2408
    :cond_0
    iget v6, p0, Lcom/htc/android/mail/server/Server;->socketState:I

    if-ne v6, v8, :cond_1

    .line 2409
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->init()V

    .line 2412
    :cond_1
    invoke-virtual {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->selectMailbox(Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    .line 2415
    iget-object v6, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    const-string v7, ""

    invoke-virtual {p0, v6, v7}, Lcom/htc/android/mail/server/ImapServer;->updateProgressStatus(Lcom/htc/android/mail/Account;Ljava/lang/String;)V

    .line 2416
    invoke-virtual {p0, p1, v8}, Lcom/htc/android/mail/server/ImapServer;->searchNotDeletedMail(Lcom/htc/android/mail/Mailbox;Z)Ljava/util/List;

    move-result-object v5

    .line 2417
    .local v5, notDeletedMail:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    invoke-direct {p0, v5}, Lcom/htc/android/mail/server/ImapServer;->pruneFetchCheckMoreList(Ljava/util/List;)V

    .line 2419
    if-eqz v5, :cond_2

    invoke-interface {v5}, Ljava/util/List;->size()I

    move-result v6

    if-lez v6, :cond_2

    .line 2420
    iget-object v6, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    const-string v7, ""

    invoke-virtual {p0, v6, v7}, Lcom/htc/android/mail/server/ImapServer;->updateProgressStatus(Lcom/htc/android/mail/Account;Ljava/lang/String;)V

    .line 2421
    iget v6, p0, Lcom/htc/android/mail/server/ImapServer;->mFetchHeaderSize:I

    invoke-virtual {p0, p1, v5, v6}, Lcom/htc/android/mail/server/ImapServer;->fetchHeader(Lcom/htc/android/mail/Mailbox;Ljava/util/List;I)Ljava/util/List;

    move-result-object v3

    .line 2422
    .local v3, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    if-nez v3, :cond_3

    .line 2450
    .end local v3           #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    :cond_2
    return-void

    .line 2428
    .restart local v3       #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    :cond_3
    if-eqz v3, :cond_4

    invoke-interface {v3}, Ljava/util/List;->size()I

    move-result v6

    if-lez v6, :cond_4

    .line 2429
    iget-object v6, p0, Lcom/htc/android/mail/server/Server;->mWeakHandler:Ljava/lang/ref/WeakReference;

    if-eqz v6, :cond_4

    .line 2430
    iget-object v6, p0, Lcom/htc/android/mail/server/Server;->mWeakHandler:Ljava/lang/ref/WeakReference;

    invoke-virtual {v6}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/os/Handler;

    .line 2431
    .local v1, handler:Landroid/os/Handler;
    if-eqz v1, :cond_4

    .line 2432
    const/16 v6, 0xc

    invoke-virtual {v1, v6}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v6

    invoke-virtual {v6}, Landroid/os/Message;->sendToTarget()V

    .line 2438
    .end local v1           #handler:Landroid/os/Handler;
    :cond_4
    const/4 v2, -0x1

    .line 2439
    .local v2, i:I
    iget-object v6, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-static {v6}, Lcom/htc/android/mail/RequestController;->getInstance(Landroid/content/Context;)Lcom/htc/android/mail/RequestController;

    move-result-object v0

    .line 2440
    .local v0, controller:Lcom/htc/android/mail/AbsRequestController;
    if-eqz v3, :cond_2

    .line 2441
    invoke-interface {v3}, Ljava/util/List;->size()I

    move-result v6

    add-int/lit8 v2, v6, -0x1

    :goto_0
    if-ltz v2, :cond_2

    .line 2442
    invoke-interface {v3, v2}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/htc/android/mail/MailMessage;

    .line 2443
    .local v4, mailMessage:Lcom/htc/android/mail/MailMessage;
    iget-wide v6, v4, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v0, v6, v7}, Lcom/htc/android/mail/RequestController;->isNeedToFetch(J)Z

    move-result v6

    if-nez v6, :cond_5

    .line 2441
    :goto_1
    add-int/lit8 v2, v2, -0x1

    goto :goto_0

    .line 2444
    :cond_5
    iget-object v6, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-interface {v3}, Ljava/util/List;->size()I

    move-result v7

    sub-int/2addr v7, v2

    invoke-interface {v3}, Ljava/util/List;->size()I

    move-result v8

    const-string v9, ""

    invoke-virtual {p0, v7, v8, v9}, Lcom/htc/android/mail/server/ImapServer;->getDownloadingStatus(IILjava/lang/String;)Ljava/lang/String;

    move-result-object v7

    invoke-virtual {p0, v6, v7}, Lcom/htc/android/mail/server/ImapServer;->updateProgressStatus(Lcom/htc/android/mail/Account;Ljava/lang/String;)V

    .line 2446
    const/4 v6, 0x0

    invoke-virtual {p0, p1, v4, v6, v0}, Lcom/htc/android/mail/server/ImapServer;->fetchInfo(Lcom/htc/android/mail/Mailbox;Lcom/htc/android/mail/MailMessage;ILcom/htc/android/mail/AbsRequestController;)V

    goto :goto_1
.end method

.method public checkNewAccount()V
    .locals 2
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    const/4 v1, 0x1

    .line 881
    iget v0, p0, Lcom/htc/android/mail/server/Server;->socketState:I

    if-ne v0, v1, :cond_0

    .line 882
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->init()V

    .line 884
    :cond_0
    iget v0, p0, Lcom/htc/android/mail/server/Server;->socketState:I

    if-eq v0, v1, :cond_1

    .line 885
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->close()V

    .line 886
    :cond_1
    return-void
.end method

.method protected clearPendingFetchMailRequest(Lcom/htc/android/mail/Mailbox;)V
    .locals 9
    .parameter "mailbox"

    .prologue
    .line 3402
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "_accountId = \'%d\' AND _fromMailboxId = \'%d\' AND _request = \'%d\'"

    const/4 v5, 0x3

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v6, 0x0

    iget-object v7, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v7}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v7

    invoke-static {v7, v8}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v5, v6

    const/4 v6, 0x1

    iget-wide v7, p1, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-static {v7, v8}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v5, v6

    const/4 v6, 0x2

    const/4 v7, 0x6

    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v7

    aput-object v7, v5, v6

    invoke-static {v3, v4, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v2

    .line 3404
    .local v2, where:Ljava/lang/String;
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v0

    .line 3406
    .local v0, cp:Landroid/content/IContentProvider;
    :try_start_0
    sget-object v3, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    const/4 v4, 0x0

    invoke-interface {v0, v3, v2, v4}, Landroid/content/IContentProvider;->delete(Landroid/net/Uri;Ljava/lang/String;[Ljava/lang/String;)I
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 3410
    :goto_0
    return-void

    .line 3407
    :catch_0
    move-exception v1

    .line 3408
    .local v1, e:Landroid/os/RemoteException;
    const-string v3, "ImapServer"

    const-string v4, "catch exception"

    invoke-static {v3, v4, v1}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V

    goto :goto_0
.end method

.method public close()V
    .locals 5

    .prologue
    .line 607
    iget-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mSocket:Ljava/net/Socket;

    .line 608
    .local v2, socket:Ljava/net/Socket;
    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mOut:Ljava/io/BufferedOutputStream;

    .line 609
    .local v1, out:Ljava/io/BufferedOutputStream;
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mIn:Ljava/io/BufferedInputStream;

    .line 611
    .local v0, in:Ljava/io/BufferedInputStream;
    new-instance v3, Ljava/lang/Thread;

    new-instance v4, Lcom/htc/android/mail/server/ImapServer$1;

    invoke-direct {v4, p0, v2, v1, v0}, Lcom/htc/android/mail/server/ImapServer$1;-><init>(Lcom/htc/android/mail/server/ImapServer;Ljava/net/Socket;Ljava/io/BufferedOutputStream;Ljava/io/BufferedInputStream;)V

    invoke-direct {v3, v4}, Ljava/lang/Thread;-><init>(Ljava/lang/Runnable;)V

    invoke-virtual {v3}, Ljava/lang/Thread;->start()V

    .line 638
    const/4 v3, 0x1

    iput v3, p0, Lcom/htc/android/mail/server/Server;->socketState:I

    .line 639
    return-void
.end method

.method protected final combine(Ljava/util/List;Ljava/lang/String;Z)Ljava/lang/String;
    .locals 5
    .parameter
    .parameter "seperator"
    .parameter "escape"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Ljava/lang/String;",
            ">;",
            "Ljava/lang/String;",
            "Z)",
            "Ljava/lang/String;"
        }
    .end annotation

    .prologue
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    const/4 v4, 0x0

    .line 4069
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    .line 4070
    .local v0, fetchStr:Ljava/lang/StringBuilder;
    if-eqz p1, :cond_0

    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v3

    if-gtz v3, :cond_1

    .line 4071
    :cond_0
    const-string v3, ""

    .line 4097
    :goto_0
    return-object v3

    .line 4074
    :cond_1
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v3

    if-lez v3, :cond_2

    .line 4075
    invoke-interface {p1, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Ljava/lang/String;

    .line 4076
    .local v2, value:Ljava/lang/String;
    if-eqz v2, :cond_2

    .line 4077
    if-eqz p3, :cond_4

    .line 4078
    invoke-interface {p1, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/String;

    invoke-static {v3}, Landroid/database/DatabaseUtils;->sqlEscapeString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4085
    .end local v2           #value:Ljava/lang/String;
    :cond_2
    :goto_1
    const/4 v1, 0x1

    .local v1, i:I
    :goto_2
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v3

    if-ge v1, v3, :cond_6

    .line 4086
    invoke-interface {p1, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Ljava/lang/String;

    .line 4087
    .restart local v2       #value:Ljava/lang/String;
    if-eqz v2, :cond_3

    .line 4088
    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4089
    if-eqz p3, :cond_5

    .line 4090
    invoke-interface {p1, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/String;

    invoke-static {v3}, Landroid/database/DatabaseUtils;->sqlEscapeString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4085
    :cond_3
    :goto_3
    add-int/lit8 v1, v1, 0x1

    goto :goto_2

    .line 4080
    .end local v1           #i:I
    :cond_4
    invoke-interface {p1, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/String;

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    goto :goto_1

    .line 4092
    .restart local v1       #i:I
    :cond_5
    invoke-interface {p1, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/String;

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    goto :goto_3

    .line 4097
    .end local v2           #value:Ljava/lang/String;
    :cond_6
    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    goto :goto_0
.end method

.method protected final combine(Ljava/util/List;Ljava/lang/String;ZII)Ljava/lang/String;
    .locals 4
    .parameter
    .parameter "seperator"
    .parameter "escape"
    .parameter "offset"
    .parameter "sizelimit"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Ljava/lang/String;",
            ">;",
            "Ljava/lang/String;",
            "ZII)",
            "Ljava/lang/String;"
        }
    .end annotation

    .prologue
    .line 4101
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    new-instance v0, Ljava/lang/StringBuilder;

    invoke-direct {v0}, Ljava/lang/StringBuilder;-><init>()V

    .line 4102
    .local v0, fetchStr:Ljava/lang/StringBuilder;
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v3

    if-gtz v3, :cond_0

    .line 4103
    const-string v3, ""

    .line 4131
    :goto_0
    return-object v3

    .line 4105
    :cond_0
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v3

    if-lt p4, v3, :cond_1

    .line 4106
    const-string v3, ""

    goto :goto_0

    .line 4108
    :cond_1
    invoke-interface {p1, p4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    if-eqz v3, :cond_2

    .line 4109
    if-eqz p3, :cond_5

    .line 4110
    invoke-interface {p1, p4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/String;

    invoke-static {v3}, Landroid/database/DatabaseUtils;->sqlEscapeString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4116
    :cond_2
    :goto_1
    add-int v2, p4, p5

    .line 4117
    .local v2, mEnd:I
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v3

    if-le v2, v3, :cond_3

    .line 4118
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v2

    .line 4120
    :cond_3
    add-int/lit8 v1, p4, 0x1

    .local v1, i:I
    :goto_2
    if-ge v1, v2, :cond_7

    .line 4121
    invoke-interface {p1, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    if-eqz v3, :cond_4

    .line 4122
    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4123
    if-eqz p3, :cond_6

    .line 4124
    invoke-interface {p1, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/String;

    invoke-static {v3}, Landroid/database/DatabaseUtils;->sqlEscapeString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 4120
    :cond_4
    :goto_3
    add-int/lit8 v1, v1, 0x1

    goto :goto_2

    .line 4112
    .end local v1           #i:I
    .end local v2           #mEnd:I
    :cond_5
    invoke-interface {p1, p4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/String;

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    goto :goto_1

    .line 4126
    .restart local v1       #i:I
    .restart local v2       #mEnd:I
    :cond_6
    invoke-interface {p1, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/String;

    invoke-virtual {v0, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    goto :goto_3

    .line 4131
    :cond_7
    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    goto :goto_0
.end method

.method protected createMailbox(Ljava/lang/String;)I
    .locals 7
    .parameter "mailboxName"

    .prologue
    .line 5540
    :try_start_0
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v2

    .line 5541
    .local v2, tag:Ljava/lang/String;
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "%s CREATE %s"

    const/4 v5, 0x2

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v6, 0x0

    aput-object v2, v5, v6

    const/4 v6, 0x1

    aput-object p1, v5, v6

    invoke-static {v3, v4, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p0, v3}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 5543
    invoke-virtual {p0, v2}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v1

    .line 5544
    .local v1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    invoke-direct {p0, v1}, Lcom/htc/android/mail/server/ImapServer;->processCreateMailbox(Ljava/util/List;)I
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    move-result v3

    .line 5546
    .end local v1           #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    .end local v2           #tag:Ljava/lang/String;
    :goto_0
    return v3

    .line 5545
    :catch_0
    move-exception v0

    .line 5546
    .local v0, e:Ljava/lang/Exception;
    const/4 v3, -0x2

    goto :goto_0
.end method

.method public deleteMail(Lcom/htc/android/mail/Mailbox;Ljava/util/ArrayList;)V
    .locals 0
    .parameter "mailbox"
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/Mailbox;",
            "Ljava/util/ArrayList",
            "<",
            "Lcom/htc/android/mail/MailMessage;",
            ">;)V"
        }
    .end annotation

    .prologue
    .line 1155
    .local p2, mailMessageList:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/htc/android/mail/MailMessage;>;"
    return-void
.end method

.method public deleteMail(Lcom/htc/android/mail/Mailbox;Ljava/util/ArrayList;Z)V
    .locals 0
    .parameter "mailbox"
    .parameter
    .parameter "onlyOnServer"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/Mailbox;",
            "Ljava/util/ArrayList",
            "<",
            "Lcom/htc/android/mail/MailMessage;",
            ">;Z)V"
        }
    .end annotation

    .prologue
    .line 1162
    .local p2, mailMessageList:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/htc/android/mail/MailMessage;>;"
    return-void
.end method

.method protected deleteMail(Lcom/htc/android/mail/server/Server$PendingRequestList;)V
    .locals 16
    .parameter "pendingRequestList"

    .prologue
    .line 1215
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->size()I

    move-result v6

    .line 1216
    .local v6, size:I
    if-lez v6, :cond_0

    .line 1217
    const/4 v10, 0x0

    move-object/from16 v0, p1

    invoke-virtual {v0, v10}, Lcom/htc/android/mail/server/Server$PendingRequestList;->get(I)Lcom/htc/android/mail/server/Server$PendingRequest;

    move-result-object v5

    .line 1218
    .local v5, request:Lcom/htc/android/mail/server/Server$PendingRequest;
    move-object/from16 v0, p0

    iget-object v10, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-static {v10}, Lcom/htc/android/mail/AccountPool;->getInstance(Landroid/content/Context;)Lcom/htc/android/mail/AccountPool;

    move-result-object v2

    .line 1219
    .local v2, accountPool:Lcom/htc/android/mail/AccountPool;
    move-object/from16 v0, p0

    iget-object v10, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    iget-wide v11, v5, Lcom/htc/android/mail/server/Server$PendingRequest;->accountId:J

    invoke-virtual {v2, v10, v11, v12}, Lcom/htc/android/mail/AccountPool;->getAccount(Landroid/content/Context;J)Lcom/htc/android/mail/Account;

    move-result-object v1

    .line 1220
    .local v1, account:Lcom/htc/android/mail/Account;
    if-nez v1, :cond_1

    .line 1221
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->delete()I

    .line 1274
    .end local v1           #account:Lcom/htc/android/mail/Account;
    .end local v2           #accountPool:Lcom/htc/android/mail/AccountPool;
    .end local v5           #request:Lcom/htc/android/mail/server/Server$PendingRequest;
    :cond_0
    :goto_0
    return-void

    .line 1224
    .restart local v1       #account:Lcom/htc/android/mail/Account;
    .restart local v2       #accountPool:Lcom/htc/android/mail/AccountPool;
    .restart local v5       #request:Lcom/htc/android/mail/server/Server$PendingRequest;
    :cond_1
    invoke-virtual {v1}, Lcom/htc/android/mail/Account;->getMailboxs()Lcom/htc/android/mail/Mailboxs;

    move-result-object v10

    iget-wide v11, v5, Lcom/htc/android/mail/server/Server$PendingRequest;->fromMailboxId:J

    invoke-virtual {v10, v11, v12}, Lcom/htc/android/mail/Mailboxs;->getMailboxById(J)Lcom/htc/android/mail/Mailbox;

    move-result-object v4

    .line 1225
    .local v4, mailbox:Lcom/htc/android/mail/Mailbox;
    if-nez v4, :cond_2

    .line 1226
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->delete()I

    goto :goto_0

    .line 1233
    :cond_2
    iget-boolean v10, v4, Lcom/htc/android/mail/Mailbox;->isServerFolder:Z

    if-nez v10, :cond_4

    .line 1234
    sget-boolean v10, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v10, :cond_3

    const-string v10, "ImapServer"

    const-string v11, "fromMailbox are not server folder"

    invoke-static {v10, v11}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 1235
    :cond_3
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->delete()I

    goto :goto_0

    .line 1239
    :cond_4
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->getUidSeq()Ljava/lang/String;

    move-result-object v8

    .line 1240
    .local v8, uidSeq:Ljava/lang/String;
    const-string v10, ""

    invoke-virtual {v10, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v10

    if-eqz v10, :cond_5

    .line 1241
    sget-boolean v10, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v10, :cond_0

    const-string v10, "ImapServer"

    const-string v11, "uidSeq is empty"

    invoke-static {v10, v11}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    goto :goto_0

    .line 1246
    :cond_5
    :try_start_0
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->probe()V

    .line 1247
    move-object/from16 v0, p0

    iget v10, v0, Lcom/htc/android/mail/server/Server;->socketState:I

    const/4 v11, 0x1

    if-ne v10, v11, :cond_6

    .line 1248
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->init()V

    .line 1251
    :cond_6
    move-object/from16 v0, p0

    invoke-virtual {v0, v4}, Lcom/htc/android/mail/server/ImapServer;->selectMailbox(Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    .line 1253
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v7

    .line 1254
    .local v7, tag:Ljava/lang/String;
    sget-object v10, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v11, "%s UID STORE %s +FLAGS.SILENT (\\Deleted)"

    const/4 v12, 0x2

    new-array v12, v12, [Ljava/lang/Object;

    const/4 v13, 0x0

    aput-object v7, v12, v13

    const/4 v13, 0x1

    aput-object v8, v12, v13

    invoke-static {v10, v11, v12}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v10

    move-object/from16 v0, p0

    invoke-virtual {v0, v10}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 1255
    move-object/from16 v0, p0

    invoke-virtual {v0, v7}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    .line 1257
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v7

    .line 1258
    sget-object v10, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v11, "%s EXPUNGE"

    const/4 v12, 0x1

    new-array v12, v12, [Ljava/lang/Object;

    const/4 v13, 0x0

    aput-object v7, v12, v13

    invoke-static {v10, v11, v12}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v10

    move-object/from16 v0, p0

    invoke-virtual {v0, v10}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 1259
    move-object/from16 v0, p0

    invoke-virtual {v0, v7}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    .line 1262
    sget-object v10, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v11, "_account = \'%d\' AND _mailboxId = \'%d\' AND _uid in (%s) AND _del <> -1"

    const/4 v12, 0x3

    new-array v12, v12, [Ljava/lang/Object;

    const/4 v13, 0x0

    move-object/from16 v0, p0

    iget-object v14, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v14}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v14

    invoke-static {v14, v15}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v14

    aput-object v14, v12, v13

    const/4 v13, 0x1

    iget-wide v14, v4, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-static {v14, v15}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v14

    aput-object v14, v12, v13

    const/4 v13, 0x2

    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->getUidSeqEscape()Ljava/lang/String;

    move-result-object v14

    aput-object v14, v12, v13

    invoke-static {v10, v11, v12}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v9

    .line 1264
    .local v9, where:Ljava/lang/String;
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v10

    sget-object v11, Lcom/htc/android/mail/MailProvider;->sNoNotifyMessagesURI:Landroid/net/Uri;

    const/4 v12, 0x0

    invoke-interface {v10, v11, v9, v12}, Landroid/content/IContentProvider;->delete(Landroid/net/Uri;Ljava/lang/String;[Ljava/lang/String;)I

    .line 1266
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->delete()I
    :try_end_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_1

    goto/16 :goto_0

    .line 1267
    .end local v7           #tag:Ljava/lang/String;
    .end local v9           #where:Ljava/lang/String;
    :catch_0
    move-exception v3

    .line 1268
    .local v3, e:Ljava/io/IOException;
    const-string v10, "ImapServer"

    const-string v11, "IO Exception"

    invoke-static {v10, v11, v3}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto/16 :goto_0

    .line 1269
    .end local v3           #e:Ljava/io/IOException;
    :catch_1
    move-exception v3

    .line 1270
    .local v3, e:Ljava/lang/Exception;
    const-string v10, "ImapServer"

    const-string v11, "Unknow Exception"

    invoke-static {v10, v11, v3}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 1272
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->delete()I

    goto/16 :goto_0
.end method

.method protected deleteMailMarkedToDelete()V
    .locals 8

    .prologue
    .line 1586
    :try_start_0
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v3, "_del = \'2\' AND _account = \'%d\'"

    const/4 v4, 0x1

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v5, 0x0

    iget-object v6, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v6}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v6

    invoke-static {v6, v7}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v6

    aput-object v6, v4, v5

    invoke-static {v2, v3, v4}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v1

    .line 1587
    .local v1, where:Ljava/lang/String;
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v2

    sget-object v3, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    const/4 v4, 0x0

    invoke-interface {v2, v3, v1, v4}, Landroid/content/IContentProvider;->delete(Landroid/net/Uri;Ljava/lang/String;[Ljava/lang/String;)I
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 1591
    .end local v1           #where:Ljava/lang/String;
    :goto_0
    return-void

    .line 1588
    :catch_0
    move-exception v0

    .line 1589
    .local v0, e:Landroid/os/RemoteException;
    const-string v2, "ImapServer"

    const-string v3, "delete message fail"

    invoke-static {v2, v3, v0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_0
.end method

.method protected emptyMailbox(Lcom/htc/android/mail/server/Server$PendingRequest;)V
    .locals 9
    .parameter "pendingRequest"

    .prologue
    const/4 v8, 0x1

    .line 1165
    if-nez p1, :cond_0

    .line 1209
    :goto_0
    return-void

    .line 1166
    :cond_0
    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-static {v5}, Lcom/htc/android/mail/AccountPool;->getInstance(Landroid/content/Context;)Lcom/htc/android/mail/AccountPool;

    move-result-object v1

    .line 1167
    .local v1, accountPool:Lcom/htc/android/mail/AccountPool;
    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    iget-wide v6, p1, Lcom/htc/android/mail/server/Server$PendingRequest;->accountId:J

    invoke-virtual {v1, v5, v6, v7}, Lcom/htc/android/mail/AccountPool;->getAccount(Landroid/content/Context;J)Lcom/htc/android/mail/Account;

    move-result-object v0

    .line 1168
    .local v0, account:Lcom/htc/android/mail/Account;
    if-nez v0, :cond_1

    .line 1169
    invoke-virtual {p1}, Lcom/htc/android/mail/server/Server$PendingRequest;->delete()I

    goto :goto_0

    .line 1172
    :cond_1
    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v5}, Lcom/htc/android/mail/Account;->getMailboxs()Lcom/htc/android/mail/Mailboxs;

    move-result-object v5

    iget-wide v6, p1, Lcom/htc/android/mail/server/Server$PendingRequest;->fromMailboxId:J

    invoke-virtual {v5, v6, v7}, Lcom/htc/android/mail/Mailboxs;->getMailboxById(J)Lcom/htc/android/mail/Mailbox;

    move-result-object v3

    .line 1173
    .local v3, mailbox:Lcom/htc/android/mail/Mailbox;
    if-nez v3, :cond_2

    .line 1174
    invoke-virtual {p1}, Lcom/htc/android/mail/server/Server$PendingRequest;->delete()I

    goto :goto_0

    .line 1178
    :cond_2
    iget-boolean v5, v3, Lcom/htc/android/mail/Mailbox;->isServerFolder:Z

    if-nez v5, :cond_4

    .line 1179
    sget-boolean v5, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v5, :cond_3

    const-string v5, "ImapServer"

    const-string v6, "fromMailbox are not server folder"

    invoke-static {v5, v6}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 1180
    :cond_3
    invoke-virtual {p1}, Lcom/htc/android/mail/server/Server$PendingRequest;->delete()I

    goto :goto_0

    .line 1185
    :cond_4
    :try_start_0
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->probe()V

    .line 1186
    iget v5, p0, Lcom/htc/android/mail/server/Server;->socketState:I

    if-ne v5, v8, :cond_5

    .line 1187
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->init()V

    .line 1190
    :cond_5
    invoke-virtual {p0, v3}, Lcom/htc/android/mail/server/ImapServer;->selectMailbox(Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    .line 1192
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v4

    .line 1193
    .local v4, tag:Ljava/lang/String;
    sget-object v5, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v6, "%s STORE 1:* +FLAGS.SILENT (\\Deleted)"

    const/4 v7, 0x1

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    aput-object v4, v7, v8

    invoke-static {v5, v6, v7}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v5

    invoke-virtual {p0, v5}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 1194
    invoke-virtual {p0, v4}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    .line 1196
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v4

    .line 1197
    sget-object v5, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v6, "%s EXPUNGE"

    const/4 v7, 0x1

    new-array v7, v7, [Ljava/lang/Object;

    const/4 v8, 0x0

    aput-object v4, v7, v8

    invoke-static {v5, v6, v7}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v5

    invoke-virtual {p0, v5}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 1199
    const/4 v5, 0x0

    invoke-virtual {p0, v4, v5}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;Z)Ljava/util/List;

    .line 1201
    invoke-virtual {p1}, Lcom/htc/android/mail/server/Server$PendingRequest;->delete()I
    :try_end_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_1

    goto :goto_0

    .line 1202
    .end local v4           #tag:Ljava/lang/String;
    :catch_0
    move-exception v2

    .line 1203
    .local v2, e:Ljava/io/IOException;
    const-string v5, "ImapServer"

    const-string v6, "IO Exception"

    invoke-static {v5, v6, v2}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto/16 :goto_0

    .line 1204
    .end local v2           #e:Ljava/io/IOException;
    :catch_1
    move-exception v2

    .line 1205
    .local v2, e:Ljava/lang/Exception;
    const-string v5, "ImapServer"

    const-string v6, "Unknow Exception"

    invoke-static {v5, v6, v2}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 1207
    invoke-virtual {p1}, Lcom/htc/android/mail/server/Server$PendingRequest;->delete()I

    goto/16 :goto_0
.end method

.method public enableDirectPush()V
    .locals 7
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    const/4 v5, 0x1

    .line 5751
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DIRECTPUSH_DEBUG:Z

    if-eqz v3, :cond_0

    const-string v3, "ImapServer"

    const-string v4, "enableDirectPush"

    invoke-static {v3, v4}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 5752
    :cond_0
    iget v3, p0, Lcom/htc/android/mail/server/Server;->socketState:I

    if-ne v3, v5, :cond_1

    .line 5753
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->init()V

    .line 5755
    :cond_1
    iget-object v3, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v3}, Lcom/htc/android/mail/Account;->getMailboxs()Lcom/htc/android/mail/Mailboxs;

    move-result-object v3

    invoke-virtual {v3}, Lcom/htc/android/mail/Mailboxs;->getDefaultMailbox()Lcom/htc/android/mail/Mailbox;

    move-result-object v1

    .line 5756
    .local v1, mailbox:Lcom/htc/android/mail/Mailbox;
    invoke-virtual {p0, v1}, Lcom/htc/android/mail/server/ImapServer;->selectMailbox(Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    .line 5757
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v2

    .line 5758
    .local v2, tag:Ljava/lang/String;
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "%s IDLE"

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v6, 0x0

    aput-object v2, v5, v6

    invoke-static {v3, v4, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p0, v3}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 5759
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->readOneLineResponse()Lcom/htc/android/mail/ByteString;

    move-result-object v0

    .line 5760
    .local v0, line:Lcom/htc/android/mail/ByteString;
    if-nez v0, :cond_2

    new-instance v3, Ljava/io/IOException;

    const-string v4, "can\'t get idle respone"

    invoke-direct {v3, v4}, Ljava/io/IOException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 5762
    :cond_2
    const/16 v3, 0x2b

    invoke-virtual {v0, v3}, Lcom/htc/android/mail/ByteString;->indexOf(I)I

    move-result v3

    const/4 v4, -0x1

    if-ne v3, v4, :cond_3

    new-instance v3, Ljava/io/IOException;

    const-string v4, "can\'t enable idle command"

    invoke-direct {v3, v4}, Ljava/io/IOException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 5763
    :cond_3
    return-void
.end method

.method protected enableExtension(Ljava/lang/String;)Z
    .locals 11
    .parameter "extension"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    const/4 v10, 0x2

    const/4 v5, 0x0

    const/4 v6, 0x1

    .line 6106
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v3

    .line 6107
    .local v3, tag:Ljava/lang/String;
    sget-object v7, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v8, "%s ENABLE %s"

    new-array v9, v10, [Ljava/lang/Object;

    aput-object v3, v9, v5

    aput-object p1, v9, v6

    invoke-static {v7, v8, v9}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v7

    invoke-virtual {p0, v7}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 6108
    invoke-virtual {p0, v3}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v0

    .line 6110
    .local v0, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    if-nez v0, :cond_1

    .line 6121
    :cond_0
    :goto_0
    return v5

    .line 6112
    :cond_1
    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v2

    .line 6114
    .local v2, size:I
    add-int/lit8 v7, v2, -0x1

    invoke-interface {v0, v7}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/htc/android/mail/ByteString;

    .line 6115
    .local v1, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v1}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v7

    const-string v8, " "

    invoke-virtual {v7, v8}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v4

    .line 6117
    .local v4, token:[Ljava/lang/String;
    array-length v7, v4

    if-lt v7, v10, :cond_0

    array-length v7, v4

    if-le v7, v6, :cond_2

    aget-object v7, v4, v6

    sget-object v8, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v8}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v7

    if-nez v7, :cond_0

    :cond_2
    move v5, v6

    .line 6121
    goto :goto_0
.end method

.method protected fetchHeader(Lcom/htc/android/mail/Mailbox;Ljava/util/List;I)Ljava/util/List;
    .locals 14
    .parameter "mailbox"
    .parameter
    .parameter "sizeLimit"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/Mailbox;",
            "Ljava/util/List",
            "<",
            "Ljava/lang/String;",
            ">;I)",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/MailMessage;",
            ">;"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 3708
    .local p2, uIdList:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    new-instance v9, Ljava/util/ArrayList;

    invoke-direct {v9}, Ljava/util/ArrayList;-><init>()V

    .line 3709
    .local v9, mailMessageList:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    if-eqz v0, :cond_0

    iget-object v0, p1, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-object v1, v1, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    invoke-virtual {v0, v1}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_1

    .line 3710
    :cond_0
    invoke-virtual {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->selectMailbox(Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    .line 3713
    :cond_1
    invoke-interface/range {p2 .. p2}, Ljava/util/List;->size()I

    move-result v0

    if-lez v0, :cond_7

    .line 3714
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v10

    .line 3715
    .local v10, tag:Ljava/lang/String;
    const/4 v4, 0x0

    .line 3717
    .local v4, mOffset:I
    :goto_0
    sget-boolean v0, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v0, :cond_2

    const-string v0, "ImapServer"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "mOffset is "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 3718
    :cond_2
    invoke-interface/range {p2 .. p2}, Ljava/util/List;->size()I

    move-result v0

    if-lt v4, v0, :cond_3

    .line 3741
    .end local v4           #mOffset:I
    .end local v9           #mailMessageList:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    .end local v10           #tag:Ljava/lang/String;
    :goto_1
    return-object v9

    .line 3721
    .restart local v4       #mOffset:I
    .restart local v9       #mailMessageList:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    .restart local v10       #tag:Ljava/lang/String;
    :cond_3
    const-string v11, "%s UID FETCH %s (INTERNALDATE RFC822.SIZE FLAGS BODY.PEEK[HEADER.FIELDS (%s)])"

    const/4 v0, 0x3

    new-array v12, v0, [Ljava/lang/Object;

    const/4 v0, 0x0

    aput-object v10, v12, v0

    const/4 v13, 0x1

    const-string v2, ","

    const/4 v3, 0x0

    move-object v0, p0

    move-object/from16 v1, p2

    move/from16 v5, p3

    invoke-virtual/range {v0 .. v5}, Lcom/htc/android/mail/server/ImapServer;->combine(Ljava/util/List;Ljava/lang/String;ZII)Ljava/lang/String;

    move-result-object v0

    aput-object v0, v12, v13

    const/4 v0, 0x2

    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getHeaderFieldsForFetchHeader()Ljava/lang/String;

    move-result-object v1

    aput-object v1, v12, v0

    invoke-static {v11, v12}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v0

    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 3727
    invoke-virtual {p0, v10}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v7

    .line 3728
    .local v7, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    invoke-virtual {p0, v7}, Lcom/htc/android/mail/server/ImapServer;->processFetchHeader(Ljava/util/List;)Ljava/util/List;

    move-result-object v8

    .line 3729
    .local v8, mRetList:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    if-nez v8, :cond_4

    .line 3730
    const/4 v9, 0x0

    goto :goto_1

    .line 3732
    :cond_4
    const/4 v6, 0x0

    .local v6, i:I
    :goto_2
    invoke-interface {v8}, Ljava/util/List;->size()I

    move-result v0

    if-ge v6, v0, :cond_6

    .line 3733
    invoke-interface {v8, v6}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v0

    if-eqz v0, :cond_5

    .line 3734
    invoke-interface {v8, v6}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v0

    invoke-interface {v9, v0}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 3732
    :cond_5
    add-int/lit8 v6, v6, 0x1

    goto :goto_2

    .line 3737
    :cond_6
    add-int v4, v4, p3

    .line 3738
    goto :goto_0

    .line 3741
    .end local v4           #mOffset:I
    .end local v6           #i:I
    .end local v7           #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    .end local v8           #mRetList:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    .end local v10           #tag:Ljava/lang/String;
    :cond_7
    const/4 v9, 0x0

    goto :goto_1
.end method

.method protected fetchInfo(Lcom/htc/android/mail/Mailbox;Lcom/htc/android/mail/MailMessage;ILcom/htc/android/mail/AbsRequestController;)V
    .locals 14
    .parameter "mailbox"
    .parameter "mailMessage"
    .parameter "retry"
    .parameter "controller"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 2826
    const/4 v9, 0x0

    .line 2828
    .local v9, done:I
    :try_start_0
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v13

    .line 2831
    .local v13, tag:Ljava/lang/String;
    sget-boolean v1, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v1, :cond_0

    const-string v1, "ImapServer"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "enter fetchInfo: "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    move-object/from16 v0, p2

    iget-wide v3, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v2, v3, v4}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v1, v2}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 2832
    :cond_0
    sget-boolean v1, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v1, :cond_1

    const-string v1, "ImapServer"

    const-string v2, "check uid"

    invoke-static {v1, v2}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 2833
    :cond_1
    move-object/from16 v0, p2

    iget-object v1, v0, Lcom/htc/android/mail/MailMessage;->uid:Ljava/lang/String;

    if-eqz v1, :cond_2

    const-string v1, ""

    move-object/from16 v0, p2

    iget-object v2, v0, Lcom/htc/android/mail/MailMessage;->uid:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_6

    .line 2834
    :cond_2
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->syncPendingRequests()V

    .line 2835
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->isFinishSyncPendingRequest()Z

    move-result v1

    if-nez v1, :cond_4

    .line 2836
    sget-boolean v1, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v1, :cond_3

    const-string v1, "TAG"

    const-string v2, "PendingRequests is not empty"

    invoke-static {v1, v2}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_1

    .line 2873
    :cond_3
    move-object/from16 v0, p2

    iget-wide v1, v0, Lcom/htc/android/mail/MailMessage;->id:J

    .end local v13           #tag:Ljava/lang/String;
    :goto_0
    move-object/from16 v0, p4

    invoke-virtual {v0, v1, v2, v9}, Lcom/htc/android/mail/AbsRequestController;->fetchMessageDone(JI)V

    .line 2876
    return-void

    .line 2840
    .restart local v13       #tag:Ljava/lang/String;
    :cond_4
    :try_start_1
    move-object/from16 v0, p2

    iget-wide v1, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {p0, v1, v2}, Lcom/htc/android/mail/server/ImapServer;->getMessageUid(J)Ljava/lang/String;

    move-result-object v1

    move-object/from16 v0, p2

    iput-object v1, v0, Lcom/htc/android/mail/MailMessage;->uid:Ljava/lang/String;

    .line 2841
    move-object/from16 v0, p2

    iget-object v1, v0, Lcom/htc/android/mail/MailMessage;->uid:Ljava/lang/String;

    if-eqz v1, :cond_5

    const-string v1, ""

    move-object/from16 v0, p2

    iget-object v2, v0, Lcom/htc/android/mail/MailMessage;->uid:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Ljava/io/IOException; {:try_start_1 .. :try_end_1} :catch_0
    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_1

    move-result v1

    if-eqz v1, :cond_6

    .line 2873
    :cond_5
    move-object/from16 v0, p2

    iget-wide v1, v0, Lcom/htc/android/mail/MailMessage;->id:J

    goto :goto_0

    .line 2846
    :cond_6
    :try_start_2
    sget-boolean v1, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v1, :cond_7

    const-string v1, "ImapServer"

    const-string v2, "fetch info"

    invoke-static {v1, v2}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 2848
    :cond_7
    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    if-eqz v1, :cond_8

    iget-object v1, p1, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    iget-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-object v2, v2, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    invoke-virtual {v1, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v1

    if-nez v1, :cond_9

    .line 2849
    :cond_8
    invoke-virtual {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->selectMailbox(Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    .line 2852
    :cond_9
    move-object/from16 v0, p2

    iget-object v1, v0, Lcom/htc/android/mail/MailMessage;->uid:Ljava/lang/String;

    invoke-virtual {p0, v13, v1}, Lcom/htc/android/mail/server/ImapServer;->getFetchInfoCommand(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v1

    invoke-virtual {p0, v1}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 2853
    invoke-virtual {p0, v13}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v11

    .line 2854
    .local v11, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    new-instance v12, Ljava/util/ArrayList;

    invoke-direct {v12}, Ljava/util/ArrayList;-><init>()V

    .line 2855
    .local v12, operations:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/ContentProviderOperation;>;"
    move-object/from16 v0, p2

    invoke-direct {p0, v11, v0, v13, v12}, Lcom/htc/android/mail/server/ImapServer;->processFetchInfo(Ljava/util/List;Lcom/htc/android/mail/MailMessage;Ljava/lang/String;Ljava/util/ArrayList;)Z

    move-result v1

    if-eqz v1, :cond_d

    .line 2856
    invoke-virtual {v12}, Ljava/util/ArrayList;->size()I

    move-result v1

    if-lez v1, :cond_a

    .line 2857
    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v1

    const-string v2, "mail"

    invoke-virtual {v1, v2, v12}, Landroid/content/ContentResolver;->applyBatch(Ljava/lang/String;Ljava/util/ArrayList;)[Landroid/content/ContentProviderResult;

    .line 2859
    :cond_a
    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget v1, v1, Lcom/htc/android/mail/Mailbox;->kind:I

    const v2, 0x7ffffffc

    if-ne v1, v2, :cond_b

    .line 2860
    const/4 v4, 0x0

    const/4 v5, 0x0

    const/4 v6, 0x0

    const/4 v7, 0x0

    const/4 v8, 0x0

    move-object v1, p0

    move-object v2, p1

    move-object/from16 v3, p2

    invoke-virtual/range {v1 .. v8}, Lcom/htc/android/mail/server/ImapServer;->fetchMultiAttachmentsInternal(Lcom/htc/android/mail/Mailbox;Lcom/htc/android/mail/MailMessage;ZZLcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;Ljava/lang/String;)V

    .line 2862
    :cond_b
    const/4 v9, 0x1

    .line 2863
    move-object/from16 v0, p2

    iget-wide v1, v0, Lcom/htc/android/mail/MailMessage;->id:J

    const/4 v3, 0x2

    invoke-static {v1, v2, v9, v3}, Lcom/htc/android/mail/MailProvider;->updateMessageDone(JII)I

    .line 2864
    sget-boolean v1, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v1, :cond_c

    const-string v1, "ImapServer"

    const-string v2, "processFetchInfo complete"

    invoke-static {v1, v2}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0
    .catch Ljava/io/IOException; {:try_start_2 .. :try_end_2} :catch_0
    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_1

    .line 2873
    :cond_c
    :goto_1
    move-object/from16 v0, p2

    iget-wide v1, v0, Lcom/htc/android/mail/MailMessage;->id:J

    goto/16 :goto_0

    .line 2866
    :cond_d
    :try_start_3
    sget-boolean v1, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v1, :cond_c

    const-string v1, "ImapServer"

    const-string v2, "processFetchInfo failed"

    invoke-static {v1, v2}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0
    .catch Ljava/io/IOException; {:try_start_3 .. :try_end_3} :catch_0
    .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_1

    goto :goto_1

    .line 2868
    .end local v11           #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    .end local v12           #operations:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/ContentProviderOperation;>;"
    .end local v13           #tag:Ljava/lang/String;
    :catch_0
    move-exception v10

    .line 2869
    .local v10, e:Ljava/io/IOException;
    :try_start_4
    throw v10
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    .line 2873
    .end local v10           #e:Ljava/io/IOException;
    :catchall_0
    move-exception v1

    move-object/from16 v0, p2

    iget-wide v2, v0, Lcom/htc/android/mail/MailMessage;->id:J

    move-object/from16 v0, p4

    invoke-virtual {v0, v2, v3, v9}, Lcom/htc/android/mail/AbsRequestController;->fetchMessageDone(JI)V

    throw v1

    .line 2870
    :catch_1
    move-exception v10

    .line 2871
    .local v10, e:Ljava/lang/Exception;
    :try_start_5
    const-string v1, "ImapServer"

    const-string v2, "catch exception"

    invoke-static {v1, v2, v10}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_0

    .line 2873
    move-object/from16 v0, p2

    iget-wide v1, v0, Lcom/htc/android/mail/MailMessage;->id:J

    goto/16 :goto_0
.end method

.method public fetchMailAgain(Lcom/htc/android/mail/Mailbox;Ljava/lang/String;JILjava/lang/String;)V
    .locals 7
    .parameter "mailbox"
    .parameter "uid"
    .parameter "msgId"
    .parameter "retry"
    .parameter "charset"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    const/4 v6, 0x0

    .line 2721
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->preFetchMailAgain()V

    .line 2723
    iget-object v4, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-static {v4}, Lcom/htc/android/mail/RequestController;->getInstance(Landroid/content/Context;)Lcom/htc/android/mail/RequestController;

    move-result-object v1

    .line 2724
    .local v1, controller:Lcom/htc/android/mail/AbsRequestController;
    const/4 v0, 0x0

    .line 2726
    .local v0, catchException:Z
    :try_start_0
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->probe()V

    .line 2727
    iget v4, p0, Lcom/htc/android/mail/server/Server;->socketState:I

    const/4 v5, 0x1

    if-ne v4, v5, :cond_0

    .line 2728
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->init()V
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_1

    .line 2737
    :cond_0
    if-eqz v0, :cond_1

    .line 2738
    :goto_0
    invoke-virtual {v1, p3, p4, v6}, Lcom/htc/android/mail/RequestController;->fetchMessageDone(JI)V

    .line 2742
    :cond_1
    new-instance v3, Lcom/htc/android/mail/MailMessage;

    const/4 v4, 0x0

    invoke-direct {v3, p3, p4, p2, v4}, Lcom/htc/android/mail/MailMessage;-><init>(JLjava/lang/String;Ljava/lang/String;)V

    .line 2743
    .local v3, mailMessage:Lcom/htc/android/mail/MailMessage;
    iget-object v4, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v4}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v4

    invoke-virtual {v3, v4, v5}, Lcom/htc/android/mail/MailMessage;->setAccountId(J)V

    .line 2744
    iget-wide v4, p1, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-virtual {v3, v4, v5}, Lcom/htc/android/mail/MailMessage;->setMailboxId(J)V

    .line 2745
    invoke-virtual {v3, p6}, Lcom/htc/android/mail/MailMessage;->setSubjectCharset(Ljava/lang/String;)V

    .line 2746
    invoke-virtual {p0, p1, v3, p5, v1}, Lcom/htc/android/mail/server/ImapServer;->fetchInfo(Lcom/htc/android/mail/Mailbox;Lcom/htc/android/mail/MailMessage;ILcom/htc/android/mail/AbsRequestController;)V

    .line 2747
    return-void

    .line 2730
    .end local v3           #mailMessage:Lcom/htc/android/mail/MailMessage;
    :catch_0
    move-exception v2

    .line 2731
    .local v2, e:Ljava/io/IOException;
    const/4 v0, 0x1

    .line 2732
    :try_start_1
    throw v2
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 2737
    .end local v2           #e:Ljava/io/IOException;
    :catchall_0
    move-exception v4

    if-eqz v0, :cond_2

    .line 2738
    invoke-virtual {v1, p3, p4, v6}, Lcom/htc/android/mail/RequestController;->fetchMessageDone(JI)V

    .line 2737
    :cond_2
    throw v4

    .line 2733
    :catch_1
    move-exception v2

    .line 2734
    .local v2, e:Ljava/lang/Exception;
    const/4 v0, 0x1

    .line 2735
    :try_start_2
    invoke-virtual {v2}, Ljava/lang/Exception;->printStackTrace()V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 2737
    if-eqz v0, :cond_1

    goto :goto_0
.end method

.method public fetchMailBoxList()V
    .locals 6
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    const/4 v4, 0x1

    .line 891
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->probe()V

    .line 893
    iget v2, p0, Lcom/htc/android/mail/server/Server;->socketState:I

    if-ne v2, v4, :cond_0

    .line 894
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->init()V

    .line 897
    :cond_0
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v1

    .line 898
    .local v1, tag:Ljava/lang/String;
    iget-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    const-string v3, ""

    invoke-virtual {p0, v2, v3}, Lcom/htc/android/mail/server/ImapServer;->updateProgressStatus(Lcom/htc/android/mail/Account;Ljava/lang/String;)V

    .line 899
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v3, "%s LIST \"\" *"

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v5, 0x0

    aput-object v1, v4, v5

    invoke-static {v2, v3, v4}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v2

    invoke-virtual {p0, v2}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 902
    invoke-virtual {p0, v1}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v0

    .line 903
    .local v0, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->processLIST(Ljava/util/List;)V

    .line 904
    return-void
.end method

.method public fetchMultiAttachments(Lcom/htc/android/mail/Mailbox;Lcom/htc/android/mail/MailMessage;ZLcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;Ljava/lang/String;)V
    .locals 8
    .parameter "mailbox"
    .parameter "message"
    .parameter "onlyRealted"
    .parameter "controller"
    .parameter
    .parameter "fileReference"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/Mailbox;",
            "Lcom/htc/android/mail/MailMessage;",
            "Z",
            "Lcom/htc/android/mail/AbsRequestController;",
            "Ljava/lang/ref/WeakReference",
            "<",
            "Landroid/os/Handler;",
            ">;",
            "Ljava/lang/String;",
            ")V"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 4412
    .local p5, weakHandler:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Landroid/os/Handler;>;"
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v0}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v0

    invoke-virtual {p2, v0, v1}, Lcom/htc/android/mail/MailMessage;->setAccountId(J)V

    .line 4413
    iget-wide v0, p1, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-virtual {p2, v0, v1}, Lcom/htc/android/mail/MailMessage;->setMailboxId(J)V

    .line 4414
    const/4 v4, 0x1

    move-object v0, p0

    move-object v1, p1

    move-object v2, p2

    move v3, p3

    move-object v5, p4

    move-object v6, p5

    move-object v7, p6

    invoke-virtual/range {v0 .. v7}, Lcom/htc/android/mail/server/ImapServer;->fetchMultiAttachmentsInternal(Lcom/htc/android/mail/Mailbox;Lcom/htc/android/mail/MailMessage;ZZLcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;Ljava/lang/String;)V

    .line 4415
    return-void
.end method

.method public fetchMultiAttachmentsInternal(Lcom/htc/android/mail/Mailbox;Lcom/htc/android/mail/MailMessage;ZZLcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;Ljava/lang/String;)V
    .locals 28
    .parameter "mailbox"
    .parameter "message"
    .parameter "onlyRealted"
    .parameter "doProbe"
    .parameter "controller"
    .parameter
    .parameter "fileReference"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/Mailbox;",
            "Lcom/htc/android/mail/MailMessage;",
            "ZZ",
            "Lcom/htc/android/mail/AbsRequestController;",
            "Ljava/lang/ref/WeakReference",
            "<",
            "Landroid/os/Handler;",
            ">;",
            "Ljava/lang/String;",
            ")V"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 4419
    .local p6, weakHandler:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Landroid/os/Handler;>;"
    if-eqz p4, :cond_0

    .line 4420
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->probe()V

    .line 4423
    :cond_0
    move-object/from16 v0, p0

    iget v2, v0, Lcom/htc/android/mail/server/Server;->socketState:I

    const/4 v5, 0x1

    if-ne v2, v5, :cond_1

    .line 4424
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->init()V

    .line 4427
    :cond_1
    move-object/from16 v0, p0

    iget-object v2, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    if-eqz v2, :cond_2

    move-object/from16 v0, p1

    iget-object v2, v0, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    move-object/from16 v0, p0

    iget-object v5, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-object v5, v5, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    invoke-virtual {v2, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_3

    .line 4428
    :cond_2
    invoke-virtual/range {p0 .. p1}, Lcom/htc/android/mail/server/ImapServer;->selectMailbox(Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    .line 4431
    :cond_3
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v1

    .line 4434
    .local v1, cp:Landroid/content/IContentProvider;
    if-eqz p3, :cond_7

    .line 4435
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v5, "_message = \'%d\' AND _filename <> \'\' AND _contenttype = \'%d\'"

    const/4 v6, 0x2

    new-array v6, v6, [Ljava/lang/Object;

    const/4 v7, 0x0

    move-object/from16 v0, p2

    iget-wide v8, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-static {v8, v9}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v8

    aput-object v8, v6, v7

    const/4 v7, 0x1

    sget v8, Lcom/htc/android/mail/Rfc2822;->CONTENTTYPE_RELATED:I

    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v8

    aput-object v8, v6, v7

    invoke-static {v2, v5, v6}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v4

    .line 4439
    .local v4, where:Ljava/lang/String;
    :goto_0
    const/4 v2, 0x6

    new-array v3, v2, [Ljava/lang/String;

    const/4 v2, 0x0

    const-string v5, "_id"

    aput-object v5, v3, v2

    const/4 v2, 0x1

    const-string v5, "_index"

    aput-object v5, v3, v2

    const/4 v2, 0x2

    const-string v5, "_encode"

    aput-object v5, v3, v2

    const/4 v2, 0x3

    const-string v5, "_filename"

    aput-object v5, v3, v2

    const/4 v2, 0x4

    const-string v5, "_mimetype"

    aput-object v5, v3, v2

    const/4 v2, 0x5

    const-string v5, "_filepath"

    aput-object v5, v3, v2

    .line 4442
    .local v3, projection:[Ljava/lang/String;
    const/16 v19, 0x0

    .line 4444
    .local v19, c:Landroid/database/Cursor;
    :try_start_0
    sget-object v2, Lcom/htc/android/mail/MailProvider;->sPartsURI:Landroid/net/Uri;

    const/4 v5, 0x0

    const/4 v6, 0x0

    invoke-interface/range {v1 .. v6}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v19

    .line 4446
    if-eqz v19, :cond_9

    .line 4450
    const-wide/16 v26, -0x1

    .line 4451
    .local v26, startTimeStamp:J
    const/16 v25, 0x1

    .line 4452
    .local v25, refreshMailbody:Z
    :cond_4
    :goto_1
    invoke-interface/range {v19 .. v19}, Landroid/database/Cursor;->moveToNext()Z

    move-result v2

    if-eqz v2, :cond_a

    .line 4453
    const-string v2, "_filepath"

    move-object/from16 v0, v19

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    move-object/from16 v0, v19

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v22

    .line 4454
    .local v22, filePath:Ljava/lang/String;
    if-eqz v22, :cond_5

    .line 4455
    new-instance v21, Ljava/io/File;

    invoke-direct/range {v21 .. v22}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    .line 4456
    .local v21, file:Ljava/io/File;
    invoke-virtual/range {v21 .. v21}, Ljava/io/File;->exists()Z

    move-result v2

    if-nez v2, :cond_4

    .line 4460
    .end local v21           #file:Ljava/io/File;
    :cond_5
    const-string v2, "_id"

    move-object/from16 v0, v19

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    move-object/from16 v0, v19

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v23

    .line 4461
    .local v23, id:J
    const-string v2, "_index"

    move-object/from16 v0, v19

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    move-object/from16 v0, v19

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v10

    .line 4462
    .local v10, index:Ljava/lang/String;
    const-string v2, "_encode"

    move-object/from16 v0, v19

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    move-object/from16 v0, v19

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v11

    .line 4463
    .local v11, encode:Ljava/lang/String;
    const-string v2, "_filename"

    move-object/from16 v0, v19

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    move-object/from16 v0, v19

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v12

    .line 4464
    .local v12, fileName:Ljava/lang/String;
    const-string v2, "_mimetype"

    move-object/from16 v0, v19

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    move-object/from16 v0, v19

    invoke-interface {v0, v2}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v13

    .line 4465
    .local v13, mimeType:Ljava/lang/String;
    if-eqz v25, :cond_6

    .line 4466
    const/16 v25, 0x0

    .line 4467
    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v26

    .line 4469
    :cond_6
    if-eqz p3, :cond_8

    .line 4470
    const-wide/16 v8, 0x0

    const/4 v14, 0x1

    sget v15, Lcom/htc/android/mail/Rfc2822;->CONTENTTYPE_RELATED:I

    move-object/from16 v5, p0

    move-object/from16 v6, p1

    move-object/from16 v7, p2

    move-object/from16 v16, p5

    move-object/from16 v17, p6

    move-object/from16 v18, p7

    invoke-direct/range {v5 .. v18}, Lcom/htc/android/mail/server/ImapServer;->fetchPartByUidInternal(Lcom/htc/android/mail/Mailbox;Lcom/htc/android/mail/MailMessage;JLjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;ZILcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;Ljava/lang/String;)V

    .line 4474
    :goto_2
    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v5

    sub-long v5, v5, v26

    const-wide/16 v7, 0x2710

    cmp-long v2, v5, v7

    if-ltz v2, :cond_4

    .line 4475
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->reloadMailbody()V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 4476
    const/16 v25, 0x1

    goto/16 :goto_1

    .line 4437
    .end local v3           #projection:[Ljava/lang/String;
    .end local v4           #where:Ljava/lang/String;
    .end local v10           #index:Ljava/lang/String;
    .end local v11           #encode:Ljava/lang/String;
    .end local v12           #fileName:Ljava/lang/String;
    .end local v13           #mimeType:Ljava/lang/String;
    .end local v19           #c:Landroid/database/Cursor;
    .end local v22           #filePath:Ljava/lang/String;
    .end local v23           #id:J
    .end local v25           #refreshMailbody:Z
    .end local v26           #startTimeStamp:J
    :cond_7
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v5, "_message = \'%d\' AND _filename <> \'\'"

    const/4 v6, 0x1

    new-array v6, v6, [Ljava/lang/Object;

    const/4 v7, 0x0

    move-object/from16 v0, p2

    iget-wide v8, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-static {v8, v9}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v8

    aput-object v8, v6, v7

    invoke-static {v2, v5, v6}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v4

    .restart local v4       #where:Ljava/lang/String;
    goto/16 :goto_0

    .line 4472
    .restart local v3       #projection:[Ljava/lang/String;
    .restart local v10       #index:Ljava/lang/String;
    .restart local v11       #encode:Ljava/lang/String;
    .restart local v12       #fileName:Ljava/lang/String;
    .restart local v13       #mimeType:Ljava/lang/String;
    .restart local v19       #c:Landroid/database/Cursor;
    .restart local v22       #filePath:Ljava/lang/String;
    .restart local v23       #id:J
    .restart local v25       #refreshMailbody:Z
    .restart local v26       #startTimeStamp:J
    :cond_8
    const-wide/16 v8, 0x0

    const/4 v14, 0x1

    :try_start_1
    sget v15, Lcom/htc/android/mail/Rfc2822;->CONTENTTYPE_MIXED:I

    move-object/from16 v5, p0

    move-object/from16 v6, p1

    move-object/from16 v7, p2

    move-object/from16 v16, p5

    move-object/from16 v17, p6

    move-object/from16 v18, p7

    invoke-direct/range {v5 .. v18}, Lcom/htc/android/mail/server/ImapServer;->fetchPartByUidInternal(Lcom/htc/android/mail/Mailbox;Lcom/htc/android/mail/MailMessage;JLjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;ZILcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;Ljava/lang/String;)V
    :try_end_1
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    goto :goto_2

    .line 4485
    .end local v10           #index:Ljava/lang/String;
    .end local v11           #encode:Ljava/lang/String;
    .end local v12           #fileName:Ljava/lang/String;
    .end local v13           #mimeType:Ljava/lang/String;
    .end local v22           #filePath:Ljava/lang/String;
    .end local v23           #id:J
    .end local v25           #refreshMailbody:Z
    .end local v26           #startTimeStamp:J
    :catch_0
    move-exception v20

    .line 4486
    .local v20, e:Landroid/os/RemoteException;
    const-string v2, "ImapServer"

    const-string v5, "catch RemoteException"

    move-object/from16 v0, v20

    invoke-static {v2, v5, v0}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V

    .line 4487
    if-eqz v19, :cond_9

    .line 4488
    invoke-interface/range {v19 .. v19}, Landroid/database/Cursor;->close()V

    .line 4490
    .end local v20           #e:Landroid/os/RemoteException;
    :cond_9
    :goto_3
    return-void

    .line 4479
    .restart local v25       #refreshMailbody:Z
    .restart local v26       #startTimeStamp:J
    :cond_a
    :try_start_2
    invoke-interface/range {v19 .. v19}, Landroid/database/Cursor;->close()V

    .line 4480
    const/16 v19, 0x0

    .line 4481
    if-nez v25, :cond_9

    .line 4482
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->reloadMailbody()V
    :try_end_2
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_0

    goto :goto_3
.end method

.method public fetchPartByUid(Lcom/htc/android/mail/Mailbox;Ljava/lang/String;JJLjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;ZILcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;Ljava/lang/String;)V
    .locals 17
    .parameter "mailbox"
    .parameter "uid"
    .parameter "msgid"
    .parameter "bodyid"
    .parameter "index"
    .parameter "encode"
    .parameter "charsetOrfilename"
    .parameter "mimetype"
    .parameter "saveAsFile"
    .parameter "attachType"
    .parameter "controller"
    .parameter
    .parameter "fileReference"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/Mailbox;",
            "Ljava/lang/String;",
            "JJ",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "ZI",
            "Lcom/htc/android/mail/AbsRequestController;",
            "Ljava/lang/ref/WeakReference",
            "<",
            "Landroid/os/Handler;",
            ">;",
            "Ljava/lang/String;",
            ")V"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 4496
    .local p14, weakHandler:Ljava/lang/ref/WeakReference;,"Ljava/lang/ref/WeakReference<Landroid/os/Handler;>;"
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->probe()V

    .line 4498
    move-object/from16 v0, p0

    iget v3, v0, Lcom/htc/android/mail/server/Server;->socketState:I

    const/4 v4, 0x1

    if-ne v3, v4, :cond_0

    .line 4499
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->init()V

    .line 4502
    :cond_0
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    if-eqz v3, :cond_1

    move-object/from16 v0, p1

    iget-object v3, v0, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-object v4, v4, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    invoke-virtual {v3, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_2

    .line 4503
    :cond_1
    invoke-virtual/range {p0 .. p1}, Lcom/htc/android/mail/server/ImapServer;->selectMailbox(Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    .line 4506
    :cond_2
    new-instance v5, Lcom/htc/android/mail/MailMessage;

    const/4 v3, 0x0

    move-wide/from16 v0, p3

    move-object/from16 v2, p2

    invoke-direct {v5, v0, v1, v2, v3}, Lcom/htc/android/mail/MailMessage;-><init>(JLjava/lang/String;Ljava/lang/String;)V

    .line 4507
    .local v5, mailMessage:Lcom/htc/android/mail/MailMessage;
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v3}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v3

    invoke-virtual {v5, v3, v4}, Lcom/htc/android/mail/MailMessage;->setAccountId(J)V

    .line 4508
    move-object/from16 v0, p1

    iget-wide v3, v0, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-virtual {v5, v3, v4}, Lcom/htc/android/mail/MailMessage;->setMailboxId(J)V

    move-object/from16 v3, p0

    move-object/from16 v4, p1

    move-wide/from16 v6, p5

    move-object/from16 v8, p7

    move-object/from16 v9, p8

    move-object/from16 v10, p9

    move-object/from16 v11, p10

    move/from16 v12, p11

    move/from16 v13, p12

    move-object/from16 v14, p13

    move-object/from16 v15, p14

    move-object/from16 v16, p15

    .line 4509
    invoke-direct/range {v3 .. v16}, Lcom/htc/android/mail/server/ImapServer;->fetchPartByUidInternal(Lcom/htc/android/mail/Mailbox;Lcom/htc/android/mail/MailMessage;JLjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;ZILcom/htc/android/mail/AbsRequestController;Ljava/lang/ref/WeakReference;Ljava/lang/String;)V

    .line 4510
    return-void
.end method

.method protected fetchPartWithSize(Lcom/htc/android/mail/MailMessage;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;IILjava/util/ArrayList;)Z
    .locals 20
    .parameter "mailMessage"
    .parameter "index"
    .parameter "mimeType"
    .parameter "charsetOrfilename"
    .parameter "nowEncode"
    .parameter "totalSize"
    .parameter "includeAttach"
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/MailMessage;",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "Ljava/lang/String;",
            "II",
            "Ljava/util/ArrayList",
            "<",
            "Landroid/content/ContentProviderOperation;",
            ">;)Z"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .line 2454
    .local p8, operations:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/ContentProviderOperation;>;"
    sget-boolean v1, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v1, :cond_0

    .line 2455
    const-string v1, "ImapServer"

    const-string v2, "enter fetchPartWithSize"

    invoke-static {v1, v2}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 2456
    :cond_0
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v8

    .line 2459
    .local v8, tag:Ljava/lang/String;
    sget-boolean v1, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v1, :cond_1

    .line 2460
    const-string v1, "ImapServer"

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "sizeLImit:"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v3, v4}, Lcom/htc/android/mail/Account;->getSizeLimit(Landroid/content/Context;)I

    move-result v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v1, v2}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 2461
    :cond_1
    move-object/from16 v0, p0

    iget-object v1, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v0, p0

    iget-object v2, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v1, v2}, Lcom/htc/android/mail/Account;->getSizeLimit(Landroid/content/Context;)I

    move-result v1

    const/4 v2, -0x1

    if-ne v1, v2, :cond_2

    .line 2462
    sget-object v1, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v2, "%s UID FETCH %s (INTERNALDATE RFC822.SIZE FLAGS BODY.PEEK[HEADER.FIELDS (subject from date to cc)] BODY.PEEK[%s]<0.%d>)"

    const/4 v3, 0x4

    new-array v3, v3, [Ljava/lang/Object;

    const/4 v4, 0x0

    aput-object v8, v3, v4

    const/4 v4, 0x1

    move-object/from16 v0, p1

    iget-object v5, v0, Lcom/htc/android/mail/MailMessage;->uid:Ljava/lang/String;

    aput-object v5, v3, v4

    const/4 v4, 0x2

    aput-object p2, v3, v4

    const/4 v4, 0x3

    const/high16 v5, 0x10

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v3, v4

    invoke-static {v1, v2, v3}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v1

    move-object/from16 v0, p0

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 2474
    :goto_0
    move-object/from16 v0, p0

    invoke-virtual {v0, v8}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v11

    .local v11, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    move-object/from16 v9, p0

    move-object/from16 v10, p1

    move-object/from16 v12, p3

    move-object/from16 v13, p4

    move-object/from16 v14, p5

    move/from16 v15, p6

    move/from16 v16, p7

    move-object/from16 v17, v8

    move-object/from16 v18, p2

    move-object/from16 v19, p8

    .line 2475
    invoke-direct/range {v9 .. v19}, Lcom/htc/android/mail/server/ImapServer;->processfetchPartWithSize(Lcom/htc/android/mail/MailMessage;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;IILjava/lang/String;Ljava/lang/String;Ljava/util/ArrayList;)Z

    move-result v1

    .end local v11           #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    :goto_1
    return v1

    .line 2464
    :cond_2
    move-object/from16 v0, p0

    iget-object v1, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v0, p0

    iget-object v2, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v1, v2}, Lcom/htc/android/mail/Account;->getSizeLimit(Landroid/content/Context;)I

    move-result v1

    if-nez v1, :cond_3

    .line 2467
    move-object/from16 v0, p1

    iget-object v2, v0, Lcom/htc/android/mail/MailMessage;->uid:Ljava/lang/String;

    move-object/from16 v1, p0

    move-object/from16 v3, p3

    move-object/from16 v4, p4

    move-object/from16 v5, p5

    move/from16 v6, p6

    move/from16 v7, p7

    move-object/from16 v9, p2

    invoke-direct/range {v1 .. v9}, Lcom/htc/android/mail/server/ImapServer;->processfetchPartWithHeaderOnly(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;IILjava/lang/String;Ljava/lang/String;)Z

    move-result v1

    goto :goto_1

    .line 2469
    :cond_3
    sget-object v1, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v2, "%s UID FETCH %s (INTERNALDATE RFC822.SIZE FLAGS BODY.PEEK[HEADER.FIELDS (subject from date to cc)] BODY.PEEK[%s]<0.%d>)"

    const/4 v3, 0x4

    new-array v3, v3, [Ljava/lang/Object;

    const/4 v4, 0x0

    aput-object v8, v3, v4

    const/4 v4, 0x1

    move-object/from16 v0, p1

    iget-object v5, v0, Lcom/htc/android/mail/MailMessage;->uid:Ljava/lang/String;

    aput-object v5, v3, v4

    const/4 v4, 0x2

    aput-object p2, v3, v4

    const/4 v4, 0x3

    move-object/from16 v0, p0

    iget-object v5, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v0, p0

    iget-object v6, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v5, v6}, Lcom/htc/android/mail/Account;->getSizeLimit(Landroid/content/Context;)I

    move-result v5

    mul-int/lit16 v5, v5, 0x400

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v3, v4

    invoke-static {v1, v2, v3}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v1

    move-object/from16 v0, p0

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    goto :goto_0
.end method

.method protected getBodyInfoBySizeLimit(Lcom/htc/android/mail/Account;Lcom/htc/android/mail/IMap4Body;)Lcom/htc/android/mail/Imap4InfoObject;
    .locals 4
    .parameter "account"
    .parameter "body"

    .prologue
    .line 5578
    const/4 v0, 0x0

    .line 5580
    .local v0, result:Lcom/htc/android/mail/Imap4InfoObject;
    iget-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    iget-object v3, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v2, v3}, Lcom/htc/android/mail/Account;->getSizeLimitIndex(Landroid/content/Context;)I

    move-result v2

    const/4 v3, 0x1

    if-eq v2, v3, :cond_0

    iget-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    iget-object v3, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v2, v3}, Lcom/htc/android/mail/Account;->getSizeLimitIndex(Landroid/content/Context;)I

    move-result v2

    const/4 v3, 0x2

    if-ne v2, v3, :cond_2

    .line 5581
    :cond_0
    const-string v2, "text"

    const-string v3, "plain"

    invoke-virtual {p2, v2, v3}, Lcom/htc/android/mail/IMap4Body;->getTextHtmlIndex(Ljava/lang/String;Ljava/lang/String;)Lcom/htc/android/mail/Imap4InfoObject;

    move-result-object v0

    .line 5582
    if-nez v0, :cond_1

    .line 5583
    const-string v2, "text"

    const-string v3, "html"

    invoke-virtual {p2, v2, v3}, Lcom/htc/android/mail/IMap4Body;->getTextHtmlIndex(Ljava/lang/String;Ljava/lang/String;)Lcom/htc/android/mail/Imap4InfoObject;

    move-result-object v0

    :cond_1
    move-object v1, v0

    .line 5589
    .end local v0           #result:Lcom/htc/android/mail/Imap4InfoObject;
    .local v1, result:Lcom/htc/android/mail/Imap4InfoObject;
    :goto_0
    return-object v1

    .line 5586
    .end local v1           #result:Lcom/htc/android/mail/Imap4InfoObject;
    .restart local v0       #result:Lcom/htc/android/mail/Imap4InfoObject;
    :cond_2
    const-string v2, "text"

    const-string v3, "html"

    invoke-virtual {p2, v2, v3}, Lcom/htc/android/mail/IMap4Body;->getTextHtmlIndex(Ljava/lang/String;Ljava/lang/String;)Lcom/htc/android/mail/Imap4InfoObject;

    move-result-object v0

    .line 5587
    if-nez v0, :cond_3

    .line 5588
    const-string v2, "text"

    const-string v3, "plain"

    invoke-virtual {p2, v2, v3}, Lcom/htc/android/mail/IMap4Body;->getTextHtmlIndex(Ljava/lang/String;Ljava/lang/String;)Lcom/htc/android/mail/Imap4InfoObject;

    move-result-object v0

    :cond_3
    move-object v1, v0

    .line 5589
    .end local v0           #result:Lcom/htc/android/mail/Imap4InfoObject;
    .restart local v1       #result:Lcom/htc/android/mail/Imap4InfoObject;
    goto :goto_0
.end method

.method protected getBodyStructure(Lcom/htc/android/mail/Mailbox;Ljava/lang/String;J)Lcom/htc/android/mail/IMap4Body;
    .locals 20
    .parameter "mailbox"
    .parameter "uid"
    .parameter "messageId"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 2751
    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    move-object/from16 v16, v0

    if-eqz v16, :cond_0

    move-object/from16 v0, p1

    iget-object v0, v0, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    move-object/from16 v16, v0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    move-object/from16 v17, v0

    move-object/from16 v0, v17

    iget-object v0, v0, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    move-object/from16 v17, v0

    invoke-virtual/range {v16 .. v17}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v16

    if-nez v16, :cond_1

    .line 2752
    :cond_0
    invoke-virtual/range {p0 .. p1}, Lcom/htc/android/mail/server/ImapServer;->selectMailbox(Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    .line 2755
    :cond_1
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v13

    .line 2756
    .local v13, tag:Ljava/lang/String;
    sget-object v16, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v17, "%s UID FETCH %s (BODYSTRUCTURE)"

    const/16 v18, 0x2

    move/from16 v0, v18

    new-array v0, v0, [Ljava/lang/Object;

    move-object/from16 v18, v0

    const/16 v19, 0x0

    aput-object v13, v18, v19

    const/16 v19, 0x1

    aput-object p2, v18, v19

    invoke-static/range {v16 .. v18}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v16

    move-object/from16 v0, p0

    move-object/from16 v1, v16

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 2757
    move-object/from16 v0, p0

    invoke-virtual {v0, v13}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v8

    .line 2759
    .local v8, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    invoke-interface {v8}, Ljava/util/List;->size()I

    move-result v12

    .line 2761
    .local v12, size:I
    if-nez v12, :cond_2

    .line 2762
    const/4 v7, 0x0

    .line 2818
    :goto_0
    return-object v7

    .line 2765
    :cond_2
    add-int/lit8 v16, v12, -0x1

    move/from16 v0, v16

    invoke-interface {v8, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/htc/android/mail/ByteString;

    .line 2766
    .local v10, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v10}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v16

    const-string v17, " "

    invoke-virtual/range {v16 .. v17}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v14

    .line 2768
    .local v14, token:[Ljava/lang/String;
    array-length v0, v14

    move/from16 v16, v0

    const/16 v17, 0x2

    move/from16 v0, v16

    move/from16 v1, v17

    if-lt v0, v1, :cond_3

    array-length v0, v14

    move/from16 v16, v0

    const/16 v17, 0x1

    move/from16 v0, v16

    move/from16 v1, v17

    if-le v0, v1, :cond_4

    const/16 v16, 0x1

    aget-object v16, v14, v16

    sget-object v17, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual/range {v17 .. v17}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-virtual/range {v16 .. v17}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v16

    if-eqz v16, :cond_4

    .line 2769
    :cond_3
    const/4 v7, 0x0

    goto :goto_0

    .line 2772
    :cond_4
    invoke-interface {v8}, Ljava/util/List;->size()I

    move-result v16

    add-int/lit8 v6, v16, -0x1

    .local v6, i:I
    :goto_1
    if-ltz v6, :cond_7

    .line 2773
    invoke-interface {v8, v6}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v10

    .end local v10           #r:Lcom/htc/android/mail/ByteString;
    check-cast v10, Lcom/htc/android/mail/ByteString;

    .line 2774
    .restart local v10       #r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v10}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v16

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, v17

    invoke-virtual {v0, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, " "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    sget-object v18, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual/range {v18 .. v18}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v18

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-virtual/range {v16 .. v17}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v16

    if-eqz v16, :cond_6

    .line 2775
    invoke-interface {v8, v6}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    .line 2772
    :cond_5
    :goto_2
    add-int/lit8 v6, v6, -0x1

    goto :goto_1

    .line 2776
    :cond_6
    invoke-virtual {v10}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v16

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    sget-object v18, Lcom/htc/android/mail/server/ImapServer;->STR_STAR:Lcom/htc/android/mail/ByteString;

    invoke-virtual/range {v18 .. v18}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v18

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    const-string v18, " "

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-virtual/range {v16 .. v17}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v16

    if-eqz v16, :cond_5

    invoke-virtual {v10}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v16

    invoke-virtual/range {v16 .. v16}, Ljava/lang/String;->toLowerCase()Ljava/lang/String;

    move-result-object v16

    const-string v17, "bodystructure"

    invoke-virtual/range {v16 .. v17}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v16

    if-nez v16, :cond_5

    .line 2777
    invoke-interface {v8, v6}, Ljava/util/List;->remove(I)Ljava/lang/Object;

    goto :goto_2

    .line 2781
    :cond_7
    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    .line 2784
    .local v9, preparebody:Ljava/lang/StringBuilder;
    const/4 v6, 0x0

    :goto_3
    invoke-interface {v8}, Ljava/util/List;->size()I

    move-result v16

    move/from16 v0, v16

    if-ge v6, v0, :cond_8

    .line 2785
    invoke-interface {v8, v6}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v16

    check-cast v16, Lcom/htc/android/mail/ByteString;

    invoke-virtual/range {v16 .. v16}, Lcom/htc/android/mail/ByteString;->trimCRLFRight()Lcom/htc/android/mail/ByteString;

    move-result-object v10

    .line 2786
    invoke-virtual {v10}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v16

    move-object/from16 v0, v16

    invoke-virtual {v9, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 2784
    add-int/lit8 v6, v6, 0x1

    goto :goto_3

    .line 2789
    :cond_8
    invoke-interface {v8}, Ljava/util/List;->size()I

    move-result v16

    if-nez v16, :cond_9

    .line 2791
    const/4 v7, 0x0

    goto/16 :goto_0

    .line 2794
    :cond_9
    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v16

    invoke-virtual/range {v16 .. v16}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object v16

    const-string v17, " "

    const/16 v18, 0x4

    invoke-virtual/range {v16 .. v18}, Ljava/lang/String;->split(Ljava/lang/String;I)[Ljava/lang/String;

    move-result-object v14

    .line 2796
    const/16 v16, 0x3

    aget-object v16, v14, v16

    const/16 v17, 0x1

    const/16 v18, 0x3

    aget-object v18, v14, v18

    invoke-virtual/range {v18 .. v18}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object v18

    invoke-virtual/range {v18 .. v18}, Ljava/lang/String;->length()I

    move-result v18

    add-int/lit8 v18, v18, -0x1

    invoke-virtual/range {v16 .. v18}, Ljava/lang/String;->substring(II)Ljava/lang/String;

    move-result-object v11

    .line 2797
    .local v11, response:Ljava/lang/String;
    sget-boolean v16, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v16, :cond_a

    const-string v16, "ImapServer"

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    const-string v18, "response:"

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    invoke-virtual {v0, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-static/range {v16 .. v17}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 2799
    :cond_a
    const-string v16, " "

    const/16 v17, 0x4

    move-object/from16 v0, v16

    move/from16 v1, v17

    invoke-virtual {v11, v0, v1}, Ljava/lang/String;->split(Ljava/lang/String;I)[Ljava/lang/String;

    move-result-object v2

    .line 2800
    .local v2, body:[Ljava/lang/String;
    const-string v5, ""

    .line 2801
    .local v5, bodystructure:Ljava/lang/String;
    const/16 v16, 0x0

    aget-object v16, v2, v16

    const-string v17, "UID"

    invoke-virtual/range {v16 .. v17}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v16

    if-eqz v16, :cond_d

    .line 2802
    const/16 v16, 0x1

    aget-object p2, v2, v16

    .line 2803
    const/16 v16, 0x2

    aget-object v16, v2, v16

    const-string v17, "BODYSTRUCTURE"

    invoke-virtual/range {v16 .. v17}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v16

    if-eqz v16, :cond_b

    .line 2804
    const/16 v16, 0x3

    aget-object v16, v2, v16

    const/16 v17, 0x1

    const/16 v18, 0x3

    aget-object v18, v2, v18

    invoke-virtual/range {v18 .. v18}, Ljava/lang/String;->length()I

    move-result v18

    add-int/lit8 v18, v18, -0x1

    invoke-virtual/range {v16 .. v18}, Ljava/lang/String;->substring(II)Ljava/lang/String;

    move-result-object v5

    .line 2815
    :cond_b
    :goto_4
    sget-boolean v16, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v16, :cond_c

    const-string v16, "ImapServer"

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    const-string v18, "bodystructure is :"

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    invoke-virtual {v0, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-static/range {v16 .. v17}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 2816
    :cond_c
    new-instance v7, Lcom/htc/android/mail/IMap4Body;

    invoke-direct {v7, v5}, Lcom/htc/android/mail/IMap4Body;-><init>(Ljava/lang/String;)V

    .line 2818
    .local v7, imap4body:Lcom/htc/android/mail/IMap4Body;
    goto/16 :goto_0

    .line 2806
    .end local v7           #imap4body:Lcom/htc/android/mail/IMap4Body;
    :cond_d
    const-string v16, "UID"

    move-object/from16 v0, v16

    invoke-virtual {v11, v0}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v16

    if-eqz v16, :cond_b

    .line 2807
    const-string v16, ")"

    move-object/from16 v0, v16

    invoke-virtual {v11, v0}, Ljava/lang/String;->lastIndexOf(Ljava/lang/String;)I

    move-result v3

    .line 2808
    .local v3, bodyLastLoc:I
    const-string v16, "("

    move-object/from16 v0, v16

    invoke-virtual {v11, v0}, Ljava/lang/String;->indexOf(Ljava/lang/String;)I

    move-result v4

    .line 2809
    .local v4, bodyStartLoc:I
    const-string v16, " "

    move-object/from16 v0, v16

    invoke-virtual {v11, v0}, Ljava/lang/String;->lastIndexOf(Ljava/lang/String;)I

    move-result v16

    add-int/lit8 v15, v16, 0x1

    .line 2810
    .local v15, uidLoc:I
    invoke-virtual {v11}, Ljava/lang/String;->length()I

    move-result v16

    move/from16 v0, v16

    invoke-virtual {v11, v15, v0}, Ljava/lang/String;->substring(II)Ljava/lang/String;

    move-result-object p2

    .line 2811
    sget-boolean v16, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v16, :cond_e

    const-string v16, "ImapServer"

    new-instance v17, Ljava/lang/StringBuilder;

    invoke-direct/range {v17 .. v17}, Ljava/lang/StringBuilder;-><init>()V

    const-string v18, "bodystruct uid is:"

    invoke-virtual/range {v17 .. v18}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    move-object/from16 v0, v17

    move-object/from16 v1, p2

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v17

    invoke-virtual/range {v17 .. v17}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v17

    invoke-static/range {v16 .. v17}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 2812
    :cond_e
    add-int/lit8 v16, v4, 0x1

    move/from16 v0, v16

    invoke-virtual {v11, v0, v3}, Ljava/lang/String;->substring(II)Ljava/lang/String;

    move-result-object v16

    invoke-virtual/range {v16 .. v16}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object v5

    goto :goto_4
.end method

.method protected getFetchInfoCommand(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
    .locals 4
    .parameter "tag"
    .parameter "uid"

    .prologue
    .line 2822
    sget-object v0, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v1, "%s UID FETCH %s (BODYSTRUCTURE)"

    const/4 v2, 0x2

    new-array v2, v2, [Ljava/lang/Object;

    const/4 v3, 0x0

    aput-object p1, v2, v3

    const/4 v3, 0x1

    aput-object p2, v2, v3

    invoke-static {v0, v1, v2}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v0

    return-object v0
.end method

.method protected getFetchNotDoneMessageList(Lcom/htc/android/mail/Mailbox;)Ljava/util/List;
    .locals 22
    .parameter "mailbox"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/Mailbox;",
            ")",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/MailMessage;",
            ">;"
        }
    .end annotation

    .prologue
    .line 1594
    const/4 v10, 0x0

    .line 1596
    .local v10, c:Landroid/database/Cursor;
    :try_start_0
    new-instance v15, Ljava/util/ArrayList;

    invoke-direct {v15}, Ljava/util/ArrayList;-><init>()V

    .line 1597
    .local v15, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v3, "_account = \'%d\' AND _mailboxId = \'%d\' AND _done = \'0\' AND _uid is not null"

    const/4 v4, 0x2

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v6, 0x0

    move-object/from16 v0, p0

    iget-object v7, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v7}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v20

    invoke-static/range {v20 .. v21}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v4, v6

    const/4 v6, 0x1

    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/htc/android/mail/Mailbox;->id:J

    move-wide/from16 v20, v0

    invoke-static/range {v20 .. v21}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v4, v6

    invoke-static {v2, v3, v4}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v5

    .line 1598
    .local v5, where:Ljava/lang/String;
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v2

    sget-object v3, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    const/4 v4, 0x5

    new-array v4, v4, [Ljava/lang/String;

    const/4 v6, 0x0

    const-string v7, "_id"

    aput-object v7, v4, v6

    const/4 v6, 0x1

    const-string v7, "_uid"

    aput-object v7, v4, v6

    const/4 v6, 0x2

    const-string v7, "_charset"

    aput-object v7, v4, v6

    const/4 v6, 0x3

    const-string v7, "_account"

    aput-object v7, v4, v6

    const/4 v6, 0x4

    const-string v7, "_mailboxId"

    aput-object v7, v4, v6

    const/4 v6, 0x0

    const/4 v7, 0x0

    invoke-interface/range {v2 .. v7}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v10

    .line 1599
    if-eqz v10, :cond_3

    .line 1602
    invoke-static {}, Lcom/htc/android/mail/Mail;->getDefaultCharset()Ljava/lang/String;

    move-result-object v11

    .line 1606
    .local v11, charset:Ljava/lang/String;
    :goto_0
    invoke-interface {v10}, Landroid/database/Cursor;->moveToNext()Z

    move-result v2

    if-eqz v2, :cond_3

    .line 1607
    const-string v2, "_id"

    invoke-interface {v10, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    invoke-interface {v10, v2}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v13

    .line 1608
    .local v13, id:J
    const-string v2, "_uid"

    invoke-interface {v10, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    invoke-interface {v10, v2}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v19

    .line 1609
    .local v19, uid:Ljava/lang/String;
    const-string v2, "_account"

    invoke-interface {v10, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    invoke-interface {v10, v2}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v8

    .line 1610
    .local v8, accountId:J
    const-string v2, "_mailboxId"

    invoke-interface {v10, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    invoke-interface {v10, v2}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v17

    .line 1611
    .local v17, mailboxId:J
    const-string v2, "_charset"

    invoke-interface {v10, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    invoke-interface {v10, v2}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v11

    .line 1612
    new-instance v16, Lcom/htc/android/mail/MailMessage;

    const/4 v2, 0x0

    move-object/from16 v0, v16

    move-object/from16 v1, v19

    invoke-direct {v0, v13, v14, v1, v2}, Lcom/htc/android/mail/MailMessage;-><init>(JLjava/lang/String;Ljava/lang/String;)V

    .line 1613
    .local v16, mailMessage:Lcom/htc/android/mail/MailMessage;
    move-object/from16 v0, v16

    invoke-virtual {v0, v8, v9}, Lcom/htc/android/mail/MailMessage;->setAccountId(J)V

    .line 1614
    invoke-virtual/range {v16 .. v18}, Lcom/htc/android/mail/MailMessage;->setMailboxId(J)V

    .line 1615
    move-object/from16 v0, v16

    invoke-virtual {v0, v11}, Lcom/htc/android/mail/MailMessage;->setSubjectCharset(Ljava/lang/String;)V

    .line 1616
    invoke-interface/range {v15 .. v16}, Ljava/util/List;->add(Ljava/lang/Object;)Z
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_0

    .line 1620
    .end local v5           #where:Ljava/lang/String;
    .end local v8           #accountId:J
    .end local v11           #charset:Ljava/lang/String;
    .end local v13           #id:J
    .end local v15           #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    .end local v16           #mailMessage:Lcom/htc/android/mail/MailMessage;
    .end local v17           #mailboxId:J
    .end local v19           #uid:Ljava/lang/String;
    :catch_0
    move-exception v12

    .line 1621
    .local v12, e:Landroid/os/RemoteException;
    :try_start_1
    const-string v2, "ImapServer"

    const-string v3, "catch exception"

    invoke-static {v2, v3, v12}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 1623
    if-eqz v10, :cond_0

    invoke-interface {v10}, Landroid/database/Cursor;->isClosed()Z

    move-result v2

    if-nez v2, :cond_0

    .line 1624
    invoke-interface {v10}, Landroid/database/Cursor;->close()V

    .line 1629
    :cond_0
    const/4 v15, 0x0

    .end local v12           #e:Landroid/os/RemoteException;
    :cond_1
    :goto_1
    return-object v15

    .line 1623
    :catchall_0
    move-exception v2

    if-eqz v10, :cond_2

    invoke-interface {v10}, Landroid/database/Cursor;->isClosed()Z

    move-result v3

    if-nez v3, :cond_2

    .line 1624
    invoke-interface {v10}, Landroid/database/Cursor;->close()V

    .line 1623
    :cond_2
    throw v2

    .restart local v5       #where:Ljava/lang/String;
    .restart local v15       #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    :cond_3
    if-eqz v10, :cond_1

    invoke-interface {v10}, Landroid/database/Cursor;->isClosed()Z

    move-result v2

    if-nez v2, :cond_1

    .line 1624
    invoke-interface {v10}, Landroid/database/Cursor;->close()V

    goto :goto_1
.end method

.method protected getFlagsForAppend(Lcom/htc/android/mail/Mailbox;Landroid/database/Cursor;)Ljava/lang/String;
    .locals 3
    .parameter "mailbox"
    .parameter "cursor"

    .prologue
    const/4 v1, 0x1

    .line 5249
    const-string v2, "_read"

    invoke-interface {p2, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    invoke-interface {p2, v2}, Landroid/database/Cursor;->getInt(I)I

    move-result v2

    if-ne v2, v1, :cond_0

    .line 5250
    .local v1, isSeen:Z
    :goto_0
    if-eqz v1, :cond_1

    .line 5251
    const-string v0, "(\\Seen)"

    .line 5255
    .local v0, flags:Ljava/lang/String;
    :goto_1
    return-object v0

    .line 5249
    .end local v0           #flags:Ljava/lang/String;
    .end local v1           #isSeen:Z
    :cond_0
    const/4 v1, 0x0

    goto :goto_0

    .line 5253
    .restart local v1       #isSeen:Z
    :cond_1
    const-string v0, "()"

    .restart local v0       #flags:Ljava/lang/String;
    goto :goto_1
.end method

.method protected getHeaderFieldsForFetchHeader()Ljava/lang/String;
    .locals 1

    .prologue
    .line 3685
    const-string v0, "subject from date content-type to cc message-id references importance reply-to"

    return-object v0
.end method

.method protected getLocalMailForSyncUp()Landroid/database/Cursor;
    .locals 14

    .prologue
    const/4 v13, 0x1

    const/4 v12, 0x0

    const/4 v4, 0x0

    .line 5036
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v0}, Lcom/htc/android/mail/Account;->getMailboxs()Lcom/htc/android/mail/Mailboxs;

    move-result-object v8

    .line 5037
    .local v8, mailboxs:Lcom/htc/android/mail/Mailboxs;
    if-nez v8, :cond_1

    .line 5045
    :cond_0
    :goto_0
    return-object v4

    .line 5038
    :cond_1
    invoke-virtual {v8}, Lcom/htc/android/mail/Mailboxs;->getDraftMailbox()Lcom/htc/android/mail/Mailbox;

    move-result-object v7

    .line 5039
    .local v7, draftMailbox:Lcom/htc/android/mail/Mailbox;
    if-eqz v7, :cond_0

    .line 5040
    invoke-virtual {v8}, Lcom/htc/android/mail/Mailboxs;->getSentMailbox()Lcom/htc/android/mail/Mailbox;

    move-result-object v9

    .line 5041
    .local v9, sentMailbox:Lcom/htc/android/mail/Mailbox;
    if-eqz v9, :cond_0

    .line 5042
    sget-object v0, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v1, "_del = -1 AND _local = 1 AND _uid IS NULL AND _mailboxId IN (%d, %d)"

    const/4 v5, 0x2

    new-array v5, v5, [Ljava/lang/Object;

    iget-wide v10, v7, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-static {v10, v11}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v10

    aput-object v10, v5, v12

    iget-wide v10, v9, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-static {v10, v11}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v10

    aput-object v10, v5, v13

    invoke-static {v0, v1, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    .line 5043
    .local v3, where:Ljava/lang/String;
    new-array v2, v13, [Ljava/lang/String;

    const-string v0, "_id"

    aput-object v0, v2, v12

    .line 5044
    .local v2, projections:[Ljava/lang/String;
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v0

    sget-object v1, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    move-object v5, v4

    invoke-virtual/range {v0 .. v5}, Landroid/content/ContentResolver;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v6

    .local v6, cursor:Landroid/database/Cursor;
    move-object v4, v6

    .line 5045
    goto :goto_0
.end method

.method protected getMSGID()Ljava/lang/String;
    .locals 2

    .prologue
    .line 363
    iget v0, p0, Lcom/htc/android/mail/server/ImapServer;->mMSGID:I

    add-int/lit8 v0, v0, 0x1

    iput v0, p0, Lcom/htc/android/mail/server/ImapServer;->mMSGID:I

    .line 364
    iget v0, p0, Lcom/htc/android/mail/server/ImapServer;->mMSGID:I

    const/16 v1, 0x270f

    if-le v0, v1, :cond_0

    .line 365
    const/4 v0, 0x1

    iput v0, p0, Lcom/htc/android/mail/server/ImapServer;->mMSGID:I

    .line 368
    :cond_0
    iget v0, p0, Lcom/htc/android/mail/server/ImapServer;->mMSGID:I

    invoke-static {v0}, Ljava/lang/Integer;->toString(I)Ljava/lang/String;

    move-result-object v0

    return-object v0
.end method

.method protected getMaxUid()J
    .locals 14

    .prologue
    .line 4247
    const-wide/16 v8, 0x0

    .line 4248
    .local v8, maxUid:J
    const/4 v6, 0x0

    .line 4250
    .local v6, c:Landroid/database/Cursor;
    :try_start_0
    sget-object v0, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v1, "_account = \'%d\' AND _mailboxId = \'%d\' AND _sync = 1"

    const/4 v2, 0x2

    new-array v2, v2, [Ljava/lang/Object;

    const/4 v4, 0x0

    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v5}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v12

    invoke-static {v12, v13}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v5

    aput-object v5, v2, v4

    const/4 v4, 0x1

    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-wide v12, v5, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-static {v12, v13}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v5

    aput-object v5, v2, v4

    invoke-static {v0, v1, v2}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    .line 4251
    .local v3, where:Ljava/lang/String;
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v0

    sget-object v1, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    const/4 v2, 0x1

    new-array v2, v2, [Ljava/lang/String;

    const/4 v4, 0x0

    const-string v5, "max(abs(_uid)) as maxUid"

    aput-object v5, v2, v4

    const/4 v4, 0x0

    const/4 v5, 0x0

    invoke-interface/range {v0 .. v5}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v6

    .line 4253
    if-eqz v6, :cond_0

    .line 4254
    invoke-interface {v6}, Landroid/database/Cursor;->moveToNext()Z

    move-result v0

    if-eqz v0, :cond_0

    .line 4255
    const-string v0, "maxUid"

    invoke-interface {v6, v0}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v0

    invoke-interface {v6, v0}, Landroid/database/Cursor;->getLong(I)J
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result-wide v10

    .line 4256
    .local v10, uid:J
    move-wide v8, v10

    .line 4262
    .end local v10           #uid:J
    :cond_0
    if-eqz v6, :cond_1

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v0

    if-nez v0, :cond_1

    .line 4263
    .end local v3           #where:Ljava/lang/String;
    :goto_0
    invoke-interface {v6}, Landroid/database/Cursor;->close()V

    .line 4267
    :cond_1
    return-wide v8

    .line 4259
    :catch_0
    move-exception v7

    .line 4260
    .local v7, e:Landroid/os/RemoteException;
    :try_start_1
    const-string v0, "ImapServer"

    const-string v1, "catch RemoteException"

    invoke-static {v0, v1, v7}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 4262
    if-eqz v6, :cond_1

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v0

    if-nez v0, :cond_1

    goto :goto_0

    .end local v7           #e:Landroid/os/RemoteException;
    :catchall_0
    move-exception v0

    if-eqz v6, :cond_2

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v1

    if-nez v1, :cond_2

    .line 4263
    invoke-interface {v6}, Landroid/database/Cursor;->close()V

    .line 4262
    :cond_2
    throw v0
.end method

.method protected getMessageUid(J)Ljava/lang/String;
    .locals 10
    .parameter "msgId"

    .prologue
    const/4 v9, 0x0

    .line 2696
    :try_start_0
    sget-object v0, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v1, "_id = \'%d\'"

    const/4 v2, 0x1

    new-array v2, v2, [Ljava/lang/Object;

    const/4 v4, 0x0

    invoke-static {p1, p2}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v5

    aput-object v5, v2, v4

    invoke-static {v0, v1, v2}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    .line 2697
    .local v3, where:Ljava/lang/String;
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v0

    sget-object v1, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    const/4 v2, 0x1

    new-array v2, v2, [Ljava/lang/String;

    const/4 v4, 0x0

    const-string v5, "_uid"

    aput-object v5, v2, v4

    const/4 v4, 0x0

    const/4 v5, 0x0

    invoke-interface/range {v0 .. v5}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v6

    .line 2698
    .local v6, c:Landroid/database/Cursor;
    if-eqz v6, :cond_1

    .line 2699
    invoke-interface {v6}, Landroid/database/Cursor;->getCount()I

    move-result v0

    if-lez v0, :cond_0

    .line 2700
    invoke-interface {v6}, Landroid/database/Cursor;->moveToNext()Z

    .line 2701
    const-string v0, "_uid"

    invoke-interface {v6, v0}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v0

    invoke-interface {v6, v0}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v8

    .line 2702
    .local v8, uid:Ljava/lang/String;
    invoke-interface {v6}, Landroid/database/Cursor;->close()V

    .line 2711
    .end local v3           #where:Ljava/lang/String;
    .end local v6           #c:Landroid/database/Cursor;
    .end local v8           #uid:Ljava/lang/String;
    :goto_0
    return-object v8

    .line 2705
    .restart local v3       #where:Ljava/lang/String;
    .restart local v6       #c:Landroid/database/Cursor;
    :cond_0
    invoke-interface {v6}, Landroid/database/Cursor;->close()V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .end local v3           #where:Ljava/lang/String;
    .end local v6           #c:Landroid/database/Cursor;
    :cond_1
    :goto_1
    move-object v8, v9

    .line 2711
    goto :goto_0

    .line 2707
    :catch_0
    move-exception v7

    .line 2708
    .local v7, e:Landroid/os/RemoteException;
    const-string v0, "ImapServer"

    const-string v1, "catch remote exception"

    invoke-static {v0, v1, v7}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_1
.end method

.method protected getMinInternalDate()J
    .locals 12

    .prologue
    .line 4298
    const-wide/16 v8, 0x0

    .line 4299
    .local v8, minInternalDate:J
    const/4 v6, 0x0

    .line 4302
    .local v6, c:Landroid/database/Cursor;
    :try_start_0
    sget-object v0, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v1, "_account = \'%d\' AND _mailboxId = \'%d\'"

    const/4 v2, 0x2

    new-array v2, v2, [Ljava/lang/Object;

    const/4 v4, 0x0

    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v5}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v10

    invoke-static {v10, v11}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v5

    aput-object v5, v2, v4

    const/4 v4, 0x1

    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-wide v10, v5, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-static {v10, v11}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v5

    aput-object v5, v2, v4

    invoke-static {v0, v1, v2}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    .line 4303
    .local v3, where:Ljava/lang/String;
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v0

    sget-object v1, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    const/4 v2, 0x1

    new-array v2, v2, [Ljava/lang/String;

    const/4 v4, 0x0

    const-string v5, "min(_internaldate) as minDate"

    aput-object v5, v2, v4

    const/4 v4, 0x0

    const/4 v5, 0x0

    invoke-interface/range {v0 .. v5}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v6

    .line 4305
    if-eqz v6, :cond_1

    .line 4306
    invoke-interface {v6}, Landroid/database/Cursor;->moveToNext()Z

    move-result v0

    if-eqz v0, :cond_0

    .line 4307
    const-string v0, "minDate"

    invoke-interface {v6, v0}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v0

    invoke-interface {v6, v0}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v8

    .line 4309
    :cond_0
    invoke-interface {v6}, Landroid/database/Cursor;->close()V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 4310
    const/4 v6, 0x0

    .line 4317
    .end local v3           #where:Ljava/lang/String;
    :cond_1
    :goto_0
    return-wide v8

    .line 4312
    :catch_0
    move-exception v7

    .line 4313
    .local v7, e:Landroid/os/RemoteException;
    const-string v0, "ImapServer"

    const-string v1, "catch RemoteException"

    invoke-static {v0, v1, v7}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V

    .line 4314
    if-eqz v6, :cond_1

    .line 4315
    invoke-interface {v6}, Landroid/database/Cursor;->close()V

    goto :goto_0
.end method

.method protected getMinUid()Ljava/lang/String;
    .locals 13

    .prologue
    .line 4271
    const-string v8, "1"

    .line 4272
    .local v8, minUid:Ljava/lang/String;
    const/4 v6, 0x0

    .line 4274
    .local v6, c:Landroid/database/Cursor;
    :try_start_0
    sget-object v0, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v1, "_account = \'%d\' AND _mailboxId = \'%d\'"

    const/4 v2, 0x2

    new-array v2, v2, [Ljava/lang/Object;

    const/4 v4, 0x0

    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v5}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v11

    invoke-static {v11, v12}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v5

    aput-object v5, v2, v4

    const/4 v4, 0x1

    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-wide v11, v5, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-static {v11, v12}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v5

    aput-object v5, v2, v4

    invoke-static {v0, v1, v2}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    .line 4275
    .local v3, where:Ljava/lang/String;
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v0

    sget-object v1, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    const/4 v2, 0x1

    new-array v2, v2, [Ljava/lang/String;

    const/4 v4, 0x0

    const-string v5, "min(abs(_uid)) as minUid"

    aput-object v5, v2, v4

    const/4 v4, 0x0

    const/4 v5, 0x0

    invoke-interface/range {v0 .. v5}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v6

    .line 4277
    if-eqz v6, :cond_1

    .line 4278
    invoke-interface {v6}, Landroid/database/Cursor;->moveToNext()Z

    move-result v0

    if-eqz v0, :cond_1

    .line 4279
    const-string v0, "minUid"

    invoke-interface {v6, v0}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v0

    invoke-interface {v6, v0}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v9

    .line 4280
    .local v9, uid:J
    const-wide/16 v0, 0x0

    cmp-long v0, v9, v0

    if-nez v0, :cond_0

    .line 4281
    const-wide/16 v9, 0x1

    .line 4283
    :cond_0
    invoke-static {v9, v10}, Ljava/lang/String;->valueOf(J)Ljava/lang/String;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result-object v8

    .line 4289
    .end local v9           #uid:J
    :cond_1
    if-eqz v6, :cond_2

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v0

    if-nez v0, :cond_2

    .line 4290
    .end local v3           #where:Ljava/lang/String;
    :goto_0
    invoke-interface {v6}, Landroid/database/Cursor;->close()V

    .line 4294
    :cond_2
    return-object v8

    .line 4286
    :catch_0
    move-exception v7

    .line 4287
    .local v7, e:Landroid/os/RemoteException;
    :try_start_1
    const-string v0, "ImapServer"

    const-string v1, "catch RemoteException"

    invoke-static {v0, v1, v7}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 4289
    if-eqz v6, :cond_2

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v0

    if-nez v0, :cond_2

    goto :goto_0

    .end local v7           #e:Landroid/os/RemoteException;
    :catchall_0
    move-exception v0

    if-eqz v6, :cond_3

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v1

    if-nez v1, :cond_3

    .line 4290
    invoke-interface {v6}, Landroid/database/Cursor;->close()V

    .line 4289
    :cond_3
    throw v0
.end method

.method public getSslError()Lcom/htc/android/mail/ssl/MailSslError;
    .locals 1

    .prologue
    .line 372
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mSslError:Lcom/htc/android/mail/ssl/MailSslError;

    return-object v0
.end method

.method protected getSummariesUri(JJ)Landroid/net/Uri;
    .locals 2
    .parameter "accountId"
    .parameter "mailboxId"

    .prologue
    .line 5773
    iget-wide v0, p0, Lcom/htc/android/mail/server/ImapServer;->mMailboxIdForSummariesUri:J

    cmp-long v0, p3, v0

    if-nez v0, :cond_0

    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mSummariesUri:Landroid/net/Uri;

    if-eqz v0, :cond_0

    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mSummariesUri:Landroid/net/Uri;

    .line 5775
    :goto_0
    return-object v0

    .line 5774
    :cond_0
    invoke-static {p1, p2, p3, p4}, Lcom/htc/android/mail/MailCommon;->getSummariesUri(JJ)Landroid/net/Uri;

    move-result-object v0

    iput-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mSummariesUri:Landroid/net/Uri;

    .line 5775
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mSummariesUri:Landroid/net/Uri;

    goto :goto_0
.end method

.method public getSyncResult()[Lcom/htc/android/mail/server/Server$SyncResult;
    .locals 3

    .prologue
    .line 5734
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mSyncResult:Lcom/htc/android/mail/server/Server$SyncResult;

    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v1}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v1

    iput-wide v1, v0, Lcom/htc/android/mail/server/Server$SyncResult;->accountId:J

    .line 5735
    const/4 v0, 0x1

    new-array v0, v0, [Lcom/htc/android/mail/server/Server$SyncResult;

    const/4 v1, 0x0

    iget-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mSyncResult:Lcom/htc/android/mail/server/Server$SyncResult;

    aput-object v2, v0, v1

    return-object v0
.end method

.method protected final getTheDisplaySize(Lcom/htc/android/mail/Account;Lcom/htc/android/mail/IMap4Body;II)I
    .locals 11
    .parameter "account"
    .parameter "body"
    .parameter "incText"
    .parameter "incHtml"

    .prologue
    const/4 v10, 0x1

    .line 3090
    const/4 v1, 0x0

    .line 3092
    .local v1, countSize:I
    const/4 v3, 0x0

    .local v3, i:I
    :goto_0
    iget-object v7, p2, Lcom/htc/android/mail/IMap4Body;->table:Ljava/util/HashMap;

    invoke-virtual {v7}, Ljava/util/HashMap;->size()I

    move-result v7

    if-ge v3, v7, :cond_8

    .line 3093
    sget-boolean v7, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v7, :cond_0

    .line 3094
    const-string v7, "ImapServer"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v8, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v8

    const-string v9, ":part numbers is :"

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    iget-object v9, p2, Lcom/htc/android/mail/IMap4Body;->table:Ljava/util/HashMap;

    invoke-virtual {v9}, Ljava/util/HashMap;->size()I

    move-result v9

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v7, v8}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 3096
    :cond_0
    iget-object v7, p2, Lcom/htc/android/mail/IMap4Body;->table:Ljava/util/HashMap;

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/htc/android/mail/Imap4InfoObject;

    .line 3097
    .local v0, attach:Lcom/htc/android/mail/Imap4InfoObject;
    if-eqz v0, :cond_3

    .line 3098
    sget-boolean v7, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v7, :cond_1

    .line 3099
    const-string v7, "ImapServer"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "counting part "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v7, v8}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 3100
    :cond_1
    iget-object v2, v0, Lcom/htc/android/mail/Imap4InfoObject;->type:Ljava/lang/String;

    .line 3101
    .local v2, filetype:Ljava/lang/String;
    iget-object v6, v0, Lcom/htc/android/mail/Imap4InfoObject;->subtype:Ljava/lang/String;

    .line 3102
    .local v6, subtype:Ljava/lang/String;
    iget-object v5, v0, Lcom/htc/android/mail/Imap4InfoObject;->size:Ljava/lang/String;

    .line 3103
    .local v5, size:Ljava/lang/String;
    iget-object v4, v0, Lcom/htc/android/mail/Imap4InfoObject;->isfile:Ljava/lang/String;

    .line 3104
    .local v4, isfile:Ljava/lang/String;
    iget-object v7, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {p1, v7}, Lcom/htc/android/mail/Account;->getSizeLimitIndex(Landroid/content/Context;)I

    move-result v7

    if-eq v7, v10, :cond_2

    iget-object v7, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {p1, v7}, Lcom/htc/android/mail/Account;->getSizeLimitIndex(Landroid/content/Context;)I

    move-result v7

    const/4 v8, 0x2

    if-ne v7, v8, :cond_6

    .line 3109
    :cond_2
    const-string v7, "0"

    invoke-virtual {v4, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_5

    const-string v7, "text"

    invoke-virtual {v2, v7}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v7

    if-eqz v7, :cond_5

    const-string v7, "html"

    invoke-virtual {v6, v7}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v7

    if-eqz v7, :cond_5

    .line 3110
    if-ne v10, p3, :cond_4

    .line 3092
    .end local v2           #filetype:Ljava/lang/String;
    .end local v4           #isfile:Ljava/lang/String;
    .end local v5           #size:Ljava/lang/String;
    .end local v6           #subtype:Ljava/lang/String;
    :cond_3
    :goto_1
    add-int/lit8 v3, v3, 0x1

    goto/16 :goto_0

    .line 3115
    .restart local v2       #filetype:Ljava/lang/String;
    .restart local v4       #isfile:Ljava/lang/String;
    .restart local v5       #size:Ljava/lang/String;
    .restart local v6       #subtype:Ljava/lang/String;
    :cond_4
    invoke-static {v5}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/Integer;->intValue()I

    move-result v7

    add-int/2addr v1, v7

    goto :goto_1

    .line 3117
    :cond_5
    invoke-static {v5}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/Integer;->intValue()I

    move-result v7

    add-int/2addr v1, v7

    goto :goto_1

    .line 3119
    :cond_6
    const-string v7, "0"

    invoke-virtual {v4, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_7

    const-string v7, "text"

    invoke-virtual {v2, v7}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v7

    if-eqz v7, :cond_7

    const-string v7, "plain"

    invoke-virtual {v6, v7}, Ljava/lang/String;->equalsIgnoreCase(Ljava/lang/String;)Z

    move-result v7

    if-eqz v7, :cond_7

    .line 3120
    if-eq v10, p4, :cond_3

    .line 3125
    invoke-static {v5}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/Integer;->intValue()I

    move-result v7

    add-int/2addr v1, v7

    goto :goto_1

    .line 3127
    :cond_7
    invoke-static {v5}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/Integer;->intValue()I

    move-result v7

    add-int/2addr v1, v7

    goto :goto_1

    .line 3131
    .end local v0           #attach:Lcom/htc/android/mail/Imap4InfoObject;
    .end local v2           #filetype:Ljava/lang/String;
    .end local v4           #isfile:Ljava/lang/String;
    .end local v5           #size:Ljava/lang/String;
    .end local v6           #subtype:Ljava/lang/String;
    :cond_8
    return v1
.end method

.method protected getUidFromServer(Lcom/htc/android/mail/Mailbox;JLjava/lang/String;ZLjava/lang/String;)Ljava/lang/String;
    .locals 18
    .parameter "mailbox"
    .parameter "messageId"
    .parameter "msgIdInHeader"
    .parameter "updatePending"
    .parameter "retUid"

    .prologue
    .line 2303
    :try_start_0
    move-object/from16 v0, p0

    iget-object v12, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    if-eqz v12, :cond_0

    move-object/from16 v0, p1

    iget-object v12, v0, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    move-object/from16 v0, p0

    iget-object v13, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-object v13, v13, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    invoke-virtual {v12, v13}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v12

    if-nez v12, :cond_1

    .line 2304
    :cond_0
    invoke-virtual/range {p0 .. p1}, Lcom/htc/android/mail/server/ImapServer;->selectMailbox(Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    .line 2307
    :cond_1
    const/4 v9, 0x0

    .line 2308
    .local v9, uid:Ljava/lang/String;
    move-object/from16 v9, p6

    .line 2309
    sget-boolean v12, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v12, :cond_2

    const-string v12, "ImapServer"

    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "update to uid:"

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-static {v12, v13}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 2310
    :cond_2
    if-nez v9, :cond_3

    .line 2312
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v8

    .line 2313
    .local v8, tag:Ljava/lang/String;
    sget-object v12, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v13, "%s UID SEARCH (HEADER MESSAGE-ID %s)"

    const/4 v14, 0x2

    new-array v14, v14, [Ljava/lang/Object;

    const/4 v15, 0x0

    aput-object v8, v14, v15

    const/4 v15, 0x1

    aput-object p4, v14, v15

    invoke-static {v12, v13, v14}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v12

    move-object/from16 v0, p0

    invoke-virtual {v0, v12}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 2314
    move-object/from16 v0, p0

    invoke-virtual {v0, v8}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v6

    .line 2315
    .local v6, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    move-object/from16 v0, p0

    invoke-direct {v0, v6}, Lcom/htc/android/mail/server/ImapServer;->processGetUid(Ljava/util/List;)Ljava/lang/String;

    move-result-object v9

    .line 2317
    .end local v6           #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    .end local v8           #tag:Ljava/lang/String;
    :cond_3
    if-nez p5, :cond_5

    .line 2365
    .end local v9           #uid:Ljava/lang/String;
    :cond_4
    :goto_0
    return-object v9

    .line 2318
    .restart local v9       #uid:Ljava/lang/String;
    :cond_5
    if-eqz v9, :cond_8

    .line 2320
    new-instance v10, Landroid/content/ContentValues;

    invoke-direct {v10}, Landroid/content/ContentValues;-><init>()V

    .line 2321
    .local v10, values:Landroid/content/ContentValues;
    const-string v12, "_uid"

    invoke-virtual {v10, v12, v9}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 2322
    sget-object v12, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v13, "_id = \'%d\' AND _mailboxId = \'%d\' AND _uid is null"

    const/4 v14, 0x2

    new-array v14, v14, [Ljava/lang/Object;

    const/4 v15, 0x0

    invoke-static/range {p2 .. p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v16

    aput-object v16, v14, v15

    const/4 v15, 0x1

    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/htc/android/mail/Mailbox;->id:J

    move-wide/from16 v16, v0

    invoke-static/range {v16 .. v17}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v16

    aput-object v16, v14, v15

    invoke-static {v12, v13, v14}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v11

    .line 2324
    .local v11, where:Ljava/lang/String;
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v12

    sget-object v13, Lcom/htc/android/mail/MailProvider;->sNoNotifyMessagesURI:Landroid/net/Uri;

    const/4 v14, 0x0

    invoke-interface {v12, v13, v10, v11, v14}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    move-result v2

    .line 2325
    .local v2, count1:I
    sget-boolean v12, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v12, :cond_6

    const-string v12, "ImapServer"

    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "update message uid: "

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    const-string v14, " : "

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-static {v12, v13}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 2328
    :cond_6
    sget-object v12, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v13, "_id = (select min(_id) from pending_requests where _messageId = \'%d\' AND _uid is null AND _fromMailboxId = \'%d\' AND _request = \'%d\')"

    const/4 v14, 0x3

    new-array v14, v14, [Ljava/lang/Object;

    const/4 v15, 0x0

    invoke-static/range {p2 .. p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v16

    aput-object v16, v14, v15

    const/4 v15, 0x1

    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/htc/android/mail/Mailbox;->id:J

    move-wide/from16 v16, v0

    invoke-static/range {v16 .. v17}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v16

    aput-object v16, v14, v15

    const/4 v15, 0x2

    const/16 v16, 0x2

    invoke-static/range {v16 .. v16}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v16

    aput-object v16, v14, v15

    invoke-static {v12, v13, v14}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v11

    .line 2330
    invoke-virtual {v10}, Landroid/content/ContentValues;->clear()V

    .line 2331
    const-string v12, "_uid"

    invoke-virtual {v10, v12, v9}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 2332
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v12

    sget-object v13, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    const/4 v14, 0x0

    invoke-interface {v12, v13, v10, v11, v14}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    move-result v3

    .line 2333
    .local v3, count2:I
    sget-boolean v12, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v12, :cond_7

    const-string v12, "ImapServer"

    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "update pending: "

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    const-string v14, " : "

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-static {v12, v13}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 2336
    :cond_7
    sget-object v12, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v13, "_messageId = \'%d\' AND _request = \'%d\'"

    const/4 v14, 0x2

    new-array v14, v14, [Ljava/lang/Object;

    const/4 v15, 0x0

    invoke-static/range {p2 .. p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v16

    aput-object v16, v14, v15

    const/4 v15, 0x1

    const/16 v16, 0x1

    invoke-static/range {v16 .. v16}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v16

    aput-object v16, v14, v15

    invoke-static {v12, v13, v14}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v11

    .line 2337
    invoke-virtual {v10}, Landroid/content/ContentValues;->clear()V

    .line 2338
    const-string v12, "_uid"

    invoke-virtual {v10, v12, v9}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 2339
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v12

    sget-object v13, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    const/4 v14, 0x0

    invoke-interface {v12, v13, v10, v11, v14}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    move-result v4

    .line 2342
    .local v4, count3:I
    sget-object v12, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v13, "_messageId = \'%d\' AND _request = \'%d\' AND _uid is null AND _fromMailboxId = \'%d\'"

    const/4 v14, 0x3

    new-array v14, v14, [Ljava/lang/Object;

    const/4 v15, 0x0

    invoke-static/range {p2 .. p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v16

    aput-object v16, v14, v15

    const/4 v15, 0x1

    const/16 v16, 0x5

    invoke-static/range {v16 .. v16}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v16

    aput-object v16, v14, v15

    const/4 v15, 0x2

    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/htc/android/mail/Mailbox;->id:J

    move-wide/from16 v16, v0

    invoke-static/range {v16 .. v17}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v16

    aput-object v16, v14, v15

    invoke-static {v12, v13, v14}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v11

    .line 2344
    invoke-virtual {v10}, Landroid/content/ContentValues;->clear()V

    .line 2345
    const-string v12, "_request"

    const/4 v13, 0x7

    invoke-static {v13}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v13

    invoke-virtual {v10, v12, v13}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 2346
    const-string v12, "_uid"

    invoke-virtual {v10, v12, v9}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 2347
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v12

    sget-object v13, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    const/4 v14, 0x0

    invoke-interface {v12, v13, v10, v11, v14}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    .line 2348
    sget-boolean v12, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v12, :cond_4

    const-string v12, "ImapServer"

    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "delete get uid pending request: "

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    move-wide/from16 v0, p2

    invoke-virtual {v13, v0, v1}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-static {v12, v13}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    goto/16 :goto_0

    .line 2358
    .end local v2           #count1:I
    .end local v3           #count2:I
    .end local v4           #count3:I
    .end local v9           #uid:Ljava/lang/String;
    .end local v10           #values:Landroid/content/ContentValues;
    .end local v11           #where:Ljava/lang/String;
    :catch_0
    move-exception v12

    .line 2365
    :goto_1
    const/4 v9, 0x0

    goto/16 :goto_0

    .line 2352
    .restart local v9       #uid:Ljava/lang/String;
    :cond_8
    sget-object v12, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v13, "_messageId = \'%d\'"

    const/4 v14, 0x1

    new-array v14, v14, [Ljava/lang/Object;

    const/4 v15, 0x0

    invoke-static/range {p2 .. p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v16

    aput-object v16, v14, v15

    invoke-static {v12, v13, v14}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v11

    .line 2353
    .restart local v11       #where:Ljava/lang/String;
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v12

    sget-object v13, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    const/4 v14, 0x0

    invoke-interface {v12, v13, v11, v14}, Landroid/content/IContentProvider;->delete(Landroid/net/Uri;Ljava/lang/String;[Ljava/lang/String;)I

    .line 2354
    sget-boolean v12, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v12, :cond_4

    const-string v12, "ImapServer"

    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    const-string v14, "delete all pending request: "

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v13

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v13

    invoke-static {v12, v13}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V
    :try_end_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_1
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_2

    goto/16 :goto_0

    .line 2360
    .end local v9           #uid:Ljava/lang/String;
    .end local v11           #where:Ljava/lang/String;
    :catch_1
    move-exception v7

    .line 2361
    .local v7, re:Landroid/os/RemoteException;
    const-string v12, "ImapServer"

    const-string v13, "update uid fail"

    invoke-static {v12, v13, v7}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_1

    .line 2362
    .end local v7           #re:Landroid/os/RemoteException;
    :catch_2
    move-exception v5

    .line 2363
    .local v5, e:Ljava/lang/Exception;
    const-string v12, "ImapServer"

    const-string v13, "catch exception"

    invoke-static {v12, v13, v5}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V

    goto :goto_1
.end method

.method protected getUidFromServer(Lcom/htc/android/mail/Mailbox;JLjava/lang/String;Ljava/lang/String;)Z
    .locals 8
    .parameter "mailbox"
    .parameter "messageId"
    .parameter "msgIdInHeader"
    .parameter "retUid"

    .prologue
    const/4 v5, 0x1

    .line 2297
    move-object v0, p0

    move-object v1, p1

    move-wide v2, p2

    move-object v4, p4

    move-object v6, p5

    invoke-virtual/range {v0 .. v6}, Lcom/htc/android/mail/server/ImapServer;->getUidFromServer(Lcom/htc/android/mail/Mailbox;JLjava/lang/String;ZLjava/lang/String;)Ljava/lang/String;

    move-result-object v7

    .line 2298
    .local v7, uid:Ljava/lang/String;
    if-eqz v7, :cond_0

    :goto_0
    return v5

    :cond_0
    const/4 v5, 0x0

    goto :goto_0
.end method

.method protected getUpperCase(Ljava/lang/String;)Ljava/lang/String;
    .locals 2
    .parameter "str"

    .prologue
    .line 873
    const/4 v0, 0x0

    invoke-virtual {p1, v0}, Ljava/lang/String;->charAt(I)C

    move-result v0

    const/16 v1, 0x26

    if-ne v0, v1, :cond_0

    invoke-virtual {p1}, Ljava/lang/String;->length()I

    move-result v0

    add-int/lit8 v0, v0, -0x1

    invoke-virtual {p1, v0}, Ljava/lang/String;->charAt(I)C

    move-result v0

    const/16 v1, 0x2d

    if-ne v0, v1, :cond_0

    .line 876
    .end local p1
    :goto_0
    return-object p1

    .restart local p1
    :cond_0
    invoke-virtual {p1}, Ljava/lang/String;->toUpperCase()Ljava/lang/String;

    move-result-object p1

    goto :goto_0
.end method

.method public getX509Certificate()Ljava/security/cert/X509Certificate;
    .locals 1

    .prologue
    .line 376
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mX509Certificate:Ljava/security/cert/X509Certificate;

    return-object v0
.end method

.method protected init()V
    .locals 2
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 183
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v0}, Lcom/htc/android/mail/Account;->getUserName()Ljava/lang/String;

    move-result-object v0

    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v1}, Lcom/htc/android/mail/Account;->getPassword()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {p0, v0, v1}, Lcom/htc/android/mail/server/ImapServer;->init(Ljava/lang/String;Ljava/lang/String;)V

    .line 184
    return-void
.end method

.method protected init(Ljava/lang/String;Ljava/lang/String;)V
    .locals 13
    .parameter "userName"
    .parameter "password"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 188
    const/4 v8, 0x0

    iput-object v8, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    .line 190
    invoke-direct {p0}, Lcom/htc/android/mail/server/ImapServer;->connect()V

    .line 192
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->isStop()Z

    move-result v8

    if-eqz v8, :cond_0

    .line 193
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->close()V

    .line 194
    new-instance v8, Ljava/io/IOException;

    invoke-direct {v8}, Ljava/io/IOException;-><init>()V

    throw v8

    .line 197
    :cond_0
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->readOneLineResponse()Lcom/htc/android/mail/ByteString;

    move-result-object v1

    .line 198
    .local v1, bannerByteString:Lcom/htc/android/mail/ByteString;
    if-nez v1, :cond_1

    .line 242
    :goto_0
    return-void

    .line 201
    :cond_1
    invoke-virtual {v1}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v0

    .line 203
    .local v0, banner:Ljava/lang/String;
    const/4 v2, 0x0

    .line 204
    .local v2, capa:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const-string v8, "CAPABILITY"

    invoke-virtual {v0, v8}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v8

    if-eqz v8, :cond_6

    .line 205
    new-instance v2, Ljava/util/ArrayList;

    .end local v2           #capa:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    invoke-direct {v2}, Ljava/util/ArrayList;-><init>()V

    .line 206
    .restart local v2       #capa:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    invoke-interface {v2, v1}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 213
    :goto_1
    invoke-direct {p0, v2}, Lcom/htc/android/mail/server/ImapServer;->processCAPA(Ljava/util/List;)Z

    .line 215
    iget-object v8, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v8}, Lcom/htc/android/mail/Account;->getUseSSLin()I

    move-result v8

    const/4 v9, 0x2

    if-ne v8, v9, :cond_2

    .line 216
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v5

    .line 217
    .local v5, stag:Ljava/lang/String;
    sget-object v8, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v9, "%s STARTTLS"

    const/4 v10, 0x1

    new-array v10, v10, [Ljava/lang/Object;

    const/4 v11, 0x0

    aput-object v5, v10, v11

    invoke-static {v8, v9, v10}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v8

    invoke-virtual {p0, v8}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 219
    invoke-virtual {p0, v5}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v6

    .line 220
    .local v6, start:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    invoke-direct {p0, v6}, Lcom/htc/android/mail/server/ImapServer;->processSTARTTLS(Ljava/util/List;)V

    .line 223
    .end local v5           #stag:Ljava/lang/String;
    .end local v6           #start:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    :cond_2
    iget-object v8, p0, Lcom/htc/android/mail/server/ImapServer;->mImapCapability:Lcom/htc/android/mail/server/ImapServer$ImapCapability;

    if-eqz v8, :cond_3

    iget-object v8, p0, Lcom/htc/android/mail/server/ImapServer;->mImapCapability:Lcom/htc/android/mail/server/ImapServer$ImapCapability;

    #getter for: Lcom/htc/android/mail/server/ImapServer$ImapCapability;->mXIDACLID:Z
    invoke-static {v8}, Lcom/htc/android/mail/server/ImapServer$ImapCapability;->access$000(Lcom/htc/android/mail/server/ImapServer$ImapCapability;)Z

    move-result v8

    const/4 v9, 0x1

    if-ne v8, v9, :cond_3

    .line 224
    invoke-direct {p0}, Lcom/htc/android/mail/server/ImapServer;->sendIdentify()V

    .line 227
    :cond_3
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v7

    .line 229
    .local v7, tag:Ljava/lang/String;
    if-eqz p1, :cond_4

    .line 230
    const/16 v8, 0x5c

    const/16 v9, 0x2f

    invoke-virtual {p1, v8, v9}, Ljava/lang/String;->replace(CC)Ljava/lang/String;

    move-result-object p1

    .line 233
    :cond_4
    sget-boolean v8, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v8, :cond_5

    const-string v8, "ImapServer"

    const-string v9, "Logging will be disabled totally in CRC build."

    invoke-static {v8, v9}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 234
    :cond_5
    sget-object v8, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v9, "%s LOGIN %s %s"

    const/4 v10, 0x3

    new-array v10, v10, [Ljava/lang/Object;

    const/4 v11, 0x0

    aput-object v7, v10, v11

    const/4 v11, 0x1

    aput-object p1, v10, v11

    const/4 v11, 0x2

    invoke-static {p2}, Lcom/htc/android/mail/mimemessage/Utility;->imapQuoted(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v12

    aput-object v12, v10, v11

    invoke-static {v8, v9, v10}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v8

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    invoke-static {p1}, Lcom/htc/android/mail/Account;->encodePwd(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v10, "/"

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-static {p2}, Lcom/htc/android/mail/Account;->encodePwd(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v10

    invoke-virtual {v9, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {p0, v8, v9}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;Ljava/lang/String;)V

    .line 238
    invoke-virtual {p0, v7}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v4

    .line 240
    .local v4, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    invoke-direct {p0, v4}, Lcom/htc/android/mail/server/ImapServer;->processLOGIN(Ljava/util/List;)V

    goto/16 :goto_0

    .line 208
    .end local v4           #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    .end local v7           #tag:Ljava/lang/String;
    :cond_6
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v3

    .line 209
    .local v3, ctag:Ljava/lang/String;
    sget-object v8, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v9, "%s CAPABILITY"

    const/4 v10, 0x1

    new-array v10, v10, [Ljava/lang/Object;

    const/4 v11, 0x0

    aput-object v3, v10, v11

    invoke-static {v8, v9, v10}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v8

    invoke-virtual {p0, v8}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 210
    invoke-virtual {p0, v3}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v2

    goto/16 :goto_1
.end method

.method protected isFinishSyncPendingRequest()Z
    .locals 11

    .prologue
    const/4 v9, 0x1

    const/4 v10, 0x0

    .line 1753
    const/4 v6, 0x0

    .line 1755
    .local v6, c:Landroid/database/Cursor;
    :try_start_0
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->whereForIsFinishSyncPendingRequest()Ljava/lang/String;

    move-result-object v3

    .line 1756
    .local v3, where:Ljava/lang/String;
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v0

    sget-object v1, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    const/4 v2, 0x1

    new-array v2, v2, [Ljava/lang/String;

    const/4 v4, 0x0

    const-string v5, "count(_id) as _total"

    aput-object v5, v2, v4

    const/4 v4, 0x0

    const/4 v5, 0x0

    invoke-interface/range {v0 .. v5}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v6

    .line 1757
    invoke-interface {v6}, Landroid/database/Cursor;->moveToNext()Z

    move-result v0

    if-eqz v0, :cond_3

    .line 1758
    const-string v0, "_total"

    invoke-interface {v6, v0}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v0

    invoke-interface {v6, v0}, Landroid/database/Cursor;->getInt(I)I
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result v8

    .line 1759
    .local v8, total:I
    if-nez v8, :cond_3

    .line 1766
    if-eqz v6, :cond_0

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v0

    if-nez v0, :cond_0

    .line 1767
    invoke-interface {v6}, Landroid/database/Cursor;->close()V

    :cond_0
    move v0, v9

    .line 1770
    .end local v3           #where:Ljava/lang/String;
    .end local v8           #total:I
    :goto_0
    return v0

    .line 1763
    :catch_0
    move-exception v7

    .line 1764
    .local v7, re:Landroid/os/RemoteException;
    :try_start_1
    const-string v0, "ImapServer"

    const-string v1, "query pending_request table fail"

    invoke-static {v0, v1, v7}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    .line 1766
    if-eqz v6, :cond_1

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v0

    if-nez v0, :cond_1

    .line 1767
    .end local v7           #re:Landroid/os/RemoteException;
    :goto_1
    invoke-interface {v6}, Landroid/database/Cursor;->close()V

    :cond_1
    move v0, v10

    .line 1770
    goto :goto_0

    .line 1766
    :catchall_0
    move-exception v0

    if-eqz v6, :cond_2

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v1

    if-nez v1, :cond_2

    .line 1767
    invoke-interface {v6}, Landroid/database/Cursor;->close()V

    .line 1766
    :cond_2
    throw v0

    .restart local v3       #where:Ljava/lang/String;
    :cond_3
    if-eqz v6, :cond_1

    invoke-interface {v6}, Landroid/database/Cursor;->isClosed()Z

    move-result v0

    if-nez v0, :cond_1

    goto :goto_1
.end method

.method public isOpen()Z
    .locals 1

    .prologue
    .line 5009
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mIn:Ljava/io/BufferedInputStream;

    if-eqz v0, :cond_0

    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mOut:Ljava/io/BufferedOutputStream;

    if-eqz v0, :cond_0

    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mSocket:Ljava/net/Socket;

    if-eqz v0, :cond_0

    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mSocket:Ljava/net/Socket;

    invoke-virtual {v0}, Ljava/net/Socket;->isConnected()Z

    move-result v0

    if-eqz v0, :cond_0

    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mSocket:Ljava/net/Socket;

    invoke-virtual {v0}, Ljava/net/Socket;->isClosed()Z

    move-result v0

    if-nez v0, :cond_0

    const/4 v0, 0x1

    :goto_0
    return v0

    :cond_0
    const/4 v0, 0x0

    goto :goto_0
.end method

.method protected issue(Ljava/lang/String;)V
    .locals 3
    .parameter "cmd"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .line 435
    if-eqz p1, :cond_1

    .line 436
    sget-boolean v0, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v0, :cond_0

    const-string v0, "ImapServer"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "issue: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 437
    :cond_0
    invoke-virtual {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 439
    :cond_1
    return-void
.end method

.method protected issue(Ljava/lang/String;Ljava/lang/String;)V
    .locals 3
    .parameter "cmd"
    .parameter "logStr"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .line 428
    if-eqz p1, :cond_1

    .line 429
    sget-boolean v0, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v0, :cond_0

    const-string v0, "ImapServer"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "issue: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 430
    :cond_0
    invoke-virtual {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    .line 432
    :cond_1
    return-void
.end method

.method protected issueAdditionalHeader()V
    .locals 0
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 5261
    return-void
.end method

.method public listen()V
    .locals 3
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 5767
    sget-boolean v1, Lcom/htc/android/mail/Mail;->MAIL_DIRECTPUSH_DEBUG:Z

    if-eqz v1, :cond_0

    const-string v1, "ImapServer"

    const-string v2, "start listen"

    invoke-static {v1, v2}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 5768
    :cond_0
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->readIdleResponse()Ljava/util/List;

    move-result-object v0

    .line 5769
    .local v0, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v1

    if-nez v1, :cond_1

    new-instance v1, Ljava/io/IOException;

    const-string v2, "listen failed"

    invoke-direct {v1, v2}, Ljava/io/IOException;-><init>(Ljava/lang/String;)V

    throw v1

    .line 5770
    :cond_1
    return-void
.end method

.method public moveMail(Lcom/htc/android/mail/Mailbox;Ljava/util/ArrayList;Lcom/htc/android/mail/Mailbox;)V
    .locals 0
    .parameter "fromMailbox"
    .parameter
    .parameter "toMailbox"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/Mailbox;",
            "Ljava/util/ArrayList",
            "<",
            "Lcom/htc/android/mail/MailMessage;",
            ">;",
            "Lcom/htc/android/mail/Mailbox;",
            ")V"
        }
    .end annotation

    .prologue
    .line 1003
    .local p2, mailMessageList:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/htc/android/mail/MailMessage;>;"
    return-void
.end method

.method public moveMail(Lcom/htc/android/mail/server/Server$PendingRequestList;)V
    .locals 24
    .parameter "pendingRequestList"

    .prologue
    .line 1008
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->size()I

    move-result v15

    .line 1009
    .local v15, size:I
    if-lez v15, :cond_0

    .line 1010
    const/4 v2, 0x0

    move-object/from16 v0, p1

    invoke-virtual {v0, v2}, Lcom/htc/android/mail/server/Server$PendingRequestList;->get(I)Lcom/htc/android/mail/server/Server$PendingRequest;

    move-result-object v14

    .line 1011
    .local v14, request:Lcom/htc/android/mail/server/Server$PendingRequest;
    move-object/from16 v0, p0

    iget-object v2, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-static {v2}, Lcom/htc/android/mail/AccountPool;->getInstance(Landroid/content/Context;)Lcom/htc/android/mail/AccountPool;

    move-result-object v9

    .line 1012
    .local v9, accountPool:Lcom/htc/android/mail/AccountPool;
    move-object/from16 v0, p0

    iget-object v2, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    iget-wide v4, v14, Lcom/htc/android/mail/server/Server$PendingRequest;->accountId:J

    invoke-virtual {v9, v2, v4, v5}, Lcom/htc/android/mail/AccountPool;->getAccount(Landroid/content/Context;J)Lcom/htc/android/mail/Account;

    move-result-object v8

    .line 1013
    .local v8, account:Lcom/htc/android/mail/Account;
    if-nez v8, :cond_1

    .line 1014
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->delete()I

    .line 1117
    .end local v8           #account:Lcom/htc/android/mail/Account;
    .end local v9           #accountPool:Lcom/htc/android/mail/AccountPool;
    .end local v14           #request:Lcom/htc/android/mail/server/Server$PendingRequest;
    :cond_0
    :goto_0
    return-void

    .line 1017
    .restart local v8       #account:Lcom/htc/android/mail/Account;
    .restart local v9       #accountPool:Lcom/htc/android/mail/AccountPool;
    .restart local v14       #request:Lcom/htc/android/mail/server/Server$PendingRequest;
    :cond_1
    invoke-virtual {v8}, Lcom/htc/android/mail/Account;->getMailboxs()Lcom/htc/android/mail/Mailboxs;

    move-result-object v2

    iget-wide v4, v14, Lcom/htc/android/mail/server/Server$PendingRequest;->fromMailboxId:J

    invoke-virtual {v2, v4, v5}, Lcom/htc/android/mail/Mailboxs;->getMailboxById(J)Lcom/htc/android/mail/Mailbox;

    move-result-object v12

    .line 1018
    .local v12, fromMailbox:Lcom/htc/android/mail/Mailbox;
    invoke-virtual {v8}, Lcom/htc/android/mail/Account;->getMailboxs()Lcom/htc/android/mail/Mailboxs;

    move-result-object v2

    iget-wide v4, v14, Lcom/htc/android/mail/server/Server$PendingRequest;->toMailboxId:J

    invoke-virtual {v2, v4, v5}, Lcom/htc/android/mail/Mailboxs;->getMailboxById(J)Lcom/htc/android/mail/Mailbox;

    move-result-object v3

    .line 1019
    .local v3, toMailbox:Lcom/htc/android/mail/Mailbox;
    if-eqz v12, :cond_2

    if-nez v3, :cond_3

    .line 1020
    :cond_2
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->delete()I

    goto :goto_0

    .line 1027
    :cond_3
    iget-boolean v2, v12, Lcom/htc/android/mail/Mailbox;->isServerFolder:Z

    if-nez v2, :cond_5

    .line 1028
    sget-boolean v2, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v2, :cond_4

    const-string v2, "ImapServer"

    const-string v4, "fromMailbox are not server folder"

    invoke-static {v2, v4}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 1029
    :cond_4
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->delete()I

    goto :goto_0

    .line 1033
    :cond_5
    sget-boolean v2, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v2, :cond_6

    const-string v2, "ImapServer"

    const-string v4, "move mail on Server"

    invoke-static {v2, v4}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 1037
    :cond_6
    :try_start_0
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->getUidSeq()Ljava/lang/String;

    move-result-object v17

    .line 1039
    .local v17, uidSeq:Ljava/lang/String;
    const-string v2, ""

    move-object/from16 v0, v17

    invoke-virtual {v2, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_7

    .line 1040
    sget-boolean v2, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v2, :cond_0

    const-string v2, "ImapServer"

    const-string v4, "uidSeq is empty"

    invoke-static {v2, v4}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    goto :goto_0

    .line 1110
    .end local v17           #uidSeq:Ljava/lang/String;
    :catch_0
    move-exception v2

    goto :goto_0

    .line 1044
    .restart local v17       #uidSeq:Ljava/lang/String;
    :cond_7
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->probe()V

    .line 1046
    move-object/from16 v0, p0

    iget v2, v0, Lcom/htc/android/mail/server/Server;->socketState:I

    const/4 v4, 0x1

    if-ne v2, v4, :cond_8

    .line 1047
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->init()V

    .line 1051
    :cond_8
    iget-boolean v2, v3, Lcom/htc/android/mail/Mailbox;->isServerFolder:Z

    if-eqz v2, :cond_9

    .line 1052
    move-object/from16 v0, p0

    invoke-virtual {v0, v3}, Lcom/htc/android/mail/server/ImapServer;->selectMailbox(Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    .line 1054
    :cond_9
    iget-boolean v2, v12, Lcom/htc/android/mail/Mailbox;->isServerFolder:Z

    if-eqz v2, :cond_a

    .line 1055
    move-object/from16 v0, p0

    invoke-virtual {v0, v12}, Lcom/htc/android/mail/server/ImapServer;->selectMailbox(Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    .line 1058
    :cond_a
    const/16 v18, 0x0

    .line 1061
    .local v18, uids:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/String;>;"
    iget-boolean v2, v3, Lcom/htc/android/mail/Mailbox;->isServerFolder:Z

    if-eqz v2, :cond_c

    iget-boolean v2, v12, Lcom/htc/android/mail/Mailbox;->isServerFolder:Z

    if-eqz v2, :cond_c

    .line 1062
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v16

    .line 1063
    .local v16, tag:Ljava/lang/String;
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "%s UID COPY %s \"%s\""

    const/4 v5, 0x3

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v6, 0x0

    aput-object v16, v5, v6

    const/4 v6, 0x1

    aput-object v17, v5, v6

    const/4 v6, 0x2

    iget-object v7, v3, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    aput-object v7, v5, v6

    invoke-static {v2, v4, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, p0

    invoke-virtual {v0, v2}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 1064
    move-object/from16 v0, p0

    move-object/from16 v1, v16

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v2

    move-object/from16 v0, p0

    invoke-direct {v0, v2}, Lcom/htc/android/mail/server/ImapServer;->processCOPYUID(Ljava/util/List;)Ljava/util/ArrayList;

    move-result-object v18

    .line 1069
    .end local v16           #tag:Ljava/lang/String;
    :goto_1
    sget-boolean v2, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v2, :cond_b

    const-string v2, "ImapServer"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "pending size:"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, v15}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v2, v4}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 1071
    :cond_b
    iget-boolean v2, v12, Lcom/htc/android/mail/Mailbox;->isServerFolder:Z

    if-eqz v2, :cond_10

    .line 1072
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v16

    .line 1073
    .restart local v16       #tag:Ljava/lang/String;
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "%s UID STORE %s +FLAGS.SILENT (\\Deleted)"

    const/4 v5, 0x2

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v6, 0x0

    aput-object v16, v5, v6

    const/4 v6, 0x1

    aput-object v17, v5, v6

    invoke-static {v2, v4, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, p0

    invoke-virtual {v0, v2}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 1074
    move-object/from16 v0, p0

    move-object/from16 v1, v16

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    .line 1076
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v16

    .line 1077
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "%s EXPUNGE"

    const/4 v5, 0x1

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v6, 0x0

    aput-object v16, v5, v6

    invoke-static {v2, v4, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, p0

    invoke-virtual {v0, v2}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 1078
    move-object/from16 v0, p0

    move-object/from16 v1, v16

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    .line 1079
    iget-boolean v2, v3, Lcom/htc/android/mail/Mailbox;->isServerFolder:Z

    if-eqz v2, :cond_10

    .line 1080
    new-array v0, v15, [Landroid/content/ContentValues;

    move-object/from16 v20, v0

    .line 1081
    .local v20, valuesArray:[Landroid/content/ContentValues;
    const/4 v13, 0x0

    .local v13, i:I
    :goto_2
    if-ge v13, v15, :cond_d

    .line 1082
    move-object/from16 v0, p1

    invoke-virtual {v0, v13}, Lcom/htc/android/mail/server/Server$PendingRequestList;->get(I)Lcom/htc/android/mail/server/Server$PendingRequest;

    move-result-object v14

    .line 1083
    new-instance v19, Landroid/content/ContentValues;

    invoke-direct/range {v19 .. v19}, Landroid/content/ContentValues;-><init>()V

    .line 1084
    .local v19, values:Landroid/content/ContentValues;
    const-string v2, "_accountId"

    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v4}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v4

    invoke-static {v4, v5}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v4

    move-object/from16 v0, v19

    invoke-virtual {v0, v2, v4}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 1085
    const-string v2, "_messageId"

    iget-wide v4, v14, Lcom/htc/android/mail/server/Server$PendingRequest;->messageId:J

    invoke-static {v4, v5}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v4

    move-object/from16 v0, v19

    invoke-virtual {v0, v2, v4}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 1086
    const-string v2, "_msgId"

    iget-object v4, v14, Lcom/htc/android/mail/server/Server$PendingRequest;->msgIdInHeader:Ljava/lang/String;

    move-object/from16 v0, v19

    invoke-virtual {v0, v2, v4}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 1087
    const-string v2, "_request"

    const/4 v4, 0x5

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    move-object/from16 v0, v19

    invoke-virtual {v0, v2, v4}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 1088
    const-string v2, "_fromMailboxId"

    iget-wide v4, v14, Lcom/htc/android/mail/server/Server$PendingRequest;->toMailboxId:J

    invoke-static {v4, v5}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v4

    move-object/from16 v0, v19

    invoke-virtual {v0, v2, v4}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 1089
    aput-object v19, v20, v13

    .line 1081
    add-int/lit8 v13, v13, 0x1

    goto :goto_2

    .line 1066
    .end local v13           #i:I
    .end local v16           #tag:Ljava/lang/String;
    .end local v19           #values:Landroid/content/ContentValues;
    .end local v20           #valuesArray:[Landroid/content/ContentValues;
    :cond_c
    const/16 v18, 0x0

    goto/16 :goto_1

    .line 1091
    .restart local v13       #i:I
    .restart local v16       #tag:Ljava/lang/String;
    .restart local v20       #valuesArray:[Landroid/content/ContentValues;
    :cond_d
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v10

    .line 1092
    .local v10, cp:Landroid/content/IContentProvider;
    sget-object v2, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    move-object/from16 v0, v20

    invoke-interface {v10, v2, v0}, Landroid/content/IContentProvider;->bulkInsert(Landroid/net/Uri;[Landroid/content/ContentValues;)I

    .line 1094
    const/4 v13, 0x0

    :goto_3
    if-ge v13, v15, :cond_10

    .line 1095
    move-object/from16 v0, p1

    invoke-virtual {v0, v13}, Lcom/htc/android/mail/server/Server$PendingRequestList;->get(I)Lcom/htc/android/mail/server/Server$PendingRequest;

    move-result-object v14

    .line 1096
    if-eqz v18, :cond_e

    invoke-virtual/range {v18 .. v18}, Ljava/util/ArrayList;->size()I

    move-result v2

    if-ne v2, v15, :cond_e

    move-object/from16 v0, v18

    invoke-virtual {v0, v13}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    if-nez v2, :cond_f

    .line 1097
    :cond_e
    iget-wide v4, v14, Lcom/htc/android/mail/server/Server$PendingRequest;->messageId:J

    iget-object v6, v14, Lcom/htc/android/mail/server/Server$PendingRequest;->msgIdInHeader:Ljava/lang/String;

    const/4 v7, 0x0

    move-object/from16 v2, p0

    invoke-virtual/range {v2 .. v7}, Lcom/htc/android/mail/server/ImapServer;->getUidFromServer(Lcom/htc/android/mail/Mailbox;JLjava/lang/String;Ljava/lang/String;)Z

    .line 1094
    :goto_4
    add-int/lit8 v13, v13, 0x1

    goto :goto_3

    .line 1099
    :cond_f
    iget-wide v4, v14, Lcom/htc/android/mail/server/Server$PendingRequest;->messageId:J

    iget-object v6, v14, Lcom/htc/android/mail/server/Server$PendingRequest;->msgIdInHeader:Ljava/lang/String;

    move-object/from16 v0, v18

    invoke-virtual {v0, v13}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Ljava/lang/String;

    move-object/from16 v2, p0

    invoke-virtual/range {v2 .. v7}, Lcom/htc/android/mail/server/ImapServer;->getUidFromServer(Lcom/htc/android/mail/Mailbox;JLjava/lang/String;Ljava/lang/String;)Z
    :try_end_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_1

    goto :goto_4

    .line 1112
    .end local v10           #cp:Landroid/content/IContentProvider;
    .end local v13           #i:I
    .end local v16           #tag:Ljava/lang/String;
    .end local v17           #uidSeq:Ljava/lang/String;
    .end local v18           #uids:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/String;>;"
    .end local v20           #valuesArray:[Landroid/content/ContentValues;
    :catch_1
    move-exception v11

    .line 1113
    .local v11, e:Ljava/lang/Exception;
    const-string v2, "ImapServer"

    const-string v4, "Unknow Exception"

    invoke-static {v2, v4, v11}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 1114
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->delete()I

    goto/16 :goto_0

    .line 1105
    .end local v11           #e:Ljava/lang/Exception;
    .restart local v17       #uidSeq:Ljava/lang/String;
    .restart local v18       #uids:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/String;>;"
    :cond_10
    :try_start_1
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "_account = \'%d\' AND _mailboxId = \'%d\' AND _uid in (%s) AND _del <> -1"

    const/4 v5, 0x3

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v6, 0x0

    move-object/from16 v0, p0

    iget-object v7, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v7}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v22

    invoke-static/range {v22 .. v23}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v5, v6

    const/4 v6, 0x1

    iget-wide v0, v12, Lcom/htc/android/mail/Mailbox;->id:J

    move-wide/from16 v22, v0

    invoke-static/range {v22 .. v23}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v5, v6

    const/4 v6, 0x2

    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->getUidSeqEscape()Ljava/lang/String;

    move-result-object v7

    aput-object v7, v5, v6

    invoke-static {v2, v4, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v21

    .line 1107
    .local v21, where:Ljava/lang/String;
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v2

    sget-object v4, Lcom/htc/android/mail/MailProvider;->sNoNotifyMessagesURI:Landroid/net/Uri;

    const/4 v5, 0x0

    move-object/from16 v0, v21

    invoke-interface {v2, v4, v0, v5}, Landroid/content/IContentProvider;->delete(Landroid/net/Uri;Ljava/lang/String;[Ljava/lang/String;)I

    .line 1109
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->delete()I
    :try_end_1
    .catch Ljava/io/IOException; {:try_start_1 .. :try_end_1} :catch_0
    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_1

    goto/16 :goto_0
.end method

.method protected parseMailbox(Ljava/util/List;Ljava/util/ArrayList;Ljava/util/ArrayList;)V
    .locals 17
    .parameter
    .parameter
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;",
            "Ljava/util/ArrayList",
            "<",
            "Lcom/htc/android/mail/Mailbox;",
            ">;",
            "Ljava/util/ArrayList",
            "<",
            "Lcom/htc/android/mail/Mailbox;",
            ">;)V"
        }
    .end annotation

    .prologue
    .line 683
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    .local p2, mailboxList:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/htc/android/mail/Mailbox;>;"
    .local p3, mailboxparentList:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/htc/android/mail/Mailbox;>;"
    const-wide/16 v12, 0x0

    .line 684
    .local v12, nowParentId:J
    const/4 v11, 0x0

    .line 686
    .local v11, nowParentBox:Lcom/htc/android/mail/Mailbox;
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v15

    .line 687
    .local v15, size:I
    const/4 v8, 0x0

    .local v8, index:I
    :goto_0
    add-int/lit8 v2, v15, -0x1

    if-ge v8, v2, :cond_6

    .line 688
    move-object/from16 v0, p1

    invoke-interface {v0, v8}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Lcom/htc/android/mail/ByteString;

    .line 689
    .local v14, r:Lcom/htc/android/mail/ByteString;
    sget-boolean v2, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v2, :cond_0

    const-string v2, "ImapServer"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "--->"

    invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v14}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v5}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v3, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    .line 690
    :cond_0
    invoke-static {}, Lcom/htc/android/mail/Regex;->getInstance()Lcom/htc/android/mail/Regex;

    move-result-object v2

    const/16 v3, 0x10

    invoke-virtual {v2, v3}, Lcom/htc/android/mail/Regex;->getPattern(I)Ljava/util/regex/Pattern;

    move-result-object v2

    invoke-virtual {v14}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/util/regex/Pattern;->matcher(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;

    move-result-object v10

    .line 691
    .local v10, matcher:Ljava/util/regex/Matcher;
    invoke-virtual {v10}, Ljava/util/regex/Matcher;->find()Z

    move-result v2

    if-eqz v2, :cond_2

    .line 693
    const/4 v2, 0x2

    invoke-virtual {v10, v2}, Ljava/util/regex/Matcher;->group(I)Ljava/lang/String;

    move-result-object v4

    .line 695
    .local v4, mailboxName:Ljava/lang/String;
    invoke-virtual {v4}, Ljava/lang/String;->length()I

    move-result v9

    .line 697
    .local v9, length:I
    const/4 v2, 0x0

    invoke-virtual {v4, v2}, Ljava/lang/String;->charAt(I)C

    move-result v2

    const/16 v3, 0x22

    if-ne v2, v3, :cond_1

    add-int/lit8 v2, v9, -0x1

    invoke-virtual {v4, v2}, Ljava/lang/String;->charAt(I)C

    move-result v2

    const/16 v3, 0x22

    if-ne v2, v3, :cond_1

    .line 698
    const/4 v2, 0x1

    add-int/lit8 v3, v9, -0x1

    invoke-virtual {v4, v2, v3}, Ljava/lang/String;->substring(II)Ljava/lang/String;

    move-result-object v4

    .line 701
    :cond_1
    const/4 v2, 0x1

    invoke-virtual {v10, v2}, Ljava/util/regex/Matcher;->group(I)Ljava/lang/String;

    move-result-object v2

    const-string v3, "HasChildren"

    invoke-virtual {v2, v3}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v2

    if-eqz v2, :cond_4

    const/4 v2, 0x1

    invoke-virtual {v10, v2}, Ljava/util/regex/Matcher;->group(I)Ljava/lang/String;

    move-result-object v2

    const-string v3, "Noselect"

    invoke-virtual {v2, v3}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v2

    if-eqz v2, :cond_4

    .line 702
    new-instance v1, Lcom/htc/android/mail/Mailbox;

    move-object/from16 v0, p0

    iget-object v2, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v2}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v2

    const/4 v5, 0x1

    const/4 v6, 0x1

    const/4 v7, 0x1

    invoke-virtual {v10, v7}, Ljava/util/regex/Matcher;->group(I)Ljava/lang/String;

    move-result-object v7

    const-string v16, "Noselect"

    move-object/from16 v0, v16

    invoke-virtual {v7, v0}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v7

    if-eqz v7, :cond_3

    const/4 v7, 0x1

    :goto_1
    invoke-direct/range {v1 .. v7}, Lcom/htc/android/mail/Mailbox;-><init>(JLjava/lang/String;ZII)V

    .line 704
    .local v1, box:Lcom/htc/android/mail/Mailbox;
    invoke-virtual {v1}, Lcom/htc/android/mail/Mailbox;->decode()V

    .line 705
    move-object/from16 v0, p0

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->updateMailboxToDb(Lcom/htc/android/mail/Mailbox;)J

    move-result-wide v12

    .line 706
    move-object v11, v1

    .line 707
    move-object/from16 v0, p3

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 687
    .end local v1           #box:Lcom/htc/android/mail/Mailbox;
    .end local v4           #mailboxName:Ljava/lang/String;
    .end local v9           #length:I
    :cond_2
    :goto_2
    add-int/lit8 v8, v8, 0x1

    goto/16 :goto_0

    .line 702
    .restart local v4       #mailboxName:Ljava/lang/String;
    .restart local v9       #length:I
    :cond_3
    const/4 v7, 0x0

    goto :goto_1

    .line 709
    :cond_4
    new-instance v1, Lcom/htc/android/mail/Mailbox;

    move-object/from16 v0, p0

    iget-object v2, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v2}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v2

    const/4 v5, 0x1

    const/4 v6, 0x0

    const/4 v7, 0x0

    invoke-direct/range {v1 .. v7}, Lcom/htc/android/mail/Mailbox;-><init>(JLjava/lang/String;ZII)V

    .line 710
    .restart local v1       #box:Lcom/htc/android/mail/Mailbox;
    invoke-virtual {v1}, Lcom/htc/android/mail/Mailbox;->decode()V

    .line 711
    const-wide/16 v2, 0x0

    cmp-long v2, v12, v2

    if-eqz v2, :cond_5

    if-eqz v11, :cond_5

    iget-object v2, v1, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    iget-object v3, v11, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    invoke-virtual {v2, v3}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v2

    if-eqz v2, :cond_5

    .line 712
    invoke-static {v12, v13}, Ljava/lang/String;->valueOf(J)Ljava/lang/String;

    move-result-object v2

    iput-object v2, v1, Lcom/htc/android/mail/Mailbox;->parentId:Ljava/lang/String;

    .line 717
    :goto_3
    move-object/from16 v0, p2

    invoke-virtual {v0, v1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_2

    .line 714
    :cond_5
    const-wide/16 v12, 0x0

    .line 715
    const/4 v11, 0x0

    goto :goto_3

    .line 721
    .end local v1           #box:Lcom/htc/android/mail/Mailbox;
    .end local v4           #mailboxName:Ljava/lang/String;
    .end local v9           #length:I
    .end local v10           #matcher:Ljava/util/regex/Matcher;
    .end local v14           #r:Lcom/htc/android/mail/ByteString;
    :cond_6
    return-void
.end method

.method protected preFetchMailAgain()V
    .locals 0

    .prologue
    .line 2716
    return-void
.end method

.method public probe()V
    .locals 6
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    const/4 v3, 0x1

    .line 5014
    invoke-direct {p0}, Lcom/htc/android/mail/server/ImapServer;->checkAccount()V

    .line 5016
    iget v2, p0, Lcom/htc/android/mail/server/Server;->socketState:I

    if-ne v2, v3, :cond_0

    .line 5033
    :goto_0
    return-void

    .line 5021
    :cond_0
    :try_start_0
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v1

    .line 5023
    .local v1, tag:Ljava/lang/String;
    iget-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    const-string v3, ""

    invoke-virtual {p0, v2, v3}, Lcom/htc/android/mail/server/ImapServer;->updateProgressStatus(Lcom/htc/android/mail/Account;Ljava/lang/String;)V

    .line 5024
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v3, "%s NOOP"

    const/4 v4, 0x1

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v5, 0x0

    aput-object v1, v4, v5

    invoke-static {v2, v3, v4}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v2

    invoke-virtual {p0, v2}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 5025
    invoke-virtual {p0, v1}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;
    :try_end_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_0

    .line 5026
    .end local v1           #tag:Ljava/lang/String;
    :catch_0
    move-exception v0

    .line 5027
    .local v0, e:Ljava/io/IOException;
    const-string v2, "ImapServer"

    const-string v3, "probe fail"

    invoke-static {v2, v3, v0}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V

    .line 5028
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->isStop()Z

    move-result v2

    if-eqz v2, :cond_1

    .line 5029
    throw v0

    .line 5031
    :cond_1
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->close()V

    goto :goto_0
.end method

.method protected processAnnotations(Lcom/htc/android/mail/MailMessage;Lcom/htc/android/mail/ByteString;Ljava/util/ArrayList;)V
    .locals 0
    .parameter "mailMessage"
    .parameter "byteString"
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/MailMessage;",
            "Lcom/htc/android/mail/ByteString;",
            "Ljava/util/ArrayList",
            "<",
            "Landroid/content/ContentProviderOperation;",
            ">;)V"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .line 3087
    .local p3, operations:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/ContentProviderOperation;>;"
    return-void
.end method

.method protected processFetchHeader(Ljava/util/List;)Ljava/util/List;
    .locals 58
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;)",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/MailMessage;",
            ">;"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .line 3745
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    invoke-interface/range {p1 .. p1}, Ljava/util/List;->size()I

    move-result v44

    .line 3747
    .local v44, size:I
    if-nez v44, :cond_1

    .line 3748
    const/16 v34, 0x0

    .line 4039
    :cond_0
    :goto_0
    return-object v34

    .line 3750
    :cond_1
    add-int/lit8 v9, v44, -0x1

    move-object/from16 v0, p1

    invoke-interface {v0, v9}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v40

    check-cast v40, Lcom/htc/android/mail/ByteString;

    .line 3751
    .local v40, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual/range {v40 .. v40}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v9

    const-string v54, " "

    move-object/from16 v0, v54

    invoke-virtual {v9, v0}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v51

    .line 3753
    .local v51, token:[Ljava/lang/String;
    move-object/from16 v0, v51

    array-length v9, v0

    const/16 v54, 0x2

    move/from16 v0, v54

    if-lt v9, v0, :cond_2

    move-object/from16 v0, v51

    array-length v9, v0

    const/16 v54, 0x1

    move/from16 v0, v54

    if-le v9, v0, :cond_3

    const/4 v9, 0x1

    aget-object v9, v51, v9

    sget-object v54, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual/range {v54 .. v54}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v54

    move-object/from16 v0, v54

    invoke-virtual {v9, v0}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v9

    if-eqz v9, :cond_3

    .line 3754
    :cond_2
    const/16 v34, 0x0

    goto :goto_0

    .line 3757
    :cond_3
    new-instance v19, Ljava/util/ArrayList;

    invoke-direct/range {v19 .. v19}, Ljava/util/ArrayList;-><init>()V

    .line 3758
    .local v19, currentMessage:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const-string v38, ""

    .line 3759
    .local v38, nowUid:Ljava/lang/String;
    const/16 v52, 0x0

    .line 3760
    .local v52, totalSize:I
    const/16 v41, 0x0

    .line 3761
    .local v41, readFlag:Z
    const/4 v14, 0x0

    .line 3762
    .local v14, bodyHeaderSize:I
    const-string v30, ""

    .line 3763
    .local v30, internaldate:Ljava/lang/String;
    invoke-static {}, Ljava/util/Calendar;->getInstance()Ljava/util/Calendar;

    move-result-object v29

    .line 3766
    .local v29, indate:Ljava/util/Calendar;
    new-instance v34, Ljava/util/ArrayList;

    invoke-direct/range {v34 .. v34}, Ljava/util/ArrayList;-><init>()V

    .line 3770
    .local v34, mailMessageList:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    new-instance v39, Ljava/util/ArrayList;

    invoke-direct/range {v39 .. v39}, Ljava/util/ArrayList;-><init>()V

    .line 3772
    .local v39, operations:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/ContentProviderOperation;>;"
    const/16 v27, 0x0

    .local v27, i:I
    :goto_1
    add-int/lit8 v9, v44, -0x1

    move/from16 v0, v27

    if-ge v0, v9, :cond_27

    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->isStop()Z

    move-result v9

    if-nez v9, :cond_27

    .line 3773
    move-object/from16 v0, p1

    move/from16 v1, v27

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v40

    .end local v40           #r:Lcom/htc/android/mail/ByteString;
    check-cast v40, Lcom/htc/android/mail/ByteString;

    .line 3774
    .restart local v40       #r:Lcom/htc/android/mail/ByteString;
    sget-object v9, Lcom/htc/android/mail/server/ImapServer;->STR_STAR:Lcom/htc/android/mail/ByteString;

    move-object/from16 v0, v40

    invoke-virtual {v0, v9}, Lcom/htc/android/mail/ByteString;->startsWith(Lcom/htc/android/mail/ByteString;)Z

    move-result v9

    if-eqz v9, :cond_d

    .line 3776
    invoke-virtual/range {v40 .. v40}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object v9

    const-string v54, " "

    const/16 v55, 0x4

    move-object/from16 v0, v54

    move/from16 v1, v55

    invoke-virtual {v9, v0, v1}, Ljava/lang/String;->split(Ljava/lang/String;I)[Ljava/lang/String;

    move-result-object v45

    .line 3777
    .local v45, splitStr:[Ljava/lang/String;
    move-object/from16 v0, v45

    array-length v9, v0

    const/16 v54, 0x4

    move/from16 v0, v54

    if-ge v9, v0, :cond_5

    .line 3772
    .end local v45           #splitStr:[Ljava/lang/String;
    :cond_4
    :goto_2
    add-int/lit8 v27, v27, 0x1

    goto :goto_1

    .line 3781
    .restart local v45       #splitStr:[Ljava/lang/String;
    :cond_5
    const-string v9, "FETCH"

    const/16 v54, 0x2

    aget-object v54, v45, v54

    move-object/from16 v0, v54

    invoke-virtual {v9, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v9

    if-eqz v9, :cond_4

    .line 3786
    invoke-interface/range {v19 .. v19}, Ljava/util/List;->clear()V

    .line 3788
    invoke-static {}, Lcom/htc/android/mail/Regex;->getInstance()Lcom/htc/android/mail/Regex;

    move-result-object v9

    const/16 v54, 0x7

    move/from16 v0, v54

    invoke-virtual {v9, v0}, Lcom/htc/android/mail/Regex;->getPattern(I)Ljava/util/regex/Pattern;

    move-result-object v9

    invoke-virtual/range {v40 .. v40}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v54

    move-object/from16 v0, v54

    invoke-virtual {v9, v0}, Ljava/util/regex/Pattern;->matcher(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;

    move-result-object v31

    .line 3789
    .local v31, m:Ljava/util/regex/Matcher;
    invoke-virtual/range {v31 .. v31}, Ljava/util/regex/Matcher;->find()Z

    move-result v22

    .line 3790
    .local v22, found:Z
    if-eqz v22, :cond_4

    .line 3791
    new-instance v46, Ljava/util/ArrayList;

    invoke-direct/range {v46 .. v46}, Ljava/util/ArrayList;-><init>()V

    .line 3792
    .local v46, store:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/String;>;"
    const-string v12, ""

    .line 3793
    .local v12, FlagsValue:Ljava/lang/String;
    sget-boolean v9, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v9, :cond_6

    .line 3794
    const-string v9, "ImapServer"

    const-string v54, " try parsing header"

    move-object/from16 v0, v54

    invoke-static {v9, v0}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 3795
    :cond_6
    const/4 v9, 0x1

    move-object/from16 v0, v31

    invoke-virtual {v0, v9}, Ljava/util/regex/Matcher;->group(I)Ljava/lang/String;

    move-result-object v9

    invoke-static {v9}, Lcom/htc/android/mail/Util;->parsePairString(Ljava/lang/String;)Ljava/util/ArrayList;

    move-result-object v46

    .line 3796
    const-string v9, "UID"

    move-object/from16 v0, v46

    invoke-static {v0, v9}, Lcom/htc/android/mail/Util;->getValueString(Ljava/util/ArrayList;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v9

    if-eqz v9, :cond_7

    .line 3797
    const-string v9, "UID"

    move-object/from16 v0, v46

    invoke-static {v0, v9}, Lcom/htc/android/mail/Util;->getValueString(Ljava/util/ArrayList;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v38

    .line 3798
    :cond_7
    const-string v9, "RFC822.SIZE"

    move-object/from16 v0, v46

    invoke-static {v0, v9}, Lcom/htc/android/mail/Util;->getValueString(Ljava/util/ArrayList;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v9

    if-eqz v9, :cond_8

    .line 3799
    const-string v9, "RFC822.SIZE"

    move-object/from16 v0, v46

    invoke-static {v0, v9}, Lcom/htc/android/mail/Util;->getValueString(Ljava/util/ArrayList;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v9

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/Integer;->intValue()I

    move-result v52

    .line 3800
    :cond_8
    const-string v9, "FLAGS"

    move-object/from16 v0, v46

    invoke-static {v0, v9}, Lcom/htc/android/mail/Util;->getValueString(Ljava/util/ArrayList;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v9

    if-eqz v9, :cond_a

    .line 3801
    const-string v9, "FLAGS"

    move-object/from16 v0, v46

    invoke-static {v0, v9}, Lcom/htc/android/mail/Util;->getValueString(Ljava/util/ArrayList;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v12

    .line 3802
    const-string v9, "\\Seen"

    invoke-virtual {v12, v9}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v9

    if-eqz v9, :cond_a

    .line 3803
    sget-boolean v9, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v9, :cond_9

    .line 3804
    const-string v9, "ImapServer"

    const-string v54, "Seen !"

    move-object/from16 v0, v54

    invoke-static {v9, v0}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 3805
    :cond_9
    const/16 v41, 0x1

    .line 3808
    :cond_a
    const-string v9, "INTERNALDATE"

    move-object/from16 v0, v46

    invoke-static {v0, v9}, Lcom/htc/android/mail/Util;->getValueString(Ljava/util/ArrayList;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v9

    if-eqz v9, :cond_b

    .line 3809
    const-string v9, "INTERNALDATE"

    move-object/from16 v0, v46

    invoke-static {v0, v9}, Lcom/htc/android/mail/Util;->getValueString(Ljava/util/ArrayList;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v30

    .line 3810
    :cond_b
    sget-boolean v9, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v9, :cond_c

    .line 3811
    const-string v9, "ImapServer"

    new-instance v54, Ljava/lang/StringBuilder;

    invoke-direct/range {v54 .. v54}, Ljava/lang/StringBuilder;-><init>()V

    const-string v55, "**************"

    invoke-virtual/range {v54 .. v55}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v54

    move-object/from16 v0, v54

    move-object/from16 v1, v30

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v54

    invoke-virtual/range {v54 .. v54}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v54

    move-object/from16 v0, v54

    invoke-static {v9, v0}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 3812
    :cond_c
    invoke-virtual/range {v30 .. v30}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object v9

    invoke-static {v9}, Lcom/htc/android/mail/DateParser;->parse(Ljava/lang/String;)Ljava/util/Calendar;

    move-result-object v29

    .line 3814
    const/4 v9, 0x2

    move-object/from16 v0, v31

    invoke-virtual {v0, v9}, Ljava/util/regex/Matcher;->group(I)Ljava/lang/String;

    move-result-object v9

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/Integer;->intValue()I

    move-result v14

    .line 3815
    sget-boolean v9, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v9, :cond_4

    .line 3816
    const-string v9, "ImapServer"

    new-instance v54, Ljava/lang/StringBuilder;

    invoke-direct/range {v54 .. v54}, Ljava/lang/StringBuilder;-><init>()V

    const-string v55, "UID is "

    invoke-virtual/range {v54 .. v55}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v54

    move-object/from16 v0, v54

    move-object/from16 v1, v38

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v54

    const-string v55, ", RFC2822.SIZE is "

    invoke-virtual/range {v54 .. v55}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v54

    move-object/from16 v0, v54

    move/from16 v1, v52

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v54

    const-string v55, ", FLAGS is "

    invoke-virtual/range {v54 .. v55}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v54

    move-object/from16 v0, v54

    invoke-virtual {v0, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v54

    const-string v55, ", HeaderSize is "

    invoke-virtual/range {v54 .. v55}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v54

    move-object/from16 v0, v54

    invoke-virtual {v0, v14}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v54

    invoke-virtual/range {v54 .. v54}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v54

    move-object/from16 v0, v54

    invoke-static {v9, v0}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    goto/16 :goto_2

    .line 3842
    .end local v12           #FlagsValue:Ljava/lang/String;
    .end local v22           #found:Z
    .end local v31           #m:Ljava/util/regex/Matcher;
    .end local v45           #splitStr:[Ljava/lang/String;
    .end local v46           #store:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/String;>;"
    :cond_d
    invoke-virtual/range {v40 .. v40}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object v47

    .local v47, str:Ljava/lang/String;
    if-eqz v47, :cond_26

    const-string v9, ")"

    move-object/from16 v0, v47

    invoke-virtual {v0, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v9

    if-nez v9, :cond_e

    const-string v9, ")"

    move-object/from16 v0, v47

    invoke-virtual {v0, v9}, Ljava/lang/String;->endsWith(Ljava/lang/String;)Z

    move-result v9

    if-eqz v9, :cond_26

    const-string v9, "FLAGS"

    move-object/from16 v0, v47

    invoke-virtual {v0, v9}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v9

    if-nez v9, :cond_e

    const-string v9, "UID"

    move-object/from16 v0, v47

    invoke-virtual {v0, v9}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v9

    if-nez v9, :cond_e

    const-string v9, "RFC822.SIZE"

    move-object/from16 v0, v47

    invoke-virtual {v0, v9}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v9

    if-eqz v9, :cond_26

    .line 3847
    :cond_e
    invoke-virtual/range {v47 .. v47}, Ljava/lang/String;->length()I

    move-result v9

    const/16 v54, 0x1

    move/from16 v0, v54

    if-le v9, v0, :cond_15

    .line 3848
    invoke-static {}, Lcom/htc/android/mail/Regex;->getInstance()Lcom/htc/android/mail/Regex;

    move-result-object v9

    const/16 v54, 0x8

    move/from16 v0, v54

    invoke-virtual {v9, v0}, Lcom/htc/android/mail/Regex;->getPattern(I)Ljava/util/regex/Pattern;

    move-result-object v9

    invoke-virtual/range {v40 .. v40}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v54

    move-object/from16 v0, v54

    invoke-virtual {v9, v0}, Ljava/util/regex/Pattern;->matcher(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;

    move-result-object v31

    .line 3849
    .restart local v31       #m:Ljava/util/regex/Matcher;
    invoke-virtual/range {v31 .. v31}, Ljava/util/regex/Matcher;->find()Z

    move-result v22

    .line 3850
    .restart local v22       #found:Z
    if-eqz v22, :cond_15

    .line 3851
    new-instance v46, Ljava/util/ArrayList;

    invoke-direct/range {v46 .. v46}, Ljava/util/ArrayList;-><init>()V

    .line 3852
    .restart local v46       #store:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/String;>;"
    const-string v12, ""

    .line 3853
    .restart local v12       #FlagsValue:Ljava/lang/String;
    sget-boolean v9, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v9, :cond_f

    .line 3854
    const-string v9, "ImapServer"

    const-string v54, " try parsing end"

    move-object/from16 v0, v54

    invoke-static {v9, v0}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 3856
    :cond_f
    const/4 v9, 0x1

    move-object/from16 v0, v31

    invoke-virtual {v0, v9}, Ljava/util/regex/Matcher;->group(I)Ljava/lang/String;

    move-result-object v9

    invoke-static {v9}, Lcom/htc/android/mail/Util;->parsePairString(Ljava/lang/String;)Ljava/util/ArrayList;

    move-result-object v46

    .line 3857
    const-string v9, "UID"

    move-object/from16 v0, v46

    invoke-static {v0, v9}, Lcom/htc/android/mail/Util;->getValueString(Ljava/util/ArrayList;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v9

    if-eqz v9, :cond_10

    .line 3858
    const-string v9, "UID"

    move-object/from16 v0, v46

    invoke-static {v0, v9}, Lcom/htc/android/mail/Util;->getValueString(Ljava/util/ArrayList;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v38

    .line 3859
    :cond_10
    const-string v9, "RFC822.SIZE"

    move-object/from16 v0, v46

    invoke-static {v0, v9}, Lcom/htc/android/mail/Util;->getValueString(Ljava/util/ArrayList;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v9

    if-eqz v9, :cond_11

    .line 3860
    const-string v9, "RFC822.SIZE"

    move-object/from16 v0, v46

    invoke-static {v0, v9}, Lcom/htc/android/mail/Util;->getValueString(Ljava/util/ArrayList;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v9

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/Integer;->intValue()I

    move-result v52

    .line 3861
    :cond_11
    const-string v9, "FLAGS"

    move-object/from16 v0, v46

    invoke-static {v0, v9}, Lcom/htc/android/mail/Util;->getValueString(Ljava/util/ArrayList;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v9

    if-eqz v9, :cond_13

    .line 3862
    const-string v9, "FLAGS"

    move-object/from16 v0, v46

    invoke-static {v0, v9}, Lcom/htc/android/mail/Util;->getValueString(Ljava/util/ArrayList;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v12

    .line 3863
    const-string v9, "\\Seen"

    invoke-virtual {v12, v9}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v9

    if-eqz v9, :cond_13

    .line 3864
    sget-boolean v9, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v9, :cond_12

    .line 3865
    const-string v9, "ImapServer"

    const-string v54, "Seen !"

    move-object/from16 v0, v54

    invoke-static {v9, v0}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 3866
    :cond_12
    const/16 v41, 0x1

    .line 3869
    :cond_13
    const-string v9, "INTERNALDATE"

    move-object/from16 v0, v46

    invoke-static {v0, v9}, Lcom/htc/android/mail/Util;->getValueString(Ljava/util/ArrayList;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v9

    if-eqz v9, :cond_14

    .line 3870
    const-string v9, "INTERNALDATE"

    move-object/from16 v0, v46

    invoke-static {v0, v9}, Lcom/htc/android/mail/Util;->getValueString(Ljava/util/ArrayList;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v30

    .line 3871
    :cond_14
    invoke-virtual/range {v30 .. v30}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object v9

    invoke-static {v9}, Lcom/htc/android/mail/DateParser;->parse(Ljava/lang/String;)Ljava/util/Calendar;

    move-result-object v29

    .line 3874
    .end local v12           #FlagsValue:Ljava/lang/String;
    .end local v22           #found:Z
    .end local v31           #m:Ljava/util/regex/Matcher;
    .end local v46           #store:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Ljava/lang/String;>;"
    :cond_15
    sget-boolean v9, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v9, :cond_16

    .line 3875
    const-string v9, "ImapServer"

    new-instance v54, Ljava/lang/StringBuilder;

    invoke-direct/range {v54 .. v54}, Ljava/lang/StringBuilder;-><init>()V

    const-string v55, "UID is "

    invoke-virtual/range {v54 .. v55}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v54

    move-object/from16 v0, v54

    move-object/from16 v1, v38

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v54

    const-string v55, ", RFC2822.SIZE is "

    invoke-virtual/range {v54 .. v55}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v54

    move-object/from16 v0, v54

    move/from16 v1, v52

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v54

    const-string v55, ", HeaderSize is "

    invoke-virtual/range {v54 .. v55}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v54

    move-object/from16 v0, v54

    invoke-virtual {v0, v14}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v54

    invoke-virtual/range {v54 .. v54}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v54

    move-object/from16 v0, v54

    invoke-static {v9, v0}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    :cond_16
    move-object/from16 v9, v19

    .line 3879
    check-cast v9, Ljava/util/ArrayList;

    const/16 v54, 0x1

    move/from16 v0, v54

    invoke-static {v9, v0}, Lcom/htc/android/mail/Util;->unfoldLines(Ljava/util/ArrayList;Z)I

    move-result v25

    .line 3880
    .local v25, headerBreak:I
    sget-boolean v9, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v9, :cond_17

    .line 3881
    const-string v9, "ImapServer"

    new-instance v54, Ljava/lang/StringBuilder;

    invoke-direct/range {v54 .. v54}, Ljava/lang/StringBuilder;-><init>()V

    const-string v55, "# break "

    invoke-virtual/range {v54 .. v55}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v54

    move-object/from16 v0, v54

    move/from16 v1, v25

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v54

    invoke-virtual/range {v54 .. v54}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v54

    move-object/from16 v0, v54

    invoke-static {v9, v0}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 3882
    :cond_17
    new-instance v26, Ljava/util/HashMap;

    move-object/from16 v0, v26

    move/from16 v1, v25

    invoke-direct {v0, v1}, Ljava/util/HashMap;-><init>(I)V

    .local v26, headers:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Ljava/lang/String;>;"
    move-object/from16 v9, v19

    .line 3884
    check-cast v9, Ljava/util/ArrayList;

    move/from16 v0, v25

    move-object/from16 v1, v26

    invoke-static {v9, v0, v1}, Lcom/htc/android/mail/Headers;->extract(Ljava/util/ArrayList;ILjava/util/HashMap;)V

    .line 3885
    const-string v9, "from"

    move-object/from16 v0, v26

    invoke-virtual {v0, v9}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Ljava/lang/String;

    .line 3886
    .local v5, from:Ljava/lang/String;
    const-string v9, "fromEmail"

    move-object/from16 v0, v26

    invoke-virtual {v0, v9}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v23

    check-cast v23, Ljava/lang/String;

    .line 3887
    .local v23, fromEmail:Ljava/lang/String;
    const-string v9, "to"

    move-object/from16 v0, v26

    invoke-virtual {v0, v9}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Ljava/lang/String;

    .line 3888
    .local v6, to:Ljava/lang/String;
    const-string v9, "cc"

    move-object/from16 v0, v26

    invoke-virtual {v0, v9}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Ljava/lang/String;

    .line 3889
    .local v8, cc:Ljava/lang/String;
    const-string v9, "subject"

    move-object/from16 v0, v26

    invoke-virtual {v0, v9}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Ljava/lang/String;

    .line 3890
    .local v7, subject:Ljava/lang/String;
    invoke-static {}, Lcom/htc/android/mail/Mail;->getDefaultCharset()Ljava/lang/String;

    move-result-object v48

    .line 3891
    .local v48, subjectCharset:Ljava/lang/String;
    sget-boolean v9, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v9, :cond_18

    const-string v54, "ImapServer"

    new-instance v9, Ljava/lang/StringBuilder;

    invoke-direct {v9}, Ljava/lang/StringBuilder;-><init>()V

    const-string v55, "subjectCharset :"

    move-object/from16 v0, v55

    invoke-virtual {v9, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    move-object/from16 v0, v48

    invoke-virtual {v9, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    const-string v55, ","

    move-object/from16 v0, v55

    invoke-virtual {v9, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v55

    const-string v9, "subjectCharset"

    move-object/from16 v0, v26

    invoke-virtual {v0, v9}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Ljava/lang/String;

    move-object/from16 v0, v55

    invoke-virtual {v0, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v9

    move-object/from16 v0, v54

    invoke-static {v0, v9}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 3892
    :cond_18
    const-string v9, "subjectCharset"

    move-object/from16 v0, v26

    invoke-virtual {v0, v9}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v9

    if-eqz v9, :cond_19

    const-string v9, ""

    const-string v54, "subjectCharset"

    move-object/from16 v0, v26

    move-object/from16 v1, v54

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v54

    move-object/from16 v0, v54

    invoke-virtual {v9, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v9

    if-nez v9, :cond_19

    const-string v9, "subjectCharset"

    move-object/from16 v0, v26

    invoke-virtual {v0, v9}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v48

    .end local v48           #subjectCharset:Ljava/lang/String;
    check-cast v48, Ljava/lang/String;

    .line 3893
    .restart local v48       #subjectCharset:Ljava/lang/String;
    :cond_19
    const-string v9, "date"

    move-object/from16 v0, v26

    invoke-virtual {v0, v9}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Ljava/lang/String;

    invoke-static {v9}, Lcom/htc/android/mail/DateParser;->parse(Ljava/lang/String;)Ljava/util/Calendar;

    move-result-object v20

    .line 3894
    .local v20, date:Ljava/util/Calendar;
    const-string v9, "content-type"

    move-object/from16 v0, v26

    invoke-virtual {v0, v9}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v17

    check-cast v17, Ljava/lang/String;

    .line 3895
    .local v17, contentType:Ljava/lang/String;
    const-string v9, "message-id"

    move-object/from16 v0, v26

    invoke-virtual {v0, v9}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v37

    check-cast v37, Ljava/lang/String;

    .line 3896
    .local v37, messageid:Ljava/lang/String;
    const-string v9, "importance"

    move-object/from16 v0, v26

    invoke-virtual {v0, v9}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Ljava/lang/String;

    invoke-static {v9}, Lcom/htc/android/mail/MailCommon;->getImportanceValue(Ljava/lang/String;)I

    move-result v28

    .line 3897
    .local v28, importance:I
    const-string v9, "reply-to"

    move-object/from16 v0, v26

    invoke-virtual {v0, v9}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v42

    check-cast v42, Ljava/lang/String;

    .line 3898
    .local v42, replyTo:Ljava/lang/String;
    const-string v9, "references"

    move-object/from16 v0, v26

    invoke-virtual {v0, v9}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Ljava/lang/String;

    .line 3899
    .local v10, references:Ljava/lang/String;
    const/16 v24, 0x0

    .line 3900
    .local v24, group:Ljava/lang/String;
    const/4 v9, 0x1

    new-array v11, v9, [J

    .line 3902
    .local v11, nPsuedoGroupId:[J
    if-eqz v37, :cond_1a

    .line 3903
    invoke-virtual/range {v37 .. v37}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object v9

    const-string v54, "<"

    const-string v55, ""

    move-object/from16 v0, v54

    move-object/from16 v1, v55

    invoke-virtual {v9, v0, v1}, Ljava/lang/String;->replaceAll(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v9

    const-string v54, ">"

    const-string v55, ""

    move-object/from16 v0, v54

    move-object/from16 v1, v55

    invoke-virtual {v9, v0, v1}, Ljava/lang/String;->replaceAll(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v37

    .line 3906
    :cond_1a
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v18

    .line 3907
    .local v18, cp:Landroid/content/IContentProvider;
    const/16 v16, 0x0

    .line 3908
    .local v16, c:Landroid/database/Cursor;
    const-wide/16 v49, 0x0

    .line 3926
    .local v49, thisMessageId:J
    :try_start_0
    const-string v32, ""

    .line 3927
    .local v32, mSubjType:Ljava/lang/String;
    move-object/from16 v0, p0

    invoke-virtual {v0, v7}, Lcom/htc/android/mail/server/ImapServer;->separateSubject(Ljava/lang/String;)Landroid/os/Bundle;

    move-result-object v13

    .line 3928
    .local v13, b:Landroid/os/Bundle;
    const-string v9, "subject"

    invoke-virtual {v13, v9}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v7

    .line 3929
    const-string v9, "prefix"

    invoke-virtual {v13, v9}, Landroid/os/Bundle;->getString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v32

    .line 3931
    if-nez v20, :cond_1b

    .line 3932
    invoke-static {}, Ljava/util/Calendar;->getInstance()Ljava/util/Calendar;

    move-result-object v20

    .line 3933
    :cond_1b
    if-nez v29, :cond_1c

    .line 3934
    move-object/from16 v29, v20

    .line 3936
    :cond_1c
    move-object/from16 v0, p0

    iget-object v9, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    move-object/from16 v54, v0

    move-object/from16 v0, v54

    invoke-virtual {v9, v0}, Lcom/htc/android/mail/Account;->getFetchMailType(Landroid/content/Context;)I

    move-result v9

    const/16 v54, 0x1

    move/from16 v0, v54

    if-ne v9, v0, :cond_1d

    move-object/from16 v0, p0

    iget-boolean v9, v0, Lcom/htc/android/mail/server/ImapServer;->mIsNotSupportSearch:Z

    if-eqz v9, :cond_1d

    .line 3937
    move-object/from16 v0, p0

    iget-wide v0, v0, Lcom/htc/android/mail/server/ImapServer;->mBeginningTimeMillis:J

    move-wide/from16 v54, v0

    invoke-virtual/range {v29 .. v29}, Ljava/util/Calendar;->getTimeInMillis()J

    move-result-wide v56

    invoke-static/range {v56 .. v57}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v9

    invoke-virtual {v9}, Ljava/lang/Long;->longValue()J
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    move-result-wide v56

    cmp-long v9, v54, v56

    if-lez v9, :cond_1d

    .line 3993
    if-eqz v16, :cond_4

    invoke-interface/range {v16 .. v16}, Landroid/database/Cursor;->isClosed()Z

    move-result v9

    if-nez v9, :cond_4

    .line 3994
    invoke-interface/range {v16 .. v16}, Landroid/database/Cursor;->close()V

    goto/16 :goto_2

    .line 3942
    :cond_1d
    const/4 v9, 0x0

    :try_start_1
    invoke-static/range {v5 .. v11}, Lcom/htc/android/mail/BaseStone;->getGroupID(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;[J)Ljava/lang/String;

    move-result-object v24

    .line 3945
    new-instance v53, Landroid/content/ContentValues;

    invoke-direct/range {v53 .. v53}, Landroid/content/ContentValues;-><init>()V

    .line 3946
    .local v53, values:Landroid/content/ContentValues;
    const-string v9, "_account"

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v54, v0

    invoke-virtual/range {v54 .. v54}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v54

    invoke-static/range {v54 .. v55}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v54

    move-object/from16 v0, v53

    move-object/from16 v1, v54

    invoke-virtual {v0, v9, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 3947
    const-string v9, "_from"

    const-string v54, ""

    move-object/from16 v0, v54

    invoke-virtual {v0, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v54

    if-eqz v54, :cond_1e

    const/4 v5, 0x0

    .end local v5           #from:Ljava/lang/String;
    :cond_1e
    move-object/from16 v0, v53

    invoke-virtual {v0, v9, v5}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3948
    const-string v9, "_fromEmail"

    move-object/from16 v0, v53

    move-object/from16 v1, v23

    invoke-virtual {v0, v9, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3949
    const-string v9, "_to"

    move-object/from16 v0, v53

    invoke-virtual {v0, v9, v6}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3950
    const-string v9, "_cc"

    move-object/from16 v0, v53

    invoke-virtual {v0, v9, v8}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3951
    const-string v9, "_subject"

    move-object/from16 v0, v53

    invoke-virtual {v0, v9, v7}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3952
    const-string v9, "_subjtype"

    move-object/from16 v0, v53

    move-object/from16 v1, v32

    invoke-virtual {v0, v9, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3953
    const-string v9, "_charset"

    move-object/from16 v0, v53

    move-object/from16 v1, v48

    invoke-virtual {v0, v9, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3954
    const-string v9, "_importance"

    invoke-static/range {v28 .. v28}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v54

    move-object/from16 v0, v53

    move-object/from16 v1, v54

    invoke-virtual {v0, v9, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 3955
    const-string v9, "_replyTo"

    move-object/from16 v0, v53

    move-object/from16 v1, v42

    invoke-virtual {v0, v9, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3956
    const-string v9, "_date"

    invoke-virtual/range {v20 .. v20}, Ljava/util/Calendar;->getTimeInMillis()J

    move-result-wide v54

    invoke-static/range {v54 .. v55}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v54

    move-object/from16 v0, v53

    move-object/from16 v1, v54

    invoke-virtual {v0, v9, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 3957
    const-string v9, "_internaldate"

    invoke-virtual/range {v29 .. v29}, Ljava/util/Calendar;->getTimeInMillis()J

    move-result-wide v54

    invoke-static/range {v54 .. v55}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v54

    move-object/from16 v0, v53

    move-object/from16 v1, v54

    invoke-virtual {v0, v9, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 3958
    sget-boolean v9, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v9, :cond_1f

    .line 3959
    const-string v9, "ImapServer"

    new-instance v54, Ljava/lang/StringBuilder;

    invoke-direct/range {v54 .. v54}, Ljava/lang/StringBuilder;-><init>()V

    const-string v55, " ****** internal dateValue :"

    invoke-virtual/range {v54 .. v55}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v54

    invoke-virtual/range {v29 .. v29}, Ljava/util/Calendar;->getTimeInMillis()J

    move-result-wide v55

    invoke-static/range {v55 .. v56}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v55

    invoke-virtual/range {v54 .. v55}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v54

    const-string v55, ":"

    invoke-virtual/range {v54 .. v55}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v54

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    move-object/from16 v55, v0

    invoke-virtual/range {v29 .. v29}, Ljava/util/Calendar;->getTimeInMillis()J

    move-result-wide v56

    invoke-static/range {v56 .. v57}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v56

    invoke-virtual/range {v56 .. v56}, Ljava/lang/Long;->longValue()J

    move-result-wide v56

    invoke-static/range {v55 .. v57}, Lcom/htc/android/mail/Util;->getTimeFullString(Landroid/content/Context;J)Ljava/lang/CharSequence;

    move-result-object v55

    invoke-virtual/range {v54 .. v55}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v54

    invoke-virtual/range {v54 .. v54}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v54

    move-object/from16 v0, v54

    invoke-static {v9, v0}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 3961
    :cond_1f
    sget-boolean v9, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v9, :cond_20

    .line 3962
    const-string v9, "ImapServer"

    new-instance v54, Ljava/lang/StringBuilder;

    invoke-direct/range {v54 .. v54}, Ljava/lang/StringBuilder;-><init>()V

    const-string v55, " ****** dateValue :"

    invoke-virtual/range {v54 .. v55}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v54

    invoke-virtual/range {v20 .. v20}, Ljava/util/Calendar;->getTimeInMillis()J

    move-result-wide v55

    invoke-static/range {v55 .. v56}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v55

    invoke-virtual/range {v54 .. v55}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v54

    const-string v55, ":"

    invoke-virtual/range {v54 .. v55}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v54

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    move-object/from16 v55, v0

    invoke-virtual/range {v20 .. v20}, Ljava/util/Calendar;->getTimeInMillis()J

    move-result-wide v56

    invoke-static/range {v56 .. v57}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v56

    invoke-virtual/range {v56 .. v56}, Ljava/lang/Long;->longValue()J

    move-result-wide v56

    invoke-static/range {v55 .. v57}, Lcom/htc/android/mail/Util;->getTimeFullString(Landroid/content/Context;J)Ljava/lang/CharSequence;

    move-result-object v55

    invoke-virtual/range {v54 .. v55}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v54

    invoke-virtual/range {v54 .. v54}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v54

    move-object/from16 v0, v54

    invoke-static {v9, v0}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 3964
    :cond_20
    const-string v54, "_read"

    const/4 v9, 0x1

    move/from16 v0, v41

    if-ne v0, v9, :cond_24

    const/4 v9, 0x1

    :goto_3
    invoke-static {v9}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    move-object/from16 v0, v53

    move-object/from16 v1, v54

    invoke-virtual {v0, v1, v9}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 3965
    const-string v9, "_readsize"

    const/16 v54, 0x0

    invoke-static/range {v54 .. v54}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v54

    move-object/from16 v0, v53

    move-object/from16 v1, v54

    invoke-virtual {v0, v9, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 3966
    const-string v9, "_readtotalsize"

    const/16 v54, 0x0

    invoke-static/range {v54 .. v54}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v54

    move-object/from16 v0, v53

    move-object/from16 v1, v54

    invoke-virtual {v0, v9, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 3967
    const-string v9, "_downloadtotalsize"

    const/16 v54, 0x0

    invoke-static/range {v54 .. v54}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v54

    move-object/from16 v0, v53

    move-object/from16 v1, v54

    invoke-virtual {v0, v9, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 3968
    const-string v9, "_messagesize"

    const/16 v54, 0x0

    invoke-static/range {v54 .. v54}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v54

    move-object/from16 v0, v53

    move-object/from16 v1, v54

    invoke-virtual {v0, v9, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 3971
    const-string v9, "_incAttachment"

    const/16 v54, 0x0

    invoke-static/range {v54 .. v54}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v54

    move-object/from16 v0, v53

    move-object/from16 v1, v54

    invoke-virtual {v0, v9, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 3972
    const-string v9, "_uid"

    move-object/from16 v0, v53

    move-object/from16 v1, v38

    invoke-virtual {v0, v9, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3973
    const-string v9, "_messageid"

    move-object/from16 v0, v53

    move-object/from16 v1, v37

    invoke-virtual {v0, v9, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3974
    const-string v9, "_references"

    move-object/from16 v0, v53

    invoke-virtual {v0, v9, v10}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3975
    const-string v9, "_group"

    move-object/from16 v0, v53

    move-object/from16 v1, v24

    invoke-virtual {v0, v9, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3976
    const-string v9, "_groupPseudo"

    const/16 v54, 0x0

    aget-wide v54, v11, v54

    invoke-static/range {v54 .. v55}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v54

    move-object/from16 v0, v53

    move-object/from16 v1, v54

    invoke-virtual {v0, v9, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 3977
    const-string v9, "_mailboxId"

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    move-object/from16 v54, v0

    move-object/from16 v0, v54

    iget-wide v0, v0, Lcom/htc/android/mail/Mailbox;->id:J

    move-wide/from16 v54, v0

    invoke-static/range {v54 .. v55}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v54

    move-object/from16 v0, v53

    move-object/from16 v1, v54

    invoke-virtual {v0, v9, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 3978
    const-string v9, "_done"

    const/16 v54, 0x0

    invoke-static/range {v54 .. v54}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v54

    move-object/from16 v0, v53

    move-object/from16 v1, v54

    invoke-virtual {v0, v9, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 3980
    move-object/from16 v0, p0

    iget-object v9, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v9}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v54

    move-object/from16 v0, p0

    iget-object v9, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-wide v0, v9, Lcom/htc/android/mail/Mailbox;->id:J

    move-wide/from16 v56, v0

    move-object/from16 v0, p0

    move-wide/from16 v1, v54

    move-wide/from16 v3, v56

    invoke-virtual {v0, v1, v2, v3, v4}, Lcom/htc/android/mail/server/ImapServer;->getSummariesUri(JJ)Landroid/net/Uri;

    move-result-object v9

    invoke-static {v9}, Landroid/content/ContentProviderOperation;->newInsert(Landroid/net/Uri;)Landroid/content/ContentProviderOperation$Builder;

    move-result-object v15

    .line 3982
    .local v15, builder:Landroid/content/ContentProviderOperation$Builder;
    move-object/from16 v0, v53

    invoke-virtual {v15, v0}, Landroid/content/ContentProviderOperation$Builder;->withValues(Landroid/content/ContentValues;)Landroid/content/ContentProviderOperation$Builder;

    move-result-object v15

    .line 3983
    const/4 v9, 0x1

    invoke-virtual {v15, v9}, Landroid/content/ContentProviderOperation$Builder;->withYieldAllowed(Z)Landroid/content/ContentProviderOperation$Builder;

    move-result-object v15

    .line 3984
    invoke-virtual {v15}, Landroid/content/ContentProviderOperation$Builder;->build()Landroid/content/ContentProviderOperation;

    move-result-object v9

    move-object/from16 v0, v39

    invoke-virtual {v0, v9}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 3986
    if-nez v41, :cond_21

    .line 3987
    move-object/from16 v0, p0

    iget-object v9, v0, Lcom/htc/android/mail/server/ImapServer;->mSyncResult:Lcom/htc/android/mail/server/Server$SyncResult;

    iget v0, v9, Lcom/htc/android/mail/server/Server$SyncResult;->unreadNum:I

    move/from16 v54, v0

    add-int/lit8 v54, v54, 0x1

    move/from16 v0, v54

    iput v0, v9, Lcom/htc/android/mail/server/Server$SyncResult;->unreadNum:I
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    .line 3993
    :cond_21
    if-eqz v16, :cond_22

    invoke-interface/range {v16 .. v16}, Landroid/database/Cursor;->isClosed()Z

    move-result v9

    if-nez v9, :cond_22

    .line 3994
    .end local v13           #b:Landroid/os/Bundle;
    .end local v15           #builder:Landroid/content/ContentProviderOperation$Builder;
    .end local v32           #mSubjType:Ljava/lang/String;
    .end local v53           #values:Landroid/content/ContentValues;
    :goto_4
    invoke-interface/range {v16 .. v16}, Landroid/database/Cursor;->close()V

    .line 4001
    :cond_22
    sget-boolean v9, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v9, :cond_23

    .line 4002
    const-string v9, "ImapServer"

    new-instance v54, Ljava/lang/StringBuilder;

    invoke-direct/range {v54 .. v54}, Ljava/lang/StringBuilder;-><init>()V

    const-string v55, "uid: "

    invoke-virtual/range {v54 .. v55}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v54

    move-object/from16 v0, v54

    move-object/from16 v1, v38

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v54

    invoke-virtual/range {v54 .. v54}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v54

    move-object/from16 v0, v54

    invoke-static {v9, v0}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 4003
    :cond_23
    new-instance v33, Lcom/htc/android/mail/MailMessage;

    const-wide/16 v54, -0x1

    const/4 v9, 0x0

    move-object/from16 v0, v33

    move-wide/from16 v1, v54

    move-object/from16 v3, v38

    invoke-direct {v0, v1, v2, v3, v9}, Lcom/htc/android/mail/MailMessage;-><init>(JLjava/lang/String;Ljava/lang/String;)V

    .line 4004
    .local v33, mailMessage:Lcom/htc/android/mail/MailMessage;
    move-object/from16 v0, p0

    iget-object v9, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v9}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v54

    move-object/from16 v0, v33

    move-wide/from16 v1, v54

    invoke-virtual {v0, v1, v2}, Lcom/htc/android/mail/MailMessage;->setAccountId(J)V

    .line 4005
    move-object/from16 v0, p0

    iget-object v9, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-wide v0, v9, Lcom/htc/android/mail/Mailbox;->id:J

    move-wide/from16 v54, v0

    move-object/from16 v0, v33

    move-wide/from16 v1, v54

    invoke-virtual {v0, v1, v2}, Lcom/htc/android/mail/MailMessage;->setMailboxId(J)V

    .line 4006
    move-object/from16 v0, v33

    move-object/from16 v1, v48

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/MailMessage;->setSubjectCharset(Ljava/lang/String;)V

    .line 4007
    move-object/from16 v0, v34

    move-object/from16 v1, v33

    invoke-interface {v0, v1}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 4009
    invoke-interface/range {v19 .. v19}, Ljava/util/List;->clear()V

    .line 4011
    const/16 v41, 0x0

    .line 4012
    const/16 v52, 0x0

    .line 4013
    const-string v38, ""

    .line 4015
    goto/16 :goto_2

    .line 3964
    .end local v33           #mailMessage:Lcom/htc/android/mail/MailMessage;
    .restart local v13       #b:Landroid/os/Bundle;
    .restart local v32       #mSubjType:Ljava/lang/String;
    .restart local v53       #values:Landroid/content/ContentValues;
    :cond_24
    const/4 v9, 0x0

    goto/16 :goto_3

    .line 3990
    .end local v13           #b:Landroid/os/Bundle;
    .end local v32           #mSubjType:Ljava/lang/String;
    .end local v53           #values:Landroid/content/ContentValues;
    :catch_0
    move-exception v21

    .line 3991
    .local v21, e:Landroid/os/RemoteException;
    :try_start_2
    invoke-virtual/range {v21 .. v21}, Landroid/os/RemoteException;->printStackTrace()V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 3993
    if-eqz v16, :cond_22

    invoke-interface/range {v16 .. v16}, Landroid/database/Cursor;->isClosed()Z

    move-result v9

    if-nez v9, :cond_22

    goto :goto_4

    .end local v21           #e:Landroid/os/RemoteException;
    :catchall_0
    move-exception v9

    if-eqz v16, :cond_25

    invoke-interface/range {v16 .. v16}, Landroid/database/Cursor;->isClosed()Z

    move-result v54

    if-nez v54, :cond_25

    .line 3994
    invoke-interface/range {v16 .. v16}, Landroid/database/Cursor;->close()V

    .line 3993
    :cond_25
    throw v9

    .line 4016
    .end local v6           #to:Ljava/lang/String;
    .end local v7           #subject:Ljava/lang/String;
    .end local v8           #cc:Ljava/lang/String;
    .end local v10           #references:Ljava/lang/String;
    .end local v11           #nPsuedoGroupId:[J
    .end local v16           #c:Landroid/database/Cursor;
    .end local v17           #contentType:Ljava/lang/String;
    .end local v18           #cp:Landroid/content/IContentProvider;
    .end local v20           #date:Ljava/util/Calendar;
    .end local v23           #fromEmail:Ljava/lang/String;
    .end local v24           #group:Ljava/lang/String;
    .end local v25           #headerBreak:I
    .end local v26           #headers:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Ljava/lang/String;>;"
    .end local v28           #importance:I
    .end local v37           #messageid:Ljava/lang/String;
    .end local v42           #replyTo:Ljava/lang/String;
    .end local v48           #subjectCharset:Ljava/lang/String;
    .end local v49           #thisMessageId:J
    :cond_26
    move-object/from16 v0, v19

    move-object/from16 v1, v40

    invoke-interface {v0, v1}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    goto/16 :goto_2

    .line 4020
    .end local v47           #str:Ljava/lang/String;
    :cond_27
    invoke-virtual/range {v39 .. v39}, Ljava/util/ArrayList;->size()I

    move-result v9

    if-lez v9, :cond_0

    .line 4022
    :try_start_3
    move-object/from16 v0, p0

    iget-object v9, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v9}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v9

    const-string v54, "mail"

    move-object/from16 v0, v54

    move-object/from16 v1, v39

    invoke-virtual {v9, v0, v1}, Landroid/content/ContentResolver;->applyBatch(Ljava/lang/String;Ljava/util/ArrayList;)[Landroid/content/ContentProviderResult;

    move-result-object v43

    .line 4024
    .local v43, results:[Landroid/content/ContentProviderResult;
    move-object/from16 v0, v43

    array-length v9, v0

    if-lez v9, :cond_28

    .line 4025
    move-object/from16 v0, p0

    iget-object v9, v0, Lcom/htc/android/mail/server/ImapServer;->mSyncResult:Lcom/htc/android/mail/server/Server$SyncResult;

    iget-wide v0, v9, Lcom/htc/android/mail/server/Server$SyncResult;->firstMessageId:J

    move-wide/from16 v54, v0

    const-wide/16 v56, -0x1

    cmp-long v9, v54, v56

    if-nez v9, :cond_28

    .line 4026
    move-object/from16 v0, p0

    iget-object v9, v0, Lcom/htc/android/mail/server/ImapServer;->mSyncResult:Lcom/htc/android/mail/server/Server$SyncResult;

    const/16 v54, 0x0

    aget-object v54, v43, v54

    move-object/from16 v0, v54

    iget-object v0, v0, Landroid/content/ContentProviderResult;->uri:Landroid/net/Uri;

    move-object/from16 v54, v0

    invoke-static/range {v54 .. v54}, Landroid/content/ContentUris;->parseId(Landroid/net/Uri;)J

    move-result-wide v54

    move-wide/from16 v0, v54

    iput-wide v0, v9, Lcom/htc/android/mail/server/Server$SyncResult;->firstMessageId:J

    .line 4029
    :cond_28
    const/16 v27, 0x0

    :goto_5
    move-object/from16 v0, v43

    array-length v9, v0

    move/from16 v0, v27

    if-ge v0, v9, :cond_0

    .line 4030
    aget-object v9, v43, v27

    iget-object v9, v9, Landroid/content/ContentProviderResult;->uri:Landroid/net/Uri;

    invoke-static {v9}, Landroid/content/ContentUris;->parseId(Landroid/net/Uri;)J

    move-result-wide v35

    .line 4031
    .local v35, messageId:J
    move-object/from16 v0, v34

    move/from16 v1, v27

    invoke-interface {v0, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/htc/android/mail/MailMessage;

    move-wide/from16 v0, v35

    invoke-virtual {v9, v0, v1}, Lcom/htc/android/mail/MailMessage;->setId(J)V
    :try_end_3
    .catch Landroid/os/RemoteException; {:try_start_3 .. :try_end_3} :catch_1
    .catch Landroid/content/OperationApplicationException; {:try_start_3 .. :try_end_3} :catch_2

    .line 4029
    add-int/lit8 v27, v27, 0x1

    goto :goto_5

    .line 4033
    .end local v35           #messageId:J
    .end local v43           #results:[Landroid/content/ContentProviderResult;
    :catch_1
    move-exception v21

    .line 4034
    .restart local v21       #e:Landroid/os/RemoteException;
    const-string v9, "ImapServer"

    const-string v54, "catch exception"

    move-object/from16 v0, v54

    move-object/from16 v1, v21

    invoke-static {v9, v0, v1}, Lcom/htc/android/mail/ll;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V

    goto/16 :goto_0

    .line 4035
    .end local v21           #e:Landroid/os/RemoteException;
    :catch_2
    move-exception v21

    .line 4036
    .local v21, e:Landroid/content/OperationApplicationException;
    const-string v9, "ImapServer"

    const-string v54, "catch exception"

    move-object/from16 v0, v54

    move-object/from16 v1, v21

    invoke-static {v9, v0, v1}, Lcom/htc/android/mail/ll;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V

    goto/16 :goto_0
.end method

.method protected processFetchResponse(Ljava/util/List;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;
    .locals 12
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;)",
            "Lcom/htc/android/mail/server/ImapServer$ImapResponses;"
        }
    .end annotation

    .prologue
    .line 5972
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    new-instance v9, Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    invoke-direct {v9}, Lcom/htc/android/mail/server/ImapServer$ImapResponses;-><init>()V

    .line 5974
    .local v9, responses:Lcom/htc/android/mail/server/ImapServer$ImapResponses;
    new-instance v5, Lcom/htc/android/mail/server/ImapServer$ByteStringListInputStream;

    invoke-direct {v5, p1}, Lcom/htc/android/mail/server/ImapServer$ByteStringListInputStream;-><init>(Ljava/util/List;)V

    .line 5975
    .local v5, in:Lcom/htc/android/mail/server/ImapServer$ByteStringListInputStream;
    new-instance v8, Ljava/io/PushbackInputStream;

    const/4 v11, 0x2

    invoke-direct {v8, v5, v11}, Ljava/io/PushbackInputStream;-><init>(Ljava/io/InputStream;I)V

    .line 5978
    .local v8, pbIn:Ljava/io/PushbackInputStream;
    :goto_0
    :try_start_0
    invoke-direct {p0, v8}, Lcom/htc/android/mail/server/ImapServer;->nextToken(Ljava/io/PushbackInputStream;)Ljava/lang/String;

    move-result-object v2

    .line 5979
    .local v2, firstToken:Ljava/lang/String;
    const-string v11, "*"

    invoke-virtual {v11, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v11

    if-eqz v11, :cond_5

    .line 5980
    invoke-direct {p0, v8}, Lcom/htc/android/mail/server/ImapServer;->nextToken(Ljava/io/PushbackInputStream;)Ljava/lang/String;

    move-result-object v10

    .line 5981
    .local v10, secondToken:Ljava/lang/String;
    const-string v11, "OK"

    invoke-virtual {v11, v10}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v11

    if-eqz v11, :cond_1

    .line 5982
    invoke-direct {p0, v8, v9}, Lcom/htc/android/mail/server/ImapServer;->parseRespTextCode(Ljava/io/PushbackInputStream;Lcom/htc/android/mail/server/ImapServer$ImapResponses;)V

    .line 6001
    :cond_0
    :goto_1
    invoke-direct {p0, v8}, Lcom/htc/android/mail/server/ImapServer;->goToEOL(Ljava/io/PushbackInputStream;)V
    :try_end_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_0

    .line 6008
    .end local v2           #firstToken:Ljava/lang/String;
    .end local v10           #secondToken:Ljava/lang/String;
    :catch_0
    move-exception v1

    .line 6009
    .local v1, e:Ljava/io/IOException;
    invoke-virtual {v1}, Ljava/io/IOException;->printStackTrace()V

    .line 6011
    .end local v1           #e:Ljava/io/IOException;
    :goto_2
    return-object v9

    .line 5983
    .restart local v2       #firstToken:Ljava/lang/String;
    .restart local v10       #secondToken:Ljava/lang/String;
    :cond_1
    :try_start_1
    const-string v11, "CAPABILITY"

    invoke-virtual {v11, v10}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v11

    if-eqz v11, :cond_2

    .line 5984
    invoke-direct {p0, v8}, Lcom/htc/android/mail/server/ImapServer;->getStringUntilEOL(Ljava/io/PushbackInputStream;)Ljava/lang/String;

    move-result-object v0

    .line 5985
    .local v0, capa:Ljava/lang/String;
    invoke-virtual {v9}, Lcom/htc/android/mail/server/ImapServer$ImapResponses;->getImapCapability()Lcom/htc/android/mail/server/ImapServer$ImapCapability;

    move-result-object v3

    .line 5986
    .local v3, imapCapability:Lcom/htc/android/mail/server/ImapServer$ImapCapability;
    invoke-virtual {v3, v0}, Lcom/htc/android/mail/server/ImapServer$ImapCapability;->parse(Ljava/lang/String;)V

    goto :goto_1

    .line 5987
    .end local v0           #capa:Ljava/lang/String;
    .end local v3           #imapCapability:Lcom/htc/android/mail/server/ImapServer$ImapCapability;
    :cond_2
    const-string v11, "VANISHED"

    invoke-virtual {v11, v10}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v11

    if-eqz v11, :cond_3

    .line 5988
    invoke-direct {p0, v8, v9}, Lcom/htc/android/mail/server/ImapServer;->parseExpungedResp(Ljava/io/PushbackInputStream;Lcom/htc/android/mail/server/ImapServer$ImapResponses;)V

    goto :goto_1

    .line 5989
    :cond_3
    invoke-direct {p0, v10}, Lcom/htc/android/mail/server/ImapServer;->isNumber(Ljava/lang/String;)Z

    move-result v11

    if-eqz v11, :cond_0

    .line 5990
    invoke-direct {p0, v8}, Lcom/htc/android/mail/server/ImapServer;->nextToken(Ljava/io/PushbackInputStream;)Ljava/lang/String;

    move-result-object v7

    .line 5991
    .local v7, nextToken:Ljava/lang/String;
    const-string v11, "EXISTS"

    invoke-virtual {v11, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v11

    if-eqz v11, :cond_4

    .line 5992
    invoke-virtual {v9}, Lcom/htc/android/mail/server/ImapServer$ImapResponses;->getImapMailboxInfo()Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;

    move-result-object v4

    .line 5993
    .local v4, imapMailboxInfo:Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;
    invoke-static {v10}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I

    move-result v11

    iput v11, v4, Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;->exists:I

    goto :goto_1

    .line 5994
    .end local v4           #imapMailboxInfo:Lcom/htc/android/mail/server/ImapServer$ImapMailboxInfo;
    :cond_4
    const-string v11, "FETCH"

    invoke-virtual {v11, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v11

    if-eqz v11, :cond_0

    .line 5995
    const/4 v11, 0x0

    invoke-direct {p0, v8, v11}, Lcom/htc/android/mail/server/ImapServer;->processFetchResponse(Ljava/io/PushbackInputStream;Ljava/util/HashMap;)Ljava/util/HashMap;

    move-result-object v6

    .line 5996
    .local v6, map:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Lcom/htc/android/mail/ByteString;>;"
    invoke-virtual {v6}, Ljava/util/HashMap;->size()I

    move-result v11

    if-lez v11, :cond_0

    .line 5997
    invoke-virtual {v9, v6}, Lcom/htc/android/mail/server/ImapServer$ImapResponses;->addFetchResponse(Ljava/util/HashMap;)V

    goto :goto_1

    .line 6003
    .end local v6           #map:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Lcom/htc/android/mail/ByteString;>;"
    .end local v7           #nextToken:Ljava/lang/String;
    .end local v10           #secondToken:Ljava/lang/String;
    :cond_5
    invoke-direct {p0, v8}, Lcom/htc/android/mail/server/ImapServer;->getTagResponse(Ljava/io/PushbackInputStream;)[Ljava/lang/String;

    .line 6004
    invoke-direct {p0, v8}, Lcom/htc/android/mail/server/ImapServer;->goToEOL(Ljava/io/PushbackInputStream;)V
    :try_end_1
    .catch Ljava/io/IOException; {:try_start_1 .. :try_end_1} :catch_0

    goto :goto_2
.end method

.method protected processFetchResponse(Lcom/htc/android/mail/ByteString;Ljava/util/HashMap;)Ljava/util/HashMap;
    .locals 4
    .parameter "byteString"
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/ByteString;",
            "Ljava/util/HashMap",
            "<",
            "Ljava/lang/String;",
            "Lcom/htc/android/mail/ByteString;",
            ">;)",
            "Ljava/util/HashMap",
            "<",
            "Ljava/lang/String;",
            "Lcom/htc/android/mail/ByteString;",
            ">;"
        }
    .end annotation

    .prologue
    .line 5779
    .local p2, map:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Lcom/htc/android/mail/ByteString;>;"
    new-instance v1, Lcom/htc/android/mail/server/ImapServer$ByteStringInputStream;

    invoke-direct {v1, p1}, Lcom/htc/android/mail/server/ImapServer$ByteStringInputStream;-><init>(Lcom/htc/android/mail/ByteString;)V

    .line 5780
    .local v1, in:Lcom/htc/android/mail/server/ImapServer$ByteStringInputStream;
    new-instance v2, Ljava/io/PushbackInputStream;

    const/4 v3, 0x2

    invoke-direct {v2, v1, v3}, Ljava/io/PushbackInputStream;-><init>(Ljava/io/InputStream;I)V

    .line 5782
    .local v2, pbIn:Ljava/io/PushbackInputStream;
    :try_start_0
    invoke-direct {p0, v2, p2}, Lcom/htc/android/mail/server/ImapServer;->processFetchResponse(Ljava/io/PushbackInputStream;Ljava/util/HashMap;)Ljava/util/HashMap;
    :try_end_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0

    move-result-object v3

    .line 5786
    :goto_0
    return-object v3

    .line 5783
    :catch_0
    move-exception v0

    .line 5784
    .local v0, e:Ljava/io/IOException;
    invoke-virtual {v0}, Ljava/io/IOException;->printStackTrace()V

    .line 5786
    const/4 v3, 0x0

    goto :goto_0
.end method

.method protected processLIST(Ljava/util/List;)V
    .locals 8
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;)V"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Lcom/htc/android/mail/exception/MailException;
        }
    .end annotation

    .prologue
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/4 v7, 0x1

    .line 725
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v3

    .line 726
    .local v3, size:I
    if-nez v3, :cond_0

    .line 727
    new-instance v5, Lcom/htc/android/mail/exception/MailException;

    invoke-direct {v5}, Lcom/htc/android/mail/exception/MailException;-><init>()V

    throw v5

    .line 730
    :cond_0
    add-int/lit8 v5, v3, -0x1

    invoke-interface {p1, v5}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/htc/android/mail/ByteString;

    .line 731
    .local v2, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v2}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v5

    const-string v6, " "

    invoke-virtual {v5, v6}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v4

    .line 733
    .local v4, token:[Ljava/lang/String;
    array-length v5, v4

    const/4 v6, 0x2

    if-lt v5, v6, :cond_1

    array-length v5, v4

    if-le v5, v7, :cond_2

    aget-object v5, v4, v7

    sget-object v6, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v6}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v5

    if-eqz v5, :cond_2

    .line 734
    :cond_1
    new-instance v5, Lcom/htc/android/mail/exception/MailException;

    invoke-direct {v5}, Lcom/htc/android/mail/exception/MailException;-><init>()V

    throw v5

    .line 737
    :cond_2
    new-instance v0, Ljava/util/ArrayList;

    invoke-direct {v0}, Ljava/util/ArrayList;-><init>()V

    .line 738
    .local v0, mailboxList:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/htc/android/mail/Mailbox;>;"
    new-instance v1, Ljava/util/ArrayList;

    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V

    .line 740
    .local v1, mailboxparentList:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/htc/android/mail/Mailbox;>;"
    invoke-virtual {p0, p1, v0, v1}, Lcom/htc/android/mail/server/ImapServer;->parseMailbox(Ljava/util/List;Ljava/util/ArrayList;Ljava/util/ArrayList;)V

    .line 742
    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {p0, v5, v1, v0}, Lcom/htc/android/mail/server/ImapServer;->syncMailboxsWithDB(Lcom/htc/android/mail/Account;Ljava/util/ArrayList;Ljava/util/ArrayList;)V

    .line 744
    return-void
.end method

.method protected processSEARCHNOTDELETED(Ljava/util/List;)Ljava/util/List;
    .locals 12
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;)",
            "Ljava/util/List",
            "<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .prologue
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/4 v2, 0x0

    const/4 v11, 0x3

    const/4 v10, 0x2

    const/4 v9, 0x1

    .line 4364
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v4

    .line 4366
    .local v4, size:I
    if-nez v4, :cond_1

    .line 4407
    :cond_0
    :goto_0
    return-object v2

    .line 4370
    :cond_1
    add-int/lit8 v7, v4, -0x1

    invoke-interface {p1, v7}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/htc/android/mail/ByteString;

    .line 4371
    .local v3, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v3}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v7

    const-string v8, " "

    invoke-virtual {v7, v8}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v5

    .line 4373
    .local v5, token:[Ljava/lang/String;
    array-length v7, v5

    if-lt v7, v10, :cond_2

    array-length v7, v5

    if-le v7, v9, :cond_3

    aget-object v7, v5, v9

    sget-object v8, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v8}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v7

    if-eqz v7, :cond_3

    .line 4374
    :cond_2
    const-string v7, ""

    invoke-virtual {p0, v7}, Lcom/htc/android/mail/server/ImapServer;->updateLastUid(Ljava/lang/String;)V

    goto :goto_0

    .line 4378
    :cond_3
    new-instance v2, Ljava/util/ArrayList;

    invoke-direct {v2}, Ljava/util/ArrayList;-><init>()V

    .line 4379
    .local v2, notDeletedMail:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    const/4 v0, 0x0

    .local v0, i:I
    :goto_1
    add-int/lit8 v7, v4, -0x1

    if-ge v0, v7, :cond_7

    .line 4380
    invoke-interface {p1, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v3

    .end local v3           #r:Lcom/htc/android/mail/ByteString;
    check-cast v3, Lcom/htc/android/mail/ByteString;

    .line 4381
    .restart local v3       #r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v3}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object v7

    const-string v8, " "

    invoke-virtual {v7, v8, v11}, Ljava/lang/String;->split(Ljava/lang/String;I)[Ljava/lang/String;

    move-result-object v6

    .line 4382
    .local v6, uids:[Ljava/lang/String;
    array-length v7, v6

    if-ge v7, v11, :cond_5

    .line 4379
    :cond_4
    add-int/lit8 v0, v0, 0x1

    goto :goto_1

    .line 4386
    :cond_5
    const-string v7, "SEARCH"

    aget-object v8, v6, v9

    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_4

    .line 4387
    aget-object v7, v6, v10

    const-string v8, " "

    invoke-virtual {v7, v8}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v5

    .line 4389
    array-length v7, v5

    if-lez v7, :cond_4

    .line 4390
    const/4 v1, 0x0

    .local v1, j:I
    :goto_2
    array-length v7, v5

    if-ge v1, v7, :cond_4

    .line 4391
    aget-object v7, v5, v1

    invoke-interface {v2, v7}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 4392
    if-nez v1, :cond_6

    .line 4390
    :cond_6
    add-int/lit8 v1, v1, 0x1

    goto :goto_2

    .line 4402
    .end local v1           #j:I
    .end local v6           #uids:[Ljava/lang/String;
    :cond_7
    new-instance v7, Lcom/htc/android/mail/server/ImapServer$StringComparator;

    invoke-direct {v7, p0}, Lcom/htc/android/mail/server/ImapServer$StringComparator;-><init>(Lcom/htc/android/mail/server/ImapServer;)V

    invoke-static {v2, v7}, Ljava/util/Collections;->sort(Ljava/util/List;Ljava/util/Comparator;)V

    .line 4403
    invoke-interface {v2}, Ljava/util/List;->size()I

    move-result v7

    if-lez v7, :cond_0

    .line 4404
    const/4 v7, 0x0

    invoke-interface {v2, v7}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Ljava/lang/String;

    iput-object v7, p0, Lcom/htc/android/mail/server/ImapServer;->mLastUid:Ljava/lang/String;

    .line 4405
    iget-object v7, p0, Lcom/htc/android/mail/server/ImapServer;->mLastUid:Ljava/lang/String;

    invoke-virtual {p0, v7}, Lcom/htc/android/mail/server/ImapServer;->updateLastUid(Ljava/lang/String;)V

    goto/16 :goto_0
.end method

.method protected processSearchNotDeletedByDate(Ljava/util/List;)Ljava/util/Map;
    .locals 13
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;)",
            "Ljava/util/Map",
            "<",
            "Ljava/lang/String;",
            "Ljava/lang/Byte;",
            ">;"
        }
    .end annotation

    .prologue
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/4 v3, 0x0

    const/4 v12, 0x3

    const/4 v11, 0x2

    const/4 v10, 0x1

    .line 4321
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v5

    .line 4323
    .local v5, size:I
    if-nez v5, :cond_1

    .line 4360
    :cond_0
    :goto_0
    return-object v3

    .line 4327
    :cond_1
    add-int/lit8 v8, v5, -0x1

    invoke-interface {p1, v8}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/htc/android/mail/ByteString;

    .line 4328
    .local v4, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v4}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v8

    const-string v9, " "

    invoke-virtual {v8, v9}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v6

    .line 4330
    .local v6, token:[Ljava/lang/String;
    array-length v8, v6

    if-lt v8, v11, :cond_2

    array-length v8, v6

    if-le v8, v10, :cond_3

    aget-object v8, v6, v10

    sget-object v9, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v9}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v9

    invoke-virtual {v8, v9}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v8

    if-eqz v8, :cond_3

    .line 4331
    :cond_2
    const-string v8, ""

    invoke-virtual {p0, v8}, Lcom/htc/android/mail/server/ImapServer;->updateLastUid(Ljava/lang/String;)V

    goto :goto_0

    .line 4335
    :cond_3
    new-instance v3, Ljava/util/HashMap;

    invoke-direct {v3}, Ljava/util/HashMap;-><init>()V

    .line 4336
    .local v3, notDeletedMailMap:Ljava/util/Map;,"Ljava/util/Map<Ljava/lang/String;Ljava/lang/Byte;>;"
    new-instance v0, Ljava/lang/Byte;

    invoke-direct {v0, v10}, Ljava/lang/Byte;-><init>(B)V

    .line 4337
    .local v0, b:Ljava/lang/Byte;
    const/4 v1, 0x0

    .local v1, i:I
    :goto_1
    add-int/lit8 v8, v5, -0x1

    if-ge v1, v8, :cond_0

    .line 4338
    invoke-interface {p1, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v4

    .end local v4           #r:Lcom/htc/android/mail/ByteString;
    check-cast v4, Lcom/htc/android/mail/ByteString;

    .line 4339
    .restart local v4       #r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v4}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object v8

    const-string v9, " "

    invoke-virtual {v8, v9, v12}, Ljava/lang/String;->split(Ljava/lang/String;I)[Ljava/lang/String;

    move-result-object v7

    .line 4340
    .local v7, uids:[Ljava/lang/String;
    array-length v8, v7

    if-ge v8, v12, :cond_5

    .line 4337
    :cond_4
    add-int/lit8 v1, v1, 0x1

    goto :goto_1

    .line 4344
    :cond_5
    const-string v8, "SEARCH"

    aget-object v9, v7, v10

    invoke-virtual {v8, v9}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v8

    if-eqz v8, :cond_4

    .line 4345
    aget-object v8, v7, v11

    const-string v9, " "

    invoke-virtual {v8, v9}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v6

    .line 4347
    array-length v8, v6

    if-lez v8, :cond_4

    .line 4348
    const/4 v2, 0x0

    .local v2, j:I
    :goto_2
    array-length v8, v6

    if-ge v2, v8, :cond_4

    .line 4349
    aget-object v8, v6, v2

    invoke-interface {v3, v8, v0}, Ljava/util/Map;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 4348
    add-int/lit8 v2, v2, 0x1

    goto :goto_2
.end method

.method protected processSearchUID(Ljava/util/List;)Ljava/util/List;
    .locals 12
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;)",
            "Ljava/util/List",
            "<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .prologue
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/4 v5, 0x0

    const/4 v11, 0x3

    const/4 v10, 0x2

    const/4 v9, 0x1

    .line 6071
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v3

    .line 6073
    .local v3, size:I
    if-nez v3, :cond_1

    .line 6102
    :cond_0
    return-object v5

    .line 6077
    :cond_1
    add-int/lit8 v7, v3, -0x1

    invoke-interface {p1, v7}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/htc/android/mail/ByteString;

    .line 6078
    .local v2, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v2}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v7

    const-string v8, " "

    invoke-virtual {v7, v8}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v4

    .line 6080
    .local v4, token:[Ljava/lang/String;
    array-length v7, v4

    if-lt v7, v10, :cond_0

    array-length v7, v4

    if-le v7, v9, :cond_2

    aget-object v7, v4, v9

    sget-object v8, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v8}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v7

    if-nez v7, :cond_0

    .line 6084
    :cond_2
    new-instance v5, Ljava/util/ArrayList;

    invoke-direct {v5}, Ljava/util/ArrayList;-><init>()V

    .line 6085
    .local v5, uidList:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    const/4 v0, 0x0

    .local v0, i:I
    :goto_0
    add-int/lit8 v7, v3, -0x1

    if-ge v0, v7, :cond_0

    .line 6086
    invoke-interface {p1, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    .end local v2           #r:Lcom/htc/android/mail/ByteString;
    check-cast v2, Lcom/htc/android/mail/ByteString;

    .line 6087
    .restart local v2       #r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v2}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object v7

    const-string v8, " "

    invoke-virtual {v7, v8, v11}, Ljava/lang/String;->split(Ljava/lang/String;I)[Ljava/lang/String;

    move-result-object v6

    .line 6088
    .local v6, uids:[Ljava/lang/String;
    array-length v7, v6

    if-ge v7, v11, :cond_4

    .line 6085
    :cond_3
    add-int/lit8 v0, v0, 0x1

    goto :goto_0

    .line 6092
    :cond_4
    const-string v7, "SEARCH"

    aget-object v8, v6, v9

    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_3

    .line 6093
    aget-object v7, v6, v10

    const-string v8, " "

    invoke-virtual {v7, v8}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v4

    .line 6095
    array-length v7, v4

    if-lez v7, :cond_3

    .line 6096
    const/4 v1, 0x0

    .local v1, j:I
    :goto_1
    array-length v7, v4

    if-ge v1, v7, :cond_3

    .line 6097
    aget-object v7, v4, v1

    invoke-interface {v5, v7}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 6096
    add-int/lit8 v1, v1, 0x1

    goto :goto_1
.end method

.method protected processUnSeenStatus(Ljava/util/List;)Ljava/util/List;
    .locals 13
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;)",
            "Ljava/util/List",
            "<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .prologue
    .local p1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    const/4 v12, 0x3

    const/4 v11, 0x2

    const/4 v10, 0x1

    .line 1687
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v3

    .line 1688
    .local v3, size:I
    sget-boolean v7, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v7, :cond_0

    const-string v7, "ImapServer"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "size: "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-static {v3}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;

    move-result-object v9

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v7, v8}, Lcom/htc/android/mail/ll;->e(Ljava/lang/String;Ljava/lang/String;)V

    .line 1690
    :cond_0
    new-instance v5, Ljava/util/ArrayList;

    invoke-direct {v5}, Ljava/util/ArrayList;-><init>()V

    .line 1692
    .local v5, uidList:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    if-nez v3, :cond_2

    .line 1720
    :cond_1
    return-object v5

    .line 1696
    :cond_2
    add-int/lit8 v7, v3, -0x1

    invoke-interface {p1, v7}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/htc/android/mail/ByteString;

    .line 1697
    .local v2, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v2}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v7

    const-string v8, " "

    invoke-virtual {v7, v8}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v4

    .line 1699
    .local v4, token:[Ljava/lang/String;
    array-length v7, v4

    if-lt v7, v11, :cond_1

    array-length v7, v4

    if-le v7, v10, :cond_3

    aget-object v7, v4, v10

    sget-object v8, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v8}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-virtual {v7, v8}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v7

    if-nez v7, :cond_1

    .line 1704
    :cond_3
    const/4 v0, 0x0

    .local v0, i:I
    :goto_0
    add-int/lit8 v7, v3, -0x1

    if-ge v0, v7, :cond_1

    .line 1705
    invoke-interface {p1, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    .end local v2           #r:Lcom/htc/android/mail/ByteString;
    check-cast v2, Lcom/htc/android/mail/ByteString;

    .line 1706
    .restart local v2       #r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v2}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-virtual {v7}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object v7

    const-string v8, " "

    invoke-virtual {v7, v8, v12}, Ljava/lang/String;->split(Ljava/lang/String;I)[Ljava/lang/String;

    move-result-object v6

    .line 1707
    .local v6, uids:[Ljava/lang/String;
    array-length v7, v6

    if-lt v7, v12, :cond_1

    .line 1711
    const-string v7, "SEARCH"

    aget-object v8, v6, v10

    invoke-virtual {v7, v8}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_4

    .line 1712
    aget-object v7, v6, v11

    const-string v8, " "

    invoke-virtual {v7, v8}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v4

    .line 1713
    array-length v7, v4

    if-lez v7, :cond_4

    .line 1714
    const/4 v1, 0x0

    .local v1, j:I
    :goto_1
    array-length v7, v4

    if-ge v1, v7, :cond_4

    .line 1715
    aget-object v7, v4, v1

    invoke-interface {v5, v7}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 1714
    add-int/lit8 v1, v1, 0x1

    goto :goto_1

    .line 1704
    .end local v1           #j:I
    :cond_4
    add-int/lit8 v0, v0, 0x1

    goto :goto_0
.end method

.method protected readIdleResponse()Ljava/util/List;
    .locals 5
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .line 455
    new-instance v1, Ljava/util/ArrayList;

    invoke-direct {v1}, Ljava/util/ArrayList;-><init>()V

    .line 459
    .local v1, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    :cond_0
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->readLine()Lcom/htc/android/mail/ByteString;

    move-result-object v0

    .local v0, line:Lcom/htc/android/mail/ByteString;
    if-eqz v0, :cond_2

    .line 460
    invoke-virtual {v0}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v2

    .line 461
    .local v2, str:Ljava/lang/String;
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DIRECTPUSH_DEBUG:Z

    if-eqz v3, :cond_1

    const-string v3, "IMAPIDLE"

    invoke-virtual {v0}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 463
    :cond_1
    const-string v3, "EXISTS"

    invoke-virtual {v2, v3}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v3

    if-eqz v3, :cond_0

    .line 464
    invoke-interface {v1, v0}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 469
    .end local v2           #str:Ljava/lang/String;
    :cond_2
    if-nez v0, :cond_3

    .line 470
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->close()V

    .line 473
    :cond_3
    return-object v1
.end method

.method protected readLine()Lcom/htc/android/mail/ByteString;
    .locals 5
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    const/4 v4, -0x1

    .line 583
    new-instance v1, Ljava/io/ByteArrayOutputStream;

    invoke-direct {v1}, Ljava/io/ByteArrayOutputStream;-><init>()V

    .line 586
    .local v1, out:Ljava/io/ByteArrayOutputStream;
    :goto_0
    iget-object v2, p0, Lcom/htc/android/mail/server/ImapServer;->mIn:Ljava/io/BufferedInputStream;

    invoke-virtual {v2}, Ljava/io/BufferedInputStream;->read()I

    move-result v0

    .local v0, d:I
    if-eq v0, v4, :cond_1

    .line 587
    int-to-char v2, v0

    const/16 v3, 0xd

    if-ne v2, v3, :cond_0

    .line 588
    invoke-virtual {v1, v0}, Ljava/io/ByteArrayOutputStream;->write(I)V

    goto :goto_0

    .line 590
    :cond_0
    int-to-char v2, v0

    const/16 v3, 0xa

    if-ne v2, v3, :cond_2

    .line 591
    invoke-virtual {v1, v0}, Ljava/io/ByteArrayOutputStream;->write(I)V

    .line 597
    :cond_1
    if-ne v0, v4, :cond_3

    .line 598
    const/4 v2, 0x0

    .line 600
    :goto_1
    return-object v2

    .line 594
    :cond_2
    invoke-virtual {v1, v0}, Ljava/io/ByteArrayOutputStream;->write(I)V

    goto :goto_0

    .line 600
    :cond_3
    new-instance v2, Lcom/htc/android/mail/ByteString;

    invoke-virtual {v1}, Ljava/io/ByteArrayOutputStream;->toByteArray()[B

    move-result-object v3

    invoke-direct {v2, v3}, Lcom/htc/android/mail/ByteString;-><init>([B)V

    goto :goto_1
.end method

.method protected readOneLineResponse()Lcom/htc/android/mail/ByteString;
    .locals 3
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .line 442
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->readLine()Lcom/htc/android/mail/ByteString;

    move-result-object v0

    .line 444
    .local v0, line:Lcom/htc/android/mail/ByteString;
    if-nez v0, :cond_1

    .line 445
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->close()V

    .line 446
    sget-boolean v1, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v1, :cond_0

    .line 447
    const-string v1, "ImapServer"

    const-string v2, "null"

    invoke-static {v1, v2}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 451
    :cond_0
    :goto_0
    return-object v0

    .line 449
    :cond_1
    sget-boolean v1, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v1, :cond_0

    const-string v1, "ImapServer"

    invoke-virtual {v0}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v1, v2}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    goto :goto_0
.end method

.method protected readResponse(Ljava/lang/String;)Ljava/util/List;
    .locals 1
    .parameter "tag"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            ")",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .line 477
    const/4 v0, 0x1

    invoke-virtual {p0, p1, v0}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;Z)Ljava/util/List;

    move-result-object v0

    return-object v0
.end method

.method protected readResponse(Ljava/lang/String;Z)Ljava/util/List;
    .locals 5
    .parameter "tag"
    .parameter "saveResponse"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/lang/String;",
            "Z)",
            "Ljava/util/List",
            "<",
            "Lcom/htc/android/mail/ByteString;",
            ">;"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    .line 481
    new-instance v2, Ljava/util/ArrayList;

    invoke-direct {v2}, Ljava/util/ArrayList;-><init>()V

    .line 484
    .local v2, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    new-instance v0, Lcom/htc/android/mail/ByteString;

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, " "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-direct {v0, v3}, Lcom/htc/android/mail/ByteString;-><init>(Ljava/lang/String;)V

    .line 486
    .local v0, btag:Lcom/htc/android/mail/ByteString;
    :cond_0
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->readLine()Lcom/htc/android/mail/ByteString;

    move-result-object v1

    .local v1, line:Lcom/htc/android/mail/ByteString;
    if-eqz v1, :cond_4

    .line 487
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-nez v3, :cond_1

    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v3, :cond_2

    iget-object v3, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v3}, Lcom/htc/android/mail/Account;->getProtocol()I

    move-result v3

    const/4 v4, 0x6

    if-ne v3, v4, :cond_2

    :cond_1
    const-string v3, "ImapServer"

    invoke-virtual {v1}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 488
    :cond_2
    if-eqz p2, :cond_3

    invoke-interface {v2, v1}, Ljava/util/List;->add(Ljava/lang/Object;)Z

    .line 489
    :cond_3
    invoke-virtual {v1, v0}, Lcom/htc/android/mail/ByteString;->startsWith(Lcom/htc/android/mail/ByteString;)Z

    move-result v3

    if-eqz v3, :cond_0

    .line 494
    :cond_4
    if-nez v1, :cond_5

    .line 495
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->close()V

    .line 498
    :cond_5
    return-object v2
.end method

.method public refresh(Lcom/htc/android/mail/Mailbox;)I
    .locals 1
    .parameter "mailbox"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 1405
    const/4 v0, 0x0

    invoke-virtual {p0, p1, v0}, Lcom/htc/android/mail/server/ImapServer;->refresh(Lcom/htc/android/mail/Mailbox;Landroid/os/Bundle;)I

    move-result v0

    return v0
.end method

.method public refresh(Lcom/htc/android/mail/Mailbox;Landroid/os/Bundle;)I
    .locals 27
    .parameter "mailbox"
    .parameter "parameter"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 1410
    new-instance v3, Lcom/htc/android/mail/server/Server$SyncResult;

    invoke-direct {v3}, Lcom/htc/android/mail/server/Server$SyncResult;-><init>()V

    move-object/from16 v0, p0

    iput-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mSyncResult:Lcom/htc/android/mail/server/Server$SyncResult;

    .line 1413
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->fetchMailBoxList()V

    .line 1414
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v3}, Lcom/htc/android/mail/Account;->refresh()V

    .line 1416
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->syncMailToServer()V

    .line 1418
    move-object/from16 v0, p0

    iget v3, v0, Lcom/htc/android/mail/server/Server;->socketState:I

    const/4 v4, 0x1

    if-ne v3, v4, :cond_0

    .line 1419
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->init()V

    .line 1426
    :cond_0
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v3}, Lcom/htc/android/mail/Account;->clearMails()Z

    move-result v3

    if-eqz v3, :cond_3

    .line 1427
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v3, :cond_1

    .line 1428
    const-string v3, "ImapServer"

    const-string v4, "clearMails"

    invoke-static {v3, v4}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 1431
    :cond_1
    :try_start_0
    invoke-virtual/range {p0 .. p1}, Lcom/htc/android/mail/server/ImapServer;->clearPendingFetchMailRequest(Lcom/htc/android/mail/Mailbox;)V

    .line 1434
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "_account = \'%d\' AND _uid is not null"

    const/4 v5, 0x1

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v6, 0x0

    move-object/from16 v0, p0

    iget-object v7, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v7}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v7

    invoke-static {v7, v8}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v5, v6

    invoke-static {v3, v4, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v26

    .line 1435
    .local v26, where:Ljava/lang/String;
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v3

    sget-object v4, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    const/4 v5, 0x0

    move-object/from16 v0, v26

    invoke-interface {v3, v4, v0, v5}, Landroid/content/IContentProvider;->delete(Landroid/net/Uri;Ljava/lang/String;[Ljava/lang/String;)I

    .line 1438
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/Server;->mWeakHandler:Ljava/lang/ref/WeakReference;

    if-eqz v3, :cond_2

    .line 1439
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/Server;->mWeakHandler:Ljava/lang/ref/WeakReference;

    invoke-virtual {v3}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Landroid/os/Handler;

    .line 1440
    .local v13, handler:Landroid/os/Handler;
    if-eqz v13, :cond_2

    .line 1441
    const/16 v3, 0xc

    invoke-virtual {v13, v3}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v3

    invoke-virtual {v3}, Landroid/os/Message;->sendToTarget()V

    .line 1445
    .end local v13           #handler:Landroid/os/Handler;
    :cond_2
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "_id = \'%d\'"

    const/4 v5, 0x1

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v6, 0x0

    move-object/from16 v0, p0

    iget-object v7, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v7}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v7

    invoke-static {v7, v8}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v5, v6

    invoke-static {v3, v4, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v26

    .line 1446
    new-instance v25, Landroid/content/ContentValues;

    invoke-direct/range {v25 .. v25}, Landroid/content/ContentValues;-><init>()V

    .line 1447
    .local v25, values:Landroid/content/ContentValues;
    const-string v3, "_fetchMailType"

    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v0, p0

    iget-object v5, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v4, v5}, Lcom/htc/android/mail/Account;->getFetchMailType(Landroid/content/Context;)I

    move-result v4

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    move-object/from16 v0, v25

    invoke-virtual {v0, v3, v4}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 1448
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v3

    sget-object v4, Lcom/htc/android/mail/MailProvider;->sAccountsURI:Landroid/net/Uri;

    const/4 v5, 0x0

    move-object/from16 v0, v25

    move-object/from16 v1, v26

    invoke-interface {v3, v4, v0, v1, v5}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    .line 1449
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    const/4 v4, 0x0

    invoke-virtual {v3, v4}, Lcom/htc/android/mail/Account;->setClearMails(Z)V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 1455
    .end local v25           #values:Landroid/content/ContentValues;
    .end local v26           #where:Ljava/lang/String;
    :cond_3
    :goto_0
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->syncPendingRequests()V

    .line 1457
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->isFinishSyncPendingRequest()Z

    move-result v3

    if-nez v3, :cond_6

    .line 1458
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v3, :cond_4

    const-string v3, "TAG"

    const-string v4, "PendingRequests is not empty"

    invoke-static {v3, v4}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 1459
    :cond_4
    const/16 v24, 0x0

    .line 1580
    :cond_5
    :goto_1
    return v24

    .line 1450
    :catch_0
    move-exception v12

    .line 1451
    .local v12, e:Landroid/os/RemoteException;
    const-string v3, "ImapServer"

    const-string v4, "catch remote exception"

    invoke-static {v3, v4, v12}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V

    goto :goto_0

    .line 1463
    .end local v12           #e:Landroid/os/RemoteException;
    :cond_6
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->deleteMailMarkedToDelete()V

    .line 1465
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v3}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v3

    move-object/from16 v0, p0

    iget-object v5, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v5}, Lcom/htc/android/mail/Account;->getProtocol()I

    move-result v5

    move-object/from16 v0, p1

    iget-wide v6, v0, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-static {v3, v4, v5, v6, v7}, Lcom/htc/android/mail/MailProvider;->getTotalMailNum(JIJ)I

    move-result v22

    .line 1467
    .local v22, total:I
    invoke-virtual/range {p0 .. p1}, Lcom/htc/android/mail/server/ImapServer;->selectMailbox(Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    .line 1470
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v3, :cond_7

    .line 1471
    const-string v3, "ImapServer"

    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v0, p0

    iget-object v5, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v4, v5}, Lcom/htc/android/mail/Account;->getFetchMailType(Landroid/content/Context;)I

    move-result v4

    invoke-static {v4}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 1472
    :cond_7
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v3, v4}, Lcom/htc/android/mail/Account;->getFetchMailType(Landroid/content/Context;)I

    move-result v3

    if-nez v3, :cond_b

    .line 1473
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v3, :cond_8

    .line 1474
    const-string v3, "ImapServer"

    const-string v4, "fetch Mail by amounts"

    invoke-static {v3, v4}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 1475
    :cond_8
    const/4 v3, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    invoke-virtual {v0, v1, v3}, Lcom/htc/android/mail/server/ImapServer;->searchNotDeletedMail(Lcom/htc/android/mail/Mailbox;Z)Ljava/util/List;

    move-result-object v18

    .line 1476
    .local v18, notDeletedMail:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    move-object/from16 v0, p0

    move-object/from16 v1, v18

    invoke-direct {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->pruneFetchRefreshList(Ljava/util/List;)Ljava/util/List;

    move-result-object v18

    .line 1488
    :cond_9
    :goto_2
    const/16 v24, 0x0

    .line 1489
    .local v24, unReadSize:I
    const/16 v23, 0x0

    .line 1490
    .local v23, totalsize:I
    const/16 v17, 0x0

    .line 1491
    .local v17, newMailSize:I
    invoke-virtual/range {p0 .. p1}, Lcom/htc/android/mail/server/ImapServer;->getFetchNotDoneMessageList(Lcom/htc/android/mail/Mailbox;)Ljava/util/List;

    move-result-object v20

    .line 1492
    .local v20, notFetchDoneMailList:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    if-eqz v20, :cond_a

    .line 1493
    invoke-interface/range {v20 .. v20}, Ljava/util/List;->size()I

    move-result v3

    add-int v23, v23, v3

    .line 1496
    :cond_a
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-static {v3}, Lcom/htc/android/mail/RequestController;->getInstance(Landroid/content/Context;)Lcom/htc/android/mail/RequestController;

    move-result-object v11

    .line 1498
    .local v11, controller:Lcom/htc/android/mail/AbsRequestController;
    if-eqz v18, :cond_12

    invoke-interface/range {v18 .. v18}, Ljava/util/List;->size()I

    move-result v3

    if-lez v3, :cond_12

    .line 1499
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    const-string v4, ""

    move-object/from16 v0, p0

    invoke-virtual {v0, v3, v4}, Lcom/htc/android/mail/server/ImapServer;->updateProgressStatus(Lcom/htc/android/mail/Account;Ljava/lang/String;)V

    .line 1500
    move-object/from16 v0, p0

    iget v3, v0, Lcom/htc/android/mail/server/ImapServer;->mFetchHeaderSize:I

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move-object/from16 v2, v18

    invoke-virtual {v0, v1, v2, v3}, Lcom/htc/android/mail/server/ImapServer;->fetchHeader(Lcom/htc/android/mail/Mailbox;Ljava/util/List;I)Ljava/util/List;

    move-result-object v15

    .line 1503
    .local v15, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->deleteMailMarkedToDelete()V

    .line 1505
    if-nez v15, :cond_d

    .line 1506
    const/16 v24, 0x0

    goto/16 :goto_1

    .line 1478
    .end local v11           #controller:Lcom/htc/android/mail/AbsRequestController;
    .end local v15           #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    .end local v17           #newMailSize:I
    .end local v18           #notDeletedMail:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    .end local v20           #notFetchDoneMailList:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    .end local v23           #totalsize:I
    .end local v24           #unReadSize:I
    :cond_b
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v3, :cond_c

    .line 1479
    const-string v3, "ImapServer"

    const-string v4, "fetch Mail by days"

    invoke-static {v3, v4}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 1480
    :cond_c
    invoke-virtual/range {p0 .. p1}, Lcom/htc/android/mail/server/ImapServer;->searchNotDeletedMailByDate(Lcom/htc/android/mail/Mailbox;)Ljava/util/Map;

    move-result-object v19

    .line 1481
    .local v19, notDeletedMailMap:Ljava/util/Map;,"Ljava/util/Map<Ljava/lang/String;Ljava/lang/Byte;>;"
    move-object/from16 v0, p0

    move-object/from16 v1, v19

    invoke-direct {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->pruneFetchRefreshListByDate(Ljava/util/Map;)Ljava/util/List;

    move-result-object v18

    .line 1482
    .restart local v18       #notDeletedMail:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    if-eqz v19, :cond_9

    .line 1483
    invoke-interface/range {v19 .. v19}, Ljava/util/Map;->clear()V

    goto :goto_2

    .line 1511
    .end local v19           #notDeletedMailMap:Ljava/util/Map;,"Ljava/util/Map<Ljava/lang/String;Ljava/lang/Byte;>;"
    .restart local v11       #controller:Lcom/htc/android/mail/AbsRequestController;
    .restart local v15       #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    .restart local v17       #newMailSize:I
    .restart local v20       #notFetchDoneMailList:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    .restart local v23       #totalsize:I
    .restart local v24       #unReadSize:I
    :cond_d
    if-eqz v15, :cond_f

    invoke-interface {v15}, Ljava/util/List;->size()I

    move-result v3

    if-lez v3, :cond_f

    .line 1512
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/Server;->mWeakHandler:Ljava/lang/ref/WeakReference;

    if-eqz v3, :cond_e

    .line 1513
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/Server;->mWeakHandler:Ljava/lang/ref/WeakReference;

    invoke-virtual {v3}, Ljava/lang/ref/WeakReference;->get()Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Landroid/os/Handler;

    .line 1514
    .restart local v13       #handler:Landroid/os/Handler;
    if-eqz v13, :cond_e

    .line 1515
    const/16 v3, 0xc

    invoke-virtual {v13, v3}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v3

    invoke-virtual {v3}, Landroid/os/Message;->sendToTarget()V

    .line 1518
    .end local v13           #handler:Landroid/os/Handler;
    :cond_e
    new-instance v3, Lcom/htc/android/mail/ulog/MULogMgr;

    invoke-direct {v3}, Lcom/htc/android/mail/ulog/MULogMgr;-><init>()V

    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    move-object/from16 v0, p0

    iget-object v5, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v5}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v5

    invoke-interface {v15}, Ljava/util/List;->size()I

    move-result v7

    int-to-long v7, v7

    const-wide/16 v9, 0x0

    invoke-virtual/range {v3 .. v10}, Lcom/htc/android/mail/ulog/MULogMgr;->updateMailCountRecord(Landroid/content/Context;JJJ)V

    .line 1521
    :cond_f
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mSyncResult:Lcom/htc/android/mail/server/Server$SyncResult;

    iget v0, v3, Lcom/htc/android/mail/server/Server$SyncResult;->unreadNum:I

    move/from16 v24, v0

    .line 1522
    if-lez v22, :cond_10

    .line 1523
    invoke-virtual/range {p0 .. p1}, Lcom/htc/android/mail/server/ImapServer;->updateUnSeenStatus(Lcom/htc/android/mail/Mailbox;)V

    .line 1528
    :cond_10
    const/4 v14, -0x1

    .line 1529
    .local v14, i:I
    if-eqz v15, :cond_13

    .line 1530
    invoke-interface {v15}, Ljava/util/List;->size()I

    move-result v17

    .line 1531
    add-int v23, v23, v17

    .line 1532
    add-int/lit8 v14, v17, -0x1

    :goto_3
    if-ltz v14, :cond_13

    .line 1533
    invoke-interface {v15, v14}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v16

    check-cast v16, Lcom/htc/android/mail/MailMessage;

    .line 1534
    .local v16, mailMessage:Lcom/htc/android/mail/MailMessage;
    move-object/from16 v0, v16

    iget-wide v3, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v11, v3, v4}, Lcom/htc/android/mail/RequestController;->isNeedToFetch(J)Z

    move-result v3

    if-nez v3, :cond_11

    .line 1532
    :goto_4
    add-int/lit8 v14, v14, -0x1

    goto :goto_3

    .line 1537
    :cond_11
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    sub-int v4, v17, v14

    const-string v5, ""

    move-object/from16 v0, p0

    move/from16 v1, v23

    invoke-virtual {v0, v4, v1, v5}, Lcom/htc/android/mail/server/ImapServer;->getDownloadingStatus(IILjava/lang/String;)Ljava/lang/String;

    move-result-object v4

    move-object/from16 v0, p0

    invoke-virtual {v0, v3, v4}, Lcom/htc/android/mail/server/ImapServer;->updateProgressStatus(Lcom/htc/android/mail/Account;Ljava/lang/String;)V

    .line 1539
    const/4 v3, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move-object/from16 v2, v16

    invoke-virtual {v0, v1, v2, v3, v11}, Lcom/htc/android/mail/server/ImapServer;->fetchInfo(Lcom/htc/android/mail/Mailbox;Lcom/htc/android/mail/MailMessage;ILcom/htc/android/mail/AbsRequestController;)V

    goto :goto_4

    .line 1544
    .end local v14           #i:I
    .end local v15           #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/MailMessage;>;"
    .end local v16           #mailMessage:Lcom/htc/android/mail/MailMessage;
    :cond_12
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->deleteMailMarkedToDelete()V

    .line 1546
    invoke-virtual/range {p0 .. p1}, Lcom/htc/android/mail/server/ImapServer;->updateUnSeenStatus(Lcom/htc/android/mail/Mailbox;)V

    .line 1549
    :cond_13
    if-eqz v20, :cond_16

    invoke-interface/range {v20 .. v20}, Ljava/util/List;->size()I

    move-result v3

    if-lez v3, :cond_16

    .line 1550
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v3, :cond_14

    .line 1551
    const-string v3, "ImapServer"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "list size: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-interface/range {v20 .. v20}, Ljava/util/List;->size()I

    move-result v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 1554
    :cond_14
    invoke-interface/range {v20 .. v20}, Ljava/util/List;->size()I

    move-result v21

    .line 1555
    .local v21, size:I
    const/4 v14, 0x0

    .restart local v14       #i:I
    :goto_5
    move/from16 v0, v21

    if-ge v14, v0, :cond_16

    .line 1556
    move-object/from16 v0, v20

    invoke-interface {v0, v14}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v16

    check-cast v16, Lcom/htc/android/mail/MailMessage;

    .line 1557
    .restart local v16       #mailMessage:Lcom/htc/android/mail/MailMessage;
    move-object/from16 v0, v16

    iget-wide v3, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-virtual {v11, v3, v4}, Lcom/htc/android/mail/RequestController;->isNeedToFetch(J)Z

    move-result v3

    if-nez v3, :cond_15

    .line 1555
    :goto_6
    add-int/lit8 v14, v14, 0x1

    goto :goto_5

    .line 1560
    :cond_15
    move-object/from16 v0, p0

    iget-object v3, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    add-int v4, v17, v14

    add-int/lit8 v4, v4, 0x1

    const-string v5, ""

    move-object/from16 v0, p0

    move/from16 v1, v23

    invoke-virtual {v0, v4, v1, v5}, Lcom/htc/android/mail/server/ImapServer;->getDownloadingStatus(IILjava/lang/String;)Ljava/lang/String;

    move-result-object v4

    move-object/from16 v0, p0

    invoke-virtual {v0, v3, v4}, Lcom/htc/android/mail/server/ImapServer;->updateProgressStatus(Lcom/htc/android/mail/Account;Ljava/lang/String;)V

    .line 1562
    const/4 v3, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move-object/from16 v2, v16

    invoke-virtual {v0, v1, v2, v3, v11}, Lcom/htc/android/mail/server/ImapServer;->fetchInfo(Lcom/htc/android/mail/Mailbox;Lcom/htc/android/mail/MailMessage;ILcom/htc/android/mail/AbsRequestController;)V

    goto :goto_6

    .line 1567
    .end local v14           #i:I
    .end local v16           #mailMessage:Lcom/htc/android/mail/MailMessage;
    .end local v21           #size:I
    :cond_16
    :try_start_1
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "_account = \'%d\' AND _mailboxId = \'%d\' AND _sync = \'0\' AND _local = \'0\'"

    const/4 v5, 0x2

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v6, 0x0

    move-object/from16 v0, p0

    iget-object v7, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v7}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v7

    invoke-static {v7, v8}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v5, v6

    const/4 v6, 0x1

    move-object/from16 v0, p0

    iget-object v7, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-wide v7, v7, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-static {v7, v8}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v5, v6

    invoke-static {v3, v4, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v26

    .line 1568
    .restart local v26       #where:Ljava/lang/String;
    new-instance v25, Landroid/content/ContentValues;

    invoke-direct/range {v25 .. v25}, Landroid/content/ContentValues;-><init>()V

    .line 1569
    .restart local v25       #values:Landroid/content/ContentValues;
    const-string v3, "_sync"

    const/4 v4, 0x1

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    move-object/from16 v0, v25

    invoke-virtual {v0, v3, v4}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 1570
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v3

    sget-object v4, Lcom/htc/android/mail/MailProvider;->sNoNotifyMessagesURI:Landroid/net/Uri;

    const/4 v5, 0x0

    move-object/from16 v0, v25

    move-object/from16 v1, v26

    invoke-interface {v3, v4, v0, v1, v5}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I
    :try_end_1
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_1

    .line 1575
    .end local v25           #values:Landroid/content/ContentValues;
    .end local v26           #where:Ljava/lang/String;
    :goto_7
    if-eqz v18, :cond_17

    invoke-interface/range {v18 .. v18}, Ljava/util/List;->size()I

    move-result v3

    if-lez v3, :cond_17

    .line 1577
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v3, :cond_5

    const-string v3, "ImapServer"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "unReadSize: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    move/from16 v0, v24

    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    goto/16 :goto_1

    .line 1571
    :catch_1
    move-exception v12

    .line 1572
    .restart local v12       #e:Landroid/os/RemoteException;
    const-string v3, "ImapServer"

    const-string v4, "update message fail"

    invoke-static {v3, v4, v12}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_7

    .line 1580
    .end local v12           #e:Landroid/os/RemoteException;
    :cond_17
    const/16 v24, 0x0

    goto/16 :goto_1
.end method

.method protected searchNotDeletedMail(Lcom/htc/android/mail/Mailbox;Z)Ljava/util/List;
    .locals 7
    .parameter "mailbox"
    .parameter "fetchAll"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/Mailbox;",
            "Z)",
            "Ljava/util/List",
            "<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 4136
    iget-object v3, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    if-eqz v3, :cond_0

    iget-object v3, p1, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    iget-object v4, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-object v4, v4, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    invoke-virtual {v3, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_1

    .line 4137
    :cond_0
    invoke-virtual {p0, p1}, Lcom/htc/android/mail/server/ImapServer;->selectMailbox(Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    .line 4141
    :cond_1
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v2

    .line 4142
    .local v2, tag:Ljava/lang/String;
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "%s UID SEARCH UID 1:* NOT DELETED"

    const/4 v5, 0x1

    new-array v5, v5, [Ljava/lang/Object;

    const/4 v6, 0x0

    aput-object v2, v5, v6

    invoke-static {v3, v4, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p0, v3}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 4143
    invoke-virtual {p0, v2}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v0

    .line 4147
    .local v0, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->processSEARCHNOTDELETED(Ljava/util/List;)Ljava/util/List;

    move-result-object v1

    .line 4148
    .local v1, notDeletedMail:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    return-object v1
.end method

.method protected searchNotDeletedMailByDate(Lcom/htc/android/mail/Mailbox;)Ljava/util/Map;
    .locals 17
    .parameter "mailbox"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/Mailbox;",
            ")",
            "Ljava/util/Map",
            "<",
            "Ljava/lang/String;",
            "Ljava/lang/Byte;",
            ">;"
        }
    .end annotation

    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 4153
    move-object/from16 v0, p0

    iget-object v11, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    if-eqz v11, :cond_0

    move-object/from16 v0, p1

    iget-object v11, v0, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    move-object/from16 v0, p0

    iget-object v12, v0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-object v12, v12, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    invoke-virtual {v11, v12}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v11

    if-nez v11, :cond_1

    .line 4154
    :cond_0
    invoke-virtual/range {p0 .. p1}, Lcom/htc/android/mail/server/ImapServer;->selectMailbox(Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    .line 4160
    :cond_1
    invoke-static {}, Ljava/util/Calendar;->getInstance()Ljava/util/Calendar;

    move-result-object v1

    .line 4161
    .local v1, cal:Ljava/util/Calendar;
    sget-boolean v11, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v11, :cond_2

    .line 4162
    const-string v11, "ImapServer"

    new-instance v12, Ljava/lang/StringBuilder;

    invoke-direct {v12}, Ljava/lang/StringBuilder;-><init>()V

    const-string v13, "days: "

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v12

    move-object/from16 v0, p0

    iget-object v13, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v0, p0

    iget-object v14, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v13, v14}, Lcom/htc/android/mail/Account;->getFetchMailDays(Landroid/content/Context;)I

    move-result v13

    invoke-static {v13}, Ljava/lang/String;->valueOf(I)Ljava/lang/String;

    move-result-object v13

    invoke-virtual {v12, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v12

    invoke-virtual {v12}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v12

    invoke-static {v11, v12}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 4165
    :cond_2
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v9

    .line 4167
    .local v9, tag:Ljava/lang/String;
    const/4 v11, 0x0

    move-object/from16 v0, p0

    iput-boolean v11, v0, Lcom/htc/android/mail/server/ImapServer;->mIsNotSupportSearch:Z

    .line 4168
    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v11

    const-wide/32 v13, 0x15180

    move-object/from16 v0, p0

    iget-object v15, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    move-object/from16 v16, v0

    invoke-virtual/range {v15 .. v16}, Lcom/htc/android/mail/Account;->getFetchMailDays(Landroid/content/Context;)I

    move-result v15

    int-to-long v15, v15

    mul-long/2addr v13, v15

    const-wide/16 v15, 0x3e8

    mul-long/2addr v13, v15

    sub-long/2addr v11, v13

    move-object/from16 v0, p0

    iput-wide v11, v0, Lcom/htc/android/mail/server/ImapServer;->mBeginningTimeMillis:J

    .line 4170
    move-object/from16 v0, p0

    iget-object v11, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v0, p0

    iget-object v12, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v11, v12}, Lcom/htc/android/mail/Account;->getFetchMailDays(Landroid/content/Context;)I

    move-result v11

    const/4 v12, -0x1

    if-eq v11, v12, :cond_5

    .line 4171
    move-object/from16 v0, p0

    iget-wide v11, v0, Lcom/htc/android/mail/server/ImapServer;->mBeginningTimeMillis:J

    invoke-virtual {v1, v11, v12}, Ljava/util/Calendar;->setTimeInMillis(J)V

    .line 4172
    invoke-virtual {v1}, Ljava/util/Calendar;->getTime()Ljava/util/Date;

    move-result-object v7

    .line 4174
    .local v7, sinceDate:Ljava/util/Date;
    new-instance v6, Ljava/text/SimpleDateFormat;

    const-string v11, "d-MMM-yyyy"

    sget-object v12, Ljava/util/Locale;->ENGLISH:Ljava/util/Locale;

    invoke-direct {v6, v11, v12}, Ljava/text/SimpleDateFormat;-><init>(Ljava/lang/String;Ljava/util/Locale;)V

    .line 4175
    .local v6, sdf:Ljava/text/SimpleDateFormat;
    invoke-virtual {v6, v7}, Ljava/text/SimpleDateFormat;->format(Ljava/util/Date;)Ljava/lang/String;

    move-result-object v8

    .line 4176
    .local v8, sinceDateStr:Ljava/lang/String;
    sget-object v11, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v12, "%s UID SEARCH SINCE %s NOT DELETED"

    const/4 v13, 0x2

    new-array v13, v13, [Ljava/lang/Object;

    const/4 v14, 0x0

    aput-object v9, v13, v14

    const/4 v14, 0x1

    aput-object v8, v13, v14

    invoke-static {v11, v12, v13}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v11

    move-object/from16 v0, p0

    invoke-virtual {v0, v11}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 4181
    .end local v6           #sdf:Ljava/text/SimpleDateFormat;
    .end local v7           #sinceDate:Ljava/util/Date;
    .end local v8           #sinceDateStr:Ljava/lang/String;
    :goto_0
    move-object/from16 v0, p0

    invoke-virtual {v0, v9}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v2

    .line 4184
    .local v2, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    if-nez v2, :cond_6

    .line 4185
    const/4 v11, 0x1

    move-object/from16 v0, p0

    iput-boolean v11, v0, Lcom/htc/android/mail/server/ImapServer;->mIsNotSupportSearch:Z

    .line 4199
    :cond_3
    :goto_1
    move-object/from16 v0, p0

    iget-boolean v11, v0, Lcom/htc/android/mail/server/ImapServer;->mIsNotSupportSearch:Z

    if-eqz v11, :cond_4

    .line 4200
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v9

    .line 4203
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->getMinInternalDate()J

    move-result-wide v11

    move-object/from16 v0, p0

    iget-wide v13, v0, Lcom/htc/android/mail/server/ImapServer;->mBeginningTimeMillis:J

    cmp-long v11, v11, v13

    if-lez v11, :cond_9

    .line 4204
    sget-object v11, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v12, "%s UID SEARCH 1:* NOT DELETED"

    const/4 v13, 0x1

    new-array v13, v13, [Ljava/lang/Object;

    const/4 v14, 0x0

    aput-object v9, v13, v14

    invoke-static {v11, v12, v13}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v11

    move-object/from16 v0, p0

    invoke-virtual {v0, v11}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 4209
    :goto_2
    move-object/from16 v0, p0

    invoke-virtual {v0, v9}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v2

    .line 4214
    :cond_4
    move-object/from16 v0, p0

    invoke-virtual {v0, v2}, Lcom/htc/android/mail/server/ImapServer;->processSearchNotDeletedByDate(Ljava/util/List;)Ljava/util/Map;

    move-result-object v4

    .line 4215
    .local v4, notDeletedMailMap:Ljava/util/Map;,"Ljava/util/Map<Ljava/lang/String;Ljava/lang/Byte;>;"
    return-object v4

    .line 4178
    .end local v2           #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    .end local v4           #notDeletedMailMap:Ljava/util/Map;,"Ljava/util/Map<Ljava/lang/String;Ljava/lang/Byte;>;"
    :cond_5
    sget-object v11, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v12, "%s UID SEARCH 1:* NOT DELETED"

    const/4 v13, 0x1

    new-array v13, v13, [Ljava/lang/Object;

    const/4 v14, 0x0

    aput-object v9, v13, v14

    invoke-static {v11, v12, v13}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v11

    move-object/from16 v0, p0

    invoke-virtual {v0, v11}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    goto :goto_0

    .line 4187
    .restart local v2       #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    :cond_6
    invoke-interface {v2}, Ljava/util/List;->size()I

    move-result v11

    if-nez v11, :cond_7

    .line 4188
    const/4 v11, 0x1

    move-object/from16 v0, p0

    iput-boolean v11, v0, Lcom/htc/android/mail/server/ImapServer;->mIsNotSupportSearch:Z

    goto :goto_1

    .line 4190
    :cond_7
    invoke-interface {v2}, Ljava/util/List;->size()I

    move-result v11

    add-int/lit8 v11, v11, -0x1

    invoke-interface {v2, v11}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/htc/android/mail/ByteString;

    .line 4191
    .local v5, r:Lcom/htc/android/mail/ByteString;
    invoke-virtual {v5}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v11

    const-string v12, " "

    invoke-virtual {v11, v12}, Ljava/lang/String;->split(Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v10

    .line 4193
    .local v10, token:[Ljava/lang/String;
    array-length v11, v10

    const/4 v12, 0x2

    if-lt v11, v12, :cond_8

    array-length v11, v10

    const/4 v12, 0x1

    if-le v11, v12, :cond_3

    const/4 v11, 0x1

    aget-object v11, v10, v11

    sget-object v12, Lcom/htc/android/mail/server/ImapServer;->STR_OK:Lcom/htc/android/mail/ByteString;

    invoke-virtual {v12}, Lcom/htc/android/mail/ByteString;->toString()Ljava/lang/String;

    move-result-object v12

    invoke-virtual {v11, v12}, Ljava/lang/String;->compareTo(Ljava/lang/String;)I

    move-result v11

    if-eqz v11, :cond_3

    .line 4194
    :cond_8
    const/4 v11, 0x1

    move-object/from16 v0, p0

    iput-boolean v11, v0, Lcom/htc/android/mail/server/ImapServer;->mIsNotSupportSearch:Z

    goto/16 :goto_1

    .line 4206
    .end local v5           #r:Lcom/htc/android/mail/ByteString;
    .end local v10           #token:[Ljava/lang/String;
    :cond_9
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->getMinUid()Ljava/lang/String;

    move-result-object v3

    .line 4207
    .local v3, minUid:Ljava/lang/String;
    sget-object v11, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v12, "%s UID SEARCH %s:* NOT DELETED"

    const/4 v13, 0x2

    new-array v13, v13, [Ljava/lang/Object;

    const/4 v14, 0x0

    aput-object v9, v13, v14

    const/4 v14, 0x1

    aput-object v3, v13, v14

    invoke-static {v11, v12, v13}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v11

    move-object/from16 v0, p0

    invoke-virtual {v0, v11}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    goto :goto_2
.end method

.method protected selectMailbox(Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;
    .locals 7
    .parameter "mailbox"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 907
    if-eqz p1, :cond_0

    iget-boolean v2, p1, Lcom/htc/android/mail/Mailbox;->isServerFolder:Z

    if-eqz v2, :cond_0

    .line 908
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v1

    .line 909
    .local v1, tag:Ljava/lang/String;
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v3, "%s SELECT \"%s\""

    const/4 v4, 0x2

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v5, 0x0

    aput-object v1, v4, v5

    const/4 v5, 0x1

    iget-object v6, p1, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    aput-object v6, v4, v5

    invoke-static {v2, v3, v4}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v2

    invoke-virtual {p0, v2}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 912
    invoke-virtual {p0, v1}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v0

    .line 914
    .local v0, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    invoke-direct {p0, v0, p1}, Lcom/htc/android/mail/server/ImapServer;->processSELECT(Ljava/util/List;Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    .line 916
    .end local v0           #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    .end local v1           #tag:Ljava/lang/String;
    :cond_0
    iput-object p1, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    .line 917
    const/4 v2, 0x0

    return-object v2
.end method

.method protected selectMailboxForQrsync(Lcom/htc/android/mail/Mailbox;J)Lcom/htc/android/mail/server/ImapServer$ImapResponses;
    .locals 10
    .parameter "mailbox"
    .parameter "minUid"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    const/4 v9, 0x2

    const/4 v8, 0x1

    const/4 v7, 0x0

    .line 921
    const/4 v1, 0x0

    .line 922
    .local v1, responses:Lcom/htc/android/mail/server/ImapServer$ImapResponses;
    if-eqz p1, :cond_0

    iget-boolean v3, p1, Lcom/htc/android/mail/Mailbox;->isServerFolder:Z

    if-eqz v3, :cond_0

    .line 923
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v2

    .line 924
    .local v2, tag:Ljava/lang/String;
    invoke-virtual {p1}, Lcom/htc/android/mail/Mailbox;->getHighestModSeq()J

    move-result-wide v3

    const-wide/16 v5, 0x0

    cmp-long v3, v3, v5

    if-eqz v3, :cond_1

    .line 925
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "%s SELECT \"%s\" (QRESYNC (%s %d %d:*))"

    const/4 v5, 0x5

    new-array v5, v5, [Ljava/lang/Object;

    aput-object v2, v5, v7

    iget-object v6, p1, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    aput-object v6, v5, v8

    invoke-virtual {p1}, Lcom/htc/android/mail/Mailbox;->getUidValidity()Ljava/lang/String;

    move-result-object v6

    aput-object v6, v5, v9

    const/4 v6, 0x3

    invoke-virtual {p1}, Lcom/htc/android/mail/Mailbox;->getHighestModSeq()J

    move-result-wide v7

    invoke-static {v7, v8}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v5, v6

    const/4 v6, 0x4

    invoke-static {p2, p3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v5, v6

    invoke-static {v3, v4, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p0, v3}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 931
    :goto_0
    invoke-virtual {p0, v2}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v0

    .line 933
    .local v0, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    invoke-direct {p0, v0, p1}, Lcom/htc/android/mail/server/ImapServer;->processSELECT(Ljava/util/List;Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    move-result-object v1

    .line 935
    .end local v0           #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    .end local v2           #tag:Ljava/lang/String;
    :cond_0
    iput-object p1, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    .line 936
    return-object v1

    .line 928
    .restart local v2       #tag:Ljava/lang/String;
    :cond_1
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "%s SELECT \"%s\""

    new-array v5, v9, [Ljava/lang/Object;

    aput-object v2, v5, v7

    iget-object v6, p1, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    aput-object v6, v5, v8

    invoke-static {v3, v4, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    invoke-virtual {p0, v3}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    goto :goto_0
.end method

.method protected separateSubject(Ljava/lang/String;)Landroid/os/Bundle;
    .locals 4
    .parameter "subject"

    .prologue
    .line 5613
    const-string v1, ""

    .line 5615
    .local v1, mSubjType:Ljava/lang/String;
    invoke-static {p1}, Lcom/htc/android/mail/BaseStone;->TrimReFwd(Ljava/lang/String;)I

    move-result v2

    .line 5616
    .local v2, nTrim:I
    if-eqz p1, :cond_0

    const/4 v3, -0x1

    if-eq v2, v3, :cond_0

    .line 5617
    const/4 v3, 0x0

    invoke-virtual {p1, v3, v2}, Ljava/lang/String;->substring(II)Ljava/lang/String;

    move-result-object v1

    .line 5618
    invoke-virtual {p1}, Ljava/lang/String;->length()I

    move-result v3

    invoke-virtual {p1, v2, v3}, Ljava/lang/String;->substring(II)Ljava/lang/String;

    move-result-object p1

    .line 5620
    :cond_0
    new-instance v0, Landroid/os/Bundle;

    invoke-direct {v0}, Landroid/os/Bundle;-><init>()V

    .line 5621
    .local v0, b:Landroid/os/Bundle;
    const-string v3, "subject"

    invoke-virtual {v0, v3, p1}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 5622
    const-string v3, "prefix"

    invoke-virtual {v0, v3, v1}, Landroid/os/Bundle;->putString(Ljava/lang/String;Ljava/lang/String;)V

    .line 5623
    return-object v0
.end method

.method public setAccount(Lcom/htc/android/mail/Account;)V
    .locals 0
    .parameter "account"

    .prologue
    .line 5521
    iput-object p1, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    .line 5522
    return-void
.end method

.method public setContext(Landroid/content/Context;)V
    .locals 0
    .parameter "context"

    .prologue
    .line 5516
    iput-object p1, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    .line 5517
    return-void
.end method

.method protected setMailRemoteStatus(Lcom/htc/android/mail/server/Server$PendingRequestList;)V
    .locals 17
    .parameter "pendingRequestList"

    .prologue
    .line 1286
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->size()I

    move-result v10

    .line 1287
    .local v10, size:I
    if-lez v10, :cond_0

    .line 1288
    const/4 v13, 0x0

    move-object/from16 v0, p1

    invoke-virtual {v0, v13}, Lcom/htc/android/mail/server/Server$PendingRequestList;->get(I)Lcom/htc/android/mail/server/Server$PendingRequest;

    move-result-object v9

    .line 1289
    .local v9, request:Lcom/htc/android/mail/server/Server$PendingRequest;
    iget v13, v9, Lcom/htc/android/mail/server/Server$PendingRequest;->requestId:I

    const/4 v14, 0x4

    if-ne v13, v14, :cond_1

    const/4 v5, 0x1

    .line 1290
    .local v5, isRead:Z
    :goto_0
    move-object/from16 v0, p0

    iget-object v13, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-static {v13}, Lcom/htc/android/mail/AccountPool;->getInstance(Landroid/content/Context;)Lcom/htc/android/mail/AccountPool;

    move-result-object v2

    .line 1291
    .local v2, accountPool:Lcom/htc/android/mail/AccountPool;
    move-object/from16 v0, p0

    iget-object v13, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    iget-wide v14, v9, Lcom/htc/android/mail/server/Server$PendingRequest;->accountId:J

    invoke-virtual {v2, v13, v14, v15}, Lcom/htc/android/mail/AccountPool;->getAccount(Landroid/content/Context;J)Lcom/htc/android/mail/Account;

    move-result-object v1

    .line 1292
    .local v1, account:Lcom/htc/android/mail/Account;
    if-nez v1, :cond_2

    .line 1293
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->delete()I

    .line 1349
    .end local v1           #account:Lcom/htc/android/mail/Account;
    .end local v2           #accountPool:Lcom/htc/android/mail/AccountPool;
    .end local v5           #isRead:Z
    .end local v9           #request:Lcom/htc/android/mail/server/Server$PendingRequest;
    :cond_0
    :goto_1
    return-void

    .line 1289
    .restart local v9       #request:Lcom/htc/android/mail/server/Server$PendingRequest;
    :cond_1
    const/4 v5, 0x0

    goto :goto_0

    .line 1296
    .restart local v1       #account:Lcom/htc/android/mail/Account;
    .restart local v2       #accountPool:Lcom/htc/android/mail/AccountPool;
    .restart local v5       #isRead:Z
    :cond_2
    invoke-virtual {v1}, Lcom/htc/android/mail/Account;->getMailboxs()Lcom/htc/android/mail/Mailboxs;

    move-result-object v13

    iget-wide v14, v9, Lcom/htc/android/mail/server/Server$PendingRequest;->fromMailboxId:J

    invoke-virtual {v13, v14, v15}, Lcom/htc/android/mail/Mailboxs;->getMailboxById(J)Lcom/htc/android/mail/Mailbox;

    move-result-object v6

    .line 1297
    .local v6, mailbox:Lcom/htc/android/mail/Mailbox;
    if-nez v6, :cond_3

    .line 1298
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->delete()I

    goto :goto_1

    .line 1305
    :cond_3
    iget-boolean v13, v6, Lcom/htc/android/mail/Mailbox;->isServerFolder:Z

    if-nez v13, :cond_5

    .line 1306
    sget-boolean v13, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v13, :cond_4

    const-string v13, "ImapServer"

    const-string v14, "fromMailbox are not server folder"

    invoke-static {v13, v14}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    .line 1307
    :cond_4
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->delete()I

    goto :goto_1

    .line 1312
    :cond_5
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->getUidSeq()Ljava/lang/String;

    move-result-object v12

    .line 1313
    .local v12, uidSeq:Ljava/lang/String;
    const-string v13, ""

    invoke-virtual {v13, v12}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v13

    if-eqz v13, :cond_6

    .line 1314
    sget-boolean v13, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v13, :cond_0

    const-string v13, "ImapServer"

    const-string v14, "uidSeq is empty"

    invoke-static {v13, v14}, Lcom/htc/android/mail/ll;->i(Ljava/lang/String;Ljava/lang/String;)V

    goto :goto_1

    .line 1318
    :cond_6
    if-eqz v5, :cond_8

    const-string v8, "+FLAGS.SILENT"

    .line 1321
    .local v8, param:Ljava/lang/String;
    :goto_2
    :try_start_0
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->probe()V

    .line 1322
    move-object/from16 v0, p0

    iget v13, v0, Lcom/htc/android/mail/server/Server;->socketState:I

    const/4 v14, 0x1

    if-ne v13, v14, :cond_7

    .line 1323
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->init()V

    .line 1326
    :cond_7
    move-object/from16 v0, p0

    invoke-virtual {v0, v6}, Lcom/htc/android/mail/server/ImapServer;->selectMailbox(Lcom/htc/android/mail/Mailbox;)Lcom/htc/android/mail/server/ImapServer$ImapResponses;

    .line 1328
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v11

    .line 1329
    .local v11, tag:Ljava/lang/String;
    sget-object v13, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v14, "%s UID STORE %s %s (\\Seen)"

    const/4 v15, 0x3

    new-array v15, v15, [Ljava/lang/Object;

    const/16 v16, 0x0

    aput-object v11, v15, v16

    const/16 v16, 0x1

    aput-object v12, v15, v16

    const/16 v16, 0x2

    aput-object v8, v15, v16

    invoke-static {v13, v14, v15}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v13

    move-object/from16 v0, p0

    invoke-virtual {v0, v13}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 1331
    move-object/from16 v0, p0

    invoke-virtual {v0, v11}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    .line 1333
    move-object/from16 v0, p0

    iget-object v13, v0, Lcom/htc/android/mail/server/ImapServer;->mMessageStatusMap:Lcom/htc/android/mail/AbsRequestController$MessageStatusMap;

    const-string v14, "READ"

    invoke-virtual {v13, v14}, Lcom/htc/android/mail/AbsRequestController$MessageStatusMap;->get(Ljava/lang/String;)Lcom/htc/android/mail/AbsRequestController$MessageStatus;

    move-result-object v7

    .line 1334
    .local v7, messageStatus:Lcom/htc/android/mail/AbsRequestController$MessageStatus;
    if-eqz v7, :cond_9

    .line 1335
    const/4 v4, 0x0

    .local v4, i:I
    :goto_3
    if-ge v4, v10, :cond_9

    .line 1336
    move-object/from16 v0, p1

    invoke-virtual {v0, v4}, Lcom/htc/android/mail/server/Server$PendingRequestList;->get(I)Lcom/htc/android/mail/server/Server$PendingRequest;

    move-result-object v9

    .line 1337
    iget-wide v13, v9, Lcom/htc/android/mail/server/Server$PendingRequest;->messageId:J

    invoke-virtual {v7, v13, v14}, Lcom/htc/android/mail/AbsRequestController$MessageStatus;->updateRemoteCompleted(J)V
    :try_end_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_1

    .line 1335
    add-int/lit8 v4, v4, 0x1

    goto :goto_3

    .line 1318
    .end local v4           #i:I
    .end local v7           #messageStatus:Lcom/htc/android/mail/AbsRequestController$MessageStatus;
    .end local v8           #param:Ljava/lang/String;
    .end local v11           #tag:Ljava/lang/String;
    :cond_8
    const-string v8, "-FLAGS.SILENT"

    goto :goto_2

    .line 1341
    .restart local v7       #messageStatus:Lcom/htc/android/mail/AbsRequestController$MessageStatus;
    .restart local v8       #param:Ljava/lang/String;
    .restart local v11       #tag:Ljava/lang/String;
    :cond_9
    :try_start_1
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->delete()I
    :try_end_1
    .catch Ljava/io/IOException; {:try_start_1 .. :try_end_1} :catch_0
    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_1

    goto/16 :goto_1

    .line 1343
    .end local v7           #messageStatus:Lcom/htc/android/mail/AbsRequestController$MessageStatus;
    .end local v11           #tag:Ljava/lang/String;
    :catch_0
    move-exception v13

    goto/16 :goto_1

    .line 1345
    :catch_1
    move-exception v3

    .line 1346
    .local v3, e:Ljava/lang/Exception;
    const-string v13, "ImapServer"

    const-string v14, "Unknow Exception"

    invoke-static {v13, v14, v3}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    .line 1347
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/server/Server$PendingRequestList;->delete()I

    goto/16 :goto_1
.end method

.method public setMessageStatusMap(Lcom/htc/android/mail/AbsRequestController$MessageStatusMap;)V
    .locals 0
    .parameter "statusMap"

    .prologue
    .line 5627
    iput-object p1, p0, Lcom/htc/android/mail/server/ImapServer;->mMessageStatusMap:Lcom/htc/android/mail/AbsRequestController$MessageStatusMap;

    .line 5628
    return-void
.end method

.method public setReadMail(Lcom/htc/android/mail/Mailbox;Lcom/htc/android/mail/MailMessage;Z)V
    .locals 2
    .parameter "mailbox"
    .parameter "mailMessage"
    .parameter "bNotifyChange"

    .prologue
    .line 1397
    sget-boolean v0, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v0, :cond_0

    .line 1398
    const-string v0, "ImapServer"

    const-string v1, "setReadMail11"

    invoke-static {v0, v1}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 1401
    :cond_0
    return-void
.end method

.method public setReadTimeout(I)V
    .locals 2
    .parameter "timeout"

    .prologue
    .line 5740
    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mSocket:Ljava/net/Socket;

    if-eqz v1, :cond_0

    .line 5742
    :try_start_0
    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mSocket:Ljava/net/Socket;

    invoke-virtual {v1, p1}, Ljava/net/Socket;->setSoTimeout(I)V
    :try_end_0
    .catch Ljava/net/SocketException; {:try_start_0 .. :try_end_0} :catch_0

    .line 5747
    :cond_0
    :goto_0
    return-void

    .line 5743
    :catch_0
    move-exception v0

    .line 5744
    .local v0, e:Ljava/net/SocketException;
    invoke-virtual {v0}, Ljava/net/SocketException;->printStackTrace()V

    goto :goto_0
.end method

.method public setUnreadMail(Lcom/htc/android/mail/Mailbox;Lcom/htc/android/mail/MailMessage;Z)V
    .locals 0
    .parameter "mailbox"
    .parameter "mailMessage"
    .parameter "bNotifyChange"

    .prologue
    .line 1279
    return-void
.end method

.method public setX509Certificate(Ljava/security/cert/X509Certificate;)V
    .locals 0
    .parameter "certificate"

    .prologue
    .line 380
    iput-object p1, p0, Lcom/htc/android/mail/server/ImapServer;->mX509Certificate:Ljava/security/cert/X509Certificate;

    .line 381
    return-void
.end method

.method public stop()V
    .locals 1

    .prologue
    .line 643
    const/4 v0, 0x1

    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->stop(Z)V

    .line 644
    return-void
.end method

.method public stop(Z)V
    .locals 1
    .parameter "immediately"

    .prologue
    .line 648
    const/4 v0, 0x1

    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->setStop(Z)V

    .line 649
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->close()V

    .line 650
    return-void
.end method

.method public syncMailToServer()V
    .locals 6

    .prologue
    .line 5052
    :try_start_0
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->probe()V

    .line 5054
    iget v4, p0, Lcom/htc/android/mail/server/Server;->socketState:I

    const/4 v5, 0x1

    if-ne v4, v5, :cond_0

    .line 5055
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->init()V

    .line 5058
    :cond_0
    invoke-virtual {p0}, Lcom/htc/android/mail/server/ImapServer;->getLocalMailForSyncUp()Landroid/database/Cursor;

    move-result-object v0

    .line 5059
    .local v0, cursor:Landroid/database/Cursor;
    if-eqz v0, :cond_1

    .line 5060
    :goto_0
    invoke-interface {v0}, Landroid/database/Cursor;->moveToNext()Z

    move-result v4

    if-eqz v4, :cond_2

    .line 5061
    const/4 v4, 0x0

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v2

    .line 5062
    .local v2, messageId:J
    const-string v4, "()"

    invoke-direct {p0, v4, v2, v3}, Lcom/htc/android/mail/server/ImapServer;->syncMailtoServerInternal(Ljava/lang/String;J)Z
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_0

    .line 5067
    .end local v0           #cursor:Landroid/database/Cursor;
    .end local v2           #messageId:J
    :catch_0
    move-exception v1

    .line 5068
    .local v1, e:Ljava/lang/Exception;
    invoke-virtual {v1}, Ljava/lang/Exception;->printStackTrace()V

    .line 5070
    .end local v1           #e:Ljava/lang/Exception;
    :cond_1
    :goto_1
    return-void

    .line 5064
    .restart local v0       #cursor:Landroid/database/Cursor;
    :cond_2
    :try_start_1
    invoke-interface {v0}, Landroid/database/Cursor;->close()V
    :try_end_1
    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0

    goto :goto_1
.end method

.method protected syncMailboxsWithDB(Lcom/htc/android/mail/Account;Ljava/util/ArrayList;Ljava/util/ArrayList;)V
    .locals 30
    .parameter "account"
    .parameter
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/Account;",
            "Ljava/util/ArrayList",
            "<",
            "Lcom/htc/android/mail/Mailbox;",
            ">;",
            "Ljava/util/ArrayList",
            "<",
            "Lcom/htc/android/mail/Mailbox;",
            ">;)V"
        }
    .end annotation

    .prologue
    .line 747
    .local p2, mailboxparentList:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/htc/android/mail/Mailbox;>;"
    .local p3, mailboxList:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Lcom/htc/android/mail/Mailbox;>;"
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v3, "_account = \'%d\'"

    const/4 v4, 0x1

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v6, 0x0

    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v28

    invoke-static/range {v28 .. v29}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v4, v6

    invoke-static {v2, v3, v4}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v5

    .line 748
    .local v5, where:Ljava/lang/String;
    const/4 v8, 0x0

    .line 749
    .local v8, c:Landroid/database/Cursor;
    move-object/from16 v0, p0

    iget-object v2, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v2}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v2

    sget-object v3, Lcom/htc/android/mail/MailProvider;->sMailBoxURI:Landroid/net/Uri;

    const/4 v4, 0x0

    const/4 v6, 0x0

    const/4 v7, 0x0

    invoke-virtual/range {v2 .. v7}, Landroid/content/ContentResolver;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v8

    .line 751
    new-instance v18, Ljava/util/HashMap;

    invoke-direct/range {v18 .. v18}, Ljava/util/HashMap;-><init>()V

    .line 752
    .local v18, mailboxsMap:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Ljava/lang/String;>;"
    if-eqz v8, :cond_1

    .line 755
    :goto_0
    invoke-interface {v8}, Landroid/database/Cursor;->moveToNext()Z

    move-result v2

    if-eqz v2, :cond_0

    .line 756
    const-string v2, "_id"

    invoke-interface {v8, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    invoke-interface {v8, v2}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v14

    .line 757
    .local v14, id:Ljava/lang/String;
    const-string v2, "_undecodename"

    invoke-interface {v8, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    invoke-interface {v8, v2}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v25

    .line 758
    .local v25, unDecodeName:Ljava/lang/String;
    move-object/from16 v0, p0

    move-object/from16 v1, v25

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->getUpperCase(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, v18

    invoke-virtual {v0, v2, v14}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    goto :goto_0

    .line 760
    .end local v14           #id:Ljava/lang/String;
    .end local v25           #unDecodeName:Ljava/lang/String;
    :cond_0
    invoke-interface {v8}, Landroid/database/Cursor;->close()V

    .line 765
    :cond_1
    const/4 v13, 0x0

    .local v13, i:I
    :goto_1
    invoke-virtual/range {p2 .. p2}, Ljava/util/ArrayList;->size()I

    move-result v2

    if-ge v13, v2, :cond_3

    .line 766
    move-object/from16 v0, p2

    invoke-virtual {v0, v13}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/htc/android/mail/Mailbox;

    iget-object v2, v2, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    move-object/from16 v0, p0

    invoke-virtual {v0, v2}, Lcom/htc/android/mail/server/ImapServer;->getUpperCase(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v16

    .line 767
    .local v16, mailboxUpperCaseName:Ljava/lang/String;
    move-object/from16 v0, v18

    move-object/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->containsKey(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_2

    .line 768
    move-object/from16 v0, v18

    move-object/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 765
    :cond_2
    add-int/lit8 v13, v13, 0x1

    goto :goto_1

    .line 773
    .end local v16           #mailboxUpperCaseName:Ljava/lang/String;
    :cond_3
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/Account;->getMailboxs()Lcom/htc/android/mail/Mailboxs;

    move-result-object v2

    invoke-virtual {v2}, Lcom/htc/android/mail/Mailboxs;->getDefaultMailbox()Lcom/htc/android/mail/Mailbox;

    move-result-object v2

    iget-object v10, v2, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    .line 774
    .local v10, defaultFolderUndecodeName:Ljava/lang/String;
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/Account;->getMailboxs()Lcom/htc/android/mail/Mailboxs;

    move-result-object v2

    invoke-virtual {v2}, Lcom/htc/android/mail/Mailboxs;->getTrashMailbox()Lcom/htc/android/mail/Mailbox;

    move-result-object v2

    iget-object v0, v2, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    move-object/from16 v24, v0

    .line 775
    .local v24, trashFolderUndecodeName:Ljava/lang/String;
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/Account;->getMailboxs()Lcom/htc/android/mail/Mailboxs;

    move-result-object v2

    invoke-virtual {v2}, Lcom/htc/android/mail/Mailboxs;->getDraftMailbox()Lcom/htc/android/mail/Mailbox;

    move-result-object v2

    iget-object v12, v2, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    .line 776
    .local v12, draftFolderUndecodeName:Ljava/lang/String;
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/Account;->getMailboxs()Lcom/htc/android/mail/Mailboxs;

    move-result-object v2

    invoke-virtual {v2}, Lcom/htc/android/mail/Mailboxs;->getOutMailbox()Lcom/htc/android/mail/Mailbox;

    move-result-object v2

    iget-object v0, v2, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    move-object/from16 v19, v0

    .line 777
    .local v19, outFolderUndecodeName:Ljava/lang/String;
    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/Account;->getMailboxs()Lcom/htc/android/mail/Mailboxs;

    move-result-object v2

    invoke-virtual {v2}, Lcom/htc/android/mail/Mailboxs;->getSentMailbox()Lcom/htc/android/mail/Mailbox;

    move-result-object v2

    iget-object v0, v2, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    move-object/from16 v22, v0

    .line 779
    .local v22, sentFolderUndecodeName:Ljava/lang/String;
    const/16 v23, 0x0

    .line 780
    .local v23, trashFolderExist:Z
    const/4 v11, 0x0

    .line 781
    .local v11, draftFolderExist:Z
    const/16 v21, 0x0

    .line 783
    .local v21, sentFolderExist:Z
    invoke-virtual/range {p3 .. p3}, Ljava/util/ArrayList;->size()I

    move-result v15

    .line 784
    .local v15, mailboxNum:I
    if-lez v15, :cond_a

    .line 785
    new-instance v9, Ljava/util/ArrayList;

    invoke-direct {v9}, Ljava/util/ArrayList;-><init>()V

    .line 786
    .local v9, contentValuesList:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/ContentValues;>;"
    const/4 v13, 0x0

    :goto_2
    if-ge v13, v15, :cond_9

    .line 787
    move-object/from16 v0, p3

    invoke-virtual {v0, v13}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/htc/android/mail/Mailbox;

    iget-object v2, v2, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    move-object/from16 v0, p0

    invoke-virtual {v0, v2}, Lcom/htc/android/mail/server/ImapServer;->getUpperCase(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v16

    .line 788
    .restart local v16       #mailboxUpperCaseName:Ljava/lang/String;
    move-object/from16 v0, v18

    move-object/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->containsKey(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_7

    .line 789
    move-object/from16 v0, v18

    move-object/from16 v1, v16

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 791
    move-object/from16 v0, p0

    move-object/from16 v1, v24

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->getUpperCase(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, v16

    invoke-virtual {v0, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_4

    .line 792
    const/16 v23, 0x1

    .line 794
    :cond_4
    move-object/from16 v0, p0

    invoke-virtual {v0, v12}, Lcom/htc/android/mail/server/ImapServer;->getUpperCase(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, v16

    invoke-virtual {v0, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_5

    .line 795
    const/4 v11, 0x1

    .line 797
    :cond_5
    move-object/from16 v0, p0

    move-object/from16 v1, v22

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->getUpperCase(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, v16

    invoke-virtual {v0, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_6

    .line 798
    const/16 v21, 0x1

    .line 786
    :cond_6
    :goto_3
    add-int/lit8 v13, v13, 0x1

    goto :goto_2

    .line 802
    :cond_7
    new-instance v26, Landroid/content/ContentValues;

    invoke-direct/range {v26 .. v26}, Landroid/content/ContentValues;-><init>()V

    .line 803
    .local v26, values:Landroid/content/ContentValues;
    const-string v3, "_undecodename"

    move-object/from16 v0, p3

    invoke-virtual {v0, v13}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/htc/android/mail/Mailbox;

    iget-object v2, v2, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    move-object/from16 v0, v26

    invoke-virtual {v0, v3, v2}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 804
    const-string v3, "_decodename"

    move-object/from16 v0, p3

    invoke-virtual {v0, v13}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/htc/android/mail/Mailbox;

    iget-object v2, v2, Lcom/htc/android/mail/Mailbox;->decodeName:Ljava/lang/String;

    move-object/from16 v0, v26

    invoke-virtual {v0, v3, v2}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 805
    const-string v3, "_shortname"

    move-object/from16 v0, p3

    invoke-virtual {v0, v13}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/htc/android/mail/Mailbox;

    iget-object v2, v2, Lcom/htc/android/mail/Mailbox;->shortName:Ljava/lang/String;

    move-object/from16 v0, v26

    invoke-virtual {v0, v3, v2}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 806
    const-string v2, "_noselect"

    const/4 v3, 0x0

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    move-object/from16 v0, v26

    invoke-virtual {v0, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 807
    const-string v2, "_haschild"

    const/4 v3, 0x0

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    move-object/from16 v0, v26

    invoke-virtual {v0, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 808
    const-string v2, "_serverfolder"

    const/4 v3, 0x1

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    move-object/from16 v0, v26

    invoke-virtual {v0, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 809
    const-string v2, "_account"

    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v3

    invoke-static {v3, v4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v3

    move-object/from16 v0, v26

    invoke-virtual {v0, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 810
    move-object/from16 v0, p3

    invoke-virtual {v0, v13}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/htc/android/mail/Mailbox;

    iget-object v2, v2, Lcom/htc/android/mail/Mailbox;->parentId:Ljava/lang/String;

    if-nez v2, :cond_8

    .line 811
    const-string v2, "_parentId"

    const/4 v3, 0x0

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    move-object/from16 v0, v26

    invoke-virtual {v0, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 815
    :goto_4
    move-object/from16 v0, v26

    invoke-virtual {v9, v0}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto/16 :goto_3

    .line 813
    :cond_8
    const-string v3, "_parentId"

    move-object/from16 v0, p3

    invoke-virtual {v0, v13}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/htc/android/mail/Mailbox;

    iget-object v2, v2, Lcom/htc/android/mail/Mailbox;->parentId:Ljava/lang/String;

    move-object/from16 v0, v26

    invoke-virtual {v0, v3, v2}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    goto :goto_4

    .line 817
    .end local v16           #mailboxUpperCaseName:Ljava/lang/String;
    .end local v26           #values:Landroid/content/ContentValues;
    :cond_9
    const/4 v2, 0x0

    new-array v2, v2, [Landroid/content/ContentValues;

    invoke-virtual {v9, v2}, Ljava/util/ArrayList;->toArray([Ljava/lang/Object;)[Ljava/lang/Object;

    move-result-object v27

    check-cast v27, [Landroid/content/ContentValues;

    .line 818
    .local v27, valuesArray:[Landroid/content/ContentValues;
    move-object/from16 v0, p0

    iget-object v2, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v2}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v2

    sget-object v3, Lcom/htc/android/mail/MailProvider;->sMailBoxURI:Landroid/net/Uri;

    move-object/from16 v0, v27

    invoke-virtual {v2, v3, v0}, Landroid/content/ContentResolver;->bulkInsert(Landroid/net/Uri;[Landroid/content/ContentValues;)I

    .line 821
    .end local v9           #contentValuesList:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/ContentValues;>;"
    .end local v27           #valuesArray:[Landroid/content/ContentValues;
    :cond_a
    if-nez v23, :cond_b

    .line 822
    move-object/from16 v0, p0

    move-object/from16 v1, v24

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->getUpperCase(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, v18

    invoke-virtual {v0, v2}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 823
    move-object/from16 v0, p0

    move-object/from16 v1, v24

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->createMailbox(Ljava/lang/String;)I

    move-result v2

    const/4 v3, -0x1

    if-ne v2, v3, :cond_b

    .line 824
    new-instance v26, Landroid/content/ContentValues;

    invoke-direct/range {v26 .. v26}, Landroid/content/ContentValues;-><init>()V

    .line 825
    .restart local v26       #values:Landroid/content/ContentValues;
    const-string v2, "_serverfolder"

    const/4 v3, 0x0

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    move-object/from16 v0, v26

    invoke-virtual {v0, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 826
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v3, "_account = \'%d\' AND _id = \'%d\'"

    const/4 v4, 0x2

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v6, 0x0

    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v28

    invoke-static/range {v28 .. v29}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v4, v6

    const/4 v6, 0x1

    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/Account;->getMailboxs()Lcom/htc/android/mail/Mailboxs;

    move-result-object v7

    invoke-virtual {v7}, Lcom/htc/android/mail/Mailboxs;->getTrashMailbox()Lcom/htc/android/mail/Mailbox;

    move-result-object v7

    iget-wide v0, v7, Lcom/htc/android/mail/Mailbox;->id:J

    move-wide/from16 v28, v0

    invoke-static/range {v28 .. v29}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v4, v6

    invoke-static {v2, v3, v4}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v5

    .line 827
    move-object/from16 v0, p0

    iget-object v2, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v2}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v2

    sget-object v3, Lcom/htc/android/mail/MailProvider;->sMailBoxURI:Landroid/net/Uri;

    const/4 v4, 0x0

    move-object/from16 v0, v26

    invoke-virtual {v2, v3, v0, v5, v4}, Landroid/content/ContentResolver;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    .line 831
    .end local v26           #values:Landroid/content/ContentValues;
    :cond_b
    if-nez v11, :cond_c

    .line 832
    move-object/from16 v0, p0

    invoke-virtual {v0, v12}, Lcom/htc/android/mail/server/ImapServer;->getUpperCase(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, v18

    invoke-virtual {v0, v2}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 833
    move-object/from16 v0, p0

    invoke-virtual {v0, v12}, Lcom/htc/android/mail/server/ImapServer;->createMailbox(Ljava/lang/String;)I

    move-result v2

    const/4 v3, -0x1

    if-ne v2, v3, :cond_c

    .line 834
    new-instance v26, Landroid/content/ContentValues;

    invoke-direct/range {v26 .. v26}, Landroid/content/ContentValues;-><init>()V

    .line 835
    .restart local v26       #values:Landroid/content/ContentValues;
    const-string v2, "_serverfolder"

    const/4 v3, 0x0

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    move-object/from16 v0, v26

    invoke-virtual {v0, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 836
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v3, "_account = \'%d\' AND _id = \'%d\'"

    const/4 v4, 0x2

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v6, 0x0

    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v28

    invoke-static/range {v28 .. v29}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v4, v6

    const/4 v6, 0x1

    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/Account;->getMailboxs()Lcom/htc/android/mail/Mailboxs;

    move-result-object v7

    invoke-virtual {v7}, Lcom/htc/android/mail/Mailboxs;->getDraftMailbox()Lcom/htc/android/mail/Mailbox;

    move-result-object v7

    iget-wide v0, v7, Lcom/htc/android/mail/Mailbox;->id:J

    move-wide/from16 v28, v0

    invoke-static/range {v28 .. v29}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v4, v6

    invoke-static {v2, v3, v4}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v5

    .line 837
    move-object/from16 v0, p0

    iget-object v2, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v2}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v2

    sget-object v3, Lcom/htc/android/mail/MailProvider;->sMailBoxURI:Landroid/net/Uri;

    const/4 v4, 0x0

    move-object/from16 v0, v26

    invoke-virtual {v2, v3, v0, v5, v4}, Landroid/content/ContentResolver;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    .line 841
    .end local v26           #values:Landroid/content/ContentValues;
    :cond_c
    if-nez v21, :cond_d

    .line 842
    move-object/from16 v0, p0

    move-object/from16 v1, v22

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->getUpperCase(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, v18

    invoke-virtual {v0, v2}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 843
    move-object/from16 v0, p0

    move-object/from16 v1, v22

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->createMailbox(Ljava/lang/String;)I

    move-result v2

    const/4 v3, -0x1

    if-ne v2, v3, :cond_d

    .line 844
    new-instance v26, Landroid/content/ContentValues;

    invoke-direct/range {v26 .. v26}, Landroid/content/ContentValues;-><init>()V

    .line 845
    .restart local v26       #values:Landroid/content/ContentValues;
    const-string v2, "_serverfolder"

    const/4 v3, 0x0

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    move-object/from16 v0, v26

    invoke-virtual {v0, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 846
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v3, "_account = \'%d\' AND _id = \'%d\'"

    const/4 v4, 0x2

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v6, 0x0

    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v28

    invoke-static/range {v28 .. v29}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v4, v6

    const/4 v6, 0x1

    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/Account;->getMailboxs()Lcom/htc/android/mail/Mailboxs;

    move-result-object v7

    invoke-virtual {v7}, Lcom/htc/android/mail/Mailboxs;->getSentMailbox()Lcom/htc/android/mail/Mailbox;

    move-result-object v7

    iget-wide v0, v7, Lcom/htc/android/mail/Mailbox;->id:J

    move-wide/from16 v28, v0

    invoke-static/range {v28 .. v29}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v4, v6

    invoke-static {v2, v3, v4}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v5

    .line 847
    move-object/from16 v0, p0

    iget-object v2, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v2}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v2

    sget-object v3, Lcom/htc/android/mail/MailProvider;->sMailBoxURI:Landroid/net/Uri;

    const/4 v4, 0x0

    move-object/from16 v0, v26

    invoke-virtual {v2, v3, v0, v5, v4}, Landroid/content/ContentResolver;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    .line 851
    .end local v26           #values:Landroid/content/ContentValues;
    :cond_d
    move-object/from16 v0, p0

    invoke-virtual {v0, v10}, Lcom/htc/android/mail/server/ImapServer;->getUpperCase(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, v18

    invoke-virtual {v0, v2}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 852
    move-object/from16 v0, p0

    move-object/from16 v1, v19

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->getUpperCase(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, v18

    invoke-virtual {v0, v2}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 855
    new-instance v20, Ljava/lang/StringBuilder;

    invoke-direct/range {v20 .. v20}, Ljava/lang/StringBuilder;-><init>()V

    .line 856
    .local v20, sb:Ljava/lang/StringBuilder;
    invoke-virtual/range {v18 .. v18}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v2

    invoke-interface {v2}, Ljava/util/Collection;->toArray()[Ljava/lang/Object;

    move-result-object v17

    check-cast v17, [Ljava/lang/Object;

    .line 857
    .local v17, mailboxid:[Ljava/lang/Object;
    const/4 v13, 0x0

    :goto_5
    move-object/from16 v0, v17

    array-length v2, v0

    if-ge v13, v2, :cond_f

    .line 858
    aget-object v14, v17, v13

    check-cast v14, Ljava/lang/String;

    .line 859
    .restart local v14       #id:Ljava/lang/String;
    invoke-virtual/range {v20 .. v20}, Ljava/lang/StringBuilder;->length()I

    move-result v2

    if-lez v2, :cond_e

    .line 860
    const-string v2, ","

    move-object/from16 v0, v20

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-static {v14}, Landroid/database/DatabaseUtils;->sqlEscapeString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    .line 857
    :goto_6
    add-int/lit8 v13, v13, 0x1

    goto :goto_5

    .line 862
    :cond_e
    invoke-static {v14}, Landroid/database/DatabaseUtils;->sqlEscapeString(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v2

    move-object/from16 v0, v20

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    goto :goto_6

    .line 866
    .end local v14           #id:Ljava/lang/String;
    :cond_f
    invoke-virtual/range {v20 .. v20}, Ljava/lang/StringBuilder;->length()I

    move-result v2

    if-lez v2, :cond_10

    .line 867
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v3, "_account = \'%d\' AND _id in (%s)"

    const/4 v4, 0x2

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v6, 0x0

    invoke-virtual/range {p1 .. p1}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v28

    invoke-static/range {v28 .. v29}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v4, v6

    const/4 v6, 0x1

    invoke-virtual/range {v20 .. v20}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    aput-object v7, v4, v6

    invoke-static {v2, v3, v4}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v5

    .line 868
    move-object/from16 v0, p0

    iget-object v2, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v2}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v2

    sget-object v3, Lcom/htc/android/mail/MailProvider;->sMailBoxURI:Landroid/net/Uri;

    const/4 v4, 0x0

    invoke-virtual {v2, v3, v5, v4}, Landroid/content/ContentResolver;->delete(Landroid/net/Uri;Ljava/lang/String;[Ljava/lang/String;)I

    .line 870
    :cond_10
    return-void
.end method

.method public syncPendingRequests()V
    .locals 67
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 1927
    const/16 v53, 0x0

    .line 1931
    .local v53, cursor:Landroid/database/Cursor;
    :try_start_0
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->whereForGetUidSyncPendingRequests()Ljava/lang/String;

    move-result-object v7

    .line 1932
    .local v7, where:Ljava/lang/String;
    const-string v9, "_messageId, _accountId, _id asc"

    .line 1933
    .local v9, sort:Ljava/lang/String;
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v4

    sget-object v5, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    const/4 v6, 0x0

    const/4 v8, 0x0

    invoke-interface/range {v4 .. v9}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v53

    .line 1934
    if-eqz v53, :cond_3

    .line 1939
    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-static {v4}, Lcom/htc/android/mail/AccountPool;->getInstance(Landroid/content/Context;)Lcom/htc/android/mail/AccountPool;

    move-result-object v52

    .line 1940
    .local v52, accountPool:Lcom/htc/android/mail/AccountPool;
    :cond_0
    :goto_0
    invoke-interface/range {v53 .. v53}, Landroid/database/Cursor;->moveToNext()Z

    move-result v4

    if-eqz v4, :cond_2

    .line 1941
    const-string v4, "_messageId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v12

    .line 1942
    .local v12, messageId:J
    const-string v4, "_fromMailboxId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v24

    .line 1943
    .local v24, fromMailboxId:J
    const-string v4, "_msgId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v14

    .line 1944
    .local v14, msgIdInHeader:Ljava/lang/String;
    const-string v4, "_accountId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v18

    .line 1945
    .local v18, accountId:J
    move-object/from16 v0, p0

    iget-object v4, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    move-object/from16 v0, v52

    move-wide/from16 v1, v18

    invoke-virtual {v0, v4, v1, v2}, Lcom/htc/android/mail/AccountPool;->getAccount(Landroid/content/Context;J)Lcom/htc/android/mail/Account;

    move-result-object v51

    .line 1946
    .local v51, account:Lcom/htc/android/mail/Account;
    if-eqz v51, :cond_0

    .line 1947
    invoke-virtual/range {v51 .. v51}, Lcom/htc/android/mail/Account;->getMailboxs()Lcom/htc/android/mail/Mailboxs;

    move-result-object v4

    move-wide/from16 v0, v24

    invoke-virtual {v4, v0, v1}, Lcom/htc/android/mail/Mailboxs;->getMailboxById(J)Lcom/htc/android/mail/Mailbox;

    move-result-object v11

    .line 1948
    .local v11, mailbox:Lcom/htc/android/mail/Mailbox;
    if-eqz v11, :cond_0

    .line 1949
    const/4 v15, 0x0

    move-object/from16 v10, p0

    invoke-virtual/range {v10 .. v15}, Lcom/htc/android/mail/server/ImapServer;->getUidFromServer(Lcom/htc/android/mail/Mailbox;JLjava/lang/String;Ljava/lang/String;)Z
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_0

    .line 2159
    .end local v7           #where:Ljava/lang/String;
    .end local v9           #sort:Ljava/lang/String;
    .end local v11           #mailbox:Lcom/htc/android/mail/Mailbox;
    .end local v12           #messageId:J
    .end local v14           #msgIdInHeader:Ljava/lang/String;
    .end local v18           #accountId:J
    .end local v24           #fromMailboxId:J
    .end local v51           #account:Lcom/htc/android/mail/Account;
    .end local v52           #accountPool:Lcom/htc/android/mail/AccountPool;
    :catch_0
    move-exception v4

    .line 2162
    if-eqz v53, :cond_1

    invoke-interface/range {v53 .. v53}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_1

    .line 2163
    :goto_1
    invoke-interface/range {v53 .. v53}, Landroid/database/Cursor;->close()V

    .line 2166
    :cond_1
    return-void

    .line 1951
    .restart local v7       #where:Ljava/lang/String;
    .restart local v9       #sort:Ljava/lang/String;
    .restart local v52       #accountPool:Lcom/htc/android/mail/AccountPool;
    :cond_2
    :try_start_1
    invoke-interface/range {v53 .. v53}, Landroid/database/Cursor;->close()V

    .line 1955
    .end local v52           #accountPool:Lcom/htc/android/mail/AccountPool;
    :cond_3
    new-instance v57, Lcom/htc/android/mail/util/SparseArray;

    invoke-direct/range {v57 .. v57}, Lcom/htc/android/mail/util/SparseArray;-><init>()V

    .line 1957
    .local v57, moveFromSparseArray:Lcom/htc/android/mail/util/SparseArray;,"Lcom/htc/android/mail/util/SparseArray<Lcom/htc/android/mail/util/SparseArray<Lcom/htc/android/mail/server/Server$PendingRequestList;>;>;"
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->whereForMoveMailSyncPendingRequests()Ljava/lang/String;

    move-result-object v7

    .line 1958
    const-string v9, "_messageId, _accountId, _id asc"

    .line 1959
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v4

    sget-object v5, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    const/4 v6, 0x0

    const/4 v8, 0x0

    invoke-interface/range {v4 .. v9}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v53

    .line 1960
    if-eqz v53, :cond_8

    .line 1964
    invoke-interface/range {v53 .. v53}, Landroid/database/Cursor;->moveToNext()Z

    move-result v4

    if-eqz v4, :cond_7

    .line 1965
    const-string v4, "_id"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v16

    .line 1966
    .local v16, id:J
    const-string v4, "_accountId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v18

    .line 1967
    .restart local v18       #accountId:J
    const-string v4, "_messageId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v12

    .line 1968
    .restart local v12       #messageId:J
    const-string v4, "_uid"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v22

    .line 1969
    .local v22, uid:Ljava/lang/String;
    const-string v4, "_fromMailboxId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v24

    .line 1970
    .restart local v24       #fromMailboxId:J
    const-string v4, "_toMailboxId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getInt(I)I

    move-result v4

    int-to-long v0, v4

    move-wide/from16 v26, v0

    .line 1971
    .local v26, toMailboxId:J
    const-string v4, "_msgId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v14

    .line 1973
    .restart local v14       #msgIdInHeader:Ljava/lang/String;
    new-instance v15, Lcom/htc/android/mail/server/Server$PendingRequest;

    move-wide/from16 v20, v12

    move-object/from16 v23, v14

    invoke-direct/range {v15 .. v27}, Lcom/htc/android/mail/server/Server$PendingRequest;-><init>(JJJLjava/lang/String;Ljava/lang/String;JJ)V

    .line 1976
    .local v15, pendingRequest:Lcom/htc/android/mail/server/Server$PendingRequest;
    :goto_2
    invoke-interface/range {v53 .. v53}, Landroid/database/Cursor;->moveToNext()Z

    move-result v4

    if-eqz v4, :cond_6

    .line 1977
    const-string v4, "_messageId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v12

    .line 1978
    iget-wide v4, v15, Lcom/htc/android/mail/server/Server$PendingRequest;->messageId:J

    cmp-long v4, v12, v4

    if-nez v4, :cond_5

    .line 1979
    const-string v4, "_toMailboxId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getInt(I)I

    move-result v4

    int-to-long v0, v4

    move-wide/from16 v26, v0

    .line 1980
    move-wide/from16 v0, v26

    invoke-virtual {v15, v0, v1}, Lcom/htc/android/mail/server/Server$PendingRequest;->updateToMailboxId(J)V

    .line 1981
    invoke-virtual/range {v15 .. v17}, Lcom/htc/android/mail/server/Server$PendingRequest;->add(J)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    goto :goto_2

    .line 2162
    .end local v7           #where:Ljava/lang/String;
    .end local v9           #sort:Ljava/lang/String;
    .end local v12           #messageId:J
    .end local v14           #msgIdInHeader:Ljava/lang/String;
    .end local v15           #pendingRequest:Lcom/htc/android/mail/server/Server$PendingRequest;
    .end local v16           #id:J
    .end local v18           #accountId:J
    .end local v22           #uid:Ljava/lang/String;
    .end local v24           #fromMailboxId:J
    .end local v26           #toMailboxId:J
    .end local v57           #moveFromSparseArray:Lcom/htc/android/mail/util/SparseArray;,"Lcom/htc/android/mail/util/SparseArray<Lcom/htc/android/mail/util/SparseArray<Lcom/htc/android/mail/server/Server$PendingRequestList;>;>;"
    :catchall_0
    move-exception v4

    if-eqz v53, :cond_4

    invoke-interface/range {v53 .. v53}, Landroid/database/Cursor;->isClosed()Z

    move-result v5

    if-nez v5, :cond_4

    .line 2163
    invoke-interface/range {v53 .. v53}, Landroid/database/Cursor;->close()V

    .line 2162
    :cond_4
    throw v4

    .line 1983
    .restart local v7       #where:Ljava/lang/String;
    .restart local v9       #sort:Ljava/lang/String;
    .restart local v12       #messageId:J
    .restart local v14       #msgIdInHeader:Ljava/lang/String;
    .restart local v15       #pendingRequest:Lcom/htc/android/mail/server/Server$PendingRequest;
    .restart local v16       #id:J
    .restart local v18       #accountId:J
    .restart local v22       #uid:Ljava/lang/String;
    .restart local v24       #fromMailboxId:J
    .restart local v26       #toMailboxId:J
    .restart local v57       #moveFromSparseArray:Lcom/htc/android/mail/util/SparseArray;,"Lcom/htc/android/mail/util/SparseArray<Lcom/htc/android/mail/util/SparseArray<Lcom/htc/android/mail/server/Server$PendingRequestList;>;>;"
    :cond_5
    :try_start_2
    move-object/from16 v0, p0

    move-object/from16 v1, v57

    invoke-virtual {v0, v1, v15}, Lcom/htc/android/mail/server/ImapServer;->addMovePendingRequest(Lcom/htc/android/mail/util/SparseArray;Lcom/htc/android/mail/server/Server$PendingRequest;)V

    .line 1985
    const-string v4, "_id"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v16

    .line 1986
    const-string v4, "_accountId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v18

    .line 1987
    const-string v4, "_uid"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v22

    .line 1988
    const-string v4, "_fromMailboxId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v24

    .line 1989
    const-string v4, "_toMailboxId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v26

    .line 1990
    const-string v4, "_msgId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v14

    .line 1992
    new-instance v15, Lcom/htc/android/mail/server/Server$PendingRequest;

    .end local v15           #pendingRequest:Lcom/htc/android/mail/server/Server$PendingRequest;
    move-wide/from16 v20, v12

    move-object/from16 v23, v14

    invoke-direct/range {v15 .. v27}, Lcom/htc/android/mail/server/Server$PendingRequest;-><init>(JJJLjava/lang/String;Ljava/lang/String;JJ)V

    .restart local v15       #pendingRequest:Lcom/htc/android/mail/server/Server$PendingRequest;
    goto/16 :goto_2

    .line 1996
    :cond_6
    move-object/from16 v0, p0

    move-object/from16 v1, v57

    invoke-virtual {v0, v1, v15}, Lcom/htc/android/mail/server/ImapServer;->addMovePendingRequest(Lcom/htc/android/mail/util/SparseArray;Lcom/htc/android/mail/server/Server$PendingRequest;)V

    .line 1998
    .end local v12           #messageId:J
    .end local v14           #msgIdInHeader:Ljava/lang/String;
    .end local v15           #pendingRequest:Lcom/htc/android/mail/server/Server$PendingRequest;
    .end local v16           #id:J
    .end local v18           #accountId:J
    .end local v22           #uid:Ljava/lang/String;
    .end local v24           #fromMailboxId:J
    .end local v26           #toMailboxId:J
    :cond_7
    invoke-interface/range {v53 .. v53}, Landroid/database/Cursor;->close()V

    .line 2001
    :cond_8
    invoke-virtual/range {v57 .. v57}, Lcom/htc/android/mail/util/SparseArray;->size()I

    move-result v64

    .line 2006
    .local v64, sizeFrom:I
    const/16 v54, 0x0

    .local v54, i:I
    :goto_3
    move/from16 v0, v54

    move/from16 v1, v64

    if-ge v0, v1, :cond_b

    .line 2007
    move-object/from16 v0, v57

    move/from16 v1, v54

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/util/SparseArray;->keyAt(I)J

    move-result-wide v24

    .line 2008
    .restart local v24       #fromMailboxId:J
    move-object/from16 v0, v57

    move-wide/from16 v1, v24

    invoke-virtual {v0, v1, v2}, Lcom/htc/android/mail/util/SparseArray;->get(J)Ljava/lang/Object;

    move-result-object v58

    check-cast v58, Lcom/htc/android/mail/util/SparseArray;

    .line 2009
    .local v58, moveToSparseArray:Lcom/htc/android/mail/util/SparseArray;,"Lcom/htc/android/mail/util/SparseArray<Lcom/htc/android/mail/server/Server$PendingRequestList;>;"
    invoke-virtual/range {v58 .. v58}, Lcom/htc/android/mail/util/SparseArray;->size()I

    move-result v65

    .line 2010
    .local v65, sizeTo:I
    const/16 v55, 0x0

    .local v55, j:I
    :goto_4
    move/from16 v0, v55

    move/from16 v1, v65

    if-ge v0, v1, :cond_a

    .line 2011
    move-object/from16 v0, v58

    move/from16 v1, v55

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/util/SparseArray;->keyAt(I)J

    move-result-wide v26

    .line 2012
    .restart local v26       #toMailboxId:J
    move-object/from16 v0, v58

    move-wide/from16 v1, v26

    invoke-virtual {v0, v1, v2}, Lcom/htc/android/mail/util/SparseArray;->get(J)Ljava/lang/Object;

    move-result-object v60

    check-cast v60, Lcom/htc/android/mail/server/Server$PendingRequestList;

    .line 2013
    .local v60, pendingRequestList:Lcom/htc/android/mail/server/Server$PendingRequestList;
    invoke-virtual/range {v60 .. v60}, Lcom/htc/android/mail/server/Server$PendingRequestList;->size()I

    move-result v4

    if-lez v4, :cond_9

    .line 2014
    move-object/from16 v0, p0

    move-object/from16 v1, v60

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->moveMail(Lcom/htc/android/mail/server/Server$PendingRequestList;)V

    .line 2010
    :cond_9
    add-int/lit8 v55, v55, 0x1

    goto :goto_4

    .line 2006
    .end local v26           #toMailboxId:J
    .end local v60           #pendingRequestList:Lcom/htc/android/mail/server/Server$PendingRequestList;
    :cond_a
    add-int/lit8 v54, v54, 0x1

    goto :goto_3

    .line 2021
    .end local v24           #fromMailboxId:J
    .end local v55           #j:I
    .end local v58           #moveToSparseArray:Lcom/htc/android/mail/util/SparseArray;,"Lcom/htc/android/mail/util/SparseArray<Lcom/htc/android/mail/server/Server$PendingRequestList;>;"
    .end local v65           #sizeTo:I
    :cond_b
    new-instance v56, Ljava/util/HashMap;

    invoke-direct/range {v56 .. v56}, Ljava/util/HashMap;-><init>()V

    .line 2022
    .local v56, messageIdMap:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/Long;Ljava/lang/Object;>;"
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->whereForMoveMailGetUidSyncPendingRequests()Ljava/lang/String;

    move-result-object v7

    .line 2023
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v28

    sget-object v29, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    const/4 v4, 0x1

    new-array v0, v4, [Ljava/lang/String;

    move-object/from16 v30, v0

    const/4 v4, 0x0

    const-string v5, "_messageId"

    aput-object v5, v30, v4

    const/16 v32, 0x0

    const/16 v33, 0x0

    move-object/from16 v31, v7

    invoke-interface/range {v28 .. v33}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v53

    .line 2024
    if-eqz v53, :cond_d

    .line 2025
    new-instance v59, Ljava/lang/Object;

    invoke-direct/range {v59 .. v59}, Ljava/lang/Object;-><init>()V

    .line 2026
    .local v59, obj:Ljava/lang/Object;
    :goto_5
    invoke-interface/range {v53 .. v53}, Landroid/database/Cursor;->moveToNext()Z

    move-result v4

    if-eqz v4, :cond_c

    .line 2027
    const-string v4, "_messageId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v12

    .line 2028
    .restart local v12       #messageId:J
    invoke-static {v12, v13}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v4

    move-object/from16 v0, v56

    move-object/from16 v1, v59

    invoke-virtual {v0, v4, v1}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    goto :goto_5

    .line 2030
    .end local v12           #messageId:J
    :cond_c
    invoke-interface/range {v53 .. v53}, Landroid/database/Cursor;->close()V

    .line 2034
    .end local v59           #obj:Ljava/lang/Object;
    :cond_d
    new-instance v61, Lcom/htc/android/mail/util/SparseArray;

    invoke-direct/range {v61 .. v61}, Lcom/htc/android/mail/util/SparseArray;-><init>()V

    .line 2035
    .local v61, pendingRequestListArray:Lcom/htc/android/mail/util/SparseArray;,"Lcom/htc/android/mail/util/SparseArray<Lcom/htc/android/mail/server/Server$PendingRequestList;>;"
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->whereForDeleteMailSyncPendingRequests()Ljava/lang/String;

    move-result-object v7

    .line 2036
    const-string v9, "_messageId, _accountId, _id asc"

    .line 2037
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v4

    sget-object v5, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    const/4 v6, 0x0

    const/4 v8, 0x0

    invoke-interface/range {v4 .. v9}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v53

    .line 2038
    if-eqz v53, :cond_f

    .line 2041
    :goto_6
    invoke-interface/range {v53 .. v53}, Landroid/database/Cursor;->moveToNext()Z

    move-result v4

    if-eqz v4, :cond_e

    .line 2042
    const-string v4, "_id"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v16

    .line 2043
    .restart local v16       #id:J
    const-string v4, "_accountId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v18

    .line 2044
    .restart local v18       #accountId:J
    const-string v4, "_messageId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v12

    .line 2045
    .restart local v12       #messageId:J
    const-string v4, "_uid"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v22

    .line 2046
    .restart local v22       #uid:Ljava/lang/String;
    const-string v4, "_fromMailboxId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v37

    .line 2047
    .local v37, mailboxId:J
    const-string v4, "_msgId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v14

    .line 2048
    .restart local v14       #msgIdInHeader:Ljava/lang/String;
    new-instance v28, Lcom/htc/android/mail/server/Server$PendingRequest;

    move-wide/from16 v29, v16

    move-wide/from16 v31, v18

    move-wide/from16 v33, v12

    move-object/from16 v35, v22

    move-object/from16 v36, v14

    invoke-direct/range {v28 .. v38}, Lcom/htc/android/mail/server/Server$PendingRequest;-><init>(JJJLjava/lang/String;Ljava/lang/String;J)V

    .line 2049
    .local v28, request:Lcom/htc/android/mail/server/Server$PendingRequest;
    move-object/from16 v0, p0

    move-object/from16 v1, v61

    move-object/from16 v2, v28

    move-object/from16 v3, v56

    invoke-virtual {v0, v1, v2, v3}, Lcom/htc/android/mail/server/ImapServer;->addDeletePendingRequest(Lcom/htc/android/mail/util/SparseArray;Lcom/htc/android/mail/server/Server$PendingRequest;Ljava/util/HashMap;)V

    goto :goto_6

    .line 2051
    .end local v12           #messageId:J
    .end local v14           #msgIdInHeader:Ljava/lang/String;
    .end local v16           #id:J
    .end local v18           #accountId:J
    .end local v22           #uid:Ljava/lang/String;
    .end local v28           #request:Lcom/htc/android/mail/server/Server$PendingRequest;
    .end local v37           #mailboxId:J
    :cond_e
    invoke-interface/range {v53 .. v53}, Landroid/database/Cursor;->close()V

    .line 2054
    :cond_f
    invoke-virtual/range {v61 .. v61}, Lcom/htc/android/mail/util/SparseArray;->size()I

    move-result v63

    .line 2055
    .local v63, size:I
    const/16 v54, 0x0

    :goto_7
    move/from16 v0, v54

    move/from16 v1, v63

    if-ge v0, v1, :cond_11

    .line 2056
    move-object/from16 v0, v61

    move/from16 v1, v54

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v60

    check-cast v60, Lcom/htc/android/mail/server/Server$PendingRequestList;

    .line 2057
    .restart local v60       #pendingRequestList:Lcom/htc/android/mail/server/Server$PendingRequestList;
    invoke-virtual/range {v60 .. v60}, Lcom/htc/android/mail/server/Server$PendingRequestList;->size()I

    move-result v4

    if-lez v4, :cond_10

    .line 2058
    move-object/from16 v0, p0

    move-object/from16 v1, v60

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->deleteMail(Lcom/htc/android/mail/server/Server$PendingRequestList;)V

    .line 2055
    :cond_10
    add-int/lit8 v54, v54, 0x1

    goto :goto_7

    .line 2063
    .end local v60           #pendingRequestList:Lcom/htc/android/mail/server/Server$PendingRequestList;
    :cond_11
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->whereForEmptyMailboxSyncPendingRequests()Ljava/lang/String;

    move-result-object v7

    .line 2064
    const-string v9, "_id asc"

    .line 2065
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v4

    sget-object v5, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    const/4 v6, 0x0

    const/4 v8, 0x0

    invoke-interface/range {v4 .. v9}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v53

    .line 2066
    if-eqz v53, :cond_13

    .line 2069
    :goto_8
    invoke-interface/range {v53 .. v53}, Landroid/database/Cursor;->moveToNext()Z

    move-result v4

    if-eqz v4, :cond_12

    .line 2070
    const-string v4, "_id"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v16

    .line 2071
    .restart local v16       #id:J
    const-string v4, "_accountId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v18

    .line 2072
    .restart local v18       #accountId:J
    const-string v4, "_fromMailboxId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v37

    .line 2073
    .restart local v37       #mailboxId:J
    new-instance v28, Lcom/htc/android/mail/server/Server$PendingRequest;

    move-object/from16 v32, v28

    move-wide/from16 v33, v16

    move-wide/from16 v35, v18

    invoke-direct/range {v32 .. v38}, Lcom/htc/android/mail/server/Server$PendingRequest;-><init>(JJJ)V

    .line 2074
    .restart local v28       #request:Lcom/htc/android/mail/server/Server$PendingRequest;
    move-object/from16 v0, p0

    move-object/from16 v1, v28

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->emptyMailbox(Lcom/htc/android/mail/server/Server$PendingRequest;)V

    goto :goto_8

    .line 2076
    .end local v16           #id:J
    .end local v18           #accountId:J
    .end local v28           #request:Lcom/htc/android/mail/server/Server$PendingRequest;
    .end local v37           #mailboxId:J
    :cond_12
    invoke-interface/range {v53 .. v53}, Landroid/database/Cursor;->close()V

    .line 2081
    :cond_13
    new-instance v62, Lcom/htc/android/mail/util/SparseArray;

    invoke-direct/range {v62 .. v62}, Lcom/htc/android/mail/util/SparseArray;-><init>()V

    .line 2082
    .local v62, readRequestArray:Lcom/htc/android/mail/util/SparseArray;,"Lcom/htc/android/mail/util/SparseArray<Lcom/htc/android/mail/server/Server$PendingRequestList;>;"
    new-instance v66, Lcom/htc/android/mail/util/SparseArray;

    invoke-direct/range {v66 .. v66}, Lcom/htc/android/mail/util/SparseArray;-><init>()V

    .line 2083
    .local v66, unreadRequestArray:Lcom/htc/android/mail/util/SparseArray;,"Lcom/htc/android/mail/util/SparseArray<Lcom/htc/android/mail/server/Server$PendingRequestList;>;"
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->whereForReadUnreadMailSyncPendingRequests()Ljava/lang/String;

    move-result-object v7

    .line 2084
    const-string v9, "_messageId, _accountId, _id asc"

    .line 2085
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v4

    sget-object v5, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    const/4 v6, 0x0

    const/4 v8, 0x0

    invoke-interface/range {v4 .. v9}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v53

    .line 2086
    if-eqz v53, :cond_18

    .line 2090
    invoke-interface/range {v53 .. v53}, Landroid/database/Cursor;->moveToNext()Z

    move-result v4

    if-eqz v4, :cond_17

    .line 2091
    const-string v4, "_id"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v16

    .line 2092
    .restart local v16       #id:J
    const-string v4, "_accountId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v18

    .line 2093
    .restart local v18       #accountId:J
    const-string v4, "_request"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getInt(I)I

    move-result v44

    .line 2094
    .local v44, requestId:I
    const-string v4, "_messageId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v12

    .line 2095
    .restart local v12       #messageId:J
    const-string v4, "_fromMailboxId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v37

    .line 2096
    .restart local v37       #mailboxId:J
    const-string v4, "_uid"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v22

    .line 2097
    .restart local v22       #uid:Ljava/lang/String;
    const-string v4, "_msgId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v14

    .line 2099
    .restart local v14       #msgIdInHeader:Ljava/lang/String;
    new-instance v15, Lcom/htc/android/mail/server/Server$PendingRequest;

    move-object/from16 v39, v15

    move-wide/from16 v40, v16

    move-wide/from16 v42, v18

    move-wide/from16 v45, v12

    move-object/from16 v47, v22

    move-object/from16 v48, v14

    move-wide/from16 v49, v37

    invoke-direct/range {v39 .. v50}, Lcom/htc/android/mail/server/Server$PendingRequest;-><init>(JJIJLjava/lang/String;Ljava/lang/String;J)V

    .line 2102
    .restart local v15       #pendingRequest:Lcom/htc/android/mail/server/Server$PendingRequest;
    :goto_9
    invoke-interface/range {v53 .. v53}, Landroid/database/Cursor;->moveToNext()Z

    move-result v4

    if-eqz v4, :cond_16

    .line 2103
    const-string v4, "_messageId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v12

    .line 2104
    iget-wide v4, v15, Lcom/htc/android/mail/server/Server$PendingRequest;->messageId:J

    cmp-long v4, v12, v4

    if-nez v4, :cond_14

    .line 2105
    const-string v4, "_id"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v16

    .line 2106
    const-string v4, "_request"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getInt(I)I

    move-result v44

    .line 2107
    const-string v4, "_fromMailboxId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v37

    .line 2108
    move/from16 v0, v44

    invoke-virtual {v15, v0}, Lcom/htc/android/mail/server/Server$PendingRequest;->updateRequestId(I)V

    .line 2109
    move-wide/from16 v0, v37

    invoke-virtual {v15, v0, v1}, Lcom/htc/android/mail/server/Server$PendingRequest;->updateFromMailboxId(J)V

    .line 2110
    invoke-virtual/range {v15 .. v17}, Lcom/htc/android/mail/server/Server$PendingRequest;->add(J)V

    goto :goto_9

    .line 2112
    :cond_14
    iget v4, v15, Lcom/htc/android/mail/server/Server$PendingRequest;->requestId:I

    const/4 v5, 0x4

    if-ne v4, v5, :cond_15

    .line 2113
    move-object/from16 v0, p0

    move-object/from16 v1, v62

    move-object/from16 v2, v56

    invoke-virtual {v0, v1, v15, v2}, Lcom/htc/android/mail/server/ImapServer;->addReadPendingRequest(Lcom/htc/android/mail/util/SparseArray;Lcom/htc/android/mail/server/Server$PendingRequest;Ljava/util/HashMap;)V

    .line 2118
    :goto_a
    const-string v4, "_id"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v16

    .line 2119
    const-string v4, "_accountId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v18

    .line 2120
    const-string v4, "_request"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getInt(I)I

    move-result v44

    .line 2121
    const-string v4, "_messageId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v12

    .line 2122
    const-string v4, "_fromMailboxId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v37

    .line 2123
    const-string v4, "_uid"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v22

    .line 2124
    const-string v4, "_msgId"

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v4

    move-object/from16 v0, v53

    invoke-interface {v0, v4}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v14

    .line 2126
    new-instance v15, Lcom/htc/android/mail/server/Server$PendingRequest;

    .end local v15           #pendingRequest:Lcom/htc/android/mail/server/Server$PendingRequest;
    move-object/from16 v39, v15

    move-wide/from16 v40, v16

    move-wide/from16 v42, v18

    move-wide/from16 v45, v12

    move-object/from16 v47, v22

    move-object/from16 v48, v14

    move-wide/from16 v49, v37

    invoke-direct/range {v39 .. v50}, Lcom/htc/android/mail/server/Server$PendingRequest;-><init>(JJIJLjava/lang/String;Ljava/lang/String;J)V

    .restart local v15       #pendingRequest:Lcom/htc/android/mail/server/Server$PendingRequest;
    goto/16 :goto_9

    .line 2115
    :cond_15
    move-object/from16 v0, p0

    move-object/from16 v1, v66

    move-object/from16 v2, v56

    invoke-virtual {v0, v1, v15, v2}, Lcom/htc/android/mail/server/ImapServer;->addReadPendingRequest(Lcom/htc/android/mail/util/SparseArray;Lcom/htc/android/mail/server/Server$PendingRequest;Ljava/util/HashMap;)V

    goto :goto_a

    .line 2130
    :cond_16
    iget v4, v15, Lcom/htc/android/mail/server/Server$PendingRequest;->requestId:I

    const/4 v5, 0x4

    if-ne v4, v5, :cond_1a

    .line 2131
    move-object/from16 v0, p0

    move-object/from16 v1, v62

    move-object/from16 v2, v56

    invoke-virtual {v0, v1, v15, v2}, Lcom/htc/android/mail/server/ImapServer;->addReadPendingRequest(Lcom/htc/android/mail/util/SparseArray;Lcom/htc/android/mail/server/Server$PendingRequest;Ljava/util/HashMap;)V

    .line 2136
    .end local v12           #messageId:J
    .end local v14           #msgIdInHeader:Ljava/lang/String;
    .end local v15           #pendingRequest:Lcom/htc/android/mail/server/Server$PendingRequest;
    .end local v16           #id:J
    .end local v18           #accountId:J
    .end local v22           #uid:Ljava/lang/String;
    .end local v37           #mailboxId:J
    .end local v44           #requestId:I
    :cond_17
    :goto_b
    invoke-interface/range {v53 .. v53}, Landroid/database/Cursor;->close()V

    .line 2139
    :cond_18
    invoke-virtual/range {v62 .. v62}, Lcom/htc/android/mail/util/SparseArray;->size()I

    move-result v63

    .line 2140
    const/16 v54, 0x0

    :goto_c
    move/from16 v0, v54

    move/from16 v1, v63

    if-ge v0, v1, :cond_1b

    .line 2141
    move-object/from16 v0, v62

    move/from16 v1, v54

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v60

    check-cast v60, Lcom/htc/android/mail/server/Server$PendingRequestList;

    .line 2142
    .restart local v60       #pendingRequestList:Lcom/htc/android/mail/server/Server$PendingRequestList;
    invoke-virtual/range {v60 .. v60}, Lcom/htc/android/mail/server/Server$PendingRequestList;->size()I

    move-result v4

    if-lez v4, :cond_19

    .line 2143
    move-object/from16 v0, p0

    move-object/from16 v1, v60

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->setMailRemoteStatus(Lcom/htc/android/mail/server/Server$PendingRequestList;)V

    .line 2140
    :cond_19
    add-int/lit8 v54, v54, 0x1

    goto :goto_c

    .line 2133
    .end local v60           #pendingRequestList:Lcom/htc/android/mail/server/Server$PendingRequestList;
    .restart local v12       #messageId:J
    .restart local v14       #msgIdInHeader:Ljava/lang/String;
    .restart local v15       #pendingRequest:Lcom/htc/android/mail/server/Server$PendingRequest;
    .restart local v16       #id:J
    .restart local v18       #accountId:J
    .restart local v22       #uid:Ljava/lang/String;
    .restart local v37       #mailboxId:J
    .restart local v44       #requestId:I
    :cond_1a
    move-object/from16 v0, p0

    move-object/from16 v1, v66

    move-object/from16 v2, v56

    invoke-virtual {v0, v1, v15, v2}, Lcom/htc/android/mail/server/ImapServer;->addReadPendingRequest(Lcom/htc/android/mail/util/SparseArray;Lcom/htc/android/mail/server/Server$PendingRequest;Ljava/util/HashMap;)V

    goto :goto_b

    .line 2146
    .end local v12           #messageId:J
    .end local v14           #msgIdInHeader:Ljava/lang/String;
    .end local v15           #pendingRequest:Lcom/htc/android/mail/server/Server$PendingRequest;
    .end local v16           #id:J
    .end local v18           #accountId:J
    .end local v22           #uid:Ljava/lang/String;
    .end local v37           #mailboxId:J
    .end local v44           #requestId:I
    :cond_1b
    invoke-virtual/range {v66 .. v66}, Lcom/htc/android/mail/util/SparseArray;->size()I

    move-result v63

    .line 2147
    const/16 v54, 0x0

    :goto_d
    move/from16 v0, v54

    move/from16 v1, v63

    if-ge v0, v1, :cond_1d

    .line 2148
    move-object/from16 v0, v66

    move/from16 v1, v54

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v60

    check-cast v60, Lcom/htc/android/mail/server/Server$PendingRequestList;

    .line 2149
    .restart local v60       #pendingRequestList:Lcom/htc/android/mail/server/Server$PendingRequestList;
    invoke-virtual/range {v60 .. v60}, Lcom/htc/android/mail/server/Server$PendingRequestList;->size()I

    move-result v4

    if-lez v4, :cond_1c

    .line 2150
    move-object/from16 v0, p0

    move-object/from16 v1, v60

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/server/ImapServer;->setMailRemoteStatus(Lcom/htc/android/mail/server/Server$PendingRequestList;)V

    .line 2147
    :cond_1c
    add-int/lit8 v54, v54, 0x1

    goto :goto_d

    .line 2154
    .end local v60           #pendingRequestList:Lcom/htc/android/mail/server/Server$PendingRequestList;
    :cond_1d
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->isFinishSyncPendingRequest()Z

    move-result v4

    if-eqz v4, :cond_1e

    .line 2155
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->whereForStoreUidSyncPendingRequests()Ljava/lang/String;

    move-result-object v7

    .line 2156
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v4

    sget-object v5, Lcom/htc/android/mail/MailProvider;->sPendingRequestURI:Landroid/net/Uri;

    const/4 v6, 0x0

    invoke-interface {v4, v5, v7, v6}, Landroid/content/IContentProvider;->delete(Landroid/net/Uri;Ljava/lang/String;[Ljava/lang/String;)I
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_2 .. :try_end_2} :catch_0

    .line 2162
    :cond_1e
    if-eqz v53, :cond_1

    invoke-interface/range {v53 .. v53}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_1

    goto/16 :goto_1
.end method

.method protected final updateAttachments(Lcom/htc/android/mail/IMap4Body;Lcom/htc/android/mail/MailMessage;ILjava/util/ArrayList;)V
    .locals 28
    .parameter "body"
    .parameter "mailMessage"
    .parameter "includeAttach"
    .parameter
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/IMap4Body;",
            "Lcom/htc/android/mail/MailMessage;",
            "I",
            "Ljava/util/ArrayList",
            "<",
            "Landroid/content/ContentProviderOperation;",
            ">;)V"
        }
    .end annotation

    .prologue
    .line 3135
    .local p4, operations:Ljava/util/ArrayList;,"Ljava/util/ArrayList<Landroid/content/ContentProviderOperation;>;"
    if-nez p3, :cond_1

    .line 3230
    :cond_0
    :goto_0
    return-void

    .line 3137
    :cond_1
    const/4 v13, 0x0

    .line 3141
    .local v13, cursor:Landroid/database/Cursor;
    :try_start_0
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v3, "_message = \'%d\'"

    const/4 v4, 0x1

    new-array v4, v4, [Ljava/lang/Object;

    const/4 v6, 0x0

    move-object/from16 v0, p2

    iget-wide v0, v0, Lcom/htc/android/mail/MailMessage;->id:J

    move-wide/from16 v26, v0

    invoke-static/range {v26 .. v27}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v7

    aput-object v7, v4, v6

    invoke-static {v2, v3, v4}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v5

    .line 3142
    .local v5, where:Ljava/lang/String;
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v2

    sget-object v3, Lcom/htc/android/mail/MailProvider;->sPartsURI:Landroid/net/Uri;

    const/4 v4, 0x1

    new-array v4, v4, [Ljava/lang/String;

    const/4 v6, 0x0

    const-string v7, "_index"

    aput-object v7, v4, v6

    const/4 v6, 0x0

    const/4 v7, 0x0

    invoke-interface/range {v2 .. v7}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v13

    .line 3143
    new-instance v20, Ljava/util/HashMap;

    invoke-direct/range {v20 .. v20}, Ljava/util/HashMap;-><init>()V

    .line 3144
    .local v20, indexMap:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Ljava/lang/Byte;>;"
    new-instance v9, Ljava/lang/Byte;

    const-string v2, "0"

    invoke-direct {v9, v2}, Ljava/lang/Byte;-><init>(Ljava/lang/String;)V

    .line 3145
    .local v9, b:Ljava/lang/Byte;
    if-eqz v13, :cond_3

    .line 3147
    :goto_1
    invoke-interface {v13}, Landroid/database/Cursor;->moveToNext()Z

    move-result v2

    if-eqz v2, :cond_2

    .line 3148
    const-string v2, "_index"

    invoke-interface {v13, v2}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v2

    invoke-interface {v13, v2}, Landroid/database/Cursor;->getString(I)Ljava/lang/String;

    move-result-object v19

    .line 3149
    .local v19, index:Ljava/lang/String;
    move-object/from16 v0, v20

    move-object/from16 v1, v19

    invoke-virtual {v0, v1, v9}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_1

    .line 3227
    .end local v5           #where:Ljava/lang/String;
    .end local v9           #b:Ljava/lang/Byte;
    .end local v19           #index:Ljava/lang/String;
    .end local v20           #indexMap:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Ljava/lang/Byte;>;"
    :catch_0
    move-exception v23

    .line 3228
    .local v23, rex:Landroid/os/RemoteException;
    const-string v2, "ImapServer"

    const-string v3, "error"

    move-object/from16 v0, v23

    invoke-static {v2, v3, v0}, Lcom/htc/android/mail/ll;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Exception;)V

    goto :goto_0

    .line 3151
    .end local v23           #rex:Landroid/os/RemoteException;
    .restart local v5       #where:Ljava/lang/String;
    .restart local v9       #b:Ljava/lang/Byte;
    .restart local v20       #indexMap:Ljava/util/HashMap;,"Ljava/util/HashMap<Ljava/lang/String;Ljava/lang/Byte;>;"
    :cond_2
    :try_start_1
    invoke-interface {v13}, Landroid/database/Cursor;->close()V

    .line 3152
    const/4 v13, 0x0

    .line 3155
    :cond_3
    const/16 v18, 0x0

    .local v18, i:I
    :goto_2
    move-object/from16 v0, p1

    iget-object v2, v0, Lcom/htc/android/mail/IMap4Body;->table:Ljava/util/HashMap;

    invoke-virtual {v2}, Ljava/util/HashMap;->size()I

    move-result v2

    move/from16 v0, v18

    if-ge v0, v2, :cond_0

    .line 3156
    sget-boolean v2, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v2, :cond_4

    .line 3157
    const-string v2, "ImapServer"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move/from16 v0, v18

    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "part number is :"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, p1

    iget-object v4, v0, Lcom/htc/android/mail/IMap4Body;->table:Ljava/util/HashMap;

    invoke-virtual {v4}, Ljava/util/HashMap;->size()I

    move-result v4

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 3158
    :cond_4
    move-object/from16 v0, p1

    iget-object v2, v0, Lcom/htc/android/mail/IMap4Body;->table:Ljava/util/HashMap;

    invoke-static/range {v18 .. v18}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    invoke-virtual {v2, v3}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/htc/android/mail/Imap4InfoObject;

    .line 3159
    .local v8, attach:Lcom/htc/android/mail/Imap4InfoObject;
    if-eqz v8, :cond_a

    .line 3160
    iget-object v0, v8, Lcom/htc/android/mail/Imap4InfoObject;->type:Ljava/lang/String;

    move-object/from16 v17, v0

    .line 3161
    .local v17, filetype:Ljava/lang/String;
    iget-object v0, v8, Lcom/htc/android/mail/Imap4InfoObject;->subtype:Ljava/lang/String;

    move-object/from16 v24, v0

    .line 3162
    .local v24, subtype:Ljava/lang/String;
    sget-boolean v2, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v2, :cond_5

    .line 3163
    const-string v2, "ImapServer"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "contenttype is :"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, v24

    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    .line 3164
    :cond_5
    iget-object v15, v8, Lcom/htc/android/mail/Imap4InfoObject;->typename:Ljava/lang/String;

    .line 3165
    .local v15, filename:Ljava/lang/String;
    iget-object v0, v8, Lcom/htc/android/mail/Imap4InfoObject;->size:Ljava/lang/String;

    move-object/from16 v16, v0

    .line 3166
    .local v16, filesize:Ljava/lang/String;
    iget-object v11, v8, Lcom/htc/android/mail/Imap4InfoObject;->cid:Ljava/lang/String;

    .line 3167
    .local v11, cid:Ljava/lang/String;
    iget-object v0, v8, Lcom/htc/android/mail/Imap4InfoObject;->inline:Ljava/lang/String;

    move-object/from16 v21, v0

    .line 3168
    .local v21, inline:Ljava/lang/String;
    iget-object v14, v8, Lcom/htc/android/mail/Imap4InfoObject;->encode:Ljava/lang/String;

    .line 3169
    .local v14, encode:Ljava/lang/String;
    iget-object v0, v8, Lcom/htc/android/mail/Imap4InfoObject;->index:Ljava/lang/String;

    move-object/from16 v19, v0

    .line 3170
    .restart local v19       #index:Ljava/lang/String;
    iget-object v2, v8, Lcom/htc/android/mail/Imap4InfoObject;->contenttype:Ljava/lang/String;

    invoke-static {v2}, Ljava/lang/Integer;->valueOf(Ljava/lang/String;)Ljava/lang/Integer;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/Integer;->intValue()I

    move-result v12

    .line 3171
    .local v12, contenttype:I
    iget-object v0, v8, Lcom/htc/android/mail/Imap4InfoObject;->isfile:Ljava/lang/String;

    move-object/from16 v22, v0

    .line 3173
    .local v22, isfile:Ljava/lang/String;
    const-string v2, "0"

    move-object/from16 v0, v22

    invoke-virtual {v0, v2}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_7

    .line 3155
    .end local v11           #cid:Ljava/lang/String;
    .end local v12           #contenttype:I
    .end local v14           #encode:Ljava/lang/String;
    .end local v15           #filename:Ljava/lang/String;
    .end local v16           #filesize:Ljava/lang/String;
    .end local v17           #filetype:Ljava/lang/String;
    .end local v19           #index:Ljava/lang/String;
    .end local v21           #inline:Ljava/lang/String;
    .end local v22           #isfile:Ljava/lang/String;
    .end local v24           #subtype:Ljava/lang/String;
    :cond_6
    :goto_3
    add-int/lit8 v18, v18, 0x1

    goto/16 :goto_2

    .line 3184
    .restart local v11       #cid:Ljava/lang/String;
    .restart local v12       #contenttype:I
    .restart local v14       #encode:Ljava/lang/String;
    .restart local v15       #filename:Ljava/lang/String;
    .restart local v16       #filesize:Ljava/lang/String;
    .restart local v17       #filetype:Ljava/lang/String;
    .restart local v19       #index:Ljava/lang/String;
    .restart local v21       #inline:Ljava/lang/String;
    .restart local v22       #isfile:Ljava/lang/String;
    .restart local v24       #subtype:Ljava/lang/String;
    :cond_7
    new-instance v25, Landroid/content/ContentValues;

    invoke-direct/range {v25 .. v25}, Landroid/content/ContentValues;-><init>()V

    .line 3186
    .local v25, values:Landroid/content/ContentValues;
    const-string v2, "_mimetype"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v0, v17

    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "/"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    move-object/from16 v0, v24

    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, v25

    invoke-virtual {v0, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3187
    const-string v2, "_filename"

    move-object/from16 v0, v25

    invoke-virtual {v0, v2, v15}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3188
    if-eqz v11, :cond_8

    .line 3189
    const-string v2, "_cid"

    move-object/from16 v0, v25

    invoke-virtual {v0, v2, v11}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3190
    :cond_8
    const-string v2, "_filesize"

    move-object/from16 v0, v25

    move-object/from16 v1, v16

    invoke-virtual {v0, v2, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3191
    const-string v2, "_contenttype"

    invoke-static {v12}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    move-object/from16 v0, v25

    invoke-virtual {v0, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 3192
    const-string v2, "_inline"

    move-object/from16 v0, v25

    move-object/from16 v1, v21

    invoke-virtual {v0, v2, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3193
    const-string v2, "_encode"

    move-object/from16 v0, v25

    invoke-virtual {v0, v2, v14}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3194
    const-string v2, "_index"

    move-object/from16 v0, v25

    move-object/from16 v1, v19

    invoke-virtual {v0, v2, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3195
    const-string v2, "_message"

    move-object/from16 v0, p2

    iget-wide v3, v0, Lcom/htc/android/mail/MailMessage;->id:J

    invoke-static {v3, v4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v3

    move-object/from16 v0, v25

    invoke-virtual {v0, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 3196
    const-string v2, "_account"

    move-object/from16 v0, p2

    iget-wide v3, v0, Lcom/htc/android/mail/MailMessage;->accountId:J

    invoke-static {v3, v4}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v3

    move-object/from16 v0, v25

    invoke-virtual {v0, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 3197
    const-string v2, "_flags"

    const/4 v3, 0x0

    invoke-static {v3}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    move-object/from16 v0, v25

    invoke-virtual {v0, v2, v3}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 3198
    move-object/from16 v0, v20

    move-object/from16 v1, v19

    invoke-virtual {v0, v1}, Ljava/util/HashMap;->containsKey(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_9

    .line 3205
    sget-boolean v2, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v2, :cond_6

    .line 3206
    const-string v2, "ImapServer"

    const-string v3, " exist, no need to update part"

    invoke-static {v2, v3}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    goto/16 :goto_3

    .line 3211
    :cond_9
    const/4 v10, 0x0

    .line 3212
    .local v10, builder:Landroid/content/ContentProviderOperation$Builder;
    sget-object v2, Lcom/htc/android/mail/MailProvider;->sPartsURI:Landroid/net/Uri;

    invoke-static {v2}, Landroid/content/ContentProviderOperation;->newInsert(Landroid/net/Uri;)Landroid/content/ContentProviderOperation$Builder;

    move-result-object v10

    .line 3213
    move-object/from16 v0, v25

    invoke-virtual {v10, v0}, Landroid/content/ContentProviderOperation$Builder;->withValues(Landroid/content/ContentValues;)Landroid/content/ContentProviderOperation$Builder;

    move-result-object v10

    .line 3214
    invoke-virtual {v10}, Landroid/content/ContentProviderOperation$Builder;->build()Landroid/content/ContentProviderOperation;

    move-result-object v2

    move-object/from16 v0, p4

    invoke-virtual {v0, v2}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    .line 3216
    sget-boolean v2, Lcom/htc/android/mail/Mail;->MAIL_DETAIL_DEBUG:Z

    if-eqz v2, :cond_6

    .line 3217
    const-string v2, "ImapServer"

    const-string v3, " insert part"

    invoke-static {v2, v3}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V

    goto/16 :goto_3

    .line 3221
    .end local v10           #builder:Landroid/content/ContentProviderOperation$Builder;
    .end local v11           #cid:Ljava/lang/String;
    .end local v12           #contenttype:I
    .end local v14           #encode:Ljava/lang/String;
    .end local v15           #filename:Ljava/lang/String;
    .end local v16           #filesize:Ljava/lang/String;
    .end local v17           #filetype:Ljava/lang/String;
    .end local v19           #index:Ljava/lang/String;
    .end local v21           #inline:Ljava/lang/String;
    .end local v22           #isfile:Ljava/lang/String;
    .end local v24           #subtype:Ljava/lang/String;
    .end local v25           #values:Landroid/content/ContentValues;
    :cond_a
    sget-boolean v2, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v2, :cond_6

    .line 3222
    const-string v2, "ImapServer"

    const-string v3, "no more part."

    invoke-static {v2, v3}, Lcom/htc/android/mail/ll;->d(Ljava/lang/String;Ljava/lang/String;)V
    :try_end_1
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0

    goto/16 :goto_3
.end method

.method public updateLastUid(Ljava/lang/String;)V
    .locals 6
    .parameter "uid"

    .prologue
    .line 3636
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v0

    .line 3637
    .local v0, cp:Landroid/content/IContentProvider;
    new-instance v2, Landroid/content/ContentValues;

    invoke-direct {v2}, Landroid/content/ContentValues;-><init>()V

    .line 3638
    .local v2, values:Landroid/content/ContentValues;
    const-string v3, "_lastuid"

    invoke-virtual {v2, v3, p1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 3640
    :try_start_0
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    sget-object v4, Lcom/htc/android/mail/MailProvider;->sMailBoxURI:Landroid/net/Uri;

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v3

    const-string v4, "/"

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v3

    iget-object v4, p0, Lcom/htc/android/mail/server/ImapServer;->mMailbox:Lcom/htc/android/mail/Mailbox;

    iget-wide v4, v4, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-virtual {v3, v4, v5}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v3

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v3}, Landroid/net/Uri;->parse(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v3

    const/4 v4, 0x0

    const/4 v5, 0x0

    invoke-interface {v0, v3, v2, v4, v5}, Landroid/content/IContentProvider;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    .line 3644
    :goto_0
    return-void

    .line 3641
    :catch_0
    move-exception v1

    .line 3642
    .local v1, re:Landroid/os/RemoteException;
    const-string v3, "ImapServer"

    const-string v4, "update mailbox last uid fail"

    invoke-static {v3, v4}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_0
.end method

.method protected updateMailbox(Lcom/htc/android/mail/Mailbox;Landroid/content/ContentValues;)V
    .locals 5
    .parameter "mailbox"
    .parameter "values"

    .prologue
    const/4 v4, 0x0

    .line 997
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v0

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    sget-object v2, Lcom/htc/android/mail/MailProvider;->sMailBoxURI:Landroid/net/Uri;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, "/"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget-wide v2, p1, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-virtual {v1, v2, v3}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v1}, Landroid/net/Uri;->parse(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v1

    invoke-virtual {v0, v1, p2, v4, v4}, Landroid/content/ContentResolver;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    .line 998
    return-void
.end method

.method protected updateMailboxToDb(Lcom/htc/android/mail/Mailbox;)J
    .locals 16
    .parameter "box"

    .prologue
    .line 5698
    const-wide/16 v8, 0x0

    .line 5699
    .local v8, id:J
    const/4 v7, 0x0

    .line 5700
    .local v7, c:Landroid/database/Cursor;
    sget-object v2, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v3, "_account = \'%d\' AND _undecodename = \'%s\' AND _serverfolder = \'%s\'"

    const/4 v1, 0x3

    new-array v5, v1, [Ljava/lang/Object;

    const/4 v1, 0x0

    move-object/from16 v0, p0

    iget-object v6, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v6}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v14

    invoke-static {v14, v15}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v6

    aput-object v6, v5, v1

    const/4 v1, 0x1

    move-object/from16 v0, p1

    iget-object v6, v0, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    aput-object v6, v5, v1

    const/4 v6, 0x2

    move-object/from16 v0, p1

    iget-boolean v1, v0, Lcom/htc/android/mail/Mailbox;->isServerFolder:Z

    if-eqz v1, :cond_0

    const/4 v1, 0x1

    :goto_0
    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v1

    aput-object v1, v5, v6

    invoke-static {v2, v3, v5}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v4

    .line 5701
    .local v4, where:Ljava/lang/String;
    move-object/from16 v0, p0

    iget-object v1, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v1

    sget-object v2, Lcom/htc/android/mail/MailProvider;->sMailBoxURI:Landroid/net/Uri;

    const/4 v3, 0x1

    new-array v3, v3, [Ljava/lang/String;

    const/4 v5, 0x0

    const-string v6, "_id"

    aput-object v6, v3, v5

    const/4 v5, 0x0

    const/4 v6, 0x0

    invoke-virtual/range {v1 .. v6}, Landroid/content/ContentResolver;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v7

    .line 5703
    if-eqz v7, :cond_2

    .line 5704
    :goto_1
    invoke-interface {v7}, Landroid/database/Cursor;->moveToNext()Z

    move-result v1

    if-eqz v1, :cond_1

    .line 5705
    const-string v1, "_id"

    invoke-interface {v7, v1}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v1

    invoke-interface {v7, v1}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v8

    goto :goto_1

    .line 5700
    .end local v4           #where:Ljava/lang/String;
    :cond_0
    const/4 v1, 0x0

    goto :goto_0

    .line 5707
    .restart local v4       #where:Ljava/lang/String;
    :cond_1
    invoke-interface {v7}, Landroid/database/Cursor;->close()V

    .line 5710
    :cond_2
    const-wide/16 v1, 0x0

    cmp-long v1, v1, v8

    if-nez v1, :cond_5

    .line 5711
    new-instance v13, Landroid/content/ContentValues;

    invoke-direct {v13}, Landroid/content/ContentValues;-><init>()V

    .line 5712
    .local v13, values:Landroid/content/ContentValues;
    const-string v1, "_undecodename"

    move-object/from16 v0, p1

    iget-object v2, v0, Lcom/htc/android/mail/Mailbox;->unDecodeName:Ljava/lang/String;

    invoke-virtual {v13, v1, v2}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 5713
    const-string v1, "_decodename"

    move-object/from16 v0, p1

    iget-object v2, v0, Lcom/htc/android/mail/Mailbox;->decodeName:Ljava/lang/String;

    invoke-virtual {v13, v1, v2}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 5714
    const-string v1, "_shortname"

    move-object/from16 v0, p1

    iget-object v2, v0, Lcom/htc/android/mail/Mailbox;->shortName:Ljava/lang/String;

    invoke-virtual {v13, v1, v2}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    .line 5715
    const-string v2, "_serverfolder"

    move-object/from16 v0, p1

    iget-boolean v1, v0, Lcom/htc/android/mail/Mailbox;->isServerFolder:Z

    if-eqz v1, :cond_3

    const/4 v1, 0x1

    :goto_2
    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v1

    invoke-virtual {v13, v2, v1}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 5716
    const-string v1, "_account"

    move-object/from16 v0, p0

    iget-object v2, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v2}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v2

    invoke-static {v2, v3}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v2

    invoke-virtual {v13, v1, v2}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Long;)V

    .line 5717
    const-string v1, "_noselect"

    move-object/from16 v0, p1

    iget v2, v0, Lcom/htc/android/mail/Mailbox;->mNoSelect:I

    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v2

    invoke-virtual {v13, v1, v2}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 5718
    const-string v1, "_haschild"

    move-object/from16 v0, p1

    iget v2, v0, Lcom/htc/android/mail/Mailbox;->mHasChild:I

    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v2

    invoke-virtual {v13, v1, v2}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 5719
    move-object/from16 v0, p1

    iget-object v1, v0, Lcom/htc/android/mail/Mailbox;->parentId:Ljava/lang/String;

    if-nez v1, :cond_4

    .line 5720
    const-string v1, "_parentId"

    const/4 v2, 0x0

    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v2

    invoke-virtual {v13, v1, v2}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 5723
    :goto_3
    move-object/from16 v0, p0

    iget-object v1, v0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v1

    sget-object v2, Lcom/htc/android/mail/MailProvider;->sMailBoxURI:Landroid/net/Uri;

    invoke-virtual {v1, v2, v13}, Landroid/content/ContentResolver;->insert(Landroid/net/Uri;Landroid/content/ContentValues;)Landroid/net/Uri;

    move-result-object v12

    .line 5724
    .local v12, uri:Landroid/net/Uri;
    invoke-static {v12}, Landroid/content/ContentUris;->parseId(Landroid/net/Uri;)J

    move-result-wide v8

    move-wide v10, v8

    .line 5728
    .end local v8           #id:J
    .end local v12           #uri:Landroid/net/Uri;
    .end local v13           #values:Landroid/content/ContentValues;
    .local v10, id:J
    :goto_4
    return-wide v10

    .line 5715
    .end local v10           #id:J
    .restart local v8       #id:J
    .restart local v13       #values:Landroid/content/ContentValues;
    :cond_3
    const/4 v1, 0x0

    goto :goto_2

    .line 5722
    :cond_4
    const-string v1, "_parentId"

    move-object/from16 v0, p1

    iget-object v2, v0, Lcom/htc/android/mail/Mailbox;->parentId:Ljava/lang/String;

    invoke-virtual {v13, v1, v2}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/String;)V

    goto :goto_3

    .end local v13           #values:Landroid/content/ContentValues;
    :cond_5
    move-wide v10, v8

    .line 5728
    .end local v8           #id:J
    .restart local v10       #id:J
    goto :goto_4
.end method

.method protected updateUnSeenStatus(Lcom/htc/android/mail/Mailbox;)V
    .locals 18
    .parameter "mailbox"

    .prologue
    .line 1634
    invoke-static {}, Lcom/htc/android/mail/MailProvider;->instance()Landroid/content/IContentProvider;

    move-result-object v2

    .line 1635
    .local v2, cp:Landroid/content/IContentProvider;
    const/4 v8, 0x0

    .line 1638
    .local v8, c:Landroid/database/Cursor;
    :try_start_0
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "_account = \'%d\' AND _mailboxId = \'%d\'"

    const/4 v6, 0x2

    new-array v6, v6, [Ljava/lang/Object;

    const/4 v7, 0x0

    move-object/from16 v0, p0

    iget-object v0, v0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    move-object/from16 v16, v0

    invoke-virtual/range {v16 .. v16}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v16

    invoke-static/range {v16 .. v17}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v16

    aput-object v16, v6, v7

    const/4 v7, 0x1

    move-object/from16 v0, p1

    iget-wide v0, v0, Lcom/htc/android/mail/Mailbox;->id:J

    move-wide/from16 v16, v0

    invoke-static/range {v16 .. v17}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v16

    aput-object v16, v6, v7

    invoke-static {v3, v4, v6}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v5

    .line 1639
    .local v5, where:Ljava/lang/String;
    sget-object v3, Lcom/htc/android/mail/MailProvider;->sMessagesURI:Landroid/net/Uri;

    const/4 v4, 0x1

    new-array v4, v4, [Ljava/lang/String;

    const/4 v6, 0x0

    const-string v7, "min(abs(_uid)) as _minuid"

    aput-object v7, v4, v6

    const/4 v6, 0x0

    const/4 v7, 0x0

    invoke-interface/range {v2 .. v7}, Landroid/content/IContentProvider;->query(Landroid/net/Uri;[Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)Landroid/database/Cursor;

    move-result-object v8

    .line 1640
    const-string v14, "1"

    .line 1641
    .local v14, uid:Ljava/lang/String;
    if-eqz v8, :cond_3

    .line 1642
    invoke-interface {v8}, Landroid/database/Cursor;->moveToNext()Z

    move-result v3

    if-eqz v3, :cond_3

    .line 1643
    const-string v3, "_minuid"

    invoke-interface {v8, v3}, Landroid/database/Cursor;->getColumnIndexOrThrow(Ljava/lang/String;)I

    move-result v3

    invoke-interface {v8, v3}, Landroid/database/Cursor;->getLong(I)J

    move-result-wide v3

    invoke-static {v3, v4}, Ljava/lang/String;->valueOf(J)Ljava/lang/String;

    move-result-object v14

    .line 1645
    if-eqz v14, :cond_5

    .line 1646
    const-string v3, "0"

    invoke-virtual {v3, v14}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_0

    .line 1647
    const-string v14, "1"

    .line 1649
    :cond_0
    invoke-virtual/range {p0 .. p0}, Lcom/htc/android/mail/server/ImapServer;->getMSGID()Ljava/lang/String;

    move-result-object v13

    .line 1650
    .local v13, tag:Ljava/lang/String;
    if-nez v13, :cond_1

    .line 1651
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "%s UID SEARCH UID %s:* UNSEEN"

    const/4 v6, 0x2

    new-array v6, v6, [Ljava/lang/Object;

    const/4 v7, 0x0

    aput-object v13, v6, v7

    const/4 v7, 0x1

    aput-object v14, v6, v7

    invoke-static {v3, v4, v6}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v12

    .line 1652
    .local v12, strT:Ljava/lang/String;
    sget-boolean v3, Lcom/htc/android/mail/Mail;->MAIL_DEBUG:Z

    if-eqz v3, :cond_1

    const-string v3, "ImapServer"

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "It has issues. tag is null="

    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 1656
    .end local v12           #strT:Ljava/lang/String;
    :cond_1
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "%s UID SEARCH UID %s:* UNSEEN"

    const/4 v6, 0x2

    new-array v6, v6, [Ljava/lang/Object;

    const/4 v7, 0x0

    aput-object v13, v6, v7

    const/4 v7, 0x1

    aput-object v14, v6, v7

    invoke-static {v3, v4, v6}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p0

    invoke-virtual {v0, v3}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 1657
    move-object/from16 v0, p0

    invoke-virtual {v0, v13}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v10

    .line 1658
    .local v10, list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    move-object/from16 v0, p0

    invoke-virtual {v0, v10}, Lcom/htc/android/mail/server/ImapServer;->processUnSeenStatus(Ljava/util/List;)Ljava/util/List;

    move-result-object v15

    .line 1659
    .local v15, unseenList:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    if-eqz v15, :cond_2

    invoke-interface {v15}, Ljava/util/List;->size()I

    move-result v3

    if-lez v3, :cond_2

    .line 1660
    const/4 v3, 0x1

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    invoke-virtual {v0, v1, v15, v3}, Lcom/htc/android/mail/server/ImapServer;->updateUnSeenStatusToDB(Lcom/htc/android/mail/Mailbox;Ljava/util/List;Z)V

    .line 1663
    :cond_2
    sget-object v3, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v4, "%s UID SEARCH UID %s:* SEEN"

    const/4 v6, 0x2

    new-array v6, v6, [Ljava/lang/Object;

    const/4 v7, 0x0

    aput-object v13, v6, v7

    const/4 v7, 0x1

    aput-object v14, v6, v7

    invoke-static {v3, v4, v6}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v3

    move-object/from16 v0, p0

    invoke-virtual {v0, v3}, Lcom/htc/android/mail/server/ImapServer;->issue(Ljava/lang/String;)V

    .line 1664
    move-object/from16 v0, p0

    invoke-virtual {v0, v13}, Lcom/htc/android/mail/server/ImapServer;->readResponse(Ljava/lang/String;)Ljava/util/List;

    move-result-object v10

    .line 1665
    move-object/from16 v0, p0

    invoke-virtual {v0, v10}, Lcom/htc/android/mail/server/ImapServer;->processUnSeenStatus(Ljava/util/List;)Ljava/util/List;

    move-result-object v11

    .line 1666
    .local v11, seenList:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    if-eqz v11, :cond_3

    invoke-interface {v11}, Ljava/util/List;->size()I

    move-result v3

    if-lez v3, :cond_3

    .line 1667
    const/4 v3, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    invoke-virtual {v0, v1, v11, v3}, Lcom/htc/android/mail/server/ImapServer;->updateUnSeenStatusToDB(Lcom/htc/android/mail/Mailbox;Ljava/util/List;Z)V
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_1

    .line 1679
    .end local v10           #list:Ljava/util/List;,"Ljava/util/List<Lcom/htc/android/mail/ByteString;>;"
    .end local v11           #seenList:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    .end local v13           #tag:Ljava/lang/String;
    .end local v15           #unseenList:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    :cond_3
    :goto_0
    if-eqz v8, :cond_4

    invoke-interface {v8}, Landroid/database/Cursor;->isClosed()Z

    move-result v3

    if-nez v3, :cond_4

    .line 1680
    .end local v5           #where:Ljava/lang/String;
    .end local v14           #uid:Ljava/lang/String;
    :goto_1
    invoke-interface {v8}, Landroid/database/Cursor;->close()V

    .line 1684
    :cond_4
    return-void

    .line 1670
    .restart local v5       #where:Ljava/lang/String;
    .restart local v14       #uid:Ljava/lang/String;
    :cond_5
    :try_start_1
    const-string v3, "1"
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0
    .catch Landroid/os/RemoteException; {:try_start_1 .. :try_end_1} :catch_0
    .catch Ljava/io/IOException; {:try_start_1 .. :try_end_1} :catch_1

    goto :goto_0

    .line 1674
    .end local v5           #where:Ljava/lang/String;
    .end local v14           #uid:Ljava/lang/String;
    :catch_0
    move-exception v9

    .line 1675
    .local v9, e:Landroid/os/RemoteException;
    :try_start_2
    const-string v3, "ImapServer"

    const-string v4, "query messages table fail"

    invoke-static {v3, v4, v9}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    .line 1679
    if-eqz v8, :cond_4

    invoke-interface {v8}, Landroid/database/Cursor;->isClosed()Z

    move-result v3

    if-nez v3, :cond_4

    goto :goto_1

    .line 1676
    .end local v9           #e:Landroid/os/RemoteException;
    :catch_1
    move-exception v9

    .line 1677
    .local v9, e:Ljava/io/IOException;
    :try_start_3
    const-string v3, "ImapServer"

    const-string v4, "timeout"

    invoke-static {v3, v4, v9}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    .line 1679
    if-eqz v8, :cond_4

    invoke-interface {v8}, Landroid/database/Cursor;->isClosed()Z

    move-result v3

    if-nez v3, :cond_4

    goto :goto_1

    .end local v9           #e:Ljava/io/IOException;
    :catchall_0
    move-exception v3

    if-eqz v8, :cond_6

    invoke-interface {v8}, Landroid/database/Cursor;->isClosed()Z

    move-result v4

    if-nez v4, :cond_6

    .line 1680
    invoke-interface {v8}, Landroid/database/Cursor;->close()V

    .line 1679
    :cond_6
    throw v3
.end method

.method protected updateUnSeenStatusToDB(Lcom/htc/android/mail/Mailbox;Ljava/util/List;Z)V
    .locals 11
    .parameter "mailbox"
    .parameter
    .parameter "isSetUnseen"
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/htc/android/mail/Mailbox;",
            "Ljava/util/List",
            "<",
            "Ljava/lang/String;",
            ">;Z)V"
        }
    .end annotation

    .prologue
    .line 1725
    .local p2, uidList:Ljava/util/List;,"Ljava/util/List<Ljava/lang/String;>;"
    if-eqz p2, :cond_0

    invoke-interface {p2}, Ljava/util/List;->size()I

    move-result v5

    if-nez v5, :cond_1

    .line 1743
    :cond_0
    :goto_0
    return-void

    .line 1728
    :cond_1
    new-instance v3, Landroid/content/ContentValues;

    invoke-direct {v3}, Landroid/content/ContentValues;-><init>()V

    .line 1729
    .local v3, values:Landroid/content/ContentValues;
    const-string v0, ""

    .line 1730
    .local v0, idSeq:Ljava/lang/String;
    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mMessageStatusMap:Lcom/htc/android/mail/AbsRequestController$MessageStatusMap;

    const-string v6, "READ"

    invoke-virtual {v5, v6}, Lcom/htc/android/mail/AbsRequestController$MessageStatusMap;->get(Ljava/lang/String;)Lcom/htc/android/mail/AbsRequestController$MessageStatus;

    move-result-object v1

    .line 1731
    .local v1, messageStatus:Lcom/htc/android/mail/AbsRequestController$MessageStatus;
    if-eqz v1, :cond_2

    .line 1732
    const-string v5, ","

    const/4 v6, 0x1

    invoke-virtual {v1, v5, v6}, Lcom/htc/android/mail/AbsRequestController$MessageStatus;->getInvalidateIdList(Ljava/lang/String;Z)Ljava/lang/String;

    move-result-object v0

    .line 1734
    :cond_2
    const-string v5, ","

    const/4 v6, 0x1

    invoke-virtual {p0, p2, v5, v6}, Lcom/htc/android/mail/server/ImapServer;->combine(Ljava/util/List;Ljava/lang/String;Z)Ljava/lang/String;

    move-result-object v2

    .line 1735
    .local v2, uidSeq:Ljava/lang/String;
    const-string v5, ""

    invoke-virtual {v5, v0}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_4

    .line 1736
    sget-object v6, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v7, "+_mailboxId = %d AND _uid in (%s) AND +_read = %d"

    const/4 v5, 0x3

    new-array v8, v5, [Ljava/lang/Object;

    const/4 v5, 0x0

    iget-wide v9, p1, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-static {v9, v10}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v9

    aput-object v9, v8, v5

    const/4 v5, 0x1

    aput-object v2, v8, v5

    const/4 v9, 0x2

    if-eqz p3, :cond_3

    const/4 v5, 0x1

    :goto_1
    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v8, v9

    invoke-static {v6, v7, v8}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v4

    .line 1740
    .local v4, where:Ljava/lang/String;
    :goto_2
    invoke-virtual {v3}, Landroid/content/ContentValues;->clear()V

    .line 1741
    const-string v6, "_read"

    if-eqz p3, :cond_6

    const/4 v5, 0x0

    :goto_3
    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    invoke-virtual {v3, v6, v5}, Landroid/content/ContentValues;->put(Ljava/lang/String;Ljava/lang/Integer;)V

    .line 1742
    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mContext:Landroid/content/Context;

    invoke-virtual {v5}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v5

    iget-object v6, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v6}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v6

    iget-wide v8, p1, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-virtual {p0, v6, v7, v8, v9}, Lcom/htc/android/mail/server/ImapServer;->getSummariesUri(JJ)Landroid/net/Uri;

    move-result-object v6

    const/4 v7, 0x0

    invoke-virtual {v5, v6, v3, v4, v7}, Landroid/content/ContentResolver;->update(Landroid/net/Uri;Landroid/content/ContentValues;Ljava/lang/String;[Ljava/lang/String;)I

    goto :goto_0

    .line 1736
    .end local v4           #where:Ljava/lang/String;
    :cond_3
    const/4 v5, 0x0

    goto :goto_1

    .line 1738
    :cond_4
    sget-object v6, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v7, "+_mailboxId = %d AND _uid in (%s) AND +_read = %d AND +_id not in (%s)"

    const/4 v5, 0x4

    new-array v8, v5, [Ljava/lang/Object;

    const/4 v5, 0x0

    iget-wide v9, p1, Lcom/htc/android/mail/Mailbox;->id:J

    invoke-static {v9, v10}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v9

    aput-object v9, v8, v5

    const/4 v5, 0x1

    aput-object v2, v8, v5

    const/4 v9, 0x2

    if-eqz p3, :cond_5

    const/4 v5, 0x1

    :goto_4
    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v8, v9

    const/4 v5, 0x3

    aput-object v0, v8, v5

    invoke-static {v6, v7, v8}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v4

    .restart local v4       #where:Ljava/lang/String;
    goto :goto_2

    .end local v4           #where:Ljava/lang/String;
    :cond_5
    const/4 v5, 0x0

    goto :goto_4

    .line 1741
    .restart local v4       #where:Ljava/lang/String;
    :cond_6
    const/4 v5, 0x1

    goto :goto_3
.end method

.method protected whereForDeleteMailSyncPendingRequests()Ljava/lang/String;
    .locals 8

    .prologue
    const/4 v7, 0x1

    .line 1906
    sget-object v1, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v2, "_accountId = %d AND _request = %d"

    const/4 v3, 0x2

    new-array v3, v3, [Ljava/lang/Object;

    const/4 v4, 0x0

    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v5}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v5

    invoke-static {v5, v6}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v5

    aput-object v5, v3, v4

    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v3, v7

    invoke-static {v1, v2, v3}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v0

    .line 1907
    .local v0, where:Ljava/lang/String;
    return-object v0
.end method

.method protected whereForEmptyMailboxSyncPendingRequests()Ljava/lang/String;
    .locals 7

    .prologue
    .line 1911
    sget-object v1, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v2, "_accountId = %d AND _request = %d"

    const/4 v3, 0x2

    new-array v3, v3, [Ljava/lang/Object;

    const/4 v4, 0x0

    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v5}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v5

    invoke-static {v5, v6}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v5

    aput-object v5, v3, v4

    const/4 v4, 0x1

    const/16 v5, 0x8

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v3, v4

    invoke-static {v1, v2, v3}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v0

    .line 1912
    .local v0, where:Ljava/lang/String;
    return-object v0
.end method

.method protected whereForGetUidSyncPendingRequests()Ljava/lang/String;
    .locals 7

    .prologue
    .line 1891
    sget-object v1, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v2, "_accountId = %d AND _request = %d"

    const/4 v3, 0x2

    new-array v3, v3, [Ljava/lang/Object;

    const/4 v4, 0x0

    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v5}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v5

    invoke-static {v5, v6}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v5

    aput-object v5, v3, v4

    const/4 v4, 0x1

    const/4 v5, 0x5

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v3, v4

    invoke-static {v1, v2, v3}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v0

    .line 1892
    .local v0, where:Ljava/lang/String;
    return-object v0
.end method

.method protected whereForIsFinishSyncPendingRequest()Ljava/lang/String;
    .locals 12

    .prologue
    const/4 v11, 0x5

    const/4 v10, 0x4

    const/4 v9, 0x3

    const/4 v8, 0x2

    const/4 v7, 0x1

    .line 1746
    sget-object v1, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v2, "_accountId = \'%d\' AND _request in (\'%d\', \'%d\', \'%d\', \'%d\', \'%d\')"

    const/4 v3, 0x6

    new-array v3, v3, [Ljava/lang/Object;

    const/4 v4, 0x0

    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v5}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v5

    invoke-static {v5, v6}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v5

    aput-object v5, v3, v4

    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v3, v7

    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v3, v8

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v3, v9

    invoke-static {v10}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v3, v10

    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v3, v11

    invoke-static {v1, v2, v3}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v0

    .line 1749
    .local v0, where:Ljava/lang/String;
    return-object v0
.end method

.method protected whereForMoveMailGetUidSyncPendingRequests()Ljava/lang/String;
    .locals 8

    .prologue
    const/4 v7, 0x2

    .line 1901
    sget-object v1, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v2, "_accountId = %d AND _request in (\'%d\', \'%d\')"

    const/4 v3, 0x3

    new-array v3, v3, [Ljava/lang/Object;

    const/4 v4, 0x0

    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v5}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v5

    invoke-static {v5, v6}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v5

    aput-object v5, v3, v4

    const/4 v4, 0x1

    const/4 v5, 0x5

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v3, v4

    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    aput-object v4, v3, v7

    invoke-static {v1, v2, v3}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v0

    .line 1902
    .local v0, where:Ljava/lang/String;
    return-object v0
.end method

.method protected whereForMoveMailSyncPendingRequests()Ljava/lang/String;
    .locals 8

    .prologue
    const/4 v7, 0x2

    .line 1896
    sget-object v1, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v2, "_accountId = %d AND _request = %d"

    new-array v3, v7, [Ljava/lang/Object;

    const/4 v4, 0x0

    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v5}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v5

    invoke-static {v5, v6}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v5

    aput-object v5, v3, v4

    const/4 v4, 0x1

    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v3, v4

    invoke-static {v1, v2, v3}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v0

    .line 1897
    .local v0, where:Ljava/lang/String;
    return-object v0
.end method

.method protected whereForReadUnreadMailSyncPendingRequests()Ljava/lang/String;
    .locals 8

    .prologue
    const/4 v7, 0x3

    .line 1916
    sget-object v1, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v2, "_accountId = %d AND _request in (\'%d\', \'%d\')"

    new-array v3, v7, [Ljava/lang/Object;

    const/4 v4, 0x0

    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v5}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v5

    invoke-static {v5, v6}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v5

    aput-object v5, v3, v4

    const/4 v4, 0x1

    const/4 v5, 0x4

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v3, v4

    const/4 v4, 0x2

    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v3, v4

    invoke-static {v1, v2, v3}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v0

    .line 1917
    .local v0, where:Ljava/lang/String;
    return-object v0
.end method

.method protected whereForStoreUidSyncPendingRequests()Ljava/lang/String;
    .locals 7

    .prologue
    .line 1921
    sget-object v1, Ljava/util/Locale;->US:Ljava/util/Locale;

    const-string v2, "_accountId = \'%d\' AND _request = \'%d\'"

    const/4 v3, 0x2

    new-array v3, v3, [Ljava/lang/Object;

    const/4 v4, 0x0

    iget-object v5, p0, Lcom/htc/android/mail/server/ImapServer;->mAccount:Lcom/htc/android/mail/Account;

    invoke-virtual {v5}, Lcom/htc/android/mail/Account;->getId()J

    move-result-wide v5

    invoke-static {v5, v6}, Ljava/lang/Long;->valueOf(J)Ljava/lang/Long;

    move-result-object v5

    aput-object v5, v3, v4

    const/4 v4, 0x1

    const/4 v5, 0x7

    invoke-static {v5}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    aput-object v5, v3, v4

    invoke-static {v1, v2, v3}, Ljava/lang/String;->format(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v0

    .line 1922
    .local v0, where:Ljava/lang/String;
    return-object v0
.end method

.method protected final write(Ljava/lang/String;)V
    .locals 4
    .parameter "data"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    const/16 v3, 0xd

    const/16 v2, 0xa

    .line 653
    const-string v1, "us-ascii"

    invoke-virtual {p1, v1}, Ljava/lang/String;->getBytes(Ljava/lang/String;)[B

    move-result-object v0

    .line 654
    .local v0, bytes:[B
    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->countOutStream:Lcom/htc/android/mail/CountSizeOutputStream;

    if-eqz v1, :cond_1

    .line 655
    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->countOutStream:Lcom/htc/android/mail/CountSizeOutputStream;

    invoke-virtual {v1, v0}, Lcom/htc/android/mail/CountSizeOutputStream;->write([B)V

    .line 656
    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->countOutStream:Lcom/htc/android/mail/CountSizeOutputStream;

    invoke-virtual {v1, v3}, Lcom/htc/android/mail/CountSizeOutputStream;->write(I)V

    .line 657
    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->countOutStream:Lcom/htc/android/mail/CountSizeOutputStream;

    invoke-virtual {v1, v2}, Lcom/htc/android/mail/CountSizeOutputStream;->write(I)V

    .line 658
    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->countOutStream:Lcom/htc/android/mail/CountSizeOutputStream;

    invoke-virtual {v1}, Lcom/htc/android/mail/CountSizeOutputStream;->flush()V

    .line 665
    :cond_0
    :goto_0
    return-void

    .line 659
    :cond_1
    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mOut:Ljava/io/BufferedOutputStream;

    if-eqz v1, :cond_0

    .line 660
    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mOut:Ljava/io/BufferedOutputStream;

    invoke-virtual {v1, v0}, Ljava/io/BufferedOutputStream;->write([B)V

    .line 661
    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mOut:Ljava/io/BufferedOutputStream;

    invoke-virtual {v1, v3}, Ljava/io/BufferedOutputStream;->write(I)V

    .line 662
    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mOut:Ljava/io/BufferedOutputStream;

    invoke-virtual {v1, v2}, Ljava/io/BufferedOutputStream;->write(I)V

    .line 663
    iget-object v1, p0, Lcom/htc/android/mail/server/ImapServer;->mOut:Ljava/io/BufferedOutputStream;

    invoke-virtual {v1}, Ljava/io/BufferedOutputStream;->flush()V

    goto :goto_0
.end method

.method protected final write([B)V
    .locals 3
    .parameter "data"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/io/IOException;
        }
    .end annotation

    .prologue
    const/16 v2, 0xd

    const/16 v1, 0xa

    .line 668
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->countOutStream:Lcom/htc/android/mail/CountSizeOutputStream;

    if-eqz v0, :cond_1

    .line 669
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->countOutStream:Lcom/htc/android/mail/CountSizeOutputStream;

    invoke-virtual {v0, p1}, Lcom/htc/android/mail/CountSizeOutputStream;->write([B)V

    .line 670
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->countOutStream:Lcom/htc/android/mail/CountSizeOutputStream;

    invoke-virtual {v0, v2}, Lcom/htc/android/mail/CountSizeOutputStream;->write(I)V

    .line 671
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->countOutStream:Lcom/htc/android/mail/CountSizeOutputStream;

    invoke-virtual {v0, v1}, Lcom/htc/android/mail/CountSizeOutputStream;->write(I)V

    .line 672
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->countOutStream:Lcom/htc/android/mail/CountSizeOutputStream;

    invoke-virtual {v0}, Lcom/htc/android/mail/CountSizeOutputStream;->flush()V

    .line 679
    :cond_0
    :goto_0
    return-void

    .line 674
    :cond_1
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mOut:Ljava/io/BufferedOutputStream;

    if-eqz v0, :cond_0

    .line 675
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mOut:Ljava/io/BufferedOutputStream;

    invoke-virtual {v0, p1}, Ljava/io/BufferedOutputStream;->write([B)V

    .line 676
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mOut:Ljava/io/BufferedOutputStream;

    invoke-virtual {v0, v2}, Ljava/io/BufferedOutputStream;->write(I)V

    .line 677
    iget-object v0, p0, Lcom/htc/android/mail/server/ImapServer;->mOut:Ljava/io/BufferedOutputStream;

    invoke-virtual {v0, v1}, Ljava/io/BufferedOutputStream;->write(I)V

    goto :goto_0
.end method

.method protected writeImportanceHeader(I)V
    .locals 1
    .parameter "importance"
    .annotation system Ldalvik/annotation/Throws;
        value = {
            Ljava/lang/Exception;
        }
    .end annotation

    .prologue
    .line 5235
    packed-switch p1, :pswitch_data_0

    .line 5245
    :goto_0
    :pswitch_0
    return-void

    .line 5237
    :pswitch_1
    const-string v0, "Importance: low"

    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    goto :goto_0

    .line 5240
    :pswitch_2
    const-string v0, "Importance: high"

    invoke-virtual {p0, v0}, Lcom/htc/android/mail/server/ImapServer;->write(Ljava/lang/String;)V

    goto :goto_0

    .line 5235
    :pswitch_data_0
    .packed-switch 0x0
        :pswitch_1
        :pswitch_0
        :pswitch_2
    .end packed-switch
.end method
